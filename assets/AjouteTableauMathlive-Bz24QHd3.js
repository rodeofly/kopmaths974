import{n as x}from"./tableauMathlive-xx-nDjq0.js";import{b as E}from"./Exercice-DtXhjCyI.js";function C({isInteractif:m,line:i,icell:n,indexCol:e,indexLine:t,tag:s,classes:o,NoEx:h,NoQ:r,style:d}){const c=document.createElement(s);let a;const p=n.options||{};if(n.texte==="")if(m){if(p.texteAvant!=null&&p.texteAvant!==""){const g=document.createElement("span");g.classList.add("tableauMathlive"),g.textContent=p.texteAvant,c.appendChild(g)}a=document.createElement("math-field"),p.espace&&a.setAttribute("data-space","true"),a.classList.add("tableauMathlive");const l=E(o).join(" ");if(a.setAttribute("data-keyboard",l),a.id=`champTexteEx${h}Q${r}L${t}C${e}`,a.setAttribute("virtual-keyboard-mode","manual"),c.appendChild(a),p.texteApres!=null&&p.texteApres!==""){const g=document.createElement("span");g.textContent=p.texteApres,c.appendChild(g)}const $=document.createElement("span");$.id=`resultatCheckEx${h}Q${r}L${t}C${e}`,c.appendChild($)}else{a=document.createElement("span"),a.classList.add("tableauMathlive");for(const l of o.split(" "))l!==""&&a.classList.add(l);a.id=`cell${h}Q${r}L${t}C${e}`,c.appendChild(a)}else n.latex?(a=document.createElement("span"),c.appendChild(a),a.outerHTML=`<span id="spanEx${h}Q${r}L${t}C${e}">$${n.texte}$</span>`):(a=document.createElement("span"),c.appendChild(a),a.outerHTML=`<span id="spanEx${h}Q${r}L${t}C${e}">${n.texte}</span>`);d!=null&&(c.style.backgroundColor=d.split(";")[0]||"transparent",c.style.color=d.split(";")[1]||"black"),i.appendChild(c)}const b=function({isInteractif:m,line:i,content:n,index:e,tag:t,classes:s,NoEx:o,NoQ:h,style:r}){for(let d=0;d<n.length;d++)C({isInteractif:m,line:i,icell:n[d],indexCol:d,indexLine:e,tag:t,classes:s,NoEx:o,NoQ:h,style:r[`L${e}C${d}`]})};class v{styles;id;numeroExercice;numeroQuestion;output;nbColonnes;ligne1;ligne2;flecheHaut;flecheBas;flecheDroite;flecheDroiteSens;flecheGauche;flecheGaucheSens;classes;isInteractif;constructor(i,n,e,t,s){this.nbColonnes=e.nbColonnes??1,this.flecheHaut=e.flecheHaut??[],this.flecheBas=e.flecheBas??[],this.flecheDroite=e.flecheDroite??!1,this.flecheDroiteSens=e.flecheDroiteSens??"bas",this.flecheGauche=e.flecheGauche??!1,this.flecheGaucheSens=e.flecheGaucheSens??"haut",this.numeroExercice=i??0,this.numeroQuestion=n,this.id=`tabMLEx${this.numeroExercice}Q${this.numeroQuestion}`,this.classes=t,this.isInteractif=s,this.styles={}}static create(i,n,e,t,s,o){(!Array.isArray(e.ligne1)||!Array.isArray(e.ligne1))&&x("ajouteTableauMathlive : vérifiez vos paramètres !",{ligne1:e.ligne1,ligne2:e.ligne2,nbColonnes:e.nbColonnes}),o==null&&(o={});const h=i??0,r=n,d=[...e.ligne1],c=[...e.ligne2],a=new v(i,n,e,t,s);a.ligne1=d.map(u=>JSON.parse(JSON.stringify(u))),a.ligne2=c.map(u=>JSON.parse(JSON.stringify(u))),a.styles=o;const p=document.createElement("table");p.className="tableauMathlive",p.id=`tabMathliveEx${h}Q${n}`;const l=document.createElement("tr"),$=d.shift();$&&C({isInteractif:s,line:l,icell:$,indexCol:0,indexLine:0,tag:"th",classes:t,NoEx:h,NoQ:r,style:o.L0C0});for(let u=0;u<d.length;u++)C({isInteractif:s,line:l,icell:d[u],indexCol:u+1,indexLine:0,tag:"td",classes:t,NoEx:h,NoQ:r,style:o[`L0C${u+1}`]??d[u].style});p.appendChild(l);const g=document.createElement("tr"),f=c.shift();f&&C({isInteractif:s,line:g,icell:f,indexCol:0,indexLine:1,tag:"th",classes:t,NoEx:h,NoQ:r,style:o.L1C0});for(let u=0;u<c.length;u++)C({isInteractif:s,line:g,icell:c[u],indexCol:u+1,indexLine:1,tag:"td",classes:t,NoEx:h,NoQ:r,style:o[`L1C${u+1}`]??c[u].style});p.appendChild(g);const L=`<span id="resultatCheckEx${i}Q${n}"></span>`;return a.output=p.outerHTML+L,a}static convertTableauToTableauMathlive(i,n,e=!1,t="black"){const s=Math.max(i.length,n.length),o=[],h=[];for(const r of i)o.push({texte:r,latex:!0,gras:e,color:t});for(const r of n)h.push({texte:r,latex:!0,gras:e,color:t});return{ligne1:o,ligne2:h,nbColonnes:s}}get latexOutput(){let i="\\begin{tabular}{|c|"+"c|".repeat(this.nbColonnes-1)+`}
`;i+=`\\hline
`;let n=[];for(let e=0;e<this.ligne1.length;e++){const t=this.ligne1[e],s=this.styles[`L0C${e}`]??"";n.push(`${(s??";").split(";")[0]!==""?`\\cellcolor{${(s??";").split(";")[0]}}`:""} ${`${t.latex?"$":""}${t.texte}${t.latex?"$":""}`}`.replace("$$",""))}i+=n.join(" & ")+`\\\\
`,i+=`\\hline
`,n=[];for(let e=0;e<this.ligne2.length;e++){const t=this.ligne2[e],s=this.styles[`L1C${e}`]??"";n.push(`${(s??";").split(";")[0]!==""?`\\cellcolor{${(s??";").split(";")[0]}}`:""} ${`${t.latex?"$":""}${t.texte}${t.latex?"$":""}`}`.replace("$$",""))}return i+=n.join(" & ")+`\\\\
`,i+=`\\hline
`,i+="\\end{tabular}",i}}class y{id;numeroExercice;numeroQuestion;output;raws;headingCols;headingLines;classes;isInteractif;constructor(i,n,e,t,s){i==null&&window.notify("AddTabDbleEntryMathlive a besoin absolument d'un numero d'exercice"),this.headingCols=e.headingCols,this.headingLines=e.headingLines,this.numeroExercice=i??0,this.numeroQuestion=n,this.id=`tabMLEx${this.numeroExercice}Q${this.numeroQuestion}`,this.raws=e.raws,this.classes=t,this.isInteractif=s}static create(i,n,e,t,s,o){(!Array.isArray(e.headingCols)||!Array.isArray(e.headingLines))&&x("ajouteTableauMathlive : vérifiez vos paramètres !",{headingCols:e.headingCols,headingLines:e.headingLines}),o==null&&(o={});const h=new y(i,n,e,t,s),r=document.createElement("table"),d=i??0,c=n;r.className="tableauMathlive",r.id=`tabMathliveEx${i}Q${n}`;const a=document.createElement("tr");r.appendChild(a),h.headingCols=e.headingCols.map(l=>JSON.parse(JSON.stringify(l))),e.headingCols!=null&&b({isInteractif:s,line:a,content:e.headingCols,index:0,tag:"th",classes:t,NoEx:d,NoQ:c,style:o});for(let l=0;l<e.raws.length;l++){const $=document.createElement("tr");if(r.appendChild($),e.headingLines!=null){h.headingLines=e.headingLines.map(L=>JSON.parse(JSON.stringify(L)));const f=o[`L${e.headingCols!=null?1+l:l}C0`]||o.LC0;C({isInteractif:s,line:$,icell:e.headingLines[l],indexCol:0,indexLine:e.headingCols!=null?1+l:l,tag:"th",classes:t,NoEx:d,NoQ:c,style:f})}h.raws=e.raws.map(f=>JSON.parse(JSON.stringify(f)));const g=e.raws[l];if(Array.isArray(g)&&g.length>0)for(let f=0;f<g.length;f++)C({isInteractif:s,line:$,icell:g[f],indexCol:e.headingLines!=null?f+1:f,indexLine:e.headingCols!=null?1+l:l,tag:"td",classes:t,NoEx:d,NoQ:c,style:o[`L${e.headingCols!=null?1+l:l}C${e.headingLines!=null?f+1:f}`]})}const p=`<span id="feedbackEx${i}Q${n}"></span>`;return h.output=r.outerHTML+p,h}get latexOutput(){if(this.headingCols.length===0&&this.headingLines.length===0)throw Error("Un tableau à double entrée doit avoir des entête de colonne et des entête de ligne");const i=this.headingCols.length>0?this.headingCols.length:this.raws[0].length+(this.headingLines.length>0?1:0),n=this.headingLines.length>0?this.headingLines.length:this.raws.length;let e="\\begin{tabular}{|c|"+"c|".repeat(i-1)+`}
`;e+=`\\hline
`;for(let t=0;t<n;t++){this.headingLines[t]!=null&&(e+=`$${this.headingLines[t].texte}$ & `);const s=this.raws[t];e+=s.map(o=>`$${o.texte}$`).join(" & ")+`\\\\
`,e+=`\\hline
`}return e+="\\end{tabular}",e}static convertTclToTableauMathlive(i,n,e,t=!0,s="black"){const o=[];for(const l of i)o.push({texte:l.toString(),latex:!0,gras:t,color:s});const h=[];for(const l of n)h.push({texte:l.toString(),latex:!l.toString().includes("<pre class"),gras:t,color:s});const r=[],d=o.length>0,c=h.length>0;if(!c&&!d)throw Error("Un tableau à double entrée doit avoir des entête de colonne et des entête de ligne");const a=c&&d?o.length-1:d?o.length:e.length/h.length,p=c?h.length:e.length/a;for(let l=0;l<p;l++){const $=[];for(let g=0;g<a;g++)$.push({texte:e[l*a+g].toString(),latex:!0,gras:t,color:s});r.push($)}return{headingLines:h,headingCols:o,raws:r}}}export{y as A,v as a};
