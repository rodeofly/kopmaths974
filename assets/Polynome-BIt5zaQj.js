import c from"decimal.js";import{largerEq as L,max as q,equal as A,polynomialRoot as j,round as y,abs as p,acos as C}from"mathjs";import{a as $,F as f,r as D,a1 as m,z as v,f as M,v as S,e as R,Y as E,a9 as k}from"./embellissements-BYV7mIDn.js";import{g as z}from"./comparisonFunctions-B45ZZ3C7.js";function O({poly:a,xG:e,xD:r}){const i=a.derivee(),t=a.fonction(e),n=a.fonction(r);let o,s;if(i.deg===2){const u=Number(i.monomes[2]),l=Number(i.monomes[1]),N=Number(i.monomes[0]),x=l**2-4*u*N;if(x<0)u>0?(s=n,o=t):(s=t,o=n);else if(x===0){const g=-l/2/u;g>e&&g<e?u>0?(s=Math.max(t,n),o=a.fonction(g)):(s=a.fonction(g),o=Math.min(t,Number(n))):(s=Math.max(t,Number(n)),o=Math.min(t,Number(n)))}else{const g=Math.sqrt(x),b=u>0?(-l-g)/2/u:(-l+g)/2/u,d=u>0?(-l+g)/2/u:(-l-g)/2/u;e<b&&b<r?e<d&&d<r?u>0?(s=Math.max(a.fonction(b),n),o=Math.min(t,a.fonction(d))):(o=Math.min(a.fonction(b),n),s=Math.max(t,a.fonction(d))):u>0?(s=a.fonction(b),o=Math.min(t,n)):(o=a.fonction(b),s=Math.max(Number(t),Number(n))):e<d&&d<r?u>0?(o=a.fonction(d),s=Math.max(e,n)):(s=a.fonction(d),o=Math.min(e,n)):u>0?d<e||b>r?(s=n,o=t):(s=t,o=n):d<e||b>r?(s=t,o=n):(s=n,o=t)}}else if(i.deg===1){const u=i.monomes[1];Number(u)>0?(s=n,o=t):(s=t,o=n)}else o=t,s=t;return{minLocal:o,maxLocal:s}}const I=z(["virgules","fractions","espaces"]),w=function(a,e){return a instanceof c?e instanceof c?a.add(e):e instanceof f?a.add(new c(e.valeurDecimale)):a.add(new c(String(e))):a instanceof f?e instanceof f?a.sommeFraction(e).simplifie():a.sommeFraction(k(Number(e))).simplifie():Number(a)+Number(e)},F=function(a,e){if(typeof a=="number"&&typeof e=="number")return a*e;if(a instanceof c)return e instanceof c?a.mul(e):e instanceof f?a.mul(new c(e.valeurDecimale)):a.mul(new c(String(e)));if(a instanceof f)return e instanceof f?a.produitFraction(e).simplifie():a.produitFraction(k(Number(e))).simplifie()},Y=function(a,e){if(m(Number(e),0)&&window.notify("quotient de Polynome.js a reçu un diviseur nul",{dividende:a,diviseur:e}),typeof a=="number"&&typeof e=="number")return a/e;if(a instanceof c)return e instanceof c?a.div(e):e instanceof f?a.div(new c(e.valeurDecimale)):a.div(new c(String(e)));if(a instanceof f)return e instanceof f?a.diviseFraction(e).simplifie():a.diviseFraction(k(Number(e))).simplifie()};class h{monomes;fonction;deg;useFraction;useDecimal;constructor({rand:e=!1,deg:r=-1,coeffs:i,useFraction:t=!1,useDecimal:n=!1}){e?(L(r,0)&&(i=new Array(r+1),i.fill([10,!0])),this.monomes=i.map(function(s){if(typeof s=="number")return s;if(Array.isArray(s)){if(s[0]===0)return 0;if(t){const u=$([2,4,5]),l=new f(...new c(D(1,u*Number(s[0]))).div(u).toFraction(100).map(Number));return s[1]?l.multiplieEntier($([-1,1])):l}else if(n){const u=new c(D(1,10*Number(s[0]))).div(10);return s[1]?u.mul($([-1,1])):u}else return s[1]?$([-1,1])*D(1,Number(s[0])):D(1,Number(s[0]))}else return s instanceof f||s instanceof c?s:(window.notify("Dans Polynome, l'un des coefficient n'est pas d'un type attendu.",{coeff:s}),NaN)})):this.monomes=i.map(function(s){return s instanceof f?t?s:new c(`${s.num}/${s.den}`):s instanceof c?n?s:s.round():Number(s)}),this.useFraction=t??this.monomes.filter(s=>s instanceof f).length>0,this.useDecimal=n??(this.monomes.filter(s=>s instanceof c).length>0&&this.monomes.filter(s=>s instanceof f).length===0),this.deg=this.monomes.length-1;const o=this.monomes;this.fonction=function(s){let u=0;for(let l=0;l<o.length;l++)if(o[l]instanceof f){const N=o[l];u=u+N.valeurDecimale*s**l}else if(o[l]instanceof c){const N=o[l];u=u+N.toNumber()*s**l}else u=u+Number(o[l])*s**l;return u}}isMon(){return this.monomes.filter(e=>e!==0).length===1}isEqual(e){if(typeof e=="number"){if(this.monomes[0]!==e)return!1;for(let r=1;r<=this.deg;r++)if(this.monomes[r]!==0)return!1;return!0}if(e instanceof h){if(e.deg===this.deg)return this.monomes.filter((t,n)=>t!==e.monomes[n]).length===0;const i=Math.min(this.deg,e.deg);for(let t=0;t<=i;t++)if(!m(Number(e.monomes[t]),Number(this.monomes[t]),1e-15))return!1;for(let t=i+1;t<=Math.max(e.deg,this.deg);t++)if(t<=this.deg&&this.monomes[t]!==0||t<=e.deg&&e.monomes[t]!==0)return!1;return!0}return window.notify(`Polynome.isEqual a reçu comme argument autre chose qu'un number ou un polynôme : ${e}`,{p:e}),!1}toMathExpr(e=!1){let r="",i="";for(const[t,n]of this.monomes.entries()){switch(t){case this.deg:{let o;switch(n instanceof f?o=e?`${n.valeurDecimale<0?n.valeurAbsolue().valeurDecimale===1?"-":"-{"+String(n.n)+"/"+String(n.d)+"}":n.valeurDecimale===1?"+":"+{"+String(n.n)+"/"+String(n.d)}+'}'`:this.deg===0?n.ecritureAlgebrique:S(n):o=e?v(n):this.deg===0?M(n):S(n),this.deg){case 1:i=m(Number(n),0,1e-15)?"":`${o}x`;break;case 0:i=m(Number(n),0,1e-15)?"":`${o}`;break;default:i=m(Number(n),0,1e-15)?"":`${o}x^${t}`}break}case 0:i=m(Number(n),0,1e-15)?"":`${n instanceof f?(n.valeurDecimale<0?"-":"+")+String(n.n)+"/"+String(n.d):M(n)}`;break;case 1:i=m(Number(n),0,1e-15)?"":n instanceof f?`${n.valeurDecimale<0?n.valeurAbsolue().valeurDecimale===1?"-":"-{"+String(n.n)+"/"+String(n.d):n.valeurDecimale===1?"+":"+{"+String(n.n)+"/"+String(n.d)}}x`:`${v(n)}x`;break;default:i=m(Number(n),0,1e-15)?"":n instanceof f?`${n.valeurDecimale<0?n.valeurAbsolue().valeurDecimale===1?"-":"-{"+String(n.n)+"/"+String(n.d):n.valeurDecimale===1?"+":"+{"+String(n.n)+"/"+String(n.d)}}x^${t}`:`${v(n)}x^${t}`;break}i=I(i),r=i+r}return r}toLatex(e=!1){let r="",i="";for(const[t,n]of this.monomes.entries())if(n instanceof f){if(n.valeurDecimale===0)continue;switch(t){case this.deg:{const o=e?`${n.valeurDecimale<0?n.valeurAbsolue().valeurDecimale===1?"-":n.texFSD:n.valeurDecimale===1?"+":n.ecritureAlgebrique}`:this.deg===0?n.texFSD:S(Number(n));if(this.deg===0)return n.texFSD;switch(this.deg){case 1:i=m(Number(n),0,1e-15)?"":`${o}x`;break;case 0:i=m(Number(n),0,1e-15)?"":`${o}`;break;default:i=m(Number(n),0,1e-15)?"":`${o}x^{${t}}`}break}case 0:i=m(Number(n),0,1e-15)?"":n.ecritureAlgebrique;break;case 1:i=m(Number(n),0,1e-15)?"":`${n.valeurDecimale<0?n.valeurAbsolue().valeurDecimale===1?"-":n.texFSD:n.valeurDecimale===1?"+":n.ecritureAlgebrique}x`;break;default:i=m(Number(n),0,1e-15)?"":`${n.valeurDecimale<0?n.valeurAbsolue().valeurDecimale===1?"-":n.texFSD:n.valeurDecimale===1?"+":n.ecritureAlgebrique}x^{${t}}`;break}r=i+r}else{switch(t){case this.deg:{const o=e?v(n):this.deg===0?n:S(Number(n));if(this.deg===0)return R(n,2);switch(this.deg){case 1:i=m(Number(n),0,1e-15)?"":`${o}x`;break;case 0:i=m(Number(n),0,1e-15)?"":`${o}`;break;default:i=m(Number(n),0,1e-15)?"":`${o}x^{${t}}`}break}case 0:i=m(Number(n),0,1e-15)?"":M(n);break;case 1:i=m(Number(n),0,1e-15)?"":`${v(n)}x`;break;default:i=m(Number(n),0,1e-15)?"":`${v(n)}x^{${t}}`;break}r=i+r}return r}toString(){return this.toLatex()}add(e){if(typeof e=="number"){const r=this.monomes.filter(t=>t instanceof f).length>0,i=[...this.monomes];return i[0]=w(this.monomes[0],e),new h({coeffs:i,useFraction:r})}else if(e instanceof f){const r=[...this.monomes];return r[0]=w(this.monomes[0],e),new h({coeffs:r,useFraction:!0})}else if(e instanceof c){const r=this.monomes.filter(t=>t instanceof f).length>0,i=[...this.monomes];return i[0]=w(e,this.monomes[0]),new h({coeffs:i,useFraction:r})}else if(e instanceof h){const r=e.monomes.filter(s=>s instanceof f).length>0||this.monomes.filter(s=>s instanceof f).length>0,i=q(this.deg,e.deg),t=A(e.deg,i)?this:e,o=(A(e.deg,i)?e:this).monomes.map(function(s,u){return u<=t.deg?w(s,t.monomes[u]):s});return new h({coeffs:o,useFraction:r})}else return window.notify("Polynome.add(arg) : l'argument n'est ni un nombre, ni un polynome",{p:e}),this}multiply(e){let r;const i=e instanceof h?e.monomes.filter(t=>t instanceof f).length>0||this.monomes.filter(t=>t instanceof f).length>0:e instanceof f;if(typeof e=="number"||e instanceof f)r=this.monomes.map(function(t){return F(t,e)}).map(t=>t??0);else if(e instanceof h){r=new Array(this.deg+e.deg+1),r.fill(0);for(let t=0;t<=this.deg;t++)for(let n=0;n<=e.deg;n++)r[t+n]=w(r[t+n],F(this.monomes[t],e.monomes[n]))}else return window.notify("Polynome.multiply(arg) : l'argument n'est ni un nombre, ni un polynome",{q:e}),this;return new h({coeffs:r,useFraction:i})}derivee(){const e=this.monomes.map(function(r,i){return F(r,i)}).map(r=>r??0);e.shift();for(let r=e.length-1;r>0;r--){if(e[r]===0){e.pop();continue}break}return e.length===0?new h({deg:0,coeffs:[0]}):new h({coeffs:e,useFraction:this.useFraction,useDecimal:this.useDecimal})}detailleCalculDerivee(){let e="";for(let r=this.monomes.length-1;r>0;r--){const i=this.monomes[r];m(Number(i),0)||(e+=e===""?`${String(r)}\\times ${i instanceof f?i.texParentheses:E(i)}${r>2?`x^{${r-1}}`:r===2?"x":""}`:`+${String(r)}\\times ${i instanceof f?i.texParentheses:E(i)}${r>2?`x^{${r-1}}`:r===2?"x":""}`)}return e}primitive0(){let e=this.monomes.map((t,n)=>Y(t,n+1));e=[0,...e];const r=e.filter(t=>t instanceof f).length>0,i=e.filter(t=>t instanceof c).length>0&&!r;return new h({coeffs:e,useFraction:r,useDecimal:i})}racines(){const e=[];if(this.monomes.slice(1).filter(i=>i!==0).length===0)return null;const r=j(...this.monomes.map(i=>Number(i)));for(const i of r){let t;if(typeof i=="number")t=y(i,3);else if(i.toPolar().r<1e-5)t=0;else{const o=i.arg();p(o)<.01||p(p(o)-Number(C(-1)))<.001?t=y(i.re,3):t=null}t!==null&&(e.includes(t)||e.push(t))}return e}static print(e,r=!1){return new h({coeffs:e}).toLatex(r)}image(e){return this.fonction(e)}static fromRoots(e,r=!1,i=!1){if(e.length===0)return new h({coeffs:[1]});let t=new h({coeffs:[1],useFraction:r,useDecimal:i});for(const n of e){const o=new h({coeffs:[typeof n=="number"?-n:F(n,-1),1],useFraction:r,useDecimal:i});t=t.multiply(o)}return t}}export{h as P,O as c};
