import d from"decimal.js";import{f as b,G as Q}from"./comparisonFunctions-B45ZZ3C7.js";import{h as c}from"./gestionInteractif-DujZpSu8.js";import{p as E}from"./qcm-BQR8Ns0N.js";import{r as q,a as v}from"./questionMathLive-DdRvWqlN.js";import{g,ay as A,af as y,y as C,F as T}from"./embellissements-BYV7mIDn.js";import{E as w}from"./Exercice-DtXhjCyI.js";import"./compute-engine.min.umd-BwAhpA7x.js";import"./index-BUDQz6-w.js";import"mathjs";import"./Hms-u2AUyU1C.js";import"./ListeDeroulanteElement-CXmzV-cr.js";import"./tableauMathlive-xx-nDjq0.js";import"./canStore-DaSrd7sp.js";import"./generalStore-C3E9FHtR.js";import"seedrandom";import"katex";import"earcut";import"roughjs";import"./sizeTools-DfTC1Dgv.js";import"./time-DMC-jnVL.js";import"./exerciseMethods-CtbYPwln.js";import"crypto-js";import"./AjouteTableauMathlive-Bz24QHd3.js";const Z="mathLive",ee=!0;class se extends w{Exercices;correctionInteractives;constructor(u){super(),this.Exercices=u,this.correctionInteractives=[],this.besoinFormulaireCaseACocher=["Sujet officiel"],this.nbQuestions=this.Exercices.length,this.sup=!1,this.sup2=Array.from({length:this.nbQuestions},(x,l)=>l+1).join("-"),this.sup3=!1}nouvelleVersion(){this.correctionInteractives=[],this.listeCanEnonces=[],this.listeCanReponsesACompleter=[],this.listeCanLiees=[],this.listeCanNumerosLies=[],this.answers={},this.nbQuestionsModifiable=this.sup3,this.besoinFormulaire2Texte=!1;let u;const x=this.sup2;let l=this.Exercices;const p=l.length;if(this.sup3?this.sup2=!1:(l=this.Exercices,this.nbQuestions=String(this.sup2).includes("-")?this.sup2.split("-").length:1),this.sup2)u=g({saisie:x,min:1,max:30,defaut:1,melange:31,shuffle:!1,nbQuestions:String(this.sup2).includes("-")?this.sup2.split("-").length:1});else{u=A(this.nbQuestions),l=this.Exercices;const h=Math.floor(this.nbQuestions/3),f=this.nbQuestions%3;let i=[h,h,h];for(let r=0;r<f;r++)i[r]++;i=y(i,3);let e=l.slice(0,Math.floor(Math.max(p/3,i[0])));e=C(e),e=e.slice(0,i[0]);let t=l.slice(Math.max(p/3,i[0]),Math.max(2*p/3,i[0]+i[1]));t=C(t),t=t.slice(0,i[1]);let o=l.slice(Math.max(2*p/3,i[0]+i[1]),p);o=C(o),o=o.slice(0,i[2]),l=[...e,...t,...o]}let s=0;this.reinit();for(const h of u){let f=1;for(const i of l){if(h===f){const e=new i;if(e.numeroExercice=this.numeroExercice,e.canOfficielle=!!this.sup,e.interactif=this.interactif,e.seed=this.seed,e.nouvelleVersionWrapper(),e.listeQuestions.length===0){const t=e.consigne===""?"":`${e.consigne}<br>`;this.listeCorrections[s]=e.correction??"";const o=e.formatChampTexte??"",r=e.optionsChampTexte??{};if(e.canEnonce!=null&&(this.listeCanEnonces[s]=e.canEnonce),e.canReponseACompleter!=null&&(this.listeCanReponsesACompleter[s]=e.canReponseACompleter),this.listeCanLiees[s]=e.canLiee,this.listeCanNumerosLies[s]=e.canNumeroLie,e.formatInteractif==="fillInTheBlank"||typeof e.reponse=="object"&&"champ1"in e.reponse)this.listeQuestions[s]=t+q(this,s,e.question,o,"\\ldots"),typeof e.reponse=="string"?c(this,s,{champ1:{value:e.reponse,compare:e.compare??b,options:r}}):typeof e.reponse=="object"?c(this,s,e.reponse):window.notify("Erreur avec cette question de type fillInTheBlank qui contient une reponse au format inconnu",{reponse:e.reponse});else if(e.formatInteractif==="qcm")e?.question?.replaceAll("labelEx0Q0",`labelEx0Q${s}`),e?.question?.replaceAll("resultatCheckEx0",`resultatCheckEx${s}`),this.listeQuestions[s]=t+e.question,this.autoCorrection[s]=e.autoCorrection[0];else{if(e.compare==null){const n=e.optionsDeComparaison==null?{}:e.optionsDeComparaison;e.reponse.reponse instanceof Object&&e.reponse.reponse.value!=null&&typeof e.reponse.reponse.value=="string"?c(this,s,e.reponse,n):c(this,s,{reponse:{value:e.reponse,options:n}})}else{const n=e.compare,m=e.optionsDeComparaison==null?{}:e.optionsDeComparaison;if(typeof e.reponse=="string"||typeof e.reponse=="number"){const a=String(e.reponse);c(this,s,{reponse:{value:a,compare:n,options:m}})}else if(typeof e.reponse=="object"){const a=e.reponse;a instanceof T?c(this,s,{reponse:{value:a.texFraction,compare:n,options:m}}):a instanceof d?c(this,s,{reponse:{value:a.toString(),compare:n,options:m}}):a instanceof Q?c(this,s,{reponse:{value:a.toString(),compare:n,options:m}}):Array.isArray(a)?c(this,s,{reponse:{value:a,compare:n,options:m}}):c(this,s,a)}else window.notify("Erreur avec cette question qui contient une reponse au format inconnu",{reponse:e.reponse})}this.listeQuestions[s]=t+e.question+v(this,s,o,r)}}else{this.listeQuestions[s]=e.listeQuestions[0],this.listeCorrections[s]=e.listeCorrections[0],this.autoCorrection[s]=e.autoCorrection[0],this.listeQuestions[s]=this.listeQuestions[s].replaceAll("champTexteEx0Q0",`champTexteEx0Q${s}`),this.listeQuestions[s]=this.listeQuestions[s].replaceAll("resultatCheckEx0Q0",`resultatCheckEx0Q${s}`),this.listeQuestions[s]=this.listeQuestions[s].replaceAll("clockEx0Q0",`clockEx0Q${s}`);const t=e.autoCorrection[0]?.reponse?.param?.formatInteractif;if(t==="custom"){e.reinit(),e.nouvelleVersionWrapper(this.numeroExercice,s);const o=this;this.correctionInteractives[s]=function(r){const n=e.correctionInteractive(r);return e.answers&&(o.answers={...o.answers,...e.answers}),n},this.autoCorrection[s]=e.autoCorrection[s],this.listeQuestions[s]=e.listeQuestions[s],this.listeCorrections[s]=e.listeCorrections[s]}else t==="qcm"?this.autoCorrection[s]=e.autoCorrection[0]:c(this,s,e.autoCorrection[0].reponse.valeur)}if(e?.autoCorrection[0]?.propositions!=null){const t=E(this,s);this.listeCanReponsesACompleter[s]=e.canReponseACompleter!=null?e.canReponseACompleter:t.texte;const o=e.consigne===null||e.consigne===""?"":`${e.consigne}<br>`,r=this.autoCorrection[s],n="enonce"in r?r.enonce:"";this.listeQuestions[s]=o+n+t.texte,this.listeCorrections[s]==null&&(this.listeCorrections[s]=t.texteCorr)}s++;break}f++}}s>30&&(s=30,window.notify("malgré des précautions prises, on a fabriqué plus de 30 questions dans MetaExercice",{nbQuestions:s}),this.listeQuestions=this.listeQuestions.slice(0,s),this.listeCorrections=this.listeCorrections.slice(0,s),this.autoCorrection=this.autoCorrection.slice(0,s)),this.besoinFormulaire2Texte=this.sup3?!1:["Choix des questions","Nombres séparés par des tirets :"],this.besoinFormulaire3CaseACocher=["Choix du nombre de questions"],this.comment=`Cet exercice fait partie des annales des Courses Aux Nombres (CAN).<br>
  Il est plus souvent composé de 30 questions (parfois 20 pour les CE1/CE2) réparties de la façon suivante. 
  Les 10 premières questions, parfois communes à plusieurs niveaux, font appel à des questions élémentaires et les 20 suivantes (qui ne sont pas rangées dans un ordre de difficulté) sont un peu plus « coûteuses » cognitivement.<br>
  Par défaut, les questions sont rangées dans le même ordre que le sujet officiel avec des données aléatoires. Ainsi, en cliquant sur « Nouvelles données », on obtient une nouvelle Course Aux Nombres avec des données différentes.<br>
  Dans les CAN depuis 2024, le choix des questions permet de choisir certaines questions parmi les 30. <br>
  Dans les CAN d'avant 2024, on pouvait seulement choisir le nombre de questions comme décrit ci-après. <br>
  En choisissant un nombre de questions inférieur à 30, on fabrique une « mini » Course Aux Nombres qui respecte la proportion de nombre de questions élémentaires par rapport aux autres.
  Par exemple, en choisissant 20 questions, la course aux nombres sera composée de 7 ou 8 questions élémentaires choisies aléatoirement dans les 10 premières questions du sujet officiel puis de 12 ou 13 autres questions choisies aléatoirement parmi les 20 autres questions du sujet officiel.`}}export{se as default,ee as interactifReady,Z as interactifType};
