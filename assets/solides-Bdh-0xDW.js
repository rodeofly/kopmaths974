import{O as _,bQ as O,bR as w,I as L,bS as fe,bT as F,aX as de,bO as $,A as H,b6 as ee,aE as Z,k as R,bU as Pe,aH as ce,bV as ue,bW as xe,T as ae,n as E,b8 as re,a4 as te,a3 as K,bX as Ce,bY as ve,ad as oe,c as pe,bZ as be,b_ as U,b$ as ie,c0 as he,c1 as ye,c2 as ge,p as le,E as ne,d as Ve}from"./embellissements-BYV7mIDn.js";import{c as se}from"./aleatoires-BLhzzHLc.js";import{cross as De,dot as we,norm as ke,multiply as Ae,matrix as Se}from"mathjs";const me={matrix:Se,multiply:Ae,norm:ke,cross:De,dot:we};class Me extends _{constructor(c,u,P="red",o="blue",a=0,g="gray",p=0,V="gray",h=!1,f="black",s=0,l=!0){super(),this.centre=c,this.rayon=u,this.objets=[],this.colorEquateur=P,this.colorEnveloppe=o,this.nbParalleles=a,this.colorParalleles=g,this.nbMeridiens=p,this.colorMeridiens=V,this.affichageAxe=h,this.colorAxe=f;const t=be($(this.centre.x,this.centre.y,this.centre.z),O(0,1,0)),y=U($(this.centre.x,this.centre.y,this.centre.z+this.rayon,!0,se(1,"OQWX"+this.centre.label)[0],"left"),t,s),b=U($(this.centre.x,this.centre.y,this.centre.z-this.rayon,!0,se(1,"OQWX"+this.centre.label+y.label)[0],"left"),t,s),m=36,i=this.nbParalleles!==0?Math.round(2*m/this.nbParalleles):1;let n,r,k,v;const e={listePoints3d:[],ptCachePremier:[],indicePtCachePremier:[],ptCacheDernier:[],indicePtCacheDernier:[]},B=[];let G=[],X=100,W=0,z=0;this.c2d=[],r=U($(this.centre.x,this.centre.y,this.centre.z+this.rayon*Math.sin((m-1)/m*Math.PI/2)),t,s),k=U(O(this.rayon*Math.cos((m-1)/m*Math.PI/2),0,0),t,s),v=U(O(0,0,1),t,s),n=ge(r,v,k),e.listePoints3d.push(n[1]),e.ptCachePremier.push(le(0,0)),e.indicePtCachePremier.push(0),e.ptCacheDernier.push(le(0,0)),e.indicePtCacheDernier.push(0);for(let D=m-2,C,d=1;D>-m;D-=1){r=U($(this.centre.x,this.centre.y,this.centre.z+this.rayon*Math.sin(D/m*Math.PI/2)),t,s),k=U(O(this.rayon*Math.cos(D/m*Math.PI/2),0,0),t,s),v=U(O(0,0,1),t,s),C=H(n[2]),n=ge(r,v,k,!1),e.listePoints3d.push(n[1]);for(let x=0;x<e.listePoints3d[0].length;x++)e.listePoints3d[d][x].isVisible=!e.listePoints3d[d][x].c2d.estDansPolygone(C);e.ptCachePremier.push(le(0,0)),e.indicePtCachePremier.push(0),e.ptCacheDernier.push(le(0,0)),e.indicePtCacheDernier.push(0);for(let x=0,q,S,T,J,N,j;x<e.listePoints3d[0].length;x++)if(q=R(e.listePoints3d[d][x].c2d,e.listePoints3d[d][(x+1)%e.listePoints3d[0].length].c2d),!e.listePoints3d[d][x].isVisible&&e.listePoints3d[d][(x+1)%e.listePoints3d[0].length].isVisible){N=x-3,S=E(e.listePoints3d[d-1][(e.listePoints3d[0].length+N)%e.listePoints3d[0].length].c2d,e.listePoints3d[d-1][(e.listePoints3d[0].length+N-1)%e.listePoints3d[0].length].c2d);let Y=0;for(;!q.estSecant(S)&&Y<7;)N++,S=E(e.listePoints3d[d-1][(e.listePoints3d[0].length+N)%e.listePoints3d[0].length].c2d,e.listePoints3d[d-1][(e.listePoints3d[0].length+N-1)%e.listePoints3d[0].length].c2d),Y++;if(Y!==7){if(T=E(e.listePoints3d[d][x].c2d,e.listePoints3d[d][(x+1)%e.listePoints3d[0].length].c2d),J=E(e.listePoints3d[d-1][(e.listePoints3d[0].length+N)%e.listePoints3d[0].length].c2d,e.listePoints3d[d-1][(e.listePoints3d[0].length+N-1)%e.listePoints3d[0].length].c2d),j=re(T,J),!j){window.notify("Erreur dans le calcul du point d'intersection entre d1 et d2",{d1:T,d2:J});continue}B.push(j),X>=d&&(X=d,W=N%e.listePoints3d[0].length),e.ptCachePremier[d]=j,e.indicePtCachePremier[d]=x}}else if(e.listePoints3d[d][x].isVisible&&!e.listePoints3d[d][(x+1)%e.listePoints3d[0].length].isVisible){N=x-3,S=E(e.listePoints3d[d-1][(e.listePoints3d[0].length+N)%e.listePoints3d[0].length].c2d,e.listePoints3d[d-1][(e.listePoints3d[0].length+N-1)%e.listePoints3d[0].length].c2d);let Y=0;for(;!q.estSecant(S)&&Y<7;)N++,S=E(e.listePoints3d[d-1][(e.listePoints3d[0].length+N)%e.listePoints3d[0].length].c2d,e.listePoints3d[d-1][(e.listePoints3d[0].length+N-1)%e.listePoints3d[0].length].c2d),Y++;if(Y!==7){if(T=E(e.listePoints3d[d][x].c2d,e.listePoints3d[d][(x+1)%e.listePoints3d[0].length].c2d),J=E(e.listePoints3d[d-1][(e.listePoints3d[0].length+N)%e.listePoints3d[0].length].c2d,e.listePoints3d[d-1][(e.listePoints3d[0].length+N-1)%e.listePoints3d[0].length].c2d),j=re(T,J),!j){window.notify("Erreur dans le calcul du point d'intersection entre d1 et d2",{d1:T,d2:J});continue}G.push(j),X>=d&&(X=d,z=N),e.ptCacheDernier[d]=j,e.indicePtCacheDernier[d]=x}}d++}if(this.nbParalleles!==0){let D=ae(y.c2d,this.colorParalleles);D.style="o",D.taille=.5,this.c2d.push(D),D=ae(b.c2d,ye(this.colorParalleles,50)),D.style="o",D.taille=.5,this.c2d.push(D)}for(let D=m,C=-1;D>-m;D-=1){const d=[];let x=[];if((this.nbParalleles!==0||D===0)&&D!==m&&D%i===0){for(let S=0;S<e.listePoints3d[0].length;S++)e.indicePtCachePremier[C]===S?x.push(e.ptCachePremier[C]):e.indicePtCacheDernier[C]===S?x.push(e.ptCacheDernier[C]):!e.listePoints3d[C][S].isVisible&&!e.listePoints3d[C][(S+1)%e.listePoints3d[0].length].isVisible?x.push(e.listePoints3d[C][S].c2d):d.push(e.listePoints3d[C][(S+1)%e.listePoints3d[0].length].c2d);if(D<36&&D>-30){let S=0;if(x.length>4)for(;S<10&&Z(x[x.length-1],x[0])<1;){const T=x.pop();T&&(x=[le(T.x,T.y),...x]),S++}if(d.length>4)for(;S<20&&Z(d[d.length-1],d[0])<1;){const T=d.shift();T&&d.push(le(T.x,T.y)),S++}}if(l){const S=x.length>0?ne(...x):null;S&&D===0?(S.color=L(this.colorEquateur),S.epaisseur=1.5):S&&(S.color=L(this.colorParalleles)),l&&S&&(S.pointilles=4,S.opacite=.5,this.c2d.push(S))}const q=d.length>0?ne(...d):null;q&&D===0?(q.color=L(this.colorEquateur),q.epaisseur=1.5):q&&(q.color=L(this.colorParalleles)),q&&this.c2d.push(q)}C++}if(this.nbMeridiens!==0){const D=Math.round(36/this.nbMeridiens);for(let C=0,d;C<18;C+=D){const x=[],q=[],S=[],T=[];for(let j=1;j<e.listePoints3d.length-1;j++)!e.listePoints3d[j][C].isVisible&&!e.listePoints3d[(j+1)%e.listePoints3d.length][C].isVisible?x.push(e.listePoints3d[j][C].c2d):q.push(e.listePoints3d[j][C].c2d),!e.listePoints3d[j][C+18].isVisible&&!e.listePoints3d[(j+1)%e.listePoints3d.length][C+18].isVisible?S.push(e.listePoints3d[j][C+18].c2d):T.push(e.listePoints3d[j][C+18].c2d);d=R(y.c2d,e.listePoints3d[1][C].c2d,this.colorMeridiens),this.c2d.push(d),d=R(e.listePoints3d[1][C+18].c2d,y.c2d,this.colorMeridiens),this.c2d.push(d),d=R(b.c2d,e.listePoints3d[e.listePoints3d.length-1][C].c2d,this.colorMeridiens),l&&!e.listePoints3d[e.listePoints3d.length-1][0].isVisible?(d.pointilles=4,d.opacite=.5,this.c2d.push(d)):l&&this.c2d.push(d),d=R(e.listePoints3d[e.listePoints3d.length-1][C+18].c2d,b.c2d,this.colorMeridiens),l&&!e.listePoints3d[e.listePoints3d.length-1][C].isVisible?(d.pointilles=4,d.opacite=.5,this.c2d.push(d)):l&&this.c2d.push(d);const J=ne(...q),N=ne(...T);if(l){const j=ne(...x),Y=ne(...S);j.pointilles=4,j.opacite=.5,Y.pointilles=4,Y.opacite=.5,this.c2d.push(j,Y)}this.c2d.push(J,N)}}G=G.reverse();const Q=[...B];let A=1;for(;(z+e.listePoints3d[0].length/2+A)%e.listePoints3d[0].length<(W+e.listePoints3d[0].length/2)%e.listePoints3d[0].length;)Q.push(e.listePoints3d[2*m-1-X][(z+e.listePoints3d[0].length/2+A)%e.listePoints3d[0].length].c2d),A++;if(Q.push(...G),z>W)for(A=1;z+A<W+e.listePoints3d[0].length;)Q.push(e.listePoints3d[X][(z+A)%e.listePoints3d[0].length].c2d),A++;else for(A=1;z+A<W;)Q.push(e.listePoints3d[X][z+A].c2d),A++;const I=H(Q,this.colorEnveloppe);if(I.epaisseur=1.5,this.c2d.push(I),this.affichageAxe){const D=Z(y.c2d,b.c2d);let C=1;const d=H(Q);for(;C<2&&ee(y.c2d,b.c2d,C*D).estDansPolygone(d);)C+=.01;let x=R(y.c2d,ee(y.c2d,b.c2d,Math.max(C-.01,1)*D),this.colorAxe);x.pointilles=2,this.c2d.push(x),x=R(b.c2d,ee(y.c2d,b.c2d,1.1*D),this.colorAxe),this.c2d.push(x),x=R(y.c2d,ee(y.c2d,b.c2d,-.1*D),this.colorAxe),this.c2d.push(x)}this.objets=this.c2d}}function We(M,c,u="red",P="blue",o=0,a="gray",g=0,p="black",V=!1,h="black",f=0,s=!0){return new Me(M,c,u,P,o,a,g,p,V,h,f,s)}class Re extends _{constructor(c,u,P,o="black",a=!0,g="black",p="gray",V=!0,h=!0){super(),this.centre=c,this.sommet=u,this.rayon=P,this.color=L(o),this.colorAxe=g,this.colorCone=p;const f=w(this.centre,this.rayon),s=[f],l=36;for(let y=1;y<l;y++)s.push(U(f,be(this.centre,O(this.sommet,this.centre)),y*360/l));const t=fe(s,this.color[0]);this.c2d=He(t,this.sommet,this.color[0],V?this.centre:void 0,a,this.colorAxe,!1,!0,this.colorCone,h).c2d}}function qe(M,c,u,P="black",o=!1,a="black",g="gray",p=!0,V=!0){return new Re(M,c,u,P,o,a,g,p,V)}class Le extends _{constructor(c,u,P,o,a="black",g=!0,p=!1,V=!1,h="black",f=!1,s="lightgray",l=!0){super(),this.centrebase1=c,this.centrebase2=u,this.rayon1=P,this.rayon2=o,this.color=L(a),this.affichageGeneratrices=g,this.affichageCentreBases=p,this.affichageAxe=V,this.colorAxe=h,this.cylindreColore=f,this.colorCylindre=s,this.c2d=[];let t;this.normal=O(this.centrebase1,this.centrebase2);const y=O(me.cross(this.normal.matrice,this.rayon1.matrice)),b=me.dot(y.matrice,O(0,1,0).matrice);let m,i;const n=this.centrebase1.c2d.y!==this.centrebase2.c2d.y?this.centrebase1.c2d.y<this.centrebase2.c2d.y:pe.anglePerspective>0;b*pe.anglePerspective>0?(m=n?"direct":"indirect",i=n?"indirect":"direct"):(i=n?"direct":"indirect",m=n?"indirect":"direct"),i=this.rayon1.x===0&&this.rayon1.y===0?"indirect":i,m=this.rayon1.x===0&&this.rayon1.y===0?"direct":m;let r=0,k=0;const v=be(this.centrebase1,this.normal);let e=U(w(this.centrebase1,this.rayon1),v,r);const B=U(w(this.centrebase1,this.rayon1),v,r+1),G=ie(e.c2d,v.c2d)<ie(B.c2d,v.c2d)?1:-1;for(;ie(e.c2d,v.c2d)>k;)k=ie(e.c2d,v.c2d),r=r+G,e=U(w(this.centrebase1,this.rayon1),v,r);r=r-G,this.angleDepart=r;const X=he(this.centrebase1,this.normal,this.rayon1,m,!0,this.color[0],r),W=he(this.centrebase2,this.normal,this.rayon2,m,!1,this.color[0],r),z=he(this.centrebase1,this.normal,this.rayon1,i,!1,this.color[0],r),Q=he(this.centrebase2,this.normal,this.rayon2,i,!1,this.color[0],r);if(this.pointsBase1=[...X.listePoints,...z.listePoints],this.pointsBase2=[...W.listePoints,...Q.listePoints],this.cylindreColore){let A=[...Q.listePoints];for(let C=z.listePoints.length-1;C>=0;C--)A.push(z.listePoints[C]);const I=H(A,"white");I.couleurDeRemplissage=L(this.colorCylindre),this.c2d.push(I),A=[...W.listePoints];for(let C=Q.listePoints.length-1;C>=0;C--)A.push(Q.listePoints[C]);const D=H(A,"white");D.couleurDeRemplissage=L(ye(this.colorCylindre,25)),this.c2d.push(D)}if(this.affichageGeneratrices)for(let A=1;A<X.listePoints.length-1;A+=2)t=R(W.listePoints[A],X.listePoints[A],this.color[0]),t.pointilles=2,t.opacite=.3,this.c2d.push(t);if(t=R(Q.listePoints[0],z.listePoints[0],this.color[0]),this.c2d.push(t),this.affichageGeneratrices)for(let A=1;A<z.listePoints.length-1;A++)t=R(Q.listePoints[A],z.listePoints[A],this.color[0]),this.c2d.push(t);if(t=R(Q.listePoints[z.listePoints.length-1],z.listePoints[z.listePoints.length-1],this.color[0]),this.c2d.push(t),this.c2d.push(X,z),l&&this.c2d.push(W,Q),this.affichageCentreBases&&this.c2d.push(ae(this.centrebase1.c2d,this.centrebase2.c2d,this.colorAxe)),this.affichageAxe){let A=9999;const I=z.listePoints;let D=0;const C=E(this.centrebase2.c2d,this.centrebase1.c2d);for(;ie(I[D],C)<A;)A=ie(I[D],v.c2d),D++;t=R(this.centrebase2.c2d,this.centrebase1.c2d,this.colorAxe),t.pointilles=2,t.opacite=.7,this.c2d.push(t),t=E(I[D],I[D-1]);const d=re(t,C);if(!d){window.notify("Axe du cylindre non défini correctement",{s:t,axeCylindre:C});return}t=R(this.centrebase1.c2d,d,this.colorAxe),t.pointilles=2,t.opacite=.7,this.c2d.push(t),t=R(te(d,K(this.centrebase1.c2d,d)),d,this.colorAxe),t.opacite=.7,this.c2d.push(t);const x=te(this.centrebase2.c2d,K(te(d,K(this.centrebase1.c2d,d)),this.centrebase1.c2d));t=R(x,this.centrebase2.c2d),t.opacite=.7,this.c2d.push(t)}}}function Ee(M,c,u,P,o="black",a=!0,g=!1,p=!1,V="black",h=!1,f="lightgray",s=!0){return new Le(M,c,u,P,o,a,g,p,V,h,f,s)}class ze extends _{constructor(c,u,P="black",o=!1,a,g){super(),this.affichageNom=o,this.color=L(P),c.color=this.color[0],this.vecteur=u,this.vecteur.y===0&&this.vecteur.x===0?(this.base1=this.vecteur.z>=1?c:w(c,O(this.vecteur.x,this.vecteur.y,-this.vecteur.z)),this.base2=this.vecteur.z<1?c:w(c,this.vecteur)):(this.base1=c,this.base2=w(c,u)),this.base2.color=this.base1.color,this.c2d=[];let p;for(let h=0;h<this.base1.listePoints.length;h++)this.c2d.push(this.base1.c2d[h]);let V=!0;for(let h=0;h<this.base1.listePoints.length;h++){const f=ee(this.base1.listePoints[h].c2d,this.base2.listePoints[h].c2d,Z(this.base1.listePoints[h].c2d,this.base2.listePoints[h].c2d)/50).estDansPolygone(H(this.base1.listePoints2d));this.base2.listePoints[h].isVisible=!f,V=!f&&V}for(let h=0;h<this.base2.listePoints.length;h++){if(p=F(this.base2.listePoints[h],this.base2.listePoints[h+1===this.base2.listePoints.length?0:h+1],this.color[0]),V){let f=!0;for(let s=0;s<this.base1.listePoints.length;s++){const l=R(this.base1.listePoints[s].c2d,this.base2.listePoints[s].c2d);f=f&&!!l.estSecant(p.c2d)}p=F(this.base2.listePoints[h],this.base2.listePoints[h+1===this.base2.listePoints.length?0:h+1],this.color[0],!f)}this.c2d.push(p.c2d)}for(let h=0;h<this.base1.listePoints.length;h++)p=F(this.base1.listePoints[h],this.base2.listePoints[h],this.color[0]),this.c2d.push(p.c2d);if(this.affichageNom){let h=H(this.base1.listePoints2d);const f=se(this.base1.listePoints.length,"OQWX"),s=c.listePoints2d.map((t,y)=>t.nom??f[y]);Pe(h,s);for(let t=0;t<this.base1.listePoints2d.length;t++)this.base1.listePoints2d[t].positionLabel=c.listePoints2d[t].positionLabel??"above";this.c2d.push(ce(...h.listePoints.map(t=>ue(t)))),h=H(this.base2.listePoints2d);const l=se(this.base1.listePoints.length,"OQWX"+s);Pe(h,a??l);for(let t=0;t<this.base2.listePoints2d.length;t++)this.base2.listePoints2d[t].positionLabel=g?.[t]??"below";this.c2d.push(ce(...h.listePoints.map(t=>ue(t)))),this.nom=s+(a??"")}}}function Ue(M,c,u="black",P=!1,o,a){return new ze(M,c,u,P,o,a)}class Oe extends _{constructor(c,u,P="black",o,a=!1,g="black",p=!1,V=!1,h="gray",f=!0){super(),c.color=P,this.base=c,this.sommet=u,this.color=L(P),this.centre=o,this.affichageAxe=a,this.colorAxe=g,this.affichageNom=p,this.estCone=V,this.colorCone=h,this.c2d=[],this.nom="";let s;this.aretesSommet=[];for(let i=0;i<this.base.listePoints.length;i++)s=F(this.base.listePoints[i],this.sommet,P,!0),this.aretesSommet.push(s);const l=[];for(let i=0;i<this.base.listePoints.length;i++)s=F(this.base.listePoints[i],this.base.listePoints[(i+1)%this.base.listePoints.length],P,!0),l.push(s);let t=!1,y;const b=[0,0],m=[];for(let i=0;i<this.base.listePoints.length;i++){y=t,t=!1;for(let n=1;n<this.base.listePoints.length-1;n++){const r=H([this.sommet.c2d,this.base.listePoints[(i+n)%this.base.listePoints.length].c2d,this.base.listePoints[(i+n+1)%this.base.listePoints.length].c2d]);r.isVisible=!1,t=t||this.base.listePoints[i].c2d.estDansPolygone(r)}this.estCone&&y!==t&&i!==0&&(t?m.push(this.aretesSommet[(this.aretesSommet.length+i-1)%this.aretesSommet.length]):m.push(this.aretesSommet[i]),t?b[1]=i:b[0]=i),t&&u.z>this.base.listePoints[0].z&&(this.aretesSommet[i].isVisible=!1,this.aretesSommet[i].c2d.pointilles=2,l[i].c2d.pointilles=2,l[(this.base.listePoints.length+i-1)%this.base.listePoints.length].c2d.pointilles=2)}if(this.estCone&&b[1]<=b[0]&&(b[1]+=this.base.listePoints.length),this.estCone&&m.length===1&&(m.push(this.aretesSommet[this.aretesSommet.length-1]),b[1]=this.aretesSommet.length-1),this.estCone){const i=[this.sommet.c2d];for(let r=b[0];r<b[1];r++)i.push(this.base.listePoints[r%this.base.listePoints.length].c2d);const n=H(i,this.colorCone);n.couleurDeRemplissage=L(this.colorCone),this.c2d.push(n)}if(this.estCone)for(let i=0;i<m.length;i++)this.c2d.push(m[i].c2d);else{let i;if(this.sommet.z>this.base.listePoints[0].z)for(let n=0;n<this.base.listePoints.length;n++){t=!1,i=Z(this.base.listePoints[n].c2d,this.base.listePoints[(n+1)%this.base.listePoints.length].c2d),s=R(ee(this.base.listePoints[n].c2d,this.base.listePoints[(n+1)%this.base.listePoints.length].c2d,i/20),ee(this.base.listePoints[n].c2d,this.base.listePoints[(n+1)%this.base.listePoints.length].c2d,19*i/20)),s.isVisible=!1;for(let r=0;r<this.aretesSommet.length;r++)t=t||!!s.estSecant(this.aretesSommet[r].c2d);t&&(l[n].c2d.pointilles=2)}else for(let n=0;n<this.base.listePoints.length;n++){i=Z(this.base.listePoints[n].c2d,this.sommet.c2d),s=R(ee(this.base.listePoints[n].c2d,this.sommet.c2d,i/20),this.sommet.c2d),s.isVisible=!1;let r=0;for(;r<l.length&&!s.estSecant(l[r].c2d);)r++;r<l.length&&(this.aretesSommet[n].c2d.pointilles=2)}for(let n=0;n<this.base.listePoints.length;n++)this.c2d.push(this.aretesSommet[n].c2d)}if(f)for(let i=0;i<this.base.listePoints.length;i++)this.c2d.push(l[i].c2d);if(this.centre!==void 0&&this.centre.constructor===xe&&(this.c2d.push(ae(this.centre.c2d,this.colorAxe)),this.centre.label===""&&(this.centre.label=se(1,"OQWX")[0]),this.c2d.push(...ce(this.centre.c2d)),this.affichageAxe))if(this.sommet.z>0){let i=!1,n=0;for(;!i&&n<l.length;){if(s=l[n].c2d,s.pointilles!==2){const r=E(this.centre.c2d,this.sommet.c2d);r.isVisible=!1,i=!!s.estSecant(r)}n++}if(i){n--;const r=E(this.base.listePoints[n].c2d,this.base.listePoints[(n+1)%this.base.listePoints.length].c2d);r.isVisible=!1;const k=E(this.centre.c2d,this.sommet.c2d);k.isVisible=!1;const v=re(r,k);if(!v){window.notify("Axe de la pyramide non défini correctement",{d1:r,d2:k});return}s=R(v,this.sommet.c2d,this.colorAxe),s.pointilles=2,this.c2d.push(s),s=R(v,te(v,K(this.centre.c2d,v)),this.colorAxe),this.c2d.push(s),s=R(this.sommet.c2d,te(this.sommet.c2d,K(v,this.centre.c2d)),this.colorAxe),this.c2d.push(s)}}else{s=R(this.centre.c2d,this.sommet.c2d,this.colorAxe),s.pointilles=2,this.c2d.push(s);const i=K(this.centre.c2d,this.sommet.c2d),n=Z(this.base.listePoints[0].c2d,this.centre.c2d),r=2*Ce(i);s=R(this.sommet.c2d,te(this.sommet.c2d,K(n*i.x/r,n*i.y/r)),this.colorAxe),this.c2d.push(s),s=R(this.centre.c2d,te(this.centre.c2d,K(-n*i.x/r,-n*i.y/r)),this.colorAxe),this.c2d.push(s)}if(this.affichageNom){const i=H(this.base.listePoints2d);i.isVisible=!1,(this.centre.label===""||this.centre.label===this.sommet.label)&&(this.sommet.label=se(1,"OQWX")[0]);const n=se(this.base.listePoints.length,"OQWX"+this.sommet.label+this.centre.label);Pe(i,n);for(let r=0;r<this.base.listePoints2d.length;r++)this.base.listePoints2d[r].positionLabel=this.sommet.z>0?"below":"above";this.c2d.push(ce(...i.listePoints.map(r=>ue(r)))),this.c2d.push(ce(this.sommet)),this.nom=n.join("")+this.sommet.label}}}function He(M,c,u="black",P,o=!1,a="black",g=!1,p=!1,V="gray",h=!0){return new Oe(M,c,u,P,o,a,g,p,V,h)}class je extends _{constructor(c,u,P=.5,o="black"){super(),this.color=L(o),c.color=o,this.base=c,this.coeff=P,this.aretes=[],this.sommet=u,this.c2d=[];const a=[];for(let g=0,p;g<this.base.listePoints.length;g++)p=ve(u,c.listePoints[g],P),p.isVisible=!0,a.push(p);this.base2=fe(...a),this.c2d.push(...this.base.c2d);for(let g=0;g<c.listePoints.length;g++)this.aretes.push(F(c.listePoints[g],this.base2.listePoints[g],o,c.listePoints[g].isVisible)),this.c2d.push(this.aretes[g].c2d);this.c2d.push(...this.base2.c2d)}}function Ye(M,c,u=.5,P="black"){return new je(M,c,u,P)}class Ge extends _{constructor(c,u,P,o,a="black",g="lightgray",p="white",V="darkgray",h=!0,f=!1,s=["A","B","C","D","E","F","G","H"]){super(),this.affichageNom=f;const l=$(c,u,P);l.c2d.nom=s[0];const t=O(o,0,0),y=O(0,o,0),b=O(0,0,o),m=w(l,t);m.c2d.nom=s[1];const i=w(m,b);i.c2d.nom=s[2];const n=w(l,b);n.c2d.nom=s[3];let r=[l.c2d,m.c2d,i.c2d,n.c2d];const k=this.affichageNom?de(...r):H(r,a);this.affichageNom&&(k[0].color=L(a));const v=w(l,y);v.c2d.nom=s[4];const e=w(v,t);e.c2d.nom=s[5];const B=w(e,b);B.c2d.nom=s[6];const G=w(n,y);G.c2d.nom=s[7],r=[v.c2d,e.c2d,B.c2d,G.c2d];const X=this.affichageNom?de(...r):oe(),W=H([m.c2d,e.c2d,B.c2d,i.c2d],a);let z,Q,A,I;pe.anglePerspective>0?(z=H([n.c2d,i.c2d,B.c2d,G.c2d],a),I=R(v.c2d,G.c2d,a),A=R(v.c2d,e.c2d,a),Q=R(v.c2d,l.c2d,a)):(z=H([l.c2d,m.c2d,e.c2d,v.c2d],a),I=R(v.c2d,G.c2d,a),A=R(n.c2d,G.c2d,a),Q=R(B.c2d,G.c2d,a)),I.pointilles=2,A.pointilles=2,Q.pointilles=2,this.sommets=[l,m,i,n,v,e,B,G],h?(Array.isArray(k)?k[0].couleurDeRemplissage=L(g):k.couleurDeRemplissage=L(g),z.couleurDeRemplissage=L(p),W.couleurDeRemplissage=L(V),this.c2d=[k.length===2?k[0]:k,k.length===2?k[1]:oe(),W,z]):this.c2d=[k.length===2?k[0]:k,k.length===2?k[1]:oe(),W,z,X.length===2?X[1]:oe(),I,A,Q]}}function Ze(M,c,u,P,o="black",a="lightgray",g="white",p="darkgray",V=!0,h=!1,f=["A","B","C","D","E","F","G","H"]){return new Ge(M,c,u,P,o,a,g,p,V,h,f)}class Qe extends _{constructor(c,u,P,o,a,g="black"){super();let p,V;this.c2d=[];const h=O(o,0,0),f=O(0,o,0),s=O(0,0,o);let l=$(c,u,P),t=l,y=l,b=l,m=l,i=l,n=l,r=l;for(let v=0;v<a;v++)t=w(l,h),y=w(t,s),b=w(l,s),m=w(l,f),i=w(m,h),n=w(i,s),r=w(b,f),p=H([l.c2d,t.c2d,y.c2d,b.c2d],g),V=H([b.c2d,y.c2d,n.c2d,r.c2d],g),p.couleurDeRemplissage=L("lightgray"),V.couleurDeRemplissage=L("white"),this.c2d.push(p,V),l=w(l,h);const k=H([t.c2d,i.c2d,n.c2d,y.c2d],g);k.couleurDeRemplissage=L("darkgray"),this.c2d.push(k)}}function _e(M,c,u,P,o,a="black"){return new Qe(M,c,u,P,o,a)}class Ne extends _{constructor(c,u,P,o,a,g,p="black"){super();let V,h,f,s,l,t,y,b,m,i;this.c2d=[];const n=O(o,0,0),r=O(0,o,0),k=O(0,0,o);for(let v=0;v<a;v++)for(let e=0;e<g;e++)V=$(c+v*o,u+e*o,P),h=w(V,n),f=w(h,k),s=w(V,k),l=w(h,r),t=w(l,k),y=w(s,r),e===0&&(b=H([V.c2d,h.c2d,f.c2d,s.c2d],p),b.couleurDeRemplissage=L("lightgray"),this.c2d.push(b)),v===a-1&&(i=H([h.c2d,l.c2d,t.c2d,f.c2d],p),i.couleurDeRemplissage=L("darkgray"),this.c2d.push(i)),m=H([s.c2d,f.c2d,t.c2d,y.c2d],p),m.couleurDeRemplissage=L("white"),this.c2d.push(m)}}function $e(M,c,u,P,o,a,g="black"){return new Ne(M,c,u,P,o,a,g)}class Fe extends _{constructor(c,u,P,o,a,g,p,V="black"){super();let h,f,s,l,t,y,b,m,i,n;this.c2d=[];const r=O(o,0,0),k=O(0,o,0),v=O(0,0,o);for(let e=0;e<a;e++)for(let B=0;B<g;B++)for(let G=0;G<p;G++)h=$(c+e*o,u+B*o,P+G*o),f=w(h,r),s=w(f,v),l=w(h,v),t=w(f,k),y=w(t,v),b=w(l,k),B===0&&(m=H([h.c2d,f.c2d,s.c2d,l.c2d],V),m.couleurDeRemplissage=L("lightgray"),this.c2d.push(m)),e===a-1&&(n=H([f.c2d,t.c2d,y.c2d,s.c2d],V),n.couleurDeRemplissage=L("darkgray"),this.c2d.push(n)),G===p-1&&(i=H([l.c2d,s.c2d,y.c2d,b.c2d],V),i.couleurDeRemplissage=L("white"),this.c2d.push(i))}}function Je(M,c,u,P,o,a,g,p="black"){return new Fe(M,c,u,P,o,a,g,p)}class Te extends _{constructor(c,u,P,o,a="black",g=!1,p="ABCDEFGH"){super(),this.affichageNom=g;const V=O(c,u),h=O(c,o),f=w(P,V),s=w(P,h),l=w(f,h),t=w(u,h);function y(b){const m=Z(b.c2d,c.c2d,5),i=Z(b.c2d,u.c2d,5),n=Z(b.c2d,f.c2d,5),r=Z(b.c2d,P.c2d,5);return Ve((m+i+n+r)/4,5)}if(o.isVisible=!o.c2d.estDansQuadrilatere(c.c2d,u.c2d,f.c2d,P.c2d),t.isVisible=!t.c2d.estDansQuadrilatere(c.c2d,u.c2d,f.c2d,P.c2d),l.isVisible=!l.c2d.estDansQuadrilatere(c.c2d,u.c2d,f.c2d,P.c2d),s.isVisible=!s.c2d.estDansQuadrilatere(c.c2d,u.c2d,f.c2d,P.c2d),o.isVisible&&t.isVisible&&l.isVisible&&s.isVisible){const b=Math.min(y(o),y(t),y(l),y(s));o.isVisible=b!==y(o),t.isVisible=b!==y(t),l.isVisible=b!==y(l),s.isVisible=b!==y(s)}this.sommets=[c,u,f,P,o,t,l,s],this.color=L(a),this.base=fe(c,u,t,o),this.hauteur=O(c,P),this.c2d=[],this.aretes=[F(c,u,a),F(c,P,a),F(c,o,a),F(f,u,a),F(t,u,a),F(f,P,a),F(f,l,a),F(t,l,a),F(t,o,a),F(s,l,a),F(s,o,a),F(s,P,a)];for(const b of this.aretes)this.c2d.push(b.c2d);if(this.affichageNom){let b=[c.c2d,u.c2d,f.c2d,P.c2d];c.c2d.nom=p[0],u.c2d.nom=p[1],f.c2d.nom=p[2],P.c2d.nom=p[3],o.c2d.nom=p[4],t.c2d.nom=p[5],l.c2d.nom=p[6],s.c2d.nom=p[7];const m=de(...b,.5);b=[o.c2d,t.c2d,l.c2d,s.c2d];const i=de(...b,.5);this.c2d.push(m[1],i[1])}}}function Ke(M,c,u,P,o="black",a=!1,g="ABCDEFGH"){return new Te(M,c,u,P,o,a,g)}export{He as a,Ue as b,Ee as c,qe as d,Ye as e,Je as f,$e as g,_e as h,Ze as i,Ke as p,We as s};
