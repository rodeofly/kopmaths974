import{r as randint,e as texNombre,g as gestionnaireFormulaireTexte,l as listeQuestionsToContenu,y as shuffle,b1 as listeDesDiviseurs,a as choice,p as point,A as polygone,I as colorToLatexOrHTML,j as latex2d,k as segment,o as mathalea2d}from"./embellissements-BYV7mIDn.js";import{c as commonjsGlobal,a as getDefaultExportFromCjs}from"./index-BUDQz6-w.js";import{E as Exercice}from"./Exercice-DtXhjCyI.js";import"mathjs";import"decimal.js";import"katex";import"earcut";import"roughjs";import"./exerciseMethods-CtbYPwln.js";import"crypto-js";import"seedrandom";function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist$1={exports:{}},jsuites={exports:{}},hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(n,h){(function(o,d){n.exports=d()})(commonjsGlobal,function(){var o;return function(){var d={195:function(R){(function(m,a){R.exports=a()})(this,function(){return function(Ae){function a(Ne,Ce){this.highOrder=Ne,this.lowOrder=Ce}var v=[new a(1779033703,4089235720),new a(3144134277,2227873595),new a(1013904242,4271175723),new a(2773480762,1595750129),new a(1359893119,2917565137),new a(2600822924,725511199),new a(528734635,4215389547),new a(1541459225,327033209)],I=[new a(1116352408,3609767458),new a(1899447441,602891725),new a(3049323471,3964484399),new a(3921009573,2173295548),new a(961987163,4081628472),new a(1508970993,3053834265),new a(2453635748,2937671579),new a(2870763221,3664609560),new a(3624381080,2734883394),new a(310598401,1164996542),new a(607225278,1323610764),new a(1426881987,3590304994),new a(1925078388,4068182383),new a(2162078206,991336113),new a(2614888103,633803317),new a(3248222580,3479774868),new a(3835390401,2666613458),new a(4022224774,944711139),new a(264347078,2341262773),new a(604807628,2007800933),new a(770255983,1495990901),new a(1249150122,1856431235),new a(1555081692,3175218132),new a(1996064986,2198950837),new a(2554220882,3999719339),new a(2821834349,766784016),new a(2952996808,2566594879),new a(3210313671,3203337956),new a(3336571891,1034457026),new a(3584528711,2466948901),new a(113926993,3758326383),new a(338241895,168717936),new a(666307205,1188179964),new a(773529912,1546045734),new a(1294757372,1522805485),new a(1396182291,2643833823),new a(1695183700,2343527390),new a(1986661051,1014477480),new a(2177026350,1206759142),new a(2456956037,344077627),new a(2730485921,1290863460),new a(2820302411,3158454273),new a(3259730800,3505952657),new a(3345764771,106217008),new a(3516065817,3606008344),new a(3600352804,1432725776),new a(4094571909,1467031594),new a(275423344,851169720),new a(430227734,3100823752),new a(506948616,1363258195),new a(659060556,3750685593),new a(883997877,3785050280),new a(958139571,3318307427),new a(1322822218,3812723403),new a(1537002063,2003034995),new a(1747873779,3602036899),new a(1955562222,1575990012),new a(2024104815,1125592928),new a(2227730452,2716904306),new a(2361852424,442776044),new a(2428436474,593698344),new a(2756734187,3733110249),new a(3204031479,2999351573),new a(3329325298,3815920427),new a(3391569614,3928383900),new a(3515267271,566280711),new a(3940187606,3454069534),new a(4118630271,4000239992),new a(116418474,1914138554),new a(174292421,2731055270),new a(289380356,3203993006),new a(460393269,320620315),new a(685471733,587496836),new a(852142971,1086792851),new a(1017036298,365543100),new a(1126000580,2618297676),new a(1288033470,3409855158),new a(1501505948,4234509866),new a(1607167915,987167468),new a(1816402316,1246189591)],A=new Array(64),l,s,g,f,c,w,L,S,k,_,M,B,z=8;function q(Ne){return unescape(encodeURIComponent(Ne))}function ce(Ne){for(var Ce=[],Ie=(1<<z)-1,Be=Ne.length*z,Pe=0;Pe<Be;Pe+=z)Ce[Pe>>5]|=(Ne.charCodeAt(Pe/z)&Ie)<<32-z-Pe%32;return Ce}function me(Ne){for(var Ce="0123456789abcdef",Ie="",Be=Ne.length*4,Pe,ze=0;ze<Be;ze+=1)Pe=Ne[ze>>2]>>(3-ze%4)*8,Ie+=Ce.charAt(Pe>>4&15)+Ce.charAt(Pe&15);return Ie}function G(Ne,Ce){var Ie,Be,Pe,ze;return Ie=(Ne.lowOrder&65535)+(Ce.lowOrder&65535),Be=(Ne.lowOrder>>>16)+(Ce.lowOrder>>>16)+(Ie>>>16),Pe=(Be&65535)<<16|Ie&65535,Ie=(Ne.highOrder&65535)+(Ce.highOrder&65535)+(Be>>>16),Be=(Ne.highOrder>>>16)+(Ce.highOrder>>>16)+(Ie>>>16),ze=(Be&65535)<<16|Ie&65535,new a(ze,Pe)}function se(Ne,Ce,Ie,Be){var Pe,ze,Ze,et;return Pe=(Ne.lowOrder&65535)+(Ce.lowOrder&65535)+(Ie.lowOrder&65535)+(Be.lowOrder&65535),ze=(Ne.lowOrder>>>16)+(Ce.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Be.lowOrder>>>16)+(Pe>>>16),Ze=(ze&65535)<<16|Pe&65535,Pe=(Ne.highOrder&65535)+(Ce.highOrder&65535)+(Ie.highOrder&65535)+(Be.highOrder&65535)+(ze>>>16),ze=(Ne.highOrder>>>16)+(Ce.highOrder>>>16)+(Ie.highOrder>>>16)+(Be.highOrder>>>16)+(Pe>>>16),et=(ze&65535)<<16|Pe&65535,new a(et,Ze)}function ge(Ne,Ce,Ie,Be,Pe){var ze,Ze,et,it;return ze=(Ne.lowOrder&65535)+(Ce.lowOrder&65535)+(Ie.lowOrder&65535)+(Be.lowOrder&65535)+(Pe.lowOrder&65535),Ze=(Ne.lowOrder>>>16)+(Ce.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Be.lowOrder>>>16)+(Pe.lowOrder>>>16)+(ze>>>16),et=(Ze&65535)<<16|ze&65535,ze=(Ne.highOrder&65535)+(Ce.highOrder&65535)+(Ie.highOrder&65535)+(Be.highOrder&65535)+(Pe.highOrder&65535)+(Ze>>>16),Ze=(Ne.highOrder>>>16)+(Ce.highOrder>>>16)+(Ie.highOrder>>>16)+(Be.highOrder>>>16)+(Pe.highOrder>>>16)+(ze>>>16),it=(Ze&65535)<<16|ze&65535,new a(it,et)}function ue(Ne,Ce,Ie){return new a(Ne.highOrder&Ce.highOrder^Ne.highOrder&Ie.highOrder^Ce.highOrder&Ie.highOrder,Ne.lowOrder&Ce.lowOrder^Ne.lowOrder&Ie.lowOrder^Ce.lowOrder&Ie.lowOrder)}function oe(Ne,Ce,Ie){return new a(Ne.highOrder&Ce.highOrder^~Ne.highOrder&Ie.highOrder,Ne.lowOrder&Ce.lowOrder^~Ne.lowOrder&Ie.lowOrder)}function xe(Ne,Ce){return Ce<=32?new a(Ne.highOrder>>>Ce|Ne.lowOrder<<32-Ce,Ne.lowOrder>>>Ce|Ne.highOrder<<32-Ce):new a(Ne.lowOrder>>>Ce|Ne.highOrder<<32-Ce,Ne.highOrder>>>Ce|Ne.lowOrder<<32-Ce)}function ke(Ne){var Ce=xe(Ne,28),Ie=xe(Ne,34),Be=xe(Ne,39);return new a(Ce.highOrder^Ie.highOrder^Be.highOrder,Ce.lowOrder^Ie.lowOrder^Be.lowOrder)}function Re(Ne){var Ce=xe(Ne,14),Ie=xe(Ne,18),Be=xe(Ne,41);return new a(Ce.highOrder^Ie.highOrder^Be.highOrder,Ce.lowOrder^Ie.lowOrder^Be.lowOrder)}function Se(Ne){var Ce=xe(Ne,1),Ie=xe(Ne,8),Be=Y(Ne,7);return new a(Ce.highOrder^Ie.highOrder^Be.highOrder,Ce.lowOrder^Ie.lowOrder^Be.lowOrder)}function $e(Ne){var Ce=xe(Ne,19),Ie=xe(Ne,61),Be=Y(Ne,6);return new a(Ce.highOrder^Ie.highOrder^Be.highOrder,Ce.lowOrder^Ie.lowOrder^Be.lowOrder)}function Y(Ne,Ce){return Ce<=32?new a(Ne.highOrder>>>Ce,Ne.lowOrder>>>Ce|Ne.highOrder<<32-Ce):new a(0,Ne.highOrder<<32-Ce)}var Ae=q(Ae),Fe=Ae.length*z;Ae=ce(Ae),Ae[Fe>>5]|=128<<24-Fe%32,Ae[(Fe+128>>10<<5)+31]=Fe;for(var k=0;k<Ae.length;k+=32){l=v[0],s=v[1],g=v[2],f=v[3],c=v[4],w=v[5],L=v[6],S=v[7];for(var _=0;_<80;_++)_<16?A[_]=new a(Ae[_*2+k],Ae[_*2+k+1]):A[_]=se($e(A[_-2]),A[_-7],Se(A[_-15]),A[_-16]),M=ge(S,Re(c),oe(c,w,L),I[_],A[_]),B=G(ke(l),ue(l,s,g)),S=L,L=w,w=c,c=G(f,M),f=g,g=s,s=l,l=G(M,B);v[0]=G(l,v[0]),v[1]=G(s,v[1]),v[2]=G(g,v[2]),v[3]=G(f,v[3]),v[4]=G(c,v[4]),v[5]=G(w,v[5]),v[6]=G(L,v[6]),v[7]=G(S,v[7])}for(var rt=[],k=0;k<v.length;k++)rt.push(v[k].highOrder),rt.push(v[k].lowOrder);return me(rt)}})}},C={};function N(R){var m=C[R];if(m!==void 0)return m.exports;var a=C[R]={exports:{}};return d[R].call(a.exports,a,a.exports,N),a.exports}(function(){N.n=function(R){var m=R&&R.__esModule?function(){return R.default}:function(){return R};return N.d(m,{a:m}),m}})(),function(){N.d=function(R,m){for(var a in m)N.o(m,a)&&!N.o(R,a)&&Object.defineProperty(R,a,{enumerable:!0,get:m[a]})}}(),function(){N.o=function(R,m){return Object.prototype.hasOwnProperty.call(R,m)}}();var W={};(function(){N.d(W,{default:function(){return gt}});var R=function(j){document.dictionary||(document.dictionary={});var T=null,p=Object.keys(j);for(T=0;T<p.length;T++)document.dictionary[p[T]]=j[p[T]]},m=function(j){return typeof document<"u"&&document.dictionary&&document.dictionary[j]||j},a={setDictionary:R,translate:m},I=function(j,T){if(T===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(r){return r!==null}),setTimeout(function(){window.jSuitesStateControl.push(j)},0);else{var p=window.jSuitesStateControl.indexOf(j);p>=0&&window.jSuitesStateControl.splice(p,1)}},A={};A.two=function(j){return j=""+j,j.length==1&&(j="0"+j),j},A.focus=function(j){if(j.textContent.length){const T=document.createRange(),p=window.getSelection();let r=j;for(;r.lastChild;)r=r.lastChild;r.nodeType===Node.TEXT_NODE?T.setStart(r,r.length):T.setStart(r,r.childNodes.length),T.collapse(!0),p.removeAllRanges(),p.addRange(T),j.scrollLeft=j.scrollWidth}},A.isNumeric=function(j){return typeof j=="string"&&(j=j.trim()),!isNaN(j)&&j!==null&&j!==""},A.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(j){var T=Math.random()*16|0,p=j=="x"?T:T&3|8;return p.toString(16)})},A.getNode=function(){var j=document.getSelection().anchorNode;return j?j.nodeType==3?j.parentNode:j:null},A.hash=function(j){var T=0,p,r;if(j.length===0)return T;for(p=0;p<j.length;p++)r=j.charCodeAt(p),r>32&&(T=(T<<5)-T+r,T|=0);return T},A.randomColor=function(j){var T=-.25,p=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");p.length<6&&(p=p[0]+p[0]+p[1]+p[1]+p[2]+p[2]);var r=[],V,ne;for(ne=0;ne<3;ne++)V=parseInt(p.substr(ne*2,2),16),V=Math.round(Math.min(Math.max(0,V+V*T),255)).toString(16),r.push(("00"+V).substr(V.length));return j==!0?"#"+A.two(r[0].toString(16))+A.two(r[1].toString(16))+A.two(r[2].toString(16)):r},A.getWindowWidth=function(){var j=window,T=document,p=T.documentElement,r=T.getElementsByTagName("body")[0],V=j.innerWidth||p.clientWidth||r.clientWidth;return V},A.getWindowHeight=function(){var j=window,T=document,p=T.documentElement,r=T.getElementsByTagName("body")[0],V=j.innerHeight||p.clientHeight||r.clientHeight;return V},A.getPosition=function(j){if(j.changedTouches&&j.changedTouches[0])var T=j.changedTouches[0].pageX,p=j.changedTouches[0].pageY;else var T=window.Event?j.pageX:j.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),p=window.Event?j.pageY:j.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[T,p]},A.click=function(j){if(j.click)j.click();else{var T=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});j.dispatchEvent(T)}},A.findElement=function(j,T){var p=!1;function r(V){V&&!p&&(typeof T=="function"?p=T(V):typeof T=="string"&&V.classList&&V.classList.contains(T)&&(p=V)),V.parentNode&&!p&&r(V.parentNode)}return r(j),p};var l=A;const s=function(j){return typeof j=="object"||typeof j=="function"};function g(j,T,p){if(typeof j!="string"||j.length===0)return;const r=j.split(".");if(r.length===0)return;let V=this;if(typeof T>"u"&&typeof p>"u"){for(let ee=0;ee<r.length;ee++){const H=r[ee];if(V!=null&&s(V)&&Object.prototype.hasOwnProperty.call(V,H))V=V[H];else return}return V}for(let ee=0;ee<r.length-1;ee++){const H=r[ee];if(V==null||!s(V))return console.warn(`Cannot set value: path '${j}' blocked by invalid object at '${H}'`),!1;Object.prototype.hasOwnProperty.call(V,H)&&(V[H]==null||!s(V[H]))?V[H]={}:Object.prototype.hasOwnProperty.call(V,H)||(V[H]={}),V=V[H]}const ne=r[r.length-1];return V==null||!s(V)?!1:p===!0?Object.prototype.hasOwnProperty.call(V,ne)?(delete V[ne],!0):!1:(V[ne]=T,!0)}function f(j,T){var p={};p.options={};var r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},V=null;for(var ne in r)T&&T.hasOwnProperty(ne)?p.options[ne]=T[ne]:p.options[ne]=r[ne];j.classList.add("jsorting"),j.addEventListener("dragstart",function(O){let U=O.target;if(U.nodeType===3)if(U.parentNode.getAttribute("draggable")==="true")U=U.parentNode;else{O.preventDefault(),O.stopPropagation();return}if(U.getAttribute("draggable")==="true"){let Q=Array.prototype.indexOf.call(U.parentNode.children,U);V={element:U,o:Q,d:Q},U.style.opacity="0.25",typeof p.options.ondragstart=="function"&&p.options.ondragstart(j,U,O),O.dataTransfer.setDragImage(U,0,0)}}),j.addEventListener("dragover",function(O){if(O.preventDefault(),V&&ee(O.target)&&O.target.getAttribute("draggable")=="true"&&V.element!=O.target){if(p.options.direction)var U=O.target.clientWidth/2>O.offsetX;else var U=O.target.clientHeight/2>O.offsetY;U?O.target.parentNode.insertBefore(V.element,O.target):O.target.parentNode.insertBefore(V.element,O.target.nextSibling),V.d=Array.prototype.indexOf.call(O.target.parentNode.children,V.element)}}),j.addEventListener("dragleave",function(O){O.preventDefault()}),j.addEventListener("dragend",function(O){O.preventDefault(),V&&(typeof p.options.ondragend=="function"&&p.options.ondragend(j,V.element,O),V.o<V.d?O.target.parentNode.insertBefore(V.element,O.target.parentNode.children[V.o]):O.target.parentNode.insertBefore(V.element,O.target.parentNode.children[V.o].nextSibling),V.element.style.opacity="",V=null)}),j.addEventListener("drop",function(O){O.preventDefault(),V&&(V.o!==V.d&&typeof p.options.ondrop=="function"&&p.options.ondrop(j,V.o,V.d,V.element,O.target,O),V.element.style.opacity="",V=null)});for(var ee=function(O){var U=!1;function Q(ae){ae.className&&ae.classList.contains("jsorting")&&(U=!0),U||Q(ae.parentNode)}return Q(O),U},H=0;H<j.children.length;H++)j.children[H].hasAttribute("draggable")||j.children[H].setAttribute("draggable","true");return j.val=function(){for(var O=null,U=[],Q=0;Q<j.children.length;Q++)(O=j.children[Q].getAttribute("data-id"))&&U.push(O);return U},j}function c(j,T){var p={};(!T.loadUp||typeof T.loadUp!="function")&&(T.loadUp=function(){return!1}),(!T.loadDown||typeof T.loadDown!="function")&&(T.loadDown=function(){return!1}),T.timer||(T.timer=100);var r=null,V=function(ne){if(r==null){var ee=!1,H=j.scrollTop;j.scrollTop+j.clientHeight*2>=j.scrollHeight?T.loadDown()&&(H==j.scrollTop&&(j.scrollTop=j.scrollTop-j.clientHeight),ee=!0):j.scrollTop<=j.clientHeight&&T.loadUp()&&(H==j.scrollTop&&(j.scrollTop=j.scrollTop+j.clientHeight),ee=!0),r=setTimeout(function(){r=null},T.timer),ee&&typeof T.onupdate=="function"&&T.onupdate()}};return j.onscroll=function(ne){V()},j.onwheel=function(ne){V()},p}function w(){var j=function(T,p){if(Array.isArray(T)){var r={instance:[],complete:p};if(T.length>0)for(var V=0;V<T.length;V++)T[V].multiple=r,r.instance.push(j(T[V]));return r}if(T.data||(T.data={}),T.type&&(T.method=T.type),T.method||(T.method="GET"),T.dataType||(T.dataType="json"),T.data){var ne=function(ae,he){var pe=[];if(ae){var be=Object.keys(ae);if(be.length)for(var Te=0;Te<be.length;Te++){if(he)var Oe=he+"["+be[Te]+"]";else var Oe=be[Te];if(ae[Oe]instanceof FileList)pe[Oe]=ae[be[Te]];else if(ae[be[Te]]===null||ae[be[Te]]===void 0)pe[Oe]="";else if(typeof ae[be[Te]]=="object")for(var De=ne(ae[be[Te]],Oe),qe=Object.keys(De),We=0;We<qe.length;We++)pe[qe[We]]=De[qe[We]];else pe[Oe]=ae[be[Te]]}}return pe},ee=ne(T.data),H=Object.keys(ee);if(T.method=="GET"){if(H.length){for(var O=[],V=0;V<H.length;V++)O.push(H[V]+"="+encodeURIComponent(ee[H[V]]));T.url.indexOf("?")<0&&(T.url+="?"),T.url+=O.join("&")}}else for(var O=new FormData,V=0;V<H.length;V++)if(ee[H[V]]instanceof FileList){if(ee[H[V]].length)for(var U=0;U<ee[H[V]].length;U++)O.append(H[V],ee[H[V]][U],ee[H[V]][U].name)}else O.append(H[V],ee[H[V]])}var Q=new XMLHttpRequest;return Q.open(T.method,T.url,!0),T.requestedWith?Q.setRequestHeader("X-Requested-With",T.requestedWith):T.requestedWith!==!1&&Q.setRequestHeader("X-Requested-With","XMLHttpRequest"),T.contentType&&Q.setRequestHeader("Content-Type",T.contentType),T.method==="POST"?Q.setRequestHeader("Accept","application/json"):T.dataType==="blob"?Q.responseType="blob":T.contentType||(T.dataType==="json"?Q.setRequestHeader("Content-Type","text/json"):T.dataType==="html"&&Q.setRequestHeader("Content-Type","text/html")),T.cache!==!0&&(Q.setRequestHeader("pragma","no-cache"),Q.setRequestHeader("cache-control","no-cache")),T.withCredentials===!0&&(Q.withCredentials=!0),typeof T.beforeSend=="function"&&T.beforeSend(Q),typeof j.beforeSend=="function"&&j.beforeSend(Q),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(Q),Q.onerror=function(){T.error&&typeof T.error=="function"&&T.error({message:"Network error: Unable to reach the server.",status:0})},Q.ontimeout=function(){T.error&&typeof T.error=="function"&&T.error({message:"Request timed out after "+Q.timeout+"ms.",status:0})},Q.onload=function(){if(Q.status>=200&&Q.status<300)if(T.dataType==="json")try{var ae=JSON.parse(Q.responseText);T.success&&typeof T.success=="function"&&T.success(ae)}catch(pe){T.error&&typeof T.error=="function"&&T.error(pe,ae)}else{if(T.dataType==="blob")var ae=Q.response;else var ae=Q.responseText;T.success&&typeof T.success=="function"&&T.success(ae)}else T.error&&typeof T.error=="function"&&T.error(Q.responseText,Q.status);if(j.queue&&j.queue.length>0&&j.send(j.queue.shift()),j.requests&&j.requests.length){var he=j.requests.indexOf(Q);if(j.requests.splice(he,1),j.requests.length||T.complete&&typeof T.complete=="function"&&T.complete(ae),T.group&&j.oncomplete&&typeof j.oncomplete[T.group]=="function"&&(j.pending(T.group)||(j.oncomplete[T.group](),j.oncomplete[T.group]=null)),T.multiple&&T.multiple.instance){var he=T.multiple.instance.indexOf(Q);T.multiple.instance.splice(he,1),T.multiple.instance.length||T.multiple.complete&&typeof T.multiple.complete=="function"&&T.multiple.complete(ae)}}},Q.options=T,Q.data=O,T.queue===!0&&j.requests.length>0?j.queue.push(Q):j.send(Q),Q};return j.send=function(T){T.data?Array.isArray(T.data)?T.send(T.data.join("&")):T.send(T.data):T.send(),j.requests.push(T)},j.exists=function(T,p){var r=new XMLHttpRequest;r.open("HEAD",T,!1),r.send(),r.status&&p(r.status)},j.pending=function(T){var p=0,r=j.requests;if(r&&r.length)for(var V=0;V<r.length;V++)(!T||T==r[V].options.group)&&p++;return p},j.oncomplete={},j.requests=[],j.queue=[],j}var L=w();function S(){const j={loading:{}};return j.loading.show=function(T){j.loading.element||(j.loading.element=document.createElement("div"),j.loading.element.className="jloading"),document.body.appendChild(j.loading.element),T>0&&setTimeout(function(){j.loading.hide()},T*1e3)},j.loading.hide=function(){j.loading.element&&j.loading.element.parentNode&&document.body.removeChild(j.loading.element)},j.slideLeft=function(T,p,r){p==!0?(T.classList.add("jslide-left-in"),setTimeout(function(){T.classList.remove("jslide-left-in"),typeof r=="function"&&r()},400)):(T.classList.add("jslide-left-out"),setTimeout(function(){T.classList.remove("jslide-left-out"),typeof r=="function"&&r()},400))},j.slideRight=function(T,p,r){p===!0?(T.classList.add("jslide-right-in"),setTimeout(function(){T.classList.remove("jslide-right-in"),typeof r=="function"&&r()},400)):(T.classList.add("jslide-right-out"),setTimeout(function(){T.classList.remove("jslide-right-out"),typeof r=="function"&&r()},400))},j.slideTop=function(T,p,r){p===!0?(T.classList.add("jslide-top-in"),setTimeout(function(){T.classList.remove("jslide-top-in"),typeof r=="function"&&r()},400)):(T.classList.add("jslide-top-out"),setTimeout(function(){T.classList.remove("jslide-top-out"),typeof r=="function"&&r()},400))},j.slideBottom=function(T,p,r){p===!0?(T.classList.add("jslide-bottom-in"),setTimeout(function(){T.classList.remove("jslide-bottom-in"),typeof r=="function"&&r()},400)):(T.classList.add("jslide-bottom-out"),setTimeout(function(){T.classList.remove("jslide-bottom-out"),typeof r=="function"&&r()},100))},j.fadeIn=function(T,p){T.style.display="",T.classList.add("jfade-in"),setTimeout(function(){T.classList.remove("jfade-in"),typeof p=="function"&&p()},2e3)},j.fadeOut=function(T,p){T.classList.add("jfade-out"),setTimeout(function(){T.style.display="none",T.classList.remove("jfade-out"),typeof p=="function"&&p()},1e3)},j}var k=S();function _(){var j={};j.now=function(ee,H){var O=null,U=null,Q=null,ae=null,he=null,pe=null;return Array.isArray(ee)?(O=ee[0],U=ee[1],Q=ee[2],ae=ee[3],he=ee[4],pe=ee[5]):(ee||(ee=new Date),O=ee.getFullYear(),U=ee.getMonth()+1,Q=ee.getDate(),ae=ee.getHours(),he=ee.getMinutes(),pe=ee.getSeconds()),H==!0?l.two(O)+"-"+l.two(U)+"-"+l.two(Q):l.two(O)+"-"+l.two(U)+"-"+l.two(Q)+" "+l.two(ae)+":"+l.two(he)+":"+l.two(pe)},j.toArray=function(ee){var O=ee.split(ee.indexOf("T")!==-1?"T":" "),H=O[1],O=O[0].split("-"),U=parseInt(O[0]),Q=parseInt(O[1]),ae=parseInt(O[2]),he=0,pe=0;return H&&(H=H.split(":"),he=parseInt(H[0]),pe=parseInt(H[1])),[U,Q,ae,he,pe,0]};var T=Date.UTC(1900,0,0),p=Date.UTC(1900,1,29),r=864e5;j.dateToNum=function(ee){typeof ee=="string"&&(ee=new Date(ee+"  GMT+0"));var H=ee.getTime();return H>=p&&(H+=r),H-=T,H/r},j.numToDate=function(ee){var H=T+ee*r;H>=p&&(H-=r);const O=new Date(H);var U=[O.getUTCFullYear(),O.getUTCMonth()+1,O.getUTCDate(),O.getUTCHours(),O.getUTCMinutes(),O.getUTCSeconds()];return j.now(U)};let V=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ne=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(j,"weekdays",{get:function(){return V.map(function(ee){return a.translate(ee)})}}),Object.defineProperty(j,"weekdaysShort",{get:function(){return V.map(function(ee){return a.translate(ee).substring(0,3)})}}),Object.defineProperty(j,"months",{get:function(){return ne.map(function(ee){return a.translate(ee)})}}),Object.defineProperty(j,"monthsShort",{get:function(){return ne.map(function(ee){return a.translate(ee).substring(0,3)})}}),j}var M=_();function B(){var j={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},T=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var E=0;this.date[4]&&(E=parseFloat(this.date[4]/60));var F=parseInt(this.date[3])+E;F/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?F=l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),F=l.two(this.date[0])+"-"+l.two(this.date[1])+"-"+l.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(F+=" "+l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5])));return F},p=function(){var E="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)E=parseInt(this.date[3]);else{let J=parseInt(this.date[3]);J<13&&this.values.indexOf("PM")!==-1?E=(J+12)%24:E=J%24}this.date[4]&&(E+=parseFloat(this.date[4]/60)),this.date[5]&&(E+=parseFloat(this.date[5]/3600)),E/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var F=M.now(this.date);E=M.dateToNum(F)}return isNaN(E)&&(E=""),E},r=function(E){return E===null||E===""||E===void 0},V=function(E){var F=(""+E)[0];return F=="="},ne=function(E){return E==="currency"||E==="percentage"||E==="scientific"||E==="numeric"},ee=function(E){if(E&&Number(E)==E)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var F=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=F[1]}else{E||(E=this.mask);var J=new RegExp("0{1}(.{1})0+","ig"),F=J.exec(E);if(F&&F[1]&&F[1].length==1)return this.options.decimal=F[1],F[1];var J=new RegExp("#{1}(.{1})#+","ig"),F=J.exec(E);F&&F[1]&&F[1].length==1?F[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},H=function(E,F){if(E=="")return"";F||(F=ee.call(this)),E=(""+E).split(F);var J=E[0].match(/[-]+/g);if(J&&J.length?J=!0:J=!1,E[0]=E[0].match(/[0-9]+/g),E[0]?(J&&E[0].unshift("-"),E[0]=E[0].join("")):J&&(E[0]="-"),E[0]||E[1])E[1]!==void 0&&(E[1]=E[1].match(/[0-9]+/g),E[1]?E[1]=E[1].join(""):E[1]="");else return"";return E},O=function(E,F){if(E==="")return"";var J=ee.call(this),de=this.options;if(E=H.call(this,E),E==="")return"";var K=null;if(E[0]&&(de.style==="percent"?K=parseFloat(E[0])/100:K=parseFloat(E[0]+".1")),(E[0]==="-"||E[0]==="-00")&&!E[1]&&F&&F.inputType=="deleteContentBackward")return"";var fe=new Intl.NumberFormat(this.locale,de).format(K);if(fe=fe.split(J),de.style==="percent"&&fe[0].indexOf("%")!==-1&&(fe[0]=fe[0].replace("%",""),fe[2]="%"),typeof fe[1]<"u"){var Ee=fe[1].replace(/[0-9]*/g,"");Ee&&(fe[2]=Ee)}return E[1]!==void 0?fe[1]=J+E[1]:fe[1]="",fe.join("")},U=function(E,F){var J=he.call(E);if(J){var de=O.call(this,J,F),K=de.length-J.length,fe=ae.call(E)+K;he.call(E,de,fe,!0)}},Q=function(E){var F=H.call(this,E);return F?(F[0]==="-"&&(F[0]="-0"),parseFloat(F.join("."))):null},ae=function(E,F){if(E===void 0)if(this.tagName=="DIV"){var J=0,de=window.getSelection();if(de&&de.rangeCount!==0){var K=de.getRangeAt(0),fe=K.cloneRange();fe.selectNodeContents(this),fe.setEnd(K.endContainer,K.endOffset),J=fe.toString().length}return J}else return this.selectionStart;else{var Ee=he.call(this);if(F){for(var fe=null,te=0;te<Ee.length;te++)(Ee[te].match(/[\-0-9]/g)||Ee[te]==="."||Ee[te]===",")&&(fe=te);fe===null&&(fe=Ee.indexOf(" ")),E>=fe&&(E=fe+1)}if(E>Ee.length&&(E=Ee.length),E)if(this.tagName=="DIV"){var de=window.getSelection(),K=document.createRange();this.childNodes[0]&&(K.setStart(this.childNodes[0],E),de.removeAllRanges(),de.addRange(K))}else this.selectionStart=E,this.selectionEnd=E}},he=function(E,F,J){if(this.tagName=="DIV")if(E===void 0){var E=this.innerText;return this.value&&this.value.length>E.length&&(E=this.value),E}else this.innerText!==E&&(this.innerText=E,F&&ae.call(this,F,J));else{if(E===void 0)return this.value;this.value!==E&&(this.value=E,F&&ae.call(this,F,J))}},pe=M.weekdays,be=M.weekdaysShort,Te=M.months,Oe=M.monthsShort,De={YEAR:function(E,F){var J=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(E)>=0&&parseInt(E)<=10&&this.values[this.index].length<F&&(this.values[this.index]+=E),this.values[this.index].length==F){if(F==2)var J=J.substr(0,2)+this.values[this.index];else if(F==3)var J=J.substr(0,1)+this.values[this.index];else if(F==4)var J=this.values[this.index];this.date[0]=J,this.index++}},YYYY:function(E){De.YEAR.call(this,E,4)},YYY:function(E){De.YEAR.call(this,E,3)},YY:function(E){De.YEAR.call(this,E,2)},FIND:function(E,F){if(r(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=E;return}for(var J=0,de=0,K=(this.values[this.index]+E).toLowerCase(),fe=0;fe<F.length;fe++)F[fe].toLowerCase().indexOf(K)==0&&(J=fe,de++);if(de>1)this.values[this.index]+=E;else if(de==1){var Ee=F[J].length-this.values[this.index].length-1;return this.position+=Ee,this.values[this.index]=F[J],this.index++,J}},MMM:function(E){var F=De.FIND.call(this,E,Oe);F!==void 0&&(this.date[1]=F+1)},MON:function(E){De.MMM.call(this,E)},MMMM:function(E){var F=De.FIND.call(this,E,Te);F!==void 0&&(this.date[1]=F+1)},MONTH:function(E){De.MMMM.call(this,E)},MMMMM:function(E){r(this.values[this.index])&&(this.values[this.index]="");for(var F=(this.values[this.index]+E).toLowerCase(),J=0;J<Te.length;J++)if(Te[J][0].toLowerCase().indexOf(F)==0){this.values[this.index]=Te[J][0],this.date[1]=J+1,this.index++;break}},MM:function(E){r(this.values[this.index])?parseInt(E)>1&&parseInt(E)<10?(this.date[1]=this.values[this.index]="0"+E,this.index++):parseInt(E)<2&&(this.values[this.index]=E):this.values[this.index]==1&&parseInt(E)<3?(this.date[1]=this.values[this.index]+=E,this.index++):this.values[this.index]==0&&parseInt(E)>0&&parseInt(E)<10&&(this.date[1]=this.values[this.index]+=E,this.index++)},M:function(E){var F=!1;if(parseInt(E)>=0&&parseInt(E)<10)if(r(this.values[this.index]))this.values[this.index]=E,E>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(E)<3)this.date[1]=this.values[this.index]+=E,this.index++;else if(this.values[this.index]==0&&parseInt(E)>0)this.date[1]=this.values[this.index]+=E,this.index++;else var F=!0;else var F=!0;if(F==!0){var J=parseInt(this.values[this.index]);J>0&&J<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(E){var F=!1;if(parseInt(E)>=0&&parseInt(E)<10)if(r(this.values[this.index]))this.values[this.index]=E,parseInt(E)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(E)<2)this.date[2]=this.values[this.index]+=E,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=E,this.index++;else if(this.values[this.index]==0&&parseInt(E)>0)this.date[2]=this.values[this.index]+=E,this.index++;else var F=!0;else var F=!0;if(F==!0){var J=parseInt(this.values[this.index]);J>0&&J<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(E){r(this.values[this.index])?parseInt(E)>3&&parseInt(E)<10?(this.date[2]=this.values[this.index]="0"+E,this.index++):parseInt(E)<10&&(this.values[this.index]=E):this.values[this.index]==3&&parseInt(E)<2?(this.date[2]=this.values[this.index]+=E,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(E)<10?(this.date[2]=this.values[this.index]+=E,this.index++):this.values[this.index]==0&&parseInt(E)>0&&parseInt(E)<10&&(this.date[2]=this.values[this.index]+=E,this.index++)},DDD:function(E){De.FIND.call(this,E,be)},DY:function(E){De.DDD.call(this,E)},DDDD:function(E){De.FIND.call(this,E,pe)},DAY:function(E){De.DDDD.call(this,E)},HH12:function(E,F){var J=!1;if(parseInt(E)>=0&&parseInt(E)<10)if(r(this.values[this.index]))parseInt(E)>1&&parseInt(E)<10?(F&&(E=0+E),this.date[3]=this.values[this.index]=E,this.index++):parseInt(E)<10&&(this.values[this.index]=E);else if(this.values[this.index]==1&&parseInt(E)<3)this.date[3]=this.values[this.index]+=E,this.index++;else if(this.values[this.index]<1&&parseInt(E)<10)this.date[3]=this.values[this.index]+=E,this.index++;else var J=!0;else var J=!0;if(J==!0){var de=parseInt(this.values[this.index]);de>=0&&de<=12&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH24:function(E,F){var J=!1;if(parseInt(E)>=0&&parseInt(E)<10)if(this.values[this.index]==null||this.values[this.index]=="")parseInt(E)>2&&parseInt(E)<10?(F&&(E=0+E),this.date[3]=this.values[this.index]=E,this.index++):parseInt(E)<10&&(this.values[this.index]=E);else if(this.values[this.index]==2&&parseInt(E)<4)!F&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=E,this.index++;else if(this.values[this.index]<2&&parseInt(E)<10)!F&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=E,this.index++;else var J=!0;else var J=!0;if(J==!0){var de=parseInt(this.values[this.index]);de>=0&&de<24&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH:function(E){De.HH24.call(this,E,1)},H:function(E){De.HH24.call(this,E,0)},"\\[H\\]":function(E){this.values[this.index]==null&&(this.values[this.index]=""),E.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=E:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(E,F){this.values[this.index]==null||this.values[this.index]==""?parseInt(E)>5&&parseInt(E)<10?(this.date[F]=this.values[this.index]="0"+E,this.index++):parseInt(E)<10&&(this.values[this.index]=E):parseInt(E)<10&&(this.date[F]=this.values[this.index]+=E,this.index++)},MI:function(E){De.N60.call(this,E,4)},SS:function(E){De.N60.call(this,E,5)},"AM/PM":function(E){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?E.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":E.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(E){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(E)>=0&&parseInt(E)<7&&(this.values[this.index]=E),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(E){var F=ee.call(this),J=!1;r(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(J=!0);var de=H.call(this,this.values[this.index],F);de&&(this.values[this.index]=de.join(F)),parseInt(E)>=0&&parseInt(E)<10?(this.values[this.index]=="0"&&E>0?this.values[this.index]="":this.values[this.index]=="-0"&&E>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||E==F)&&(this.values[this.index]+=E)):F&&E==F?this.values[this.index].indexOf(F)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=E):E=="-"&&(J=!0),J===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(E){De["0{1}(.{1}0+)?"].call(this,E)},"0{1}(.{1}0+)?%":function(E){De["0{1}(.{1}0+)?"].call(this,E),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(E){De["0{1}(.{1}0+)?"].call(this,E);var F=ee.call(this),J=this.tokens[this.index].substr(1,1),de=this.values[this.index][0]==="-",K=H.call(this,this.values[this.index],F);if(K!==""){var fe=K[0].match(/[0-9]/g);if(fe){fe=fe.join("");for(var Ee=[],te=0,le=fe.length-1;le>=0;le--)Ee.push(fe[le]),te++,te%3||Ee.push(J);Ee=Ee.reverse(),K[0]=Ee.join(""),K[0].substr(0,1)==J&&(K[0]=K[0].substr(1))}else K[0]="";this.values[this.index]=K.join(F),de&&(this.values[this.index]="-"+this.values[this.index])}},0:function(E){E.match(/[0-9]/g)&&(this.values[this.index]=E,this.index++)},"[0-9a-zA-Z$]+":function(E){r(this.values[this.index])&&(this.values[this.index]="");var F=this.tokens[this.index],J=this.values[this.index],de=J.length;F[de]==E?(this.values[this.index]+=E,this.values[this.index]==F&&this.index++):(this.values[this.index]=F,this.index++,E.match(/[\-0-9]/g)&&this.position--)},A:function(E){E.match(/[a-zA-Z]/gi)&&(this.values[this.index]=E,this.index++)},".":function(E){De["[0-9a-zA-Z$]+"].call(this,E)},"@":function(E){r(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=E}},qe=function(E){if(this.type=="general")var F=[].concat(j.general);else var F=[].concat(j.currency,j.datetime,j.percentage,j.scientific,j.numeric,j.text,j.general);var J=new RegExp(F.join("|"),"gi");return E.match(J)},We=function(E){if(this.type)if(this.type=="text")var F=["text"];else if(this.type=="general")var F=["general"];else if(this.type=="datetime")var F=["numeric","datetime","general"];else var F=["currency","percentage","scientific","numeric","general"];else var F=Object.keys(j);for(var J=0;J<F.length;J++)for(var de=F[J],K=0;K<j[de].length;K++){var fe=new RegExp(j[de][K],"gi"),Ee=E.match(fe);if(Ee)return{type:de,method:j[de][K]}}},re=function(E){for(var F=[],J=0;J<E.length;J++){var de=We.call(this,E[J]);de?F.push(de.method):F.push(null)}for(var J=0;J<F.length;J++)F[J]=="MM"&&(F[J-1]&&F[J-1].indexOf("H")>=0||F[J-2]&&F[J-2].indexOf("H")>=0||F[J+1]&&F[J+1].indexOf("S")>=0||F[J+2]&&F[J+2].indexOf("S")>=0)&&(F[J]="MI");return F},ve=function(E){var F=We.call(this,E);if(F)var J=F.type;if(J){for(var de=0,K=qe.call(this,E),fe=0;fe<K.length;fe++)F=We.call(this,K[fe]),F&&ne(F.type)&&de++;de>1&&(J="general")}return J},Le=function(){typeof De[this.methods[this.index]]=="function"?(De[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},X=function(E){return(""+ +E).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(F,J,de,K,fe){return fe<0?J+"0."+Array(1-fe-de.length).join(0)+de+K:J+de+K+Array(fe-K.length+1).join(0)})},Z=function(E,F,J){var de=null,K={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof E=="object"){if(K.input=E.target,K.value=he.call(E.target),K.caret=ae.call(E.target),(de=E.target.getAttribute("data-mask"))&&(K.mask=de),(de=E.target.getAttribute("data-type"))&&(K.type=de),E.target.mask?(E.target.mask.options&&(K.options=E.target.mask.options),E.target.mask.locale&&(K.locale=E.target.mask.locale)):(de=E.target.getAttribute("data-locale"))&&(K.locale=de,K.mask&&(K.options.style=K.mask)),E.target.attributes&&E.target.attributes.length)for(var fe=0;fe<E.target.attributes.length;fe++){var Ee=E.target.attributes[fe].name,te=E.target.attributes[fe].value;Ee.substr(0,4)=="data"&&(K.options[Ee.substr(5)]=te)}}else{if(typeof F=="string")K.mask=F;else for(var Ee=Object.keys(F),fe=0;fe<Ee.length;fe++)K[Ee[fe]]=F[Ee[fe]];typeof E=="number"&&(ee.call(K,K.mask),E=(""+E).replace(".",K.options.decimal)),K.value=E,K.input&&(he.call(K.input,E),l.focus(K.input),K.caret=ae.call(K.input))}if(!V(K.value)&&(K.mask||K.locale)){if(K.mask){if(K.mask=K.mask.replace(new RegExp(/\[h]/),"|h|"),K.mask=K.mask.replace(new RegExp(/\[.*?\]/),""),K.mask=K.mask.replace(new RegExp(/\|h\|/),"[h]"),K.mask.indexOf(";")!==-1){var de=K.mask.split(";");K.mask=de[0]}if(K.mask.indexOf("##")!==-1){var le=K.mask.split(";");le[0]&&(typeof E=="object"&&(le[0]=le[0].replace(new RegExp(/_\)/g),""),le[0]=le[0].replace(new RegExp(/_\(/g),"")),le[0]=le[0].replace("*","	"),le[0]=le[0].replace(new RegExp(/_-/g),""),le[0]=le[0].replace(new RegExp(/_/g),""),le[0]=le[0].replace(new RegExp(/"/g),""),le[0]=le[0].replace("##0.###","##0.000"),le[0]=le[0].replace("##0.##","##0.00"),le[0]=le[0].replace("##0.#","##0.0"),le[0]=le[0].replace("##0,###","##0,000"),le[0]=le[0].replace("##0,##","##0,00"),le[0]=le[0].replace("##0,#","##0,0")),K.mask=le[0]}if(K.mask.indexOf("\\")!==-1){var le=K.mask.split(";");le[0]=le[0].replace(new RegExp(/\\/g),""),K.mask=le[0]}K.type||(K.type=ve.call(K,K.mask)),K.tokens=qe.call(K,K.mask)}if(typeof E!="object"||!E.inputType||!E.inputType.indexOf("insert")||!E.inputType.indexOf("delete"))if(K.locale)if(K.input)U.call(K,K.input,E);else var we=O.call(K,K.value);else{for(K.methods=re.call(K,K.tokens),K.event=E;K.position<K.value.length&&typeof K.tokens[K.index]<"u";)Le.call(K);var we=K.values.join("");if(ne(K.type)&&we!==""){for(;typeof K.tokens[K.index]<"u";){var de=We.call(K,K.tokens[K.index]);de&&de.type=="general"&&(K.values[K.index]=K.tokens[K.index]),K.index++}var je=!0}else var je=!1;if(we=K.values.join(""),K.input){if(de=we.length-K.value.length,de>0)var Ye=K.caret+de;else var Ye=K.caret;he.call(K.input,we,Ye,je)}}if(K.input){var Ue=null;if(ne(K.type)){let Je=he.call(K.input);K.number=Q.call(K,Je),K.type=="percentage"&&(""+Je).indexOf("%")!==-1?Ue=Z.adjustPrecision(K.number/100):Ue=K.number}else K.type=="datetime"&&(Ue=T.call(K),K.date[0]&&K.date[1]&&K.date[2]&&K.input.setAttribute("data-completed",!0));Ue&&K.input.setAttribute("data-value",Ue)}if(we!==void 0)return J?K:we}};return Z.adjustPrecision=function(E){if(typeof E=="number"&&!Number.isInteger(E)){const F=E.toString().split(".");if(F[1]&&F[1].length>10){let J=0;const de=F[1][F[1].length-2];if(de==0||de==9){for(let K=F[1].length-2;K>0;K--)if(J>=0&&F[1][K]==de){if(J++,J>6)break}else{J=0;break}if(J)return parseFloat(parseFloat(E).toFixed(F[1].length-1))}}}return E},Z.getType=ve,Z.prepare=function(E,F){return F||(F={}),qe.call(F,E)},Z.apply=function(E){var F=he.call(E.target);E.key.length==1&&(F+=E.key),he.call(E.target,Z(F,E.target.getAttribute("data-mask")))},Z.run=function(E,F,J){return Z(E,{mask:F,decimal:J})},Z.extract=function(E,F,J){if(r(E)||typeof F!="object")return E;if(F=Object.assign({},F),F.options||(F.options={}),!F.mask&&F.format&&(F.mask=F.format),F.mask){if(F.mask.indexOf(";")!==-1){var de=F.mask.split(";");F.mask=de[0]}F.mask=F.mask.replace(new RegExp(/\[h]/),"|h|"),F.mask=F.mask.replace(new RegExp(/\[.*?\]/),""),F.mask=F.mask.replace(new RegExp(/\|h\|/),"[h]")}ee.call(F,F.mask);var K=null,fe=null;if(F.type=="percent"||F.options.style=="percent"?K="percentage":F.mask&&(K=ve.call(F,F.mask)),K==="text"){var Ee={};fe=E}else if(K==="general"){var Ee=Z(E,F,!0);fe=E}else if(K==="datetime"){E instanceof Date&&(E=Z.getDateString(E,F.mask));var Ee=Z(E,F,!0);l.isNumeric(E)?fe=E:fe=p.call(Ee)}else if(K==="scientific"){fe=E,typeof E=="string"&&(fe=Number(fe));var Ee=F}else{fe=Q.call(F,E),K==="percentage"&&(""+E).indexOf("%")!==-1&&(fe/=100);var Ee=F}return Ee.value=fe,!Ee.type&&K&&(Ee.type=K),J?Ee:fe},Z.render=function(E,F,J,de){if(r(E)||typeof F!="object")return E;if(F=Object.assign({},F),F.options||(F.options={}),!F.mask&&F.format&&(F.mask=F.format),F.mask){if(F.mask.indexOf(";")!==-1){var K=F.mask.split(";");J||(K[0]=K[0].replace(new RegExp(/_\)/g),""),K[0]=K[0].replace(new RegExp(/_\(/g),"")),F.mask=K[0]}F.mask=F.mask.replace(new RegExp(/\[h]/),"|h|"),F.mask=F.mask.replace(new RegExp(/\[.*?\]/),""),F.mask=F.mask.replace(new RegExp(/\|h\|/),"[h]")}var fe=null;F.type=="percent"||F.options.style=="percent"?fe="percentage":F.mask?fe=ve.call(F,F.mask):E instanceof Date&&(fe="datetime");var Ee=!1;if(fe=="datetime"||F.type=="calendar"){var K=Z.getDateString(E,F.mask);K&&(E=K),F.mask&&J&&(Ee=!0)}else if(fe==="text")typeof E=="number"&&(E=E.toString());else if(typeof E=="string"&&o.isNumeric(E)&&(E=Number(E)),fe==="percentage"&&(E=Z.adjustPrecision(E*100)),typeof E=="number"){var K=null;if(F.mask&&J){var te=ee.call(F,F.mask);if(fe==="scientific")if(F.mask.indexOf(te)!==-1){let Ge=F.mask.split("E");Ge=Ge[0].split(te),Ge=""+Ge[1].match(/[0-9]+/g),Ge=Ge.length,K=E.toExponential(Ge)}else K=E.toExponential(0);else{if(F.mask.indexOf(te)!==-1){te=F.mask.split(te),te=""+te[1].match(/[0-9]+/g),te=te.length,K=E.toFixed(te);let Ge=E.toString().split("."),tt=Ge[1];tt&&tt.length>te&&tt[tt.length-1]==="5"&&(K=parseFloat(Ge[0]+"."+tt+"1").toFixed(te))}else K=E.toFixed(0);(""+K).indexOf("e")!==-1&&(K=X(K))}}else if(F.locale&&J){var te=(""+E).split(".");if(F.options){typeof te[1]>"u"&&(te[1]="");var we=te[1].length;if(F.options.minimumFractionDigits>we)for(var le=0;le<F.options.minimumFractionDigits-we;le++)te[1]+="0"}te[1].length?K=te.join("."):K=te[0];var we=te[1].length;F.options&&F.options.maximumFractionDigits<we&&(K=parseFloat(K).toFixed(F.options.maximumFractionDigits))}else K=X(E);K!==null&&(E=K,ee.call(F,F.mask),F.options.decimal&&(E=E.replace(".",F.options.decimal)))}else F.mask&&J&&(Ee=!0);if(Ee){var je=F.mask.length-E.length;if(je>0)for(var le=0;le<je;le++)E+=" "}if(fe==="scientific")if(!J)E=X(E);else return E;if(fe==="numeric"&&de===!1&&typeof E=="string")return E;if(E=Z(E,F),J&&fe==="numeric"){var Ye=F.mask.match(new RegExp(/^[0]+$/gm));if(Ye&&Ye.length===1){var Ue=Ye[0].length;if(Ue>3)for(E=""+E;E.length<Ue;)E="0"+E}}return E},Z.set=function(E,F){if(F){E.setAttribute("data-mask",F);var J=new Event("input",{bubbles:!0,cancelable:!0});E.dispatchEvent(J)}},Z.extractDateFromString=function(E,F){var J=Z(E,{mask:F},!0);if(E>0&&Number(E)==E&&(J.values.join("")!==J.value||J.type=="numeric")){var de=new Date(Math.round((E-25569)*86400*1e3));return de.getFullYear()+"-"+l.two(de.getMonth())+"-"+l.two(de.getDate())+" 00:00:00"}var K=!1;return J.values&&J.values.length===J.tokens.length&&J.values[J.values.length-1].length>=J.tokens[J.tokens.length-1].length&&(K=!0),J.date[0]&&J.date[1]&&(J.date[2]||K)?(J.date[2]||(J.date[2]=1),J.date[0]+"-"+l.two(J.date[1])+"-"+l.two(J.date[2])+" "+l.two(J.date[3])+":"+l.two(J.date[4])+":"+l.two(J.date[5])):""},Z.getDateString=function(E,F){if(!F)var F={};if(F&&typeof F=="object"){if(F.format)var J=F.format;else if(F.mask)var J=F.mask}else var J=F;if(J||(J="YYYY-MM-DD"),J.indexOf("[h]")>=0){var de=0;if(E&&l.isNumeric(E)&&(de=parseFloat(24*Number(E)),J.indexOf("mm")>=0)){var K=(""+de).split(".");if(K[1]){var fe=60*parseFloat("0."+K[1]);fe=parseFloat(fe.toFixed(2))}else var fe=0;de=parseInt(K[0])+":"+l.two(fe)}return de}E instanceof Date?E=M.now(E):E&&l.isNumeric(E)&&(E=M.numToDate(E));for(var Ee=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],te=new RegExp(Ee.join("|"),"gi"),le=J.match(te),we=0;we<le.length;we++)le[we].toUpperCase()=="MM"&&(le[we-1]&&le[we-1].toUpperCase().indexOf("H")>=0||le[we-2]&&le[we-2].toUpperCase().indexOf("H")>=0||le[we+1]&&le[we+1].toUpperCase().indexOf("S")>=0||le[we+2]&&le[we+2].toUpperCase().indexOf("S")>=0)&&(le[we]="mi");var je={tokens:le};if(E){var fe=""+E,Ye=fe.indexOf("T")!==-1?"T":" ";fe=fe.split(Ye);var K=0,Ue=0,Je=0;fe[1]&&(K=fe[1].split(":"),Ue=K[1]?K[1]:0,Je=K[2]?K[2]:0,K=K[0]?K[0]:0),fe=fe[0].split("-");let mt=new Date(fe[0],fe[1],0).getDate();if(fe[0]&&fe[1]&&fe[2]&&fe[0]>0&&fe[1]>0&&fe[1]<13&&fe[2]>0&&fe[2]<=mt){je.data=[fe[0],fe[1],fe[2],K,Ue,Je],je.value=[];for(var Ge=new Date(je.data[0],je.data[1]-1,je.data[2],je.data[3],je.data[4],je.data[5]),tt=function(vt){var yt=this.tokens[vt],at=yt.toUpperCase(),Ke=null;at==="YYYY"?Ke=this.data[0]:at==="YYY"?Ke=this.data[0].substring(1,4):at==="YY"?Ke=this.data[0].substring(2,4):at==="Y"?Ke=this.data[0].substring(3,4):yt==="MON"?Ke=M.months[Ge.getMonth()].substr(0,3).toUpperCase():yt==="mon"?Ke=M.months[Ge.getMonth()].substr(0,3).toLowerCase():yt==="MONTH"?Ke=M.months[Ge.getMonth()].toUpperCase():yt==="month"?Ke=M.months[Ge.getMonth()].toLowerCase():at==="MMMMM"?Ke=M.months[Ge.getMonth()].substr(0,1):at==="MMMM"||yt==="Month"?Ke=M.months[Ge.getMonth()]:at==="MMM"||yt=="Mon"?Ke=M.months[Ge.getMonth()].substr(0,3):at==="MM"?Ke=l.two(this.data[1]):at==="M"?Ke=Ge.getMonth()+1:yt==="DAY"?Ke=M.weekdays[Ge.getDay()].toUpperCase():yt==="day"?Ke=M.weekdays[Ge.getDay()].toLowerCase():at==="DDDD"||yt=="Day"?Ke=M.weekdays[Ge.getDay()]:at==="DDD"?Ke=M.weekdays[Ge.getDay()].substr(0,3):at==="DD"?Ke=l.two(this.data[2]):at==="D"?Ke=parseInt(this.data[2]):at==="Q"?Ke=Math.floor((Ge.getMonth()+3)/3):at==="HH24"||at==="HH"?(Ke=this.data[3],Ke>12&&this.tokens.indexOf("am/pm")!==-1&&(Ke-=12),Ke=l.two(Ke)):at==="HH12"?this.data[3]>12?Ke=l.two(this.data[3]-12):Ke=l.two(this.data[3]):at==="H"?(Ke=this.data[3],Ke>12&&this.tokens.indexOf("am/pm")!==-1&&(Ke-=12,Ke=l.two(Ke))):at==="MI"?Ke=l.two(this.data[4]):at==="SS"?Ke=l.two(this.data[5]):at==="MS"?Ke=Ge.getMilliseconds():at==="AM/PM"?this.data[3]>=12?Ke="PM":Ke="AM":at==="WD"&&(Ke=M.weekdays[Ge.getDay()]),Ke===null?this.value[vt]=this.tokens[vt]:this.value[vt]=Ke},we=0;we<je.tokens.length;we++)tt.call(je,we);E=je.value.join("")}else E=""}return E},Z}var z=B();function q(){var j=function(T,p){if(T.calendar)return T.calendar.setOptions(p,!0);var r={type:"calendar"};r.options={},r.date=null,r.setOptions=function(X,Z){var E={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:M.monthsShort,monthsFull:M.months,weekdays:M.weekdays,textDone:a.translate("Done"),textReset:a.translate("Reset"),textUpdate:a.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var F in E)X&&X.hasOwnProperty(F)?r.options[F]=X[F]:(typeof r.options[F]>"u"||Z===!0)&&(r.options[F]=E[F]);if(r.options.resetButton==!1?O.style.display="none":O.style.display="",r.options.readonly?T.setAttribute("readonly","readonly"):T.removeAttribute("readonly"),r.options.placeholder?T.setAttribute("placeholder",r.options.placeholder):T.removeAttribute("placeholder"),l.isNumeric(r.options.value)&&r.options.value>0&&(r.options.value=j.numToDate(r.options.value),r.options.dataType="numeric"),O.innerHTML=r.options.textReset,U.innerHTML=r.options.textDone,We.innerHTML=r.options.textUpdate,r.options.format&&T.setAttribute("data-mask",r.options.format.toLowerCase()),!r.options.value&&r.options.today)var J=j.now();else var J=r.options.value;return J&&(r.options.value=null,r.setValue(J)),r},r.open=function(X){if(!H.classList.contains("jcalendar-focus")&&!H.classList.contains("jcalendar-inline")){if(j.current=r,I(r,!0),r.getDays(),r.options.type=="year-month-picker"&&r.getMonths(),r.options.time&&(re.value=r.date[3],ve.value=r.date[4]),H.classList.add("jcalendar-focus"),l.getWindowWidth()<800||r.options.fullscreen)H.classList.add("jcalendar-fullsize"),k.slideBottom(ae,1);else{H.classList.remove("jcalendar-fullsize");var Z=T.getBoundingClientRect(),E=ae.getBoundingClientRect();if(r.options.position)Q.style.position="fixed",window.innerHeight<Z.bottom+E.height?Q.style.top=Z.top-(E.height+2)+"px":Q.style.top=Z.top+Z.height+2+"px",Q.style.left=Z.left+"px";else{if(window.innerHeight<Z.bottom+E.height){var F=-1*(Z.height+E.height+2);F+Z.top<0&&(F=-1*(Z.top+Z.height)),Q.style.top=F+"px"}else Q.style.top="2px";if(window.innerWidth<Z.left+E.width){var F=window.innerWidth-(Z.left+E.width+20);Q.style.left=F+"px"}else Q.style.left="0px"}}typeof r.options.onopen=="function"&&r.options.onopen(T)}},r.close=function(X,Z){if(r.options.autoSelect!==!0&&typeof Z>"u"&&(Z=!1),H.classList.contains("jcalendar-focus")){if(Z!==!1){var E=H.querySelector(".jcalendar-selected");if(typeof Z=="string")var F=Z;else if(!E||E.classList.contains("jcalendar-disabled"))var F=r.options.value;else var F=r.getValue();r.setValue(F)}else{let J=r.options.value||"";r.options.value=null,r.setValue(J)}!X&&typeof r.options.onclose=="function"&&r.options.onclose(T),H.classList.remove("jcalendar-focus"),I(r,!1),j.current=null}return r.options.value},r.prev=function(){r.options.mode=="years"?(r.date[0]=r.date[0]-12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(r.date[1]<2?(r.date[0]=r.date[0]-1,r.date[1]=12):r.date[1]=r.date[1]-1,r.getDays())},r.next=function(){r.options.mode=="years"?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(r.date[1]>11?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},r.setToday=function(){var X=new Date().toISOString().substr(0,10);return r.setValue(X),X},r.setValue=function(X){X||(X=""+X);var Z=X,E=r.options.value;if(E!=Z){if(Z){r.setLabel(Z,r.options);var J=Z.split(" ");J[1]||(J[1]="00:00:00");var F=J[1].split(":"),J=J[0].split("-"),de=parseInt(J[0]),K=parseInt(J[1]),fe=parseInt(J[2]),Ee=parseInt(F[0]),te=parseInt(F[1]);r.date=[de,K,fe,Ee,te,0];var X=r.setLabel(Z,r.options),le=j.now(new Date(de,K-1,fe),!0);if(r.options.validRange){if(!r.options.validRange[0]||le>=r.options.validRange[0])var we=!0;else var we=!1;if(!r.options.validRange[1]||le<=r.options.validRange[1])var je=!0;else var je=!1;we&&je?(T.classList.remove("jcalendar_warning"),T.title=""):(T.classList.add("jcalendar_warning"),T.title=a.translate("Date outside the valid range"))}else T.classList.remove("jcalendar_warning"),T.title=""}else{r.date=null;var X="";T.classList.remove("jcalendar_warning"),T.title=""}r.options.value=Z,typeof r.options.onchange=="function"&&r.options.onchange(T,Z,E),T.value!=X&&(T.value=X,typeof T.oninput=="function"&&T.oninput({type:"input",target:T,value:T.value}))}r.date&&(r.getDays(),r.options.type=="year-month-picker"&&r.getMonths())},r.getValue=function(){return r.date?r.options.time?l.two(r.date[0])+"-"+l.two(r.date[1])+"-"+l.two(r.date[2])+" "+l.two(r.date[3])+":"+l.two(r.date[4])+":"+l.two(0):l.two(r.date[0])+"-"+l.two(r.date[1])+"-"+l.two(r.date[2])+" "+l.two(0)+":"+l.two(0)+":"+l.two(0):""},r.update=function(X,Z){if(!X.classList.contains("jcalendar-disabled")){var E=H.querySelector(".jcalendar-selected");E&&E.classList.remove("jcalendar-selected"),X.classList.add("jcalendar-selected"),X.classList.contains("jcalendar-set-month")?(r.date[1]=Z,r.date[2]=1):r.date[2]=X.innerText,r.options.time?(r.date[3]=re.value,r.date[4]=ve.value):r.close(null,!0)}ee()},r.reset=function(){r.setValue(""),r.date=null,r.close(!1,!1)},r.getDays=function(){r.options.mode="days";var Ee=new Date,X=r.date&&l.isNumeric(r.date[0])?r.date[0]:parseInt(Ee.getFullYear()),Z=r.date&&l.isNumeric(r.date[1])?r.date[1]:parseInt(Ee.getMonth())+1,E=r.date&&l.isNumeric(r.date[2])?r.date[2]:parseInt(Ee.getDate()),F=r.date&&l.isNumeric(r.date[3])?r.date[3]:parseInt(Ee.getHours()),J=r.date&&l.isNumeric(r.date[4])?r.date[4]:parseInt(Ee.getMinutes());r.date=[X,Z,E,F,J,0],he.innerHTML=X,pe.innerHTML=r.options.months[Z-1];var de=Ee.getMonth()==Z-1&&Ee.getFullYear()==X,K=Ee.getDate(),Ee=new Date(X,Z,0,0,0),fe=Ee.getDate(),Ee=new Date(X,Z-1,0,0,0),te=Ee.getDay()+1,Ye=r.options.startingDay||0;te=te-Ye,Te.innerHTML="";var le=document.createElement("tr");le.setAttribute("align","center"),Te.appendChild(le);for(var we=0;we<7;we++){var je=document.createElement("td");je.classList.add("jcalendar-weekday"),je.innerHTML=r.options.weekdays[Ye].substr(0,1),le.appendChild(je),Ye++,Ye>6&&(Ye=0)}for(var Ye=0,Ue=0,Je=0;Je<6;Je++){var le=document.createElement("tr");le.setAttribute("align","center"),le.style.height="34px";for(var we=0;we<7;we++){var je=document.createElement("td");if(je.classList.add("jcalendar-set-day"),Ye>=te&&Ye<te+fe){Ue++,je.innerHTML=Ue,Ue==E&&je.classList.add("jcalendar-selected"),de&&K==Ue&&(je.style.fontWeight="bold");var Ge=j.now(new Date(X,Z-1,Ue),!0);if(r.options.validRange){if(!r.options.validRange[0]||Ge>=r.options.validRange[0])var tt=!0;else var tt=!1;if(!r.options.validRange[1]||Ge<=r.options.validRange[1])var Ot=!0;else var Ot=!1;tt&&Ot||je.classList.add("jcalendar-disabled")}}le.appendChild(je),Ye++}Te.appendChild(le)}r.options.time?De.style.display="":De.style.display="none",ee()},r.getMonths=function(){r.options.mode="months";var X=r.options.months;r.options.value;var Z=new Date,E=parseInt(Z.getFullYear()),F=parseInt(Z.getMonth())+1,J=r.date&&l.isNumeric(r.date[0])?r.date[0]:E,de=r.date&&l.isNumeric(r.date[1])?r.date[1]:F;he.innerHTML=r.date[0],pe.innerHTML=X[de-1];var K=document.createElement("table");K.setAttribute("width","100%");for(var fe=null,Ee=0;Ee<12;Ee++){if(!(Ee%4)){var fe=document.createElement("tr");fe.setAttribute("align","center"),K.appendChild(fe)}var te=document.createElement("td");if(te.classList.add("jcalendar-set-month"),te.setAttribute("data-value",Ee+1),te.innerText=X[Ee],r.options.validRange){var le=J+"-"+l.two(Ee+1);if(!r.options.validRange[0]||le>=r.options.validRange[0].substr(0,7))var we=!0;else var we=!1;if(!r.options.validRange[1]||le<=r.options.validRange[1].substr(0,7))var je=!0;else var je=!1;we&&je||te.classList.add("jcalendar-disabled")}Ee+1==de&&te.classList.add("jcalendar-selected"),E==J&&Ee+1==F&&(te.style.fontWeight="bold"),fe.appendChild(te)}Te.innerHTML='<tr><td colspan="7"></td></tr>',Te.children[0].children[0].appendChild(K),ee()},r.getYears=function(){r.options.mode="years";for(var X=new Date,Z=X.getFullYear(),E=r.date&&l.isNumeric(r.date[0])?r.date[0]:parseInt(X.getFullYear()),F=[],J=0;J<25;J++)F[J]=parseInt(r.date[0])+(J-12);var de=document.createElement("table");de.setAttribute("width","100%");for(var J=0;J<25;J++){if(!(J%5)){var K=document.createElement("tr");K.setAttribute("align","center"),de.appendChild(K)}var fe=document.createElement("td");fe.classList.add("jcalendar-set-year"),fe.innerText=F[J],E==F[J]&&fe.classList.add("jcalendar-selected"),Z==F[J]&&(fe.style.fontWeight="bold"),K.appendChild(fe)}Te.innerHTML='<tr><td colspan="7"></td></tr>',Te.firstChild.firstChild.appendChild(de),ee()},r.setLabel=function(X,Z){return j.getDateString(X,Z)},r.fromFormatted=function(X,Z){return j.extractDateFromString(X,Z)};var V=function(X){var Z=l.findElement(X.target,"jcalendar-container");if(Z){var E=X.target.className;if(E=="jcalendar-prev")r.prev();else if(E=="jcalendar-next")r.next();else if(E=="jcalendar-month")r.getMonths();else if(E=="jcalendar-year")r.getYears();else if(E=="jcalendar-set-year")r.date[0]=X.target.innerText,r.options.type=="year-month-picker"?r.getMonths():r.getDays();else if(X.target.classList.contains("jcalendar-set-month")){var F=parseInt(X.target.getAttribute("data-value"));r.options.type=="year-month-picker"?r.update(X.target,F):(r.date[1]=F,r.getDays())}else E=="jcalendar-confirm"||E=="jcalendar-update"||E=="jcalendar-close"?r.close(null,!0):E=="jcalendar-backdrop"?r.close(!1,!1):E=="jcalendar-reset"?r.reset():X.target.classList.contains("jcalendar-set-day")&&X.target.innerText&&r.update(X.target)}else r.close(!1,!1)},ne=function(X){if(X.target.value&&X.target.value.length>3){var Z=j.extractDateFromString(X.target.value,r.options.format);Z&&r.setValue(Z)}},ee=function(){var X=H.querySelector(".jcalendar-selected");X&&X.classList.contains("jcalendar-disabled")?(We.setAttribute("disabled","disabled"),re.setAttribute("disabled","disabled"),ve.setAttribute("disabled","disabled")):(We.removeAttribute("disabled"),re.removeAttribute("disabled"),ve.removeAttribute("disabled")),typeof r.options.onupdate=="function"&&r.options.onupdate(T,r.getValue())},H=null,O=null,U=null,Q=null,ae=null,he=null,pe=null,be=null,Te=null,Oe=null,De=null,qe=null,We=null,re=null,ve=null,Le=function(){T.tagName=="INPUT"&&T.value&&(p.value=T.value),O=document.createElement("div"),O.className="jcalendar-reset",U=document.createElement("div"),U.className="jcalendar-confirm",Oe=document.createElement("div"),Oe.className="jcalendar-controls",Oe.style.borderBottom="1px solid #ddd",Oe.appendChild(O),Oe.appendChild(U),Q=document.createElement("div"),Q.className="jcalendar-container",ae=document.createElement("div"),ae.className="jcalendar-content",Q.appendChild(ae),T.tagName=="DIV"?(H=T,H.classList.add("jcalendar-inline")):(ae.appendChild(Oe),H=document.createElement("div"),H.className="jcalendar"),H.classList.add("jcalendar-container"),H.appendChild(Q);var X=document.createElement("div");X.className="jcalendar-table",ae.appendChild(X);var Z=document.createElement("td");Z.setAttribute("colspan","2"),Z.className="jcalendar-prev",he=document.createElement("span"),he.className="jcalendar-year",pe=document.createElement("span"),pe.className="jcalendar-month";var E=document.createElement("td");E.className="jcalendar-header",E.setAttribute("colspan","3"),E.appendChild(pe),E.appendChild(he);var F=document.createElement("td");F.setAttribute("colspan","2"),F.className="jcalendar-next";var J=document.createElement("thead"),de=document.createElement("tr");de.appendChild(Z),de.appendChild(E),de.appendChild(F),J.appendChild(de),be=document.createElement("table"),Te=document.createElement("tbody"),be.setAttribute("cellpadding","0"),be.setAttribute("cellspacing","0"),be.appendChild(J),be.appendChild(Te),X.appendChild(be),re=document.createElement("select"),re.className="jcalendar-select",re.onchange=function(){r.date[3]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(T,r.getValue())};for(var K=0;K<24;K++){var fe=document.createElement("option");fe.value=K,fe.innerHTML=l.two(K),re.appendChild(fe)}ve=document.createElement("select"),ve.className="jcalendar-select",ve.onchange=function(){r.date[4]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(T,r.getValue())};for(var K=0;K<60;K++){var fe=document.createElement("option");fe.value=K,fe.innerHTML=l.two(K),ve.appendChild(fe)}var Ee=document.createElement("div");Ee.className="jcalendar-controls",De=document.createElement("div"),De.className="jcalendar-time",De.style.maxWidth="140px",De.appendChild(re),De.appendChild(ve),We=document.createElement("button"),We.setAttribute("type","button"),We.className="jcalendar-update",qe=document.createElement("div"),qe.style.flexGrow="10",qe.appendChild(We),Ee.appendChild(De),T.tagName=="INPUT"&&Ee.appendChild(qe),ae.appendChild(Ee);var te=document.createElement("div");te.className="jcalendar-backdrop",H.appendChild(te),T.addEventListener("keyup",ne),H.addEventListener("swipeleft",function(le){k.slideLeft(be,0,function(){r.next(),k.slideRight(be,1)}),le.preventDefault(),le.stopPropagation()}),H.addEventListener("swiperight",function(le){k.slideRight(be,0,function(){r.prev(),k.slideLeft(be,1)}),le.preventDefault(),le.stopPropagation()}),"ontouchend"in document.documentElement?(H.addEventListener("touchend",V),T.addEventListener("touchend",r.open)):(H.addEventListener("mouseup",V),T.addEventListener("mouseup",r.open)),j.hasEvents||(j.hasEvents=!0,document.addEventListener("keydown",j.keydown)),r.setOptions(p),T.tagName=="INPUT"?(T.parentNode.insertBefore(H,T.nextSibling),T.setAttribute("autocomplete","off"),T.classList.add("jcalendar-input"),T.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(re.value=r.date[3],ve.value=r.date[4])),r.options.opened==!0&&r.open(),r.options.controls==!1&&Q.classList.add("jcalendar-hide-controls"),T.change=r.setValue,T.val=function(le){if(le===void 0)return r.getValue();r.setValue(le)},T.calendar=H.calendar=r};return Le(),r};return j.keydown=function(T){var p=null;(p=j.current)&&(T.which==13?p.close(!1,!0):T.which==27&&p.close(!1,!1))},j.prettify=function(T,p){if(!p)var p={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};T.indexOf("GMT")===-1&&T.indexOf("Z")===-1&&(T+=" GMT");var r=new Date,V=new Date(T),ne=parseInt((r-V)/1e3/60);if(String.prototype.format=function(H){return this.replace("{0}",H)},ne==0)var ee=p.justNow;else if(ne<90)var ee=p.xMinutesAgo.format(ne);else if(ne<1440)var ee=p.xHoursAgo.format(Math.round(ne/60));else if(ne<20160)var ee=p.xDaysAgo.format(Math.round(ne/1440));else if(ne<43200)var ee=p.xWeeksAgo.format(Math.round(ne/10080));else if(ne<1036800)var ee=p.xMonthsAgo.format(Math.round(ne/43200));else var ee=p.xYearsAgo.format(Math.round(ne/525600));return ee},j.prettifyAll=function(){for(var T=document.querySelectorAll(".prettydate"),p=0;p<T.length;p++)T[p].getAttribute("data-date")?T[p].innerHTML=j.prettify(T[p].getAttribute("data-date")):T[p].innerHTML&&(T[p].setAttribute("title",T[p].innerHTML),T[p].setAttribute("data-date",T[p].innerHTML),T[p].innerHTML=j.prettify(T[p].innerHTML))},j.now=M.now,j.toArray=M.toArray,j.dateToNum=M.dateToNum,j.numToDate=M.numToDate,j.weekdays=M.weekdays,j.months=M.months,j.weekdaysShort=M.weekdaysShort,j.monthsShort=M.monthsShort,j.extractDateFromString=z.extractDateFromString,j.getDateString=z.getDateString,j}var ce=q();function me(){var j={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},T=function(p){return j[p]?j[p]:j.material};return T.get=function(p){return j[p]?j[p]:j},T.set=function(p,r){j[p]=r},T}var G=me();function se(j,T){var p={};p.options={};var r={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var V in r)T&&T.hasOwnProperty(V)?p.options[V]=T[V]:p.options[V]=r[V];j.classList.add("jtabs");var ne=null,ee=null,H=null;const O=function(pe){p.options.animation&&setTimeout(function(){let be=p.headers.children[pe].getBoundingClientRect();p.options.palette==="modern"?(H.style.width=be.width-4+"px",H.style.left=p.headers.children[pe].offsetLeft+2+"px"):(H.style.width=be.width+"px",H.style.left=p.headers.children[pe].offsetLeft+"px"),p.options.position==="bottom"?H.style.top="0px":H.style.bottom="0px"},50)};var U=function(pe){typeof p.headers.scrollTo=="function"?p.headers.scrollTo({left:pe,behavior:"smooth"}):p.headers.scrollLeft=pe,pe<=1?ne.classList.add("disabled"):ne.classList.remove("disabled"),pe>=p.headers.scrollWidth-p.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),p.headers.scrollWidth<=p.headers.offsetWidth?(ne.style.display="none",ee.style.display="none"):(ne.style.display="",ee.style.display="")};if(p.setBorder=O,p.open=function(pe){if(Array.from(p.content.children),!!p.content.children[pe]){for(var be=null,Te=0;Te<p.headers.children.length;Te++)p.headers.children[Te].classList.contains("jtabs-selected")&&(be=Te),p.headers.children[Te].classList.remove("jtabs-selected"),p.headers.children[Te].removeAttribute("aria-selected"),p.content.children[Te]&&p.content.children[Te].classList.remove("jtabs-selected");if(p.headers.children[pe].classList.add("jtabs-selected"),p.headers.children[pe].setAttribute("aria-selected","true"),p.content.children[pe]&&p.content.children[pe].classList.add("jtabs-selected"),be!=pe&&typeof p.options.onchange=="function"&&p.content.children[pe]&&p.options.onchange(j,p,pe,p.headers.children[pe],p.content.children[pe]),p.options.hideHeaders==!0&&p.headers.children.length<3&&p.options.allowCreate==!1)p.headers.parentNode.style.display="none";else{p.headers.parentNode.style.display="";var Oe=p.headers.children[pe].offsetLeft,De=Oe+p.headers.children[pe].offsetWidth,qe=p.headers.scrollLeft,We=qe+p.headers.offsetWidth;qe<=Oe&&We>=De||U(Oe-1),O(pe)}}},p.selectIndex=function(pe){var be=Array.prototype.indexOf.call(p.headers.children,pe);return be>=0&&p.open(be),be},p.rename=function(pe,be){be||(be=prompt("New title",p.headers.children[pe].innerText)),p.headers.children[pe].innerText=be,O(p.getActive())},p.create=function(pe,be){if(typeof p.options.onbeforecreate=="function"){var Te=p.options.onbeforecreate(j,pe);if(Te===!1)return!1;pe=Te}var Oe=p.appendElement(pe);return typeof p.options.oncreate=="function"&&p.options.oncreate(j,Oe),O(p.getActive()),Oe},p.remove=function(pe){return p.deleteElement(pe)},p.nextNumber=function(){for(var pe=0,be=0;be<p.headers.children.length;be++){var Te=p.headers.children[be].innerText.match(/[0-9].*/);Te>pe&&(pe=parseInt(Te))}return pe?pe++:pe=1,pe},p.deleteElement=function(pe){let be=p.getActive();if(p.headers.children[pe])p.headers.removeChild(p.headers.children[pe]),p.content.removeChild(p.content.children[pe]);else return!1;if(be===pe)p.open(0);else{let Te=p.getActive()||0;O(Te)}typeof p.options.ondelete=="function"&&p.options.ondelete(j,pe)},p.appendElement=function(pe,be,Te,Oe){if(!pe)var pe=prompt("Title?","");if(pe){let We=l.guid(),re=l.guid();var De=document.createElement("div");De.setAttribute("id",re),De.setAttribute("role","tabpanel"),De.setAttribute("aria-labelledby",We);var qe=document.createElement("div");if(qe.setAttribute("id",We),qe.setAttribute("role","tab"),qe.setAttribute("aria-controls",re),qe.textContent=pe,qe.content=De,typeof Oe>"u")p.content.appendChild(De),p.headers.insertBefore(qe,p.headers.lastChild);else{let ve=p.content.children[Oe];ve?p.content.insertBefore(De,ve):p.content.appendChild(De),ve=p.headers.children[Oe]||p.headers.lastChild,p.headers.insertBefore(qe,ve)}return p.options.allowChangePosition&&qe.setAttribute("draggable","true"),Te!==!1&&p.selectIndex(qe),typeof be=="function"&&be(De,qe),De}},p.getActive=function(){for(var pe=0;pe<p.headers.children.length;pe++)if(p.headers.children[pe].classList.contains("jtabs-selected"))return pe;return!1},p.updateContent=function(pe,be){if(typeof be!="string")var Te=be;else{var Te=document.createElement("div");Te.innerHTML=be}p.content.children[pe].classList.contains("jtabs-selected")&&be.classList.add("jtabs-selected"),p.content.replaceChild(be,p.content.children[pe]),O()},p.updatePosition=function(pe,be,Te,Oe){if(pe>be?p.content.insertBefore(p.content.children[pe],p.content.children[be]):p.content.insertBefore(p.content.children[pe],p.content.children[be].nextSibling),Oe!==!1)p.open(be);else{const De=p.getActive();be<De&&p.setBorder(De)}!Te&&typeof p.options.onchangeposition=="function"&&p.options.onchangeposition(p.headers,pe,be)},p.move=function(pe,be,Te,Oe){pe>be?p.headers.insertBefore(p.headers.children[pe],p.headers.children[be]):p.headers.insertBefore(p.headers.children[pe],p.headers.children[be].nextSibling),p.updatePosition(pe,be,Te,Oe)},p.setBorder=O,p.init=function(){j.textContent="",p.headers=document.createElement("div"),p.content=document.createElement("div"),p.headers.classList.add("jtabs-headers"),p.headers.setAttribute("role","tablist"),p.content.classList.add("jtabs-content"),p.content.setAttribute("role","region"),p.content.setAttribute("aria-label","Tab Panels"),p.options.palette?j.classList.add("jtabs-modern"):j.classList.remove("jtabs-modern"),p.options.padding&&(p.content.style.padding=parseInt(p.options.padding)+"px");var pe=document.createElement("div");pe.className="jtabs-headers-container",pe.appendChild(p.headers),p.options.maxWidth&&(pe.style.maxWidth=parseInt(p.options.maxWidth)+"px");var be=document.createElement("div");if(be.className="jtabs-controls",be.setAttribute("draggable","false"),pe.appendChild(be),p.options.position=="bottom"?(j.appendChild(p.content),j.appendChild(pe)):(j.appendChild(pe),j.appendChild(p.content)),p.options.allowCreate==!0){var Te=document.createElement("div");Te.className="jtabs-add",Te.onclick=function(){p.create()},be.appendChild(Te)}ne=document.createElement("div"),ne.className="jtabs-prev",ne.onclick=function(){U(p.headers.scrollLeft-p.headers.offsetWidth)},be.appendChild(ne),ee=document.createElement("div"),ee.className="jtabs-next",ee.onclick=function(){U(p.headers.scrollLeft+p.headers.offsetWidth)},be.appendChild(ee);for(var Oe=0;Oe<p.options.data.length;Oe++){if(p.options.data[Oe].titleElement)var De=p.options.data[Oe].titleElement;else var De=document.createElement("div");if(p.options.data[Oe].icon){var qe=document.createElement("div"),We=document.createElement("i");We.classList.add("material-icons"),We.textContent=p.options.data[Oe].icon,qe.appendChild(We),De.appendChild(qe)}if(p.options.data[Oe].title){var re=document.createTextNode(p.options.data[Oe].title);De.appendChild(re)}if(p.options.data[Oe].width&&(De.style.width=p.options.data[Oe].width),p.options.data[Oe].contentElement)var ve=p.options.data[Oe].contentElement;else{var ve=document.createElement("div");ve.innerHTML=p.options.data[Oe].content}p.headers.appendChild(De),p.content.appendChild(ve)}H=document.createElement("div"),H.className="jtabs-border",p.headers.appendChild(H),p.options.animation&&j.classList.add("jtabs-animation"),p.headers.addEventListener("click",function(Le){if(Le.target.parentNode.classList.contains("jtabs-headers"))var X=Le.target;else if(Le.target.tagName=="I")var X=Le.target.parentNode.parentNode;else var X=Le.target.parentNode;var Z=p.selectIndex(X);typeof p.options.onclick=="function"&&p.options.onclick(j,p,Z,p.headers.children[Z],p.content.children[Z])}),p.headers.addEventListener("contextmenu",function(Le){p.selectIndex(Le.target)}),p.headers.children.length&&p.open(0),U(0),p.options.allowChangePosition==!0&&f(p.headers,{direction:1,ondrop:function(Le,X,Z){p.updatePosition(X,Z)}}),typeof p.options.onload=="function"&&p.options.onload(j,p)},j.children[0]&&j.children[0].children.length)for(var Q=0;Q<j.children[0].children.length;Q++){var ae=p.options.data&&p.options.data[Q]?p.options.data[Q]:{};j.children[1]&&j.children[1].children[Q]?(ae.titleElement=j.children[0].children[Q],ae.contentElement=j.children[1].children[Q]):ae.contentElement=j.children[0].children[Q],p.options.data[Q]=ae}var he=!1;if(p.options.data)for(var Q=0;Q<p.options.data.length;Q++)p.options.data[Q].url&&(L({url:p.options.data[Q].url,type:"GET",dataType:"text/html",index:Q,success:function(be){p.options.data[this.index].content=be},complete:function(){p.init()}}),he=!0);return he||p.init(),j.tabs=p,p}function ge(j,T){if(j.color)return j.color.setOptions(T,!0);var p={type:"color"};p.options={};var r=null,V=null,ne=null,ee=null,H=null,O=null,U=null;p.setOptions=function(E,F){var J={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};E||(E={}),E&&!E.palette&&(E.palette=G());for(var de in J)E&&E.hasOwnProperty(de)?p.options[de]=E[de]:(typeof p.options[de]>"u"||F===!0)&&(p.options[de]=J[de]);return ee&&(ee.innerHTML=p.options.resetLabel),H&&(H.innerHTML=p.options.doneLabel),p.options.palette&&U&&U.updateContent(0,be()),typeof p.options.value=="string"&&(j.value=p.options.value,j.tagName==="INPUT"&&(j.style.color=j.value,j.style.backgroundColor=j.value)),p.options.placeholder?j.setAttribute("placeholder",p.options.placeholder):j.getAttribute("placeholder")&&j.removeAttribute("placeholder"),p},p.select=function(E){var F=r.querySelector(".jcolor-selected");F&&F.classList.remove("jcolor-selected"),p.values[E]&&p.values[E].classList.add("jcolor-selected"),p.options.value=E},p.open=function(){if(!r.classList.contains("jcolor-focus")){I(p,!0),r.classList.add("jcolor-focus"),p.options.value&&p.select(p.options.value),ne.style.marginTop="",ne.style.marginLeft="";var E=ne.getBoundingClientRect(),F=l.getWindowWidth(),J=l.getWindowHeight();if(F<800||p.options.fullscreen==!0?(ne.classList.add("jcolor-fullscreen"),k.slideBottom(ne,1),V.style.display="block"):(ne.classList.contains("jcolor-fullscreen")&&(ne.classList.remove("jcolor-fullscreen"),V.style.display=""),p.options.position?ne.style.position="fixed":ne.style.position="",E.left+E.width>F&&(ne.style.marginLeft=-1*(E.left+E.width-(F-20))+"px"),E.top+E.height>J&&(ne.style.marginTop=-1*(E.top+E.height-(J-20))+"px")),typeof p.options.onopen=="function"&&p.options.onopen(j,p),U.setBorder(U.getActive()),p.options.value){var de=pe(p.options.value);ve.forEach(function(K,fe){K.value=de[fe],K.dispatchEvent(new Event("input"))})}}},p.close=function(E){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),V.style.display="",!E&&typeof p.options.onclose=="function"&&p.options.onclose(j,p),I(p,!1)),p.options.value},p.setValue=function(E){E||(E=""),E!=p.options.value&&(p.options.value=E,re=E,p.select(E),typeof p.options.onchange=="function"&&p.options.onchange(j,E,p),j.value!=p.options.value&&(j.value=p.options.value,j.tagName==="INPUT"&&(j.style.color=j.value,j.style.backgroundColor=j.value),typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value})),p.options.closeOnChange==!0&&p.close())},p.getValue=function(){return p.options.value};var Q=function(E){var F=E.toString(16);return F.length===1?"0"+F:F},ae=function(E,F,J){return"#"+Q(E)+Q(F)+Q(J)},he=function(E){return parseInt("0x"+E)},pe=function(E){return[he(E.substr(1,2)),he(E.substr(3,2)),he(E.substr(5,2))]},be=function(){var E=document.createElement("div");E.className="jcolor-grid",p.values=[];var F=document.createElement("table");F.setAttribute("cellpadding","7"),F.setAttribute("cellspacing","0");for(var J=0;J<p.options.palette.length;J++){for(var de=document.createElement("tr"),K=0;K<p.options.palette[J].length;K++){var fe=document.createElement("td"),Ee=p.options.palette[J][K];Ee.length<7&&Ee.substr(0,1)!=="#"&&(Ee="#"+Ee),fe.style.backgroundColor=Ee,fe.setAttribute("data-value",Ee),fe.innerHTML="",de.appendChild(fe),p.options.value==Ee&&fe.classList.add("jcolor-selected"),p.values[Ee]=fe}F.appendChild(de)}return E.appendChild(F),E},Te=document.createElement("canvas");Te.width=200,Te.height=160;var Oe=Te.getContext("2d"),De=function(){var E=O.firstChild.getBoundingClientRect();Te.width=E.width-14,qe()},qe=function(){var E=Oe.createLinearGradient(0,0,Te.width,0);E.addColorStop(0,"rgb(255,0,0)"),E.addColorStop(.15,"rgb(255,0,255)"),E.addColorStop(.33,"rgb(0,0,255)"),E.addColorStop(.49,"rgb(0,255,255)"),E.addColorStop(.67,"rgb(0,255,0)"),E.addColorStop(.84,"rgb(255,255,0)"),E.addColorStop(1,"rgb(255,0,0)"),Oe.fillStyle=E,Oe.fillRect(0,0,Te.width,Te.height),E=Oe.createLinearGradient(0,0,0,Te.height),E.addColorStop(0,"rgba(255,255,255,1)"),E.addColorStop(.5,"rgba(255,255,255,0)"),E.addColorStop(.5,"rgba(0,0,0,0)"),E.addColorStop(1,"rgba(0,0,0,1)"),Oe.fillStyle=E,Oe.fillRect(0,0,Te.width,Te.height)},We=function(){var E=document.createElement("div");E.className="jcolor-hsl";var F=document.createElement("div");F.className="jcolor-point";var J=document.createElement("div");J.appendChild(Te),J.appendChild(F),E.appendChild(J);var de=function(K,fe,Ee){if(K===1){var te=E.getBoundingClientRect(),le=fe-te.left,we=Ee-te.top;le<0&&(le=0),we<0&&(we=0),le>te.width&&(le=te.width),we>te.height&&(we=te.height),F.style.left=le+"px",F.style.top=we+"px";var je=Oe.getImageData(le,we,1,1).data;re=ae(je[0],je[1],je[2])}};return E.addEventListener("mousedown",function(K){de(K.buttons,K.clientX,K.clientY)}),E.addEventListener("mousemove",function(K){de(K.buttons,K.clientX,K.clientY)}),E.addEventListener("touchmove",function(K){de(1,K.changedTouches[0].clientX,K.changedTouches[0].clientY)}),E},re="",ve=[],Le=function(){if(re!=="")for(var E=0;E<ve.length;E++){var F=pe(re);F[E]=0;var J="linear-gradient(90deg, rgb(";J+=F.join(", "),J+="), rgb(",F[E]=255,J+=F.join(", "),J+="))",ve[E].style.backgroundImage=J}},X=function(){var E=document.createElement("div");E.className="jcolor-sliders";var F=document.createElement("div"),J=function(Ee){var te=document.createElement("div");te.className="jcolor-sliders-input-container";var le=document.createElement("label");le.innerText=Ee;var we=document.createElement("div");we.className="jcolor-sliders-input-subcontainer";var je=document.createElement("input");je.type="range",je.min=0,je.max=255,je.value=0,je.setAttribute("aria-label","Color value"),je.setAttribute("aria-valuemin","0"),je.setAttribute("aria-valuemax","255"),je.setAttribute("aria-valuenow","0"),te.appendChild(le),we.appendChild(je);var Ye=document.createElement("div");return Ye.innerText=je.value,je.addEventListener("input",function(){Ye.innerText=je.value}),we.appendChild(Ye),te.appendChild(we),F.appendChild(te),je};ve=[J("Red"),J("Green"),J("Blue")],E.appendChild(F);var de=document.createElement("div");de.className="jcolor-sliders-final-color";var K=document.createElement("div");K.style.visibility="hidden",K.innerText="a",de.appendChild(K);var fe=function(){var Ee=ae(parseInt(ve[0].value),parseInt(ve[1].value),parseInt(ve[2].value));K.innerText=Ee,K.style.color=Ee,K.style.removeProperty("visibility"),re=Ee};return ve.forEach(function(Ee){Ee.addEventListener("input",function(){fe(),Le()})}),E.appendChild(de),E},Z=function(){p.setOptions(T),j.tagName=="INPUT"&&(j.classList.add("jcolor-input"),j.readOnly=!0),r=document.createElement("div"),r.className="jcolor",V=document.createElement("div"),V.className="jcolor-backdrop",r.appendChild(V),ne=document.createElement("div"),ne.className="jcolor-content";var E=document.createElement("div");E.className="jcolor-controls",ne.appendChild(E),ee=document.createElement("div"),ee.className="jcolor-reset",ee.innerHTML=p.options.resetLabel,E.appendChild(ee),H=document.createElement("div"),H.className="jcolor-close",H.innerHTML=p.options.doneLabel,E.appendChild(H),O=document.createElement("div"),ne.appendChild(O),U=se(O,{animation:!0,data:[{title:"Grid",contentElement:be()},{title:"Spectrum",contentElement:We()},{title:"Sliders",contentElement:X()}],onchange:function(F,J,de){if(de===1)De();else{var K=re!==""?re:p.getValue();if(de===2&&K){var fe=pe(K);ve.forEach(function(Ee,te){Ee.value=fe[te],Ee.dispatchEvent(new Event("input"))})}}},palette:"modern"}),r.appendChild(ne),j.tagName=="INPUT"?j.parentNode.insertBefore(r,j.nextSibling):j.appendChild(r),r.addEventListener("click",function(F){if(F.target.tagName=="TD"){var J=F.target.getAttribute("data-value");J&&p.setValue(J)}else F.target.classList.contains("jcolor-reset")?(p.setValue(""),p.close()):F.target.classList.contains("jcolor-close")?(U.getActive()>0&&p.setValue(re),p.close()):F.target.classList.contains("jcolor-backdrop")?p.close():p.open()}),j.addEventListener("mouseup",function(F){p.open()}),window.addEventListener("resize",function(){r.classList.contains("jcolor-focus")&&U.getActive()==1&&De()}),p.options.opened==!0&&p.open(),j.change=p.setValue,j.val=function(F){if(F===void 0)return p.getValue();p.setValue(F)},j.color=p,r.color=p};return p.toHex=function(E){var F=function(J){return("0"+parseInt(J).toString(16)).slice(-2)};if(E)return/^#[0-9A-F]{6}$/i.test(E)?E:(E=E.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),E&&E.length?"#"+F(E[1])+F(E[2])+F(E[3]):"")},Z(),p}function ue(){var j=function(T,p){var r={type:"contextmenu"};r.options={};var V={items:null,onclick:null};for(var ne in V)p&&p.hasOwnProperty(ne)?r.options[ne]=p[ne]:r.options[ne]=V[ne];T.classList.add("jcontextmenu"),r.open=function(O,U){if(U&&(r.options.items=U,r.create(U)),j.current&&j.current.close(),I(r,!0),T.classList.add("jcontextmenu-focus"),j.current=r,r.options.items&&r.options.items.length>0||T.children.length){if(O.target)if(O.changedTouches&&O.changedTouches[0])Q=O.changedTouches[0].clientX,ae=O.changedTouches[0].clientY;else var Q=O.clientX,ae=O.clientY;else var Q=O.x,ae=O.y;var he=T.getBoundingClientRect();if(window.innerHeight<ae+he.height){var pe=ae-he.height;pe<0&&(pe=0),T.style.top=pe+"px"}else T.style.top=ae+"px";window.innerWidth<Q+he.width?Q-he.width>0?T.style.left=Q-he.width+"px":T.style.left="10px":T.style.left=Q+"px"}},r.isOpened=function(){return!!T.classList.contains("jcontextmenu-focus")},r.close=function(){T.classList.contains("jcontextmenu-focus")&&T.classList.remove("jcontextmenu-focus"),I(r,!1)},r.create=function(O){T.innerHTML="";var U=ee();T.appendChild(U);for(var Q=0;Q<O.length;Q++){var ae=H(O[Q]);T.appendChild(ae)}};function ee(){var O=document.createElement("div");O.classList.add("header"),O.addEventListener("click",function(ae){ae.preventDefault(),ae.stopPropagation()});var U=document.createElement("a");U.classList.add("title"),U.innerHTML=a.translate("Menu"),O.appendChild(U);var Q=document.createElement("a");return Q.classList.add("close"),Q.innerHTML=a.translate("close"),Q.addEventListener("click",function(ae){r.close()}),O.appendChild(Q),O}function H(O){if(O.type&&(O.type=="line"||O.type=="divisor"))var U=document.createElement("hr");else{var U=document.createElement("div"),Q=document.createElement("a");if(Q.innerHTML=O.title,O.tooltip&&U.setAttribute("title",O.tooltip),O.icon&&U.setAttribute("data-icon",O.icon),O.id&&(U.id=O.id),O.disabled?U.className="jcontextmenu-disabled":O.onclick&&(U.method=O.onclick,U.addEventListener("mousedown",function(qe){qe.preventDefault()}),U.addEventListener("mouseup",function(qe){this.method(this,qe)})),U.appendChild(Q),O.submenu){var ae=document.createElement("span");ae.innerHTML="&#9658;",U.appendChild(ae),U.classList.add("jcontexthassubmenu");var he=document.createElement("div");he.classList.add("jcontextmenu"),he.setAttribute("tabindex","900");for(var pe=O.submenu,be=0;be<pe.length;be++){var Te=H(pe[be]);he.appendChild(Te)}U.appendChild(he),U.addEventListener("mouseenter",function(){he.style.left="",he.style.right="",he.style.minWidth=U.offsetWidth+"px",he.style.display="block",he.style.opacity="0",he.style.pointerEvents="none";var qe=U.getBoundingClientRect(),We=he.getBoundingClientRect(),re=window.innerWidth||document.documentElement.clientWidth,ve=qe.right+We.width,Le=qe.left-We.width;ve>re&&Le>=0?(he.style.left="auto",he.style.right="99%"):ve>re&&Le<0?(he.style.left="32px",he.style.right="auto",he.style.top="100%"):(he.style.left="99%",he.style.right="auto"),he.style.opacity="",he.style.pointerEvents="",he.style.display=""}),U.addEventListener("mouseleave",function(){he.style.left="",he.style.right="",he.style.minWidth=""})}else if(O.shortcut){var Oe=document.createElement("span");Oe.innerHTML=O.shortcut,U.appendChild(Oe)}}return U}return typeof r.options.onclick=="function"&&T.addEventListener("click",function(O){r.options.onclick(r,O)}),r.options.items&&r.create(r.options.items),window.addEventListener("mousewheel",function(){r.close()}),T.contextmenu=r,r};return j}var oe=ue();function xe(){var j=function(T,p){if(T.dropdown)return T.dropdown.setOptions(p,!0);var r={type:"dropdown"};r.options={};var V=function(X,Z){X&&X.length&&(r.options.sortResults!==!1&&(typeof r.options.sortResults=="function"?X.sort(r.options.sortResults):X.sort(ne)),r.setData(X)),typeof r.options.onload=="function"&&r.options.onload(T,r,X,Z),Z&&H(Z),Z==null&&(r.options.value=""),T.value=r.options.value,r.options.opened==!0&&r.open()},ne=function(X,Z){var E,F;return typeof X=="string"?E=X:X.text?E=X.text:X.name&&(E=X.name),typeof Z=="string"?F=Z:Z.text?F=Z.text:Z.name&&(F=Z.name),typeof E=="string"||typeof F=="string"?(typeof E!="string"&&(E=""+E),typeof F!="string"&&(F=""+F),E.localeCompare(F)):E-F},ee=function(){r.value={};for(var X=0;X<r.items.length;X++)r.items[X].selected==!0&&(r.items[X].element&&r.items[X].element.classList.remove("jdropdown-selected"),r.items[X].selected=null);r.options.value="",T.value=""},H=function(X){if(ee(),X!==null)if(!X)typeof r.value[""]<"u"&&(r.value[""]="");else{Array.isArray(X)||(X=(""+X).split(";"));for(var Z=0;Z<X.length;Z++)r.value[X[Z]]=""}for(var Z=0;Z<r.items.length;Z++)typeof r.value[O(Z)]<"u"&&(r.items[Z].element&&r.items[Z].element.classList.add("jdropdown-selected"),r.items[Z].selected=!0,r.value[O(Z)]=U(Z));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},O=function(X,Z){if(r.options.format)var E="id";else var E="value";return r.items[X]?r.items[X].data[E]:""},U=function(X,Z){if(r.options.format)var E="name";else var E="text";return r.items[X]?r.items[X].data[E]:""},Q=function(){return Object.keys(r.value)},ae=function(){for(var X=[],Z=Object.keys(r.value),E=0;E<Z.length;E++)X.push(r.value[Z[E]]);return X};r.setOptions=function(X,Z){X||(X={});var E={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var F in E)X&&X.hasOwnProperty(F)?r.options[F]=X[F]:(typeof r.options[F]>"u"||Z===!0)&&(r.options[F]=E[F]);return(r.options.remoteSearch==!0||r.options.type==="searchbar")&&(r.options.autocomplete=!0),r.options.newOptions==!0?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),r.options.autocomplete==!0?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),T.classList.remove("jdropdown-searchbar"),T.classList.remove("jdropdown-picker"),T.classList.remove("jdropdown-list"),r.options.type=="searchbar"?T.classList.add("jdropdown-searchbar"):r.options.type=="list"?T.classList.add("jdropdown-list"):r.options.type=="picker"?T.classList.add("jdropdown-picker"):l.getWindowWidth()<800?r.options.autocomplete?(T.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(T.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(T.style.width=r.options.width,T.style.minWidth=r.options.width):(T.style.removeProperty("width"),T.style.removeProperty("min-width")),T.classList.add("jdropdown-default"),r.options.type="default"),r.options.type=="searchbar"?he.appendChild(Te):pe.insertBefore(Te,pe.firstChild),r.options.url&&!X.data?L({url:r.options.url,method:"GET",dataType:"json",success:function(J){J&&V(J,r.options.value)}}):V(r.options.data,r.options.value),r};var he=null,pe=null,be=null,Te=null,Oe=null,De=null,qe=null,We=function(){if(p||(p={}),T.tagName=="SELECT"){var X=j.extractFromDom(T,p);T=X.el,p=X.options}!p.placeholder&&T.getAttribute("placeholder")&&(p.placeholder=T.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,T.classList.add("jdropdown"),he=document.createElement("div"),he.className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header jss_object",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){typeof r.options.onfocus=="function"&&r.options.onfocus(T)},r.header.onblur=function(){typeof r.options.onblur=="function"&&r.options.onblur(T)},r.header.onkeyup=function(Z){r.options.autocomplete==!0&&!qe?(r.search!=r.header.value.trim()&&(qe=setTimeout(function(){r.find(r.header.value.trim()),qe=null},400)),T.classList.contains("jdropdown-focus")||r.open()):r.options.autocomplete||r.next(Z.key)},j.hasEvents||(j.hasEvents=!0,document.addEventListener("keydown",j.keydown)),pe=document.createElement("div"),pe.className="jdropdown-container",be=document.createElement("div"),be.className="jdropdown-content",Te=document.createElement("div"),Te.className="jdropdown-close",Te.textContent="Done",Oe=document.createElement("div"),Oe.className="jdropdown-reset",Oe.textContent="x",Oe.onclick=function(){r.reset(),r.close()},De=document.createElement("div"),De.className="jdropdown-backdrop",he.appendChild(r.header),pe.appendChild(be),T.appendChild(he),T.appendChild(pe),T.appendChild(De),r.setOptions(p),"ontouchsend"in document.documentElement?T.addEventListener("touchsend",j.mouseup):T.addEventListener("mouseup",j.mouseup),r.options.lazyLoading==!0&&c(be,{loadUp:r.loadUp,loadDown:r.loadDown}),be.onwheel=function(Z){Z.stopPropagation()},T.change=r.setValue,T.val=function(Z){if(Z===void 0)return r.getValue(!!r.options.multiple);r.setValue(Z)},T.dropdown=r};r.getUrl=function(){return r.options.url},r.setUrl=function(X,Z){r.options.url=X,L({url:r.options.url,method:"GET",dataType:"json",success:function(E){r.setData(E),typeof Z=="function"&&Z(r)}})},r.setId=function(X,Z){if(r.options.format)var E="id";else var E="value";typeof X=="object"?X[E]=Z:r.items[X].data[E]=Z};const re=function(X,Z){if(!X){let J=r.options.autocomplete==!0?r.header.value:"";if(X=prompt(a.translate("Add A New Option"),J),!X)return!1}if(Z||(Z=l.guid()),r.options.format)var E={id:Z,name:X};else var E={value:Z,text:X};if(typeof r.options.onbeforeinsert=="function"){let J=r.options.onbeforeinsert(r,E);if(J===!1)return!1;J&&(E=J)}r.options.data.push(E);var F=r.createItem(E);return be.appendChild(F.element),typeof r.options.oninsert=="function"&&r.options.oninsert(r,E,F),be.style.display=="none"&&(be.style.display=""),r.results&&r.results.push(F),E};r.add=function(X,Z){return typeof r.options.prompt=="function"?r.options.prompt.call(r,re):re(X,Z)},r.createItem=function(X,Z,E){r.options.format?(!X.id&&X.value!==void 0&&(X.id=X.value),!X.name&&X.text!==void 0&&(X.name=X.text)):(!X.value&&X.id!==void 0&&(X.value=X.id),!X.text&&X.name!==void 0&&(X.text=X.name));var F={};if(F.element=document.createElement("div"),F.element.className="jdropdown-item",F.element.indexValue=r.items.length,F.data=X,Z&&(F.group=Z),X.id&&F.element.setAttribute("id",X.id),X.disabled==!0&&F.element.setAttribute("data-disabled",!0),X.tooltip&&F.element.setAttribute("title",X.tooltip),X.image){var J=document.createElement("img");J.className="jdropdown-image",J.src=X.image,X.title||J.classList.add("jdropdown-image-small"),F.element.appendChild(J)}else if(X.icon){var de=document.createElement("span");de.className="jdropdown-icon material-icons",de.innerText=X.icon,X.title||de.classList.add("jdropdown-icon-small"),X.color&&(de.style.color=X.color),F.element.appendChild(de)}else if(X.color){var K=document.createElement("div");K.className="jdropdown-color",K.style.backgroundColor=X.color,F.element.appendChild(K)}if(r.options.format)var fe=X.name;else var fe=X.text;var Ee=document.createElement("div");if(Ee.className="jdropdown-description",Ee.textContent=fe||"&nbsp;",X.title){var te=document.createElement("div");te.className="jdropdown-title",te.innerText=X.title,Ee.appendChild(te)}if(r.options.format)var le=X.id;else var le=X.value;return r.value[le]&&(F.element.classList.add("jdropdown-selected"),F.selected=!0),r.items.push(F),F.element.appendChild(Ee),F},r.appendData=function(X){if(X.length){for(var Z=[],E=[],F=0;F<X.length;F++)X[F].group?(E[X[F].group]||(E[X[F].group]=[]),E[X[F].group].push(F)):Z.push(F);var J=0,de=Object.keys(E);if(de.length>0)for(var F=0;F<de.length;F++){var K=document.createElement("div");K.className="jdropdown-group";var fe=document.createElement("div");fe.className="jdropdown-group-name",fe.textContent=de[F];var Ee=document.createElement("i");Ee.className="jdropdown-group-arrow jdropdown-group-arrow-down",fe.appendChild(Ee);var te=document.createElement("div");te.className="jdropdown-group-items";for(var le=0;le<E[de[F]].length;le++){var we=r.createItem(X[E[de[F]][le]],K,de[F]);(r.options.lazyLoading==!1||J<200)&&(te.appendChild(we.element),J++)}K.appendChild(fe),K.appendChild(te),r.groups.push(K),te.children.length>0&&be.appendChild(K)}if(Z.length)for(var F=0;F<Z.length;F++){var we=r.createItem(X[Z[F]]);(r.options.lazyLoading==!1||J<200)&&(be.appendChild(we.element),J++)}}},r.setData=function(X){if(ee(),be.textContent="",r.header.value="",r.items=[],X&&X.length){for(var Z=0;Z<X.length;Z++)typeof X[Z]!="object"&&(r.options.format?X[Z]={id:X[Z],name:X[Z]}:X[Z]={value:X[Z],text:X[Z]});r.appendData(X),r.options.data=X}else r.options.data=[];r.close()},r.getData=function(){return r.options.data},r.getPosition=function(X){for(var Z=0;Z<r.items.length;Z++)if(O(Z)==X)return Z;return!1},r.getText=function(X){var Z=ae();return X?Z:Z.join("; ")},r.getValue=function(X){var Z=Q();return X?Z:Z.join(";")};var ve=function(X){T.value!=r.options.value&&(T.value=r.options.value,typeof T.oninput=="function"&&T.oninput({type:"input",target:T,value:T.value})),typeof r.options.onchange=="function"&&r.options.onchange(T,r,X,r.options.value)};r.setValue=function(X){var Z=r.getValue();Array.isArray(X)&&(X=X.join(";")),Z!==X&&(H(X),ve(Z))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(E,Z){var E=parseInt(E);if(r.items&&r.items[E]&&(Z===!0||r.items[E].data.disabled!==!0))if(r.setCursor(E,!1),!r.options.multiple)r.items[E].selected?r.options.allowEmpty!==!1&&r.setValue(null):r.setValue(O(E)),r.close();else{var F=r.options.value;r.items[E].selected?(r.items[E].element.classList.remove("jdropdown-selected"),r.items[E].selected=!1,delete r.value[O(E)]):(r.items[E].element.classList.add("jdropdown-selected"),r.items[E].selected=!0,r.value[O(E)]=U(E)),r.options.value=Object.keys(r.value).join(";"),r.options.autocomplete==!1&&(r.header.value=ae().join("; ")),ve(F)}},r.selectItem=function(X){r.selectIndex(X.indexValue)};var Le=function(X,Z){for(var E=0;E<Z.length;E++)if(r.options.format){if(Z[E].id==X)return!0}else if(Z[E].value==X)return!0;return!1};return r.find=function(X){if(r.search==X.trim())return!1;if(r.search=X,r.setCursor(),r.groups.length)for(var Z=0;Z<r.groups.length;Z++)r.groups[Z].lastChild.textContent="";if(be.textContent="",r.options.remoteSearch==!0){r.results=null;var E=r.options.url;let te={url:E,method:"GET",data:{q:X},dataType:"json",success:function(le){r.items=[];var we=Object.keys(r.value);if(we.length)for(var je=0;je<we.length;je++)Le(we[je],le)||(r.options.format?le.unshift({id:we[je],name:r.value[we[je]]}):le.unshift({value:we[je],text:r.value[we[je]]}));r.appendData(le),le.length?be.style.display="":be.style.display="none",typeof r.options.onsearch=="function"&&r.options.onsearch(r,le)}};if(typeof r.options.onbeforesearch=="function"){let le=r.options.onbeforesearch(r,te);if(le===!1)return;typeof le=="object"&&(te=le)}L(te)}else{X=new RegExp(X,"gi");for(var F=[],Z=0;Z<r.items.length;Z++){var J=U(Z),de=r.items[Z].data.title||"",K=r.items[Z].data.group||"",fe=r.items[Z].data.synonym||"";fe&&(fe=fe.join(" ")),(X==null||r.items[Z].selected==!0||J.toString().match(X)||de.match(X)||K.match(X)||fe.match(X))&&F.push(r.items[Z])}if(!F.length)be.style.display="none",r.results=null;else{be.style.display="",r.results=F;var Ee=F.length||0;r.options.lazyLoading==!0&&Ee>200&&(Ee=200);for(var Z=0;Z<Ee;Z++)r.results[Z].group?(r.results[Z].group.parentNode||be.appendChild(r.results[Z].group),r.results[Z].group.lastChild.appendChild(r.results[Z].element)):be.appendChild(r.results[Z].element)}}r.options.autofocus==!0&&r.first()},r.open=function(){if(!T.classList.contains("jdropdown-focus")){j.current=r,I(r,!0),T.classList.add("jdropdown-focus"),l.getWindowWidth()<800&&(r.options.type==null||r.options.type=="picker")&&k.slideBottom(pe,1),r.options.autocomplete==!0&&(r.header.value=r.search,r.header.focus());var X=Q();if(X[0]){var Z=r.getPosition(X[0]);Z!==!1&&r.setCursor(Z)}if(!r.options.type||r.options.type=="default"){var E=T.getBoundingClientRect(),F=pe.getBoundingClientRect();r.options.position?(pe.style.position="fixed",window.innerHeight<E.bottom+F.height?(pe.style.top="",pe.style.bottom=window.innerHeight-E.top+1+"px"):(pe.style.top=E.bottom+"px",pe.style.bottom=""),pe.style.left=E.left+"px"):window.innerHeight<E.bottom+F.height?(pe.style.top="",pe.style.bottom=E.height+1+"px"):(pe.style.top="",pe.style.bottom=""),pe.style.minWidth=E.width+"px",r.options.maxWidth&&(pe.style.maxWidth=r.options.maxWidth),!r.items.length&&r.options.autocomplete==!0?be.style.display="none":be.style.display=""}}typeof r.options.onopen=="function"&&r.options.onopen(T)},r.close=function(X){return T.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),!X&&typeof r.options.onclose=="function"&&r.options.onclose(T),r.header.blur&&r.header.blur(),T.classList.remove("jdropdown-focus"),I(r,!1),j.current=null),r.getValue()},r.setCursor=function(X,Z){if(r.currentIndex!=null&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),X==null)r.currentIndex=null;else if(X=parseInt(X),r.items[X].element.parentNode&&(r.items[X].element.classList.add("jdropdown-cursor"),r.currentIndex=X,Z!==!1&&r.items[r.currentIndex].element)){be.scrollTop;var E=r.items[r.currentIndex].element;be.scrollTop=E.offsetTop-E.scrollTop+E.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){r.options.lazyLoading===!0&&r.loadFirst();var X=be.querySelectorAll(".jdropdown-item");if(X.length){var Z=X[0].indexValue;r.setCursor(Z)}},r.last=function(){r.options.lazyLoading===!0&&r.loadLast();var X=be.querySelectorAll(".jdropdown-item");if(X.length){var Z=X[X.length-1].indexValue;r.setCursor(Z)}},r.next=function(X){var Z=null;if(X){if(X.length==1){var E=r.currentIndex||-1;X=X.toLowerCase();var F=null,J=null,de=be.querySelectorAll(".jdropdown-item");if(de.length){for(var K=0;K<de.length;K++)if(de[K].indexValue>E&&(F=r.items[de[K].indexValue])&&(J=F.element.innerText[0])&&(J=J.toLowerCase(),X==J)){Z=de[K].indexValue;break}r.setCursor(Z)}}}else if(r.currentIndex==null||r.currentIndex==null)r.first();else{var fe=r.items[r.currentIndex].element,Ee=fe.nextElementSibling;Ee?(Ee.classList.contains("jdropdown-group")&&(Ee=Ee.lastChild.firstChild),Z=Ee.indexValue):fe.parentNode.classList.contains("jdropdown-group-items")&&((Ee=fe.parentNode.parentNode.nextElementSibling)&&(Ee.classList.contains("jdropdown-group")?Ee=Ee.lastChild.firstChild:Ee.classList.contains("jdropdown-item")?Z=Ee.indexValue:Ee=null),Ee&&(Z=Ee.indexValue)),Z!==null&&r.setCursor(Z)}},r.prev=function(){var X=null;if(r.currentIndex===null)r.first();else{var Z=r.items[r.currentIndex].element,E=Z.previousElementSibling;E?(E.classList.contains("jdropdown-group")&&(E=E.lastChild.lastChild),X=E.indexValue):Z.parentNode.classList.contains("jdropdown-group-items")&&((E=Z.parentNode.parentNode.previousElementSibling)&&(E.classList.contains("jdropdown-group")?E=E.lastChild.lastChild:E.classList.contains("jdropdown-item")?X=E.indexValue:E=null),E&&(X=E.indexValue))}X!==null&&r.setCursor(X)},r.loadFirst=function(){if(r.results)var X=r.results;else var X=r.items;var Z=X.length||0;r.options.lazyLoading==!0&&Z>200&&(Z=200),be.textContent="";for(var E=0;E<Z;E++)X[E].group?(X[E].group.parentNode||be.appendChild(X[E].group),X[E].group.lastChild.appendChild(X[E].element)):be.appendChild(X[E].element);be.scrollTop=0},r.loadLast=function(){if(r.results)var X=r.results;else var X=r.items;var Z=X.length;if(Z>200){Z=Z-200,be.textContent="";for(var E=Z;E<X.length;E++)X[E].group?(X[E].group.parentNode||be.appendChild(X[E].group),X[E].group.lastChild.appendChild(X[E].element)):be.appendChild(X[E].element);be.scrollTop=be.scrollHeight}},r.loadUp=function(){var X=!1;if(r.results)var Z=r.results;else var Z=r.items;var E=be.querySelectorAll(".jdropdown-item"),F=E[0].indexValue;F=r.items[F];var J=Z.indexOf(F)-1;if(J>0){for(var de=0;J>0&&Z[J]&&de<200;)Z[J].group?(Z[J].group.parentNode||be.insertBefore(Z[J].group,be.firstChild),Z[J].group.lastChild.insertBefore(Z[J].element,Z[J].group.lastChild.firstChild)):be.insertBefore(Z[J].element,be.firstChild),J--,de++;X=!0}return X},r.loadDown=function(){var X=!1;if(r.results)var Z=r.results;else var Z=r.items;var E=be.querySelectorAll(".jdropdown-item"),F=E[E.length-1].indexValue;F=r.items[F];var J=Z.indexOf(F)+1;if(J<Z.length){for(var de=0;J<Z.length&&Z[J]&&de<200;)Z[J].group?(Z[J].group.parentNode||be.appendChild(Z[J].group),Z[J].group.lastChild.appendChild(Z[J].element)):be.appendChild(Z[J].element),J++,de++;X=!0}return X},We(),r};return j.keydown=function(T){var p=null;if(p=j.current){if(T.which==13||T.which==9)p.header.value&&p.currentIndex==null&&p.options.newOptions?p.add():(p.currentIndex==null&&p.options.autocomplete==!0&&p.header.value!=""&&p.find(p.header.value),p.selectIndex(p.currentIndex));else if(T.which==38)p.currentIndex==null?p.first():p.currentIndex>0&&p.prev(),T.preventDefault();else if(T.which==40)p.currentIndex==null?p.first():p.currentIndex+1<p.items.length&&p.next(),T.preventDefault();else if(T.which==36)p.first(),T.target.classList.contains("jdropdown-header")||T.preventDefault();else if(T.which==35)p.last(),T.target.classList.contains("jdropdown-header")||T.preventDefault();else if(T.which==27)p.close();else if(T.which==33){if(p.currentIndex==null)p.first();else if(p.currentIndex>0)for(var r=0;r<7;r++)p.prev();T.preventDefault()}else if(T.which==34){if(p.currentIndex==null)p.first();else if(p.currentIndex+1<p.items.length)for(var r=0;r<7;r++)p.next();T.preventDefault()}}},j.mouseup=function(T){var p=l.findElement(T.target,"jdropdown");if(p){var r=p.dropdown;if(T.target.classList.contains("jdropdown-header"))if(p.classList.contains("jdropdown-focus")&&p.classList.contains("jdropdown-default")){var V=p.getBoundingClientRect();if(T.changedTouches&&T.changedTouches[0]){var ne=T.changedTouches[0].clientX;T.changedTouches[0].clientY}else{var ne=T.clientX;T.clientY}V.width-(ne-V.left)<30?T.target.classList.contains("jdropdown-add")?r.add():r.close():r.options.autocomplete==!1&&r.close()}else r.open();else if(T.target.classList.contains("jdropdown-group-name")){var ee=T.target.nextSibling.children;if(T.target.nextSibling.style.display!="none")for(var H=0;H<ee.length;H++)ee[H].style.display!="none"&&r.selectItem(ee[H])}else T.target.classList.contains("jdropdown-group-arrow")?T.target.classList.contains("jdropdown-group-arrow-down")?(T.target.classList.remove("jdropdown-group-arrow-down"),T.target.classList.add("jdropdown-group-arrow-up"),T.target.parentNode.nextSibling.style.display="none"):(T.target.classList.remove("jdropdown-group-arrow-up"),T.target.classList.add("jdropdown-group-arrow-down"),T.target.parentNode.nextSibling.style.display=""):T.target.classList.contains("jdropdown-item")?r.selectItem(T.target):T.target.classList.contains("jdropdown-image")||T.target.classList.contains("jdropdown-description")?r.selectItem(T.target.parentNode):T.target.classList.contains("jdropdown-title")?r.selectItem(T.target.parentNode.parentNode):(T.target.classList.contains("jdropdown-close")||T.target.classList.contains("jdropdown-backdrop"))&&r.close()}},j.extractFromDom=function(T,p){var r=T;if(p||(p={}),T.getAttribute("multiple")&&(!p||p.multiple==null)&&(p.multiple=!0),T.getAttribute("placeholder")&&(!p||p.placeholder==null)&&(p.placeholder=T.getAttribute("placeholder")),T.getAttribute("data-autocomplete")&&(!p||p.autocomplete==null)&&(p.autocomplete=!0),(!p||p.width==null)&&(p.width=T.offsetWidth),T.value&&(!p||p.value==null)&&(p.value=T.value),!p||p.data==null){p.data=[];for(var V=0;V<T.children.length;V++)if(T.children[V].tagName=="OPTGROUP")for(var ne=0;ne<T.children[V].children.length;ne++)p.data.push({value:T.children[V].children[ne].value,text:T.children[V].children[ne].textContent,group:T.children[V].getAttribute("label")});else p.data.push({value:T.children[V].value,text:T.children[V].textContent})}(!p||p.onchange==null)&&(p.onchange=function(H,O,U,Q){p.multiple==!0?obj.items[O].classList.contains("jdropdown-selected")?r.options[O].setAttribute("selected","selected"):r.options[O].removeAttribute("selected"):r.value=Q});var ee=document.createElement("div");return T.parentNode.insertBefore(ee,T),T.style.display="none",T=ee,{el:T,options:p}},j}var ke=xe();function Re(j,T){if(j.picker)return j.picker.setOptions(T,!0);var p={type:"picker"};p.options={};var r=null,V=null,ne=function(O){return O instanceof Element||O instanceof HTMLDocument},ee=function(){V.innerHTML="";for(var O=Object.keys(p.options.data),U=0;U<O.length;U++){var Q=document.createElement("div");Q.classList.add("jpicker-item"),Q.setAttribute("role","option"),Q.k=O[U],Q.v=p.options.data[O[U]];var ae=p.getLabel(O[U],Q);ne(ae)?Q.appendChild(ae):Q.innerHTML=ae,V.appendChild(Q)}};p.setOptions=function(O,U){var Q={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};O&&O.options&&(O.data=O.options);for(var ae in Q)O&&O.hasOwnProperty(ae)?p.options[ae]=O[ae]:(typeof p.options[ae]>"u"||U===!0)&&(p.options[ae]=Q[ae]);return p.options.header===!1?r.style.display="none":r.style.display="",p.options.width?r.style.width=parseInt(p.options.width)+"px":r.style.width="",p.options.height?(V.style.maxHeight=p.options.height+"px",V.style.overflow="scroll"):V.style.overflow="",p.options.columns>0&&(p.options.grid?(V.classList.add("jpicker-grid"),V.style.gridTemplateColumns="repeat("+p.options.grid+", 1fr)"):(V.classList.add("jpicker-columns"),V.style.width=p.options.width?p.options.width:36*p.options.columns+"px")),isNaN(parseInt(p.options.value))&&(p.options.value=0),ee(),p.setValue(p.options.value),p},p.getValue=function(){return p.options.value},p.setValue=function(O,U){if(p.setLabel(O),p.options.value=String(O),j.value!=p.options.value&&(j.value=p.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value})),V.children[O]&&V.children[O].getAttribute("type")!=="generic"&&p.close(),U&&typeof p.options.onchange=="function"){var Q=p.options.data[O];p.options.onchange(j,p,Q,Q,O,U)}},p.getLabel=function(O,U){var Q=p.options.data[O]||null;return typeof p.options.render=="function"&&(Q=p.options.render(Q,U)),Q},p.setLabel=function(O){var U;p.options.content?(U=document.createElement("i"),U.textContent=p.options.content,U.classList.add("material-icons")):U=p.getLabel(O,null),ne(U)?(r.textContent="",r.appendChild(U)):r.innerHTML=U},p.open=function(){if(!j.classList.contains("jpicker-focus")){I(p,!0),j.classList.add("jpicker-focus"),j.focus();var O=0,U=0;V.style.marginLeft="";var Q=r.getBoundingClientRect(),ae=V.getBoundingClientRect();window.innerHeight<Q.bottom+ae.height||p.options.bottom?O=-1*(ae.height+4):O=Q.height+4,p.options.right===!0&&(U=-1*ae.width+Q.width),ae.left+U<0&&(U=U+ae.left+10),ae.left+ae.width>window.innerWidth&&(U=-1*(10+ae.left+ae.width-window.innerWidth)),V.style.marginTop=parseInt(O)+"px",V.style.marginLeft=parseInt(U)+"px",typeof p.options.onopen=="function"&&p.options.onopen(j,p)}},p.close=function(){j.classList.contains("jpicker-focus")&&(j.classList.remove("jpicker-focus"),I(p,!1),typeof p.options.onclose=="function"&&p.options.onclose(j,p))};var H=function(){let O=l.guid();j.classList.add("jpicker"),j.setAttribute("role","combobox"),j.setAttribute("aria-haspopup","listbox"),j.setAttribute("aria-expanded","false"),j.setAttribute("aria-controls",O),j.setAttribute("tabindex","0"),j.onmousedown=function(U){j.classList.contains("jpicker-focus")||p.open()},r=document.createElement("div"),r.classList.add("jpicker-header"),V=document.createElement("div"),V.setAttribute("id",O),V.setAttribute("role","listbox"),V.classList.add("jpicker-content"),V.onclick=function(U){var Q=l.findElement(U.target,"jpicker-item");Q&&Q.parentNode===V&&p.setValue(Q.k,U)},j.appendChild(r),j.appendChild(V),j.value=T.value||0,p.setOptions(T),typeof p.options.onload=="function"&&p.options.onload(j,p),j.change=p.setValue,j.val=function(U){if(U===void 0)return p.getValue();p.setValue(U)},j.picker=p};return H(),p}function Se(j,T){var p={type:"toolbar"};p.options={};var r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var V in r)T&&T.hasOwnProperty(V)?p.options[V]=T[V]:p.options[V]=r[V];!j&&T.app&&T.app.el&&(j=document.createElement("div"),T.app.el.appendChild(j));var ne=document.createElement("div");ne.classList.add("jtoolbar-item"),ne.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),ne.appendChild(ee),p.selectItem=function(O){for(var U=H.children,Q=0;Q<U.length;Q++)O!=U[Q]&&U[Q].classList.remove("jtoolbar-selected");O.classList.add("jtoolbar-selected")},p.hide=function(){k.slideBottom(j,0,function(){j.style.display="none"})},p.show=function(){j.style.display="",k.slideBottom(j,1)},p.get=function(){return j},p.setBadge=function(O,U){H.children[O].children[1].firstChild.innerHTML=U},p.destroy=function(){toolbar.remove(),j.innerHTML=""},p.update=function(O,U){for(var Q=0;Q<H.children.length;Q++){var ae=H.children[Q];typeof ae.updateState=="function"&&ae.updateState(j,p,ae,O,U)}for(var Q=0;Q<ee.children.length;Q++){var ae=ee.children[Q];typeof ae.updateState=="function"&&ae.updateState(j,p,ae,O,U)}},p.create=function(O){H.innerHTML="";for(var U=0;U<O.length;U++){var Q=document.createElement("div");if(Q.classList.add("jtoolbar-item"),O[U].width&&(Q.style.width=parseInt(O[U].width)+"px"),O[U].k&&(Q.k=O[U].k),O[U].tooltip&&(Q.setAttribute("title",O[U].tooltip),Q.setAttribute("aria-label",O[U].tooltip)),O[U].id&&Q.setAttribute("id",O[U].id),O[U].updateState&&(Q.updateState=O[U].updateState),O[U].active&&Q.classList.add("jtoolbar-active"),O[U].disabled&&Q.classList.add("jtoolbar-disabled"),O[U].type=="select"||O[U].type=="dropdown")Re(Q,O[U]);else if(O[U].type=="divisor")Q.classList.add("jtoolbar-divisor");else if(O[U].type=="label")Q.classList.add("jtoolbar-label"),Q.innerHTML=O[U].content;else{var ae=document.createElement("i");if(typeof O[U].class>"u")ae.classList.add("material-icons");else for(var he=O[U].class.split(" "),pe=0;pe<he.length;pe++)ae.classList.add(he[pe]);if(ae.innerHTML=O[U].content?O[U].content:"",Q.setAttribute("role","button"),Q.appendChild(ae),p.options.badge==!0){var be=document.createElement("div");be.classList.add("jbadge");var Te=document.createElement("div");Te.innerHTML=O[U].badge?O[U].badge:"",be.appendChild(Te),Q.appendChild(be)}if(O[U].title)if(p.options.title==!0){var Oe=document.createElement("span");Oe.innerHTML=O[U].title,Q.appendChild(Oe)}else Q.setAttribute("title",O[U].title);p.options.app&&O[U].route&&(Q.route=O[U].route,Q.onclick=function(){p.options.app.pages(this.route)},p.options.app.pages(O[U].route,{toolbarItem:Q,closed:!0})),typeof O[U].render=="function"&&O[U].render(Q,O[U])}O[U].onclick&&(Q.onclick=O[U].onclick.bind(O[U],j,p,Q)),H.appendChild(Q)}setTimeout(function(){p.refresh()},0)},p.open=function(){ne.classList.add("jtoolbar-arrow-selected"),j.getBoundingClientRect();var O=ee.getBoundingClientRect();O.bottom>window.innerHeight||p.options.bottom?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",ne.children[0].focus(),I(p,!0)},p.close=function(){ne.classList.remove("jtoolbar-arrow-selected"),I(p,!1)},p.refresh=function(){if(p.options.responsive==!0){var O=j.parentNode.getBoundingClientRect();p.options.maxWidth||(p.options.maxWidth=O.width);var U=parseInt(p.options.maxWidth);for(ne.parentNode&&ne.parentNode.removeChild(ne);ee.firstChild;)H.appendChild(ee.firstChild);if(U<H.offsetWidth)for(U-=50;H.lastChild&&U<H.offsetWidth;)ee.insertBefore(H.lastChild,ee.firstChild);ee.children.length>0&&H.appendChild(ne)}},p.setReadonly=function(O){O=O?"add":"remove",j.classList[O]("jtoolbar-disabled")},j.onclick=function(O){var U=l.findElement(O.target,"jtoolbar-item");U&&p.selectItem(U),O.target.classList.contains("jtoolbar-arrow")&&p.open()},window.addEventListener("resize",function(){p.refresh()}),j.classList.add("jtoolbar"),j.innerHTML="",p.options.container==!0&&j.classList.add("jtoolbar-container");var H=document.createElement("div");return j.appendChild(H),p.options.app&&j.classList.add("jtoolbar-mobile"),p.create(p.options.items),j.toolbar=p,p}const $e=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],Y=["width","height","align","border","src","tabindex"],Ae=["color","font-weight","font-size","background","background-color","margin"],Fe=function(j,T){if(j.tagName&&$e.indexOf(j.tagName.toLowerCase())===-1&&j.innerText&&(j.innerHTML=j.innerText),j.attributes&&j.attributes.length){let p=null,r=j.getAttribute("style");if(r){p=[];let ne=r.split(";");for(let ee=0;ee<ne.length;ee++){let H=ne[ee].trim().split(":");if(Ae.indexOf(H[0].trim())>=0){let O=H.shift();H=H.join(":"),p.push(O+":"+H)}}}j.tagName.toUpperCase()==="IMG"&&(j.src?(j.setAttribute("tabindex","900"),T.push(j.src)):j.parentNode.removeChild(j));let V=[];for(let ne=0;ne<j.attributes.length;ne++)V.push(j.attributes[ne].name);V.length&&V.forEach(function(ne){if(Y.indexOf(ne)===-1)j.removeAttribute(ne);else{let ee=j.getAttribute(ne);ee.indexOf("<")!==-1&&j.setAttribute(ne,ee.replace("<","&#60;"))}}),j.style="",p&&p.length&&j.setAttribute("style",p.join(";"))}if(j.children.length)for(let p=j.children.length;p>0;p--)Fe(j.children[p-1],T)};var Ne=function(j,T){j&&(j=j.replace(new RegExp("<!--(.*?)-->","gsi"),""));let r=new DOMParser().parseFromString(j,"text/html");Fe(r,T);let V=document.createElement("div");return V.innerHTML=r.firstChild.innerHTML,V};function Ce(){var j=function(T,p){var r={type:"editor"};r.options={};var V={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var ne in V)p&&p.hasOwnProperty(ne)?r.options[ne]=p[ne]:r.options[ne]=V[ne];var ee=null,H=null,O=[];r.el=T,typeof r.options.onclick=="function"&&(T.onclick=function(te){r.options.onclick(T,r,te)}),T.classList.add("jeditor-container");var U=document.createElement("div");U.className="jsnippet",U.setAttribute("contenteditable",!1);var Q=document.createElement("div");if(Q.className="jeditor-toolbar",r.editor=document.createElement("div"),r.editor.setAttribute("contenteditable",!0),r.editor.setAttribute("spellcheck",!1),r.editor.classList.add("jeditor"),r.options.placeholder&&r.editor.setAttribute("data-placeholder",r.options.placeholder),(r.options.maxHeight||r.options.height)&&(r.editor.style.overflowY="auto",r.options.maxHeight&&(r.editor.style.maxHeight=r.options.maxHeight),r.options.height&&(r.editor.style.height=r.options.height)),r.options.url)L({url:r.options.url,dataType:"html",success:function(te){r.editor.innerHTML=te,j.setCursor(r.editor,r.options.focus=="initial")}});else if(r.options.value)r.editor.innerHTML=r.options.value;else for(var ae=0;ae<T.children.length;ae++)r.editor.appendChild(T.children[ae]);T.innerHTML="";var he=function(te){typeof r.options.onchange=="function"&&r.options.onchange(T,r,te),r.options.value=r.getData(),T.value!=r.options.value&&(T.value=r.options.value,typeof T.oninput=="function"&&T.oninput({type:"input",target:T,value:T.value}))},pe=function(te){let le=[];if(document.createElement("div"),Ne(te,le),le.length)for(var we=0;we<le.length;we++)r.addImage(le[we])},be=function(){var te=null;if(te=U.children[0]){te.classList.contains("jslider-grid")||te.classList.add("jslider-grid");var le=te.children.length;te.setAttribute("data-number",le>4?4:le),le>4?te.setAttribute("data-total",le-4):te.removeAttribute("data-total")}},Te=function(te){U.innerHTML||r.appendSnippet({}),U.children[0].appendChild(te),be()};r.appendSnippet=function(te){U.innerHTML="";for(var le=["image","title","description","host","url"],we=0;we<le.length;we++){var je=document.createElement("div");if(je.className="jsnippet-"+le[we],je.setAttribute("data-k",le[we]),U.appendChild(je),te[le[we]])if(le[we]=="image"){Array.isArray(te.image)||(te.image=[te.image]);for(var Ye=0;Ye<te.image.length;Ye++){var Ue=document.createElement("img");Ue.src=te.image[Ye],je.appendChild(Ue)}}else je.innerHTML=te[le[we]]}r.editor.appendChild(document.createElement("br")),r.editor.appendChild(U)},r.setData=function(te){typeof te=="object"?r.editor.innerHTML=te.content:r.editor.innerHTML=te,r.options.focus&&j.setCursor(r.editor,!0),O=[]},r.getFiles=function(){for(var te=r.editor.querySelectorAll(".jfile"),le=[],we=0;we<te.length;we++)O[te[we].src]&&le.push(O[te[we].src]);return le},r.getText=function(){return r.editor.innerText},r.getData=function(te){if(te){var le={content:""};if(U.innerHTML){le.snippet={};for(var we=0;we<U.children.length;we++){var je=U.children[we].getAttribute("data-k");if(je)if(je=="image"){le.snippet.image||(le.snippet.image=[]);for(var Ye=0;Ye<U.children[we].children.length;Ye++)le.snippet.image.push(U.children[we].children[Ye].getAttribute("src"))}else le.snippet[je]=U.children[we].innerHTML}}var Ue=Object.keys(O);if(Ue.length){le.files=[];for(var we=0;we<Ue.length;we++)le.files.push(O[Ue[we]])}var Je=document.createElement("div");Je.innerHTML=r.editor.innerHTML;var Ge=Je.querySelector(".jsnippet");Ge&&Ge.remove();var tt=Je.innerHTML;tt=tt.replace(/<br>/g,`
`),tt=tt.replace(/<\/div>/g,`</div>
`),tt=tt.replace(/<(?:.|\n)*?>/gm,""),le.content=tt.trim(),K("getData",le)}else var le=r.editor.innerHTML;return le},r.reset=function(){r.editor.innerHTML="",U.innerHTML="",O=[]},r.addPdf=function(te){if(te.result.substr(0,4)!="data")console.error("Invalid source");else{var le=document.createElement("canvas");le.width=60,le.height=60;var we=new Image,je=le.getContext("2d");je.drawImage(we,0,0,le.width,le.height),le.toBlob(function(Ye){var Ue=document.createElement("img");Ue.src=window.URL.createObjectURL(Ye),Ue.title=te.name,Ue.className="jfile pdf",O[Ue.src]={file:Ue.src,extension:"pdf",content:te.result},document.execCommand("insertHtml",!1,Ue.outerHTML)})}},r.addImage=function(te,le){if(r.options.acceptImages)if(te||(te=""),te.substr(0,4)!="data"&&!r.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(te.substr(0,4)=="data"){var we=te.split(";");we=we[0].split("/"),we=we[1]}else{var we=te.substr(te.lastIndexOf(".")+1);te=r.options.remoteParser+te}var je=new Image;je.onload=function(){var Ue=document.createElement("canvas");Ue.width=je.width,Ue.height=je.height;var Je=Ue.getContext("2d");Je.drawImage(je,0,0,Ue.width,Ue.height),Ue.toBlob(function(Ge){var tt=document.createElement("img");tt.src=window.URL.createObjectURL(Ge),tt.classList.add("jfile"),tt.setAttribute("tabindex","900"),tt.setAttribute("width",je.width),tt.setAttribute("height",je.height),O[tt.src]={file:tt.src,extension:we,content:Ue.toDataURL()},r.options.dropAsSnippet||le?(Te(tt),O[tt.src].snippet=!0):document.execCommand("insertHtml",!1,tt.outerHTML),he()})},je.src=te}},r.addFile=function(te){for(var le=[],we=0;we<te.length;we++)if(te[we].size>r.options.maxFileSize)alert("The file is too big");else{var je=te[we].type.split("/");je[0]=="image"?je=1:je[1]=="pdf"?je=2:je=0,je?(le[we]=new FileReader,le[we].index=we,le[we].type=je,le[we].name=te[we].name,le[we].date=te[we].lastModified,le[we].size=te[we].size,le[we].addEventListener("load",function(Ye){Ye.target.type==2?r.options.acceptFiles==!0&&r.addPdf(Ye.target):r.addImage(Ye.target.result)},!1),le[we].readAsDataURL(te[we])):alert("The extension is not allowed")}},r.destroy=function(){r.editor.removeEventListener("mouseup",F),r.editor.removeEventListener("mousedown",J),r.editor.removeEventListener("mousemove",de),r.editor.removeEventListener("keyup",Z),r.editor.removeEventListener("keydown",E),r.editor.removeEventListener("dragstart",qe),r.editor.removeEventListener("dragenter",We),r.editor.removeEventListener("dragover",re),r.editor.removeEventListener("drop",ve),r.editor.removeEventListener("paste",De),r.editor.removeEventListener("blur",Le),r.editor.removeEventListener("focus",X),T.editor=null,T.classList.remove("jeditor-container"),Q.remove(),U.remove(),r.editor.remove()},r.upload=function(){l.click(r.file)};var Oe=function(te){var le=window.getSelection(),we=document.createRange();we.selectNode(te),le.addRange(we)},De=function(te){if(r.options.filterPaste==!0){if(te.clipboardData||te.originalEvent.clipboardData)var le=(te.originalEvent||te).clipboardData.getData("text/html"),we=(te.originalEvent||te).clipboardData.getData("text/plain"),je=(te.originalEvent||te).clipboardData.files;else if(window.clipboardData)var le=window.clipboardData.getData("Html"),we=window.clipboardData.getData("Text"),je=window.clipboardData.files;if(je.length)r.addFile(je);else if(!le)le=we.split(`\r
`),te.target.innerText?(le=le.map(function(Je){return"<div>"+Je+"</div>"}),document.execCommand("insertText",!1,le.join(""))):le.map(function(Je){var Ge=document.createElement("div");Ge.innerText=Je,r.editor.appendChild(Ge)});else{let Je=[];var Ye=Ne(le,Je);if(Je.length)for(var Ue=0;Ue<Je.length;Ue++)r.addImage(Je[Ue]);document.execCommand("insertHtml",!1,Ye.innerHTML)}te.preventDefault()}},qe=function(te){H&&H.e&&te.preventDefault()},We=function(te){H||r.options.dropZone==!1||(T.classList.add("jeditor-dragging"),te.preventDefault())},re=function(te){H||r.options.dropZone==!1||(ee&&clearTimeout(ee),ee=setTimeout(function(){T.classList.remove("jeditor-dragging")},100),te.preventDefault())},ve=function(te){if(!(H||r.options.dropZone===!1)){let le=null;document.caretRangeFromPoint?le=document.caretRangeFromPoint(te.clientX,te.clientY):te.rangeParent&&(le=document.createRange(),le.setStart(te.rangeParent,te.rangeOffset));let we=window.getSelection();we.removeAllRanges(),we.addRange(le),we.anchorNode.parentNode.focus();let je=(te.originalEvent||te).dataTransfer.getData("text/html"),Ye=(te.originalEvent||te).dataTransfer.getData("text/plain"),Ue=(te.originalEvent||te).dataTransfer.files;Ue.length?r.addFile(Ue):Ye&&pe(je),T.classList.remove("jeditor-dragging"),te.preventDefault()}},Le=function(te){K("onevent",te),he(te),typeof r.options.onblur=="function"&&r.options.onblur(T,r,te)},X=function(te){typeof r.options.onfocus=="function"&&r.options.onfocus(T,r,te)},Z=function(te){r.editor.innerHTML||(r.editor.innerHTML="<div><br></div>"),typeof r.options.onkeyup=="function"&&r.options.onkeyup(T,r,te)},E=function(te){if(K("onevent",te),te.key=="Delete"&&te.target.tagName=="IMG"){var le=te.target.parentNode;Oe(te.target),le.classList.contains("jsnippet-image")&&be()}typeof r.options.onkeydown=="function"&&r.options.onkeydown(T,r,te)},F=function(te){if(H&&H.e&&(H.e.classList.remove("resizing"),H.e.changed==!0)){var le=H.e.cloneNode();le.width=parseInt(H.e.style.width)||H.e.getAttribute("width"),le.height=parseInt(H.e.style.height)||H.e.getAttribute("height"),H.e.style.width="",H.e.style.height="",Oe(H.e),document.execCommand("insertHtml",!1,le.outerHTML)}H=!1},J=function(te){var le=function(Ue){var Je=Ue.getBoundingClientRect();Je.width-(te.clientX-Je.left)<40&&te.clientY-Je.top<40&&(Ue.innerHTML="",Ue.remove())};if(te.target.tagName=="IMG")if(te.target.style.cursor){var we=te.target.getBoundingClientRect();H={e:te.target,x:te.clientX,y:te.clientY,w:we.width,h:we.height,d:te.target.style.cursor},te.target.getAttribute("width")||te.target.setAttribute("width",we.width),te.target.getAttribute("height")||te.target.setAttribute("height",we.height);var je=window.getSelection();if(je.rangeCount)for(var Ye=0;Ye<je.rangeCount;Ye++)je.removeRange(je.getRangeAt(Ye));te.target.classList.add("resizing")}else H=!0;else te.target.classList.contains("jsnippet")?le(te.target):te.target.parentNode.classList.contains("jsnippet")&&le(te.target.parentNode),H=!0},de=function(te){if(te.target.tagName=="IMG"&&!te.target.parentNode.classList.contains("jsnippet-image")&&r.options.allowImageResize==!0&&te.target.getAttribute("tabindex")){var le=te.target.getBoundingClientRect();te.clientY-le.top<5?le.width-(te.clientX-le.left)<5?te.target.style.cursor="ne-resize":te.clientX-le.left<5?te.target.style.cursor="nw-resize":te.target.style.cursor="n-resize":le.height-(te.clientY-le.top)<5?le.width-(te.clientX-le.left)<5?te.target.style.cursor="se-resize":te.clientX-le.left<5?te.target.style.cursor="sw-resize":te.target.style.cursor="s-resize":le.width-(te.clientX-le.left)<5?te.target.style.cursor="e-resize":te.clientX-le.left<5?te.target.style.cursor="w-resize":te.target.style.cursor=""}if(te.which==1&&H&&H.d){if(H.d=="e-resize"||H.d=="ne-resize"||H.d=="se-resize")if(H.e.style.width=H.w+(te.clientX-H.x),te.shiftKey){var we=(te.clientX-H.x)*(H.h/H.w);H.e.style.height=H.h+we}else var we=null;we||(H.d=="s-resize"||H.d=="se-resize"||H.d=="sw-resize")&&(te.shiftKey||(H.e.style.height=H.h+(te.clientY-H.y))),H.e.changed=!0}},K=function(te,le){if(r.options.extensions){var we=Object.keys(r.options.extensions);if(we.length)for(var je=0;je<we.length;je++)r.options.extensions[we[je]]&&typeof r.options.extensions[we[je]][te]=="function"&&r.options.extensions[we[je]][te].call(r,le)}},fe=function(){if(r.options.extensions){var te=Object.keys(r.options.extensions);if(te.length)for(var le=0;le<te.length;le++)r.options.extensions[te[le]]&&typeof r.options.extensions[te[le]]=="function"&&(r.options.extensions[te[le]]=r.options.extensions[te[le]](T,r))}};if(document.addEventListener("mouseup",F),document.addEventListener("mousemove",de),r.editor.addEventListener("mousedown",J),r.editor.addEventListener("keyup",Z),r.editor.addEventListener("keydown",E),r.editor.addEventListener("dragstart",qe),r.editor.addEventListener("dragenter",We),r.editor.addEventListener("dragover",re),r.editor.addEventListener("drop",ve),r.editor.addEventListener("paste",De),r.editor.addEventListener("focus",X),r.editor.addEventListener("blur",Le),T.appendChild(r.editor),r.options.snippet&&r.appendSnippet(r.options.snippet),r.options.toolbar){if(Array.isArray(r.options.toolbar))var Ee={container:!0,responsive:!0,items:r.options.toolbar};else if(r.options.toolbar===!0)var Ee={container:!0,responsive:!0,items:[]};else var Ee=r.options.toolbar;Ee.items&&Ee.items.length||(Ee.items=j.getDefaultToolbar(r)),r.options.toolbarOnTop?(T.classList.add("toolbar-on-top"),T.insertBefore(Q,T.firstChild)):(r.editor.style.padding="15px",T.appendChild(Q)),Se(Q,Ee),Q.addEventListener("click",function(){r.editor.focus()})}return r.file=document.createElement("input"),r.file.style.display="none",r.file.type="file",r.file.setAttribute("accept","image/*"),r.file.onchange=function(){r.addFile(this.files)},T.appendChild(r.file),r.options.focus&&j.setCursor(r.editor,r.options.focus=="initial"),T.change=r.setData,T.val=function(te){if(te===void 0){var le=T.getAttribute("data-html")!=="true";return r.getData(le)}else r.setData(te)},fe(),T.editor=r,typeof r.options.onload=="function"&&r.options.onload(T,r,r.editor),r};return j.setCursor=function(T,p){T.focus(),document.execCommand("selectAll");var r=window.getSelection(),V=r.getRangeAt(0);if(p==!0)var ne=V.startContainer,ee=0;else var ne=V.endContainer,ee=ne.length;V.setStart(ne,ee),V.setEnd(ne,ee),r.removeAllRanges(),r.addRange(V)},j.getDefaultToolbar=function(T){var p=function(V,ne,ee){ee.color||(ge(ee,{onchange:function(H,O){ee.k==="color"?document.execCommand("foreColor",!1,O):document.execCommand("backColor",!1,O)}}),ee.color.open())},r=[];return r.push({content:"undo",onclick:function(){document.execCommand("undo")}}),r.push({content:"redo",onclick:function(){document.execCommand("redo")}}),r.push({type:"divisor"}),T.options.toolbarOnTop&&(r.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(V){return'<span style="font-family:'+V+'">'+V+"</span>"},onchange:function(V,ne,ee,H,O){document.execCommand("fontName",!1,H)}}),r.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(V){return'<span style="font-size:'+V+'">'+V+"</span>"},onchange:function(V,ne,ee,H,O){document.execCommand("fontSize",!1,parseInt(O)+1)}}),r.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(V){return'<i class="material-icons">'+V+"</i>"},onchange:function(V,ne,ee,H,O){var U=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(U[O])}}),r.push({type:"divisor"}),r.push({content:"format_color_text",k:"color",onclick:p}),r.push({content:"format_color_fill",k:"background-color",onclick:p})),r.push({content:"format_bold",onclick:function(V,ne,ee){document.execCommand("bold"),document.queryCommandState("bold")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_italic",onclick:function(V,ne,ee){document.execCommand("italic"),document.queryCommandState("italic")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_underline",onclick:function(V,ne,ee){document.execCommand("underline"),document.queryCommandState("underline")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({type:"divisor"}),r.push({content:"format_list_bulleted",onclick:function(V,ne,ee){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_list_numbered",onclick:function(V,ne,ee){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_increase",onclick:function(V,ne,ee){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_decrease",onclick:function(V,ne,ee){document.execCommand("outdent"),document.queryCommandState("outdent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),T.options.toolbarOnTop&&(r.push({type:"divisor"}),r.push({content:"photo",onclick:function(){T.upload()}}),r.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(V,ne){ne&&(ne.onmouseover=this.onmouseover,V=V.split("x"),ne.setAttribute("data-x",V[0]),ne.setAttribute("data-y",V[1]));var ee=document.createElement("div");return ne.style.margin="1px",ne.style.border="1px solid #ddd",ee},onmouseover:function(V){for(var ne=parseInt(V.target.getAttribute("data-x")),ee=parseInt(V.target.getAttribute("data-y")),H=0;H<V.target.parentNode.children.length;H++){var O=V.target.parentNode.children[H],U=parseInt(O.getAttribute("data-x")),Q=parseInt(O.getAttribute("data-y"));U<=ne&&Q<=ee?(O.style.backgroundColor="#cae1fc",O.style.borderColor="#2977ff"):(O.style.backgroundColor="",O.style.borderColor="#ddd")}},onchange:function(V,ne,ee){ee=ee.split("x");for(var H=document.createElement("table"),O=document.createElement("tbody"),U=0;U<=ee[1];U++){for(var Q=document.createElement("tr"),ae=0;ae<=ee[0];ae++){var he=document.createElement("td");he.innerHTML="",Q.appendChild(he)}O.appendChild(Q)}H.appendChild(O),H.setAttribute("width","100%"),H.setAttribute("cellpadding","6"),H.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,H.outerHTML)}})),r},j}var Ie=Ce();function Be(){var j=function(T,p){var r={};r.options={};var V={type:"big",title:"Untitled",width:510,height:472};for(var ne in V)p&&p.hasOwnProperty(ne)?r.options[ne]=p[ne]:r.options[ne]=V[ne];var ee=function(){for(var U=document.createElement("div");T.children[0];)U.appendChild(T.children[0]);for(r.content=document.createElement("div"),r.content.className="jfloating_content",r.content.innerHTML=T.innerHTML;U.children[0];)r.content.appendChild(U.children[0]);r.container=document.createElement("div"),r.container.className="jfloating",r.container.appendChild(r.content),r.options.title?r.container.setAttribute("title",r.options.title):r.container.classList.add("no-title"),r.options.width&&(r.container.style.width=parseInt(r.options.width)+"px"),r.options.height&&(r.container.style.height=parseInt(r.options.height)+"px"),T.innerHTML="",T.appendChild(r.container)},H=function(){r.container&&r.container.addEventListener("click",function(U){var Q=U.target.getBoundingClientRect();if(U.target.classList.contains("jfloating")){if(U.changedTouches&&U.changedTouches[0])var ae=U.changedTouches[0].clientX,he=U.changedTouches[0].clientY;else var ae=U.clientX,he=U.clientY;Q.width-(ae-Q.left)<50&&he-Q.top<50?setTimeout(function(){r.close()},100):r.setState()}})},O=function(){r.container.classList.add("jfloating-"+r.options.type)};return r.state={isMinized:!1},r.setState=function(){r.state.isMinized?r.container.classList.remove("jfloating-minimized"):r.container.classList.add("jfloating-minimized"),r.state.isMinized=!r.state.isMinized},r.close=function(){Components.elements.splice(j.elements.indexOf(r.container),1),r.updatePosition(),T.remove()},r.updatePosition=function(){for(var U=0;U<j.elements.length;U++){var Q=j.elements[U],ae=j.elements[U-1];Q.style.right=U*(ae?ae.offsetWidth:Q.offsetWidth)*1.01+"px"}},r.init=function(){ee(),H(),O(),j.elements.push(r.container),r.updatePosition(),T.floating=r},r.init(),r};return j.elements=[],j}var Pe=Be();function ze(){const j=function(H){return!isNaN(H)&&H!==null&&(typeof H!="string"||H.trim()!=="")},T={between:function(H,O){return H>=O[0]&&H<=O[1]},"not between":function(H,O){return H<O[0]||H>O[1]},"<":function(H,O){return H<O[0]},"<=":function(H,O){return H<=O[0]},">":function(H,O){return H>O[0]},">=":function(H,O){return H>=O[0]},"=":function(H,O){return H==O[0]},"!=":function(H,O){return H!=O[0]}},p={"valid date":function(){return!0},"=":function(H,O){return H===O[0]},"!=":function(H,O){return H!==O[0]},"<":function(H,O){return H<O[0]},"<=":function(H,O){return H<=O[0]},">":function(H,O){return H>O[0]},">=":function(H,O){return H>=O[0]},between:function(H,O){return H>=O[0]&&H<=O[1]},"not between":function(H,O){return H<O[0]||H>O[1]}},r={contains:function(H,O){return H.includes(O[0])},"not contains":function(H,O){return!H.includes(O[0])},"begins with":function(H,O){return H.startsWith(O[0])},"ends with":function(H,O){return H.endsWith(O[0])},"=":function(H,O){return H===O[0]},"!=":function(H,O){return H!==O[0]},"valid email":function(H){var O=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return O.test(H)},"valid url":function(H){var O=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return O.test(H)}},V=function(H,O){return typeof V[O.type]=="function"?O.allowBlank&&(typeof H>"u"||H===""||H===null)?!0:V[O.type].call(this,H,O):null};V.url=function(H){var O=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!O.test(H)},V.email=function(H){var O=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(H&&O.test(H))},V.required=function(H){return!!(H&&H.trim())},V.empty=function(H){return typeof H>"u"||H===null||typeof H=="string"&&!H.toString().trim()},V["not exist"]=V.empty,V.notEmpty=function(H){return!V.empty(H)},V.exist=V.notEmpty,V.number=function(H,O){if(!j(H))return!1;if(!O||!O.criteria)return!0;if(!T[O.criteria])return!1;let U=O.value.map(function(Q){return parseFloat(Q)});return T[O.criteria](H,U)},V.login=function(H){let O=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(H&&O.test(H))},V.list=function(H,O){let U=typeof H;if(U!=="string"&&U!=="number")return!1;let Q;return typeof O.value[0]=="string"?O.source?Q=O.source:Q=O.value[0].split(","):Q=O.value[0],Array.isArray(Q)?Q.findIndex(function(he){return he==H})>-1:!1};const ne=function(){let H=new Date;return H.setHours(0,0,0,0),H},ee={"one year ago":function(){let H=ne();return H.setFullYear(H.getFullYear()-1),H},"one month ago":function(){let H=ne();return H.setMonth(H.getMonth()-1),H},"one week ago":function(){let H=ne();return H.setDate(H.getDate()-7),H},yesterday:function(){let H=ne();return H.setDate(H.getDate()-1),H},today:ne,tomorrow:function(){let H=ne();return H.setDate(H.getDate()+1),H}};return V.date=function(H,O){if(j(H)&&H>0&&H<1e6&&(H=M.numToDate(H)),new Date(H)=="Invalid Date")return!1;if(!O||!O.criteria)return!0;if(!p[O.criteria])return!1;let U=O.value.map(function(Q){return typeof Q=="string"&&ee[Q]?ee[Q]().getTime():new Date(Q).getTime()});return p[O.criteria](new Date(H).getTime(),U)},V.text=function(H,O){if(typeof H>"u"||H===null)H="";else if(typeof H!="string")return!1;return!O||!O.criteria?!0:r[O.criteria]?r[O.criteria](H,O.value):!1},V.textLength=function(H,O){let U;return typeof H=="string"?U=H.length:typeof H<"u"&&H!==null&&typeof H.toString=="function"?U=H.toString().length:U=0,V.number(U,O)},V.time=function(H,O){if(!j(H))return!1;if(!O||!O.criteria)return!0;if(!T[O.criteria])return!1;let U=O.value.map(function(Q){return parseInt(parseFloat(Q)*10**17)/10**17});return T[O.criteria](parseInt(parseFloat(H)*10**17)/10**17,U)},V}var Ze=ze();function et(){var j=function(T,p){var r={};r.options={};var V={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(O,U){alert(U)}};for(var ne in V)p&&p.hasOwnProperty(ne)?r.options[ne]=p[ne]:r.options[ne]=V[ne];r.options.validations||(r.options.validations={}),r.options.submitButton||(r.options.submitButton=T.querySelector("input[type=submit]")),r.options.submitButton&&r.options.url&&(r.options.submitButton.onclick=function(){r.save()}),r.options.validations.email||(r.options.validations.email=Ze.email),r.options.validations.length||(r.options.validations.length=Ze.length),r.options.validations.required||(r.options.validations.required=Ze.required),r.setUrl=function(O){r.options.url=O},r.load=function(){L({url:r.options.url,method:"GET",dataType:"json",queue:!0,success:function(O){if(typeof r.options.onbeforeload=="function"){var U=r.options.onbeforeload(T,O);U&&(O=U)}j.setElements(T,O),typeof r.options.onload=="function"&&r.options.onload(T,O)}})},r.save=function(){var O=r.validate();if(O)r.options.onerror(T,O);else{var U=j.getElements(T,!0);if(typeof r.options.onbeforesave=="function"){var U=r.options.onbeforesave(T,U);if(U===!1)return}L({url:r.options.url,method:"POST",dataType:"json",data:U,success:function(Q){typeof r.options.onsave=="function"&&r.options.onsave(T,U,Q)}})}},r.remove=function(){if(typeof r.options.onbeforeremove=="function"){var O=r.options.onbeforeremove(T,r);if(O===!1)return!1}L({url:r.options.url,method:"DELETE",dataType:"json",success:function(U){typeof r.options.onremove=="function"&&r.options.onremove(T,r,U),r.reset()}})};var ee=function(O){O.classList.add("error"),r.options.submitButton&&r.options.submitButton.setAttribute("disabled",!0);var U=O.getAttribute("data-error")||"There is an error in the form";return O.setAttribute("title",U),U},H=function(O){var U=!1;O.classList.remove("error"),O.removeAttribute("title");for(var Q=T.querySelectorAll("input, select, textarea, div[name]"),ae=0;ae<Q.length;ae++)Q[ae].getAttribute("data-validation")&&Q[ae].classList.contains("error")&&(U=!0);r.options.submitButton&&(U?r.options.submitButton.setAttribute("disabled",!0):r.options.submitButton.removeAttribute("disabled"))};return r.validateElement=function(O){var U=!1,Q=j.getValue(O),ae=O.getAttribute("data-validation");return typeof r.options.validations[ae]=="function"&&!r.options.validations[ae](Q,O)?U=ee(O):O.classList.contains("error")&&H(O),U},r.reset=function(){for(var O=T.querySelectorAll("input, select, textarea, div[name]"),U=0;U<O.length;U++)O[U].getAttribute("name")&&(O[U].type=="checkbox"||O[U].type=="radio"?O[U].checked=!1:typeof O[U].val=="function"?O[U].val(""):O[U].value="")},r.validate=function(){for(var O=[],U=T.querySelectorAll("input, select, textarea, div[name]"),Q=0;Q<U.length;Q++)if(U[Q].getAttribute("data-validation")){var ae=r.validateElement(U[Q]);ae&&O.push(ae)}return O.length>0?O.join("<br>"):!1},r.getError=function(){return!!r.validation()},r.setHash=function(){return r.getHash(j.getElements(T))},r.getHash=function(O){var U=0,Q,ae;if(O.length===0)return U;for(Q=0;Q<O.length;Q++)ae=O.charCodeAt(Q),U=(U<<5)-U+ae,U|=0;return U},r.isChanged=function(){var O=r.setHash();return r.options.currentHash!=O},r.resetTracker=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.setIgnore=function(O){r.options.ignore=!!O},setTimeout(function(){r.options.currentHash=r.setHash()},1e3),T.addEventListener("keyup",function(O){O.target.getAttribute("data-validation")&&r.validateElement(O.target)}),j.hasEvents||(window.addEventListener("beforeunload",function(O){if(r.isChanged()&&r.options.ignore==!1){var U=r.options.message?r.options.message:"o/";return U?(typeof O>"u"&&(O=window.event),O&&(O.returnValue=U),U):void 0}}),j.hasEvents=!0),T.form=r,r};return j.getValue=function(T){var p=null;if(T.type=="checkbox")T.checked==!0&&(p=T.value||!0);else if(T.type=="radio")T.checked==!0&&(p=T.value);else if(T.type=="file")p=T.files;else if(T.tagName=="select"&&T.multiple==!0){p=[];for(var r=T.querySelectorAll("options[selected]"),V=0;V<r.length;V++)p.push(r[V].value)}else typeof T.val=="function"?p=T.val():p=T.value||"";return p},j.getElements=function(T,p){for(var r={},V=null,ne=T.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<ne.length;ee++)(V=ne[ee].getAttribute("name"))&&(r[V]=j.getValue(ne[ee])||"");return p==!0?r:JSON.stringify(r)},j.setElements=function(T,p){for(var r=null,V=null,ne=T.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<ne.length;ee++){var H=ne[ee].getAttribute("type");if(r=ne[ee].getAttribute("name")){if(r=r.replace(new RegExp(/\[(.*?)\]/ig),".$1"),V=null,r.match(/\./)){var O=g.call(p,r)||"";typeof O<"u"&&(V=O)}else typeof p[r]<"u"&&(V=p[r]);V!==null&&(H=="checkbox"||H=="radio"?ne[ee].checked=!!V:H=="file"||(typeof ne[ee].val=="function"?ne[ee].val(V):ne[ee].value=V))}}},j}var it=et();function dt(){var j=function(){var p=null,r=function(H){if(H.which==27)for(var O=document.querySelectorAll(".jmodal"),U=0;U<O.length;U++)O[U].parentNode.modal.close()},V=function(H){let O=H.composedPath();var U=l.findElement(O[0],"jmodal");if(U){var Q=U.getBoundingClientRect();if(H.changedTouches&&H.changedTouches[0])var ae=H.changedTouches[0].clientX,he=H.changedTouches[0].clientY;else var ae=H.clientX,he=H.clientY;Q.width-(ae-Q.left)<50&&he-Q.top<50&&U.parentNode.modal.close()}p&&(p.element.style.cursor="auto",p=null)},ne=function(H){let O=H.composedPath();var U=l.findElement(O[0],"jmodal");if(U){var Q=U.getBoundingClientRect();if(H.changedTouches&&H.changedTouches[0])var ae=H.changedTouches[0].clientX,he=H.changedTouches[0].clientY;else var ae=H.clientX,he=H.clientY;Q.width-(ae-Q.left)<50&&he-Q.top<50||he-Q.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),p={left:Q.left,top:Q.top,x:H.clientX,y:H.clientY,width:Q.width,height:Q.height,element:U})}},ee=function(H){if(p){if(H=H||window.event,H.buttons)var O=H.buttons;else if(H.button)var O=H.button;else var O=H.which;O?(p.element.style.top=p.top+(H.clientY-p.y)+p.height/2+"px",p.element.style.left=p.left+(H.clientX-p.x)+p.width/2+"px",p.element.style.cursor="move"):p.element.style.cursor="auto"}};document.addEventListener("keydown",r),document.addEventListener("mouseup",V),document.addEventListener("mousedown",ne),document.addEventListener("mousemove",ee)},T=function(p,r){var V={};V.options={};var ne={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ee in ne)r&&r.hasOwnProperty(ee)?V.options[ee]=r[ee]:V.options[ee]=ne[ee];!V.options.title&&p.getAttribute("title")&&(V.options.title=p.getAttribute("title"));for(var H=document.createElement("div");p.children[0];)H.appendChild(p.children[0]);for(V.title=document.createElement("div"),V.title.className="jmodal_title",V.options.icon&&V.title.setAttribute("data-icon",V.options.icon),V.content=document.createElement("div"),V.content.className="jmodal_content",V.content.innerHTML=p.innerHTML;H.children[0];)V.content.appendChild(H.children[0]);if(V.container=document.createElement("div"),V.container.className="jmodal",V.container.appendChild(V.title),V.container.appendChild(V.content),V.options.padding&&(V.content.style.padding=V.options.padding),V.options.width&&(V.container.style.width=V.options.width),V.options.height&&(V.container.style.height=V.options.height),V.options.title){var O=document.createElement("h4");O.innerText=V.options.title,V.title.appendChild(O)}if(p.innerHTML="",p.style.display="none",p.appendChild(V.container),V.options.backdrop){var U=document.createElement("div");U.className="jmodal_backdrop",U.onclick=function(){V.close()},p.appendChild(U)}return V.open=function(){p.style.display="block";var Q=V.container.getBoundingClientRect();l.getWindowWidth()<Q.width?(V.container.style.top="",V.container.style.left="",V.container.classList.add("jmodal_fullscreen"),k.slideBottom(V.container,1)):V.options.backdrop&&(U.style.display="block"),typeof V.options.onopen=="function"&&V.options.onopen(p,V)},V.resetPosition=function(){V.container.style.top="",V.container.style.left=""},V.isOpen=function(){return p.style.display!="none"},V.close=function(){V.isOpen()&&(p.style.display="none",V.options.backdrop&&(U.style.display=""),V.container.classList.remove("jmodal_fullscreen"),typeof V.options.onclose=="function"&&V.options.onclose(p,V))},V.options.url?L({url:V.options.url,method:"GET",dataType:"text/html",success:function(Q){V.content.innerHTML=Q,V.options.closed||V.open(),typeof V.options.onload=="function"&&V.options.onload(V)}}):(V.options.closed||V.open(),typeof V.options.onload=="function"&&V.options.onload(V)),p.modal=V,j(),j=function(){},V};return T}var ft=dt();function kt(){var j=function(T){var p={};p.options={};var r={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var V in r)T&&T.hasOwnProperty(V)?p.options[V]=T[V]:p.options[V]=r[V];var ne=document.createElement("div");ne.className="jnotification",p.options.error&&ne.classList.add("jnotification-error");var ee=document.createElement("div");ee.className="jnotification-container",ne.appendChild(ee);var H=document.createElement("div");H.className="jnotification-header",ee.appendChild(H);var O=document.createElement("div");if(O.className="jnotification-image",H.appendChild(O),p.options.icon){var U=document.createElement("img");U.src=p.options.icon,O.appendChild(U)}var Q=document.createElement("div");if(Q.className="jnotification-name",Q.innerHTML=p.options.name,H.appendChild(Q),p.options.closeable==!0){var ae=document.createElement("div");ae.className="jnotification-close",ae.onclick=function(){p.hide()},H.appendChild(ae)}var he=document.createElement("div");he.className="jnotification-date",H.appendChild(he);var pe=document.createElement("div");if(pe.className="jnotification-content",ee.appendChild(pe),p.options.title){var be=document.createElement("div");be.className="jnotification-title",be.innerHTML=p.options.title,pe.appendChild(be)}var Te=document.createElement("div");if(Te.className="jnotification-message",Te.innerHTML=p.options.message,pe.appendChild(Te),p.show=function(){document.body.appendChild(ne),l.getWindowWidth()>800?k.fadeIn(ne):k.slideTop(ne,1)},p.hide=function(){l.getWindowWidth()>800?k.fadeOut(ne,function(){ne.parentNode&&(ne.parentNode.removeChild(ne),Oe&&clearTimeout(Oe))}):k.slideTop(ne,0,function(){ne.parentNode&&(ne.parentNode.removeChild(ne),Oe&&clearTimeout(Oe))})},p.show(),p.options.autoHide==!0)var Oe=setTimeout(function(){p.hide()},p.options.timeout);return l.getWindowWidth()<800&&ne.addEventListener("swipeup",function(De){p.hide(),De.preventDefault(),De.stopPropagation()}),p};return j.isVisible=function(){var T=document.querySelector(".jnotification");return!!(T&&T.parentNode)},j}var Rt=kt();function Mt(j,T){var p={};p.options={};var r={value:0,onchange:null,width:null};for(var V in r)T&&T.hasOwnProperty(V)?p.options[V]=T[V]:p.options[V]=r[V];j.classList.add("jprogressbar"),j.setAttribute("tabindex",1),j.setAttribute("data-value",p.options.value);var ne=document.createElement("div");ne.style.width=p.options.value+"%",ne.style.color="#fff",j.appendChild(ne),p.options.width&&(j.style.width=p.options.width),p.setValue=function(H){H=parseInt(H),p.options.value=H,ne.style.width=H+"%",j.setAttribute("data-value",H+"%"),H<6?j.style.color="#000":j.style.color="#fff",p.options.value=H,typeof p.options.onchange=="function"&&p.options.onchange(j,H),j.value!=p.options.value&&(j.value=p.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value}))},p.getValue=function(){return p.options.value};var ee=function(H){if(H.which){var O=j.getBoundingClientRect();if(H.changedTouches&&H.changedTouches[0]){var U=H.changedTouches[0].clientX;H.changedTouches[0].clientY}else{var U=H.clientX;H.clientY}p.setValue(Math.round((U-O.left)/O.width*100))}};return"touchstart"in document.documentElement?(j.addEventListener("touchstart",ee),j.addEventListener("touchend",ee)):(j.addEventListener("mousedown",ee),j.addEventListener("mousemove",ee)),j.change=p.setValue,j.val=function(H){if(H===void 0)return p.getValue();p.setValue(H)},j.progressbar=p,p}function Bt(j,T){if(j.rating)return j.rating.setOptions(T,!0);var p={};p.options={},p.setOptions=function(V,ne){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var H in ee)V&&V.hasOwnProperty(H)?p.options[H]=V[H]:(typeof p.options[H]>"u"||ne===!0)&&(p.options[H]=ee[H]);j.innerHTML="";for(var O=0;O<p.options.number;O++){var U=document.createElement("div");U.setAttribute("data-index",O+1),U.setAttribute("title",p.options.tooltip[O]),j.appendChild(U)}if(p.options.value)for(var O=0;O<p.options.number;O++)O<p.options.value&&j.children[O].classList.add("jrating-selected");return p},p.setValue=function(V){for(var ne=0;ne<p.options.number;ne++)ne<V?j.children[ne].classList.add("jrating-selected"):(j.children[ne].classList.remove("jrating-over"),j.children[ne].classList.remove("jrating-selected"));p.options.value=V,typeof p.options.onchange=="function"&&p.options.onchange(j,V),j.value!=p.options.value&&(j.value=p.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value}))},p.getValue=function(){return p.options.value};var r=function(){p.setOptions(T),j.classList.add("jrating"),j.addEventListener("click",function(V){var ne=V.target.getAttribute("data-index");ne!=null&&(ne==p.options.value?p.setValue(0):p.setValue(ne))}),j.addEventListener("mouseover",function(V){for(var ne=V.target.getAttribute("data-index"),ee=0;ee<p.options.number;ee++)ee<ne?j.children[ee].classList.add("jrating-over"):j.children[ee].classList.remove("jrating-over")}),j.addEventListener("mouseout",function(V){for(var ne=0;ne<p.options.number;ne++)j.children[ne].classList.remove("jrating-over")}),j.change=p.setValue,j.val=function(V){if(V===void 0)return p.getValue();p.setValue(V)},j.rating=p};return r(),p}function Et(j,T){if(j.search)return j.search;var p=null,r=function(U){if(U.target.classList.contains("jsearch_item"))var Q=U.target;else var Q=U.target.parentNode;H.selectIndex(Q),U.preventDefault()},V=function(U){if(typeof H.options.onsearch=="function"){var Q=H.options.onsearch(H,U);Q&&(U=Q)}if(O.innerHTML="",!U.length)j.style.display="";else{j.style.display="block";for(var ae=U.length<11?U.length:10,he=0;he<ae;he++){if(typeof U[he]=="string")var pe=U[he],be=U[he];else{var pe=U[he].text;!pe&&U[he].name&&(pe=U[he].name);var be=U[he].value;!be&&U[he].id&&(be=U[he].id)}var Te=document.createElement("div");Te.setAttribute("data-value",be),Te.setAttribute("data-text",pe),Te.className="jsearch_item",U[he].id&&Te.setAttribute("id",U[he].id),H.options.forceSelect&&he==0&&Te.classList.add("selected");var Oe=document.createElement("img");U[he].image?Oe.src=U[he].image:Oe.style.display="none",Te.appendChild(Oe);var De=document.createElement("div");De.innerHTML=pe,Te.appendChild(De),O.appendChild(Te)}}},ne=function(U){if(U!=H.terms)if(H.terms=U,H.options.forceSelect?p=0:p=null,Array.isArray(H.options.data)){var Q=function(he){if(typeof he=="string"){if((""+he).toLowerCase().search(U.toLowerCase())>=0)return!0}else for(var pe in he){var be=he[pe];if((""+be).toLowerCase().search(U.toLowerCase())>=0)return!0}return!1},ae=H.options.data.filter(function(he){return Q(he)});V(ae)}else L({url:H.options.data+U,method:"GET",dataType:"json",success:function(he){V(he)}})},ee=null,H=function(U){ee&&clearTimeout(ee),ee=setTimeout(function(){ne(U)},500)};T.forceSelect===null&&(T.forceSelect=!0),H.options={data:T.data||null,input:T.input||null,searchByNode:T.searchByNode||null,onselect:T.onselect||null,forceSelect:T.forceSelect,onsearch:T.onsearch||null,onbeforesearch:T.onbeforesearch||null},H.selectIndex=function(U){var Q=U.getAttribute("id"),ae=U.getAttribute("data-text"),he=U.getAttribute("data-value"),pe=U.children[0].src||"";typeof H.options.onselect=="function"&&H.options.onselect(H,ae,he,Q,pe),H.close()},H.open=function(){j.style.display="block"},H.close=function(){ee&&clearTimeout(ee),H.terms="",O.innerHTML="",j.style.display=""},H.isOpened=function(){return!!j.style.display},H.keydown=function(U){H.isOpened()&&(U.key=="Enter"?p!==null&&O.children[p]?(H.selectIndex(O.children[p]),U.preventDefault()):H.close():U.key==="ArrowUp"?(p!==null&&O.children[0]&&(O.children[p].classList.remove("selected"),!H.options.forceSelect&&p===0?p=null:(p=Math.max(0,p-1),O.children[p].classList.add("selected"))),U.preventDefault()):U.key==="ArrowDown"&&(p==null?p=-1:O.children[p].classList.remove("selected"),p<9&&O.children[p+1]&&p++,O.children[p].classList.add("selected"),U.preventDefault()))},H.keyup=function(U){if(!H.options.searchByNode&&H.options.input)if(H.options.input.tagName==="DIV")var Q=H.options.input.innerText;else var Q=H.options.input.value;else{var ae=l.getNode();if(ae)var Q=ae.innerText}if(typeof H.options.onbeforesearch=="function"){var he=H.options.onbeforesearch(H,Q);if(he)Q=he;else if(he===!1)return}H(Q)},H.blur=function(U){H.close()},H.options.input&&(H.options.input.addEventListener("keyup",H.keyup),H.options.input.addEventListener("keydown",H.keydown),H.options.input.addEventListener("blur",H.blur));var O=document.createElement("div");return O.classList.add("jsearch_container"),O.onmousedown=r,j.appendChild(O),j.classList.add("jsearch"),j.search=H,H}function Ht(j,T){var p={};if(p.options={},p.currentImage=null,T&&(p.options=T),j.setAttribute("tabindex","900"),p.options.items=[],!j.classList.contains("jslider")){if(j.classList.add("jslider"),j.classList.add("unselectable"),p.options.height&&(j.style.minHeight=parseInt(p.options.height)+"px"),p.options.width&&(j.style.width=parseInt(p.options.width)+"px"),p.options.grid){j.classList.add("jslider-grid");var r=j.children.length;r>4&&j.setAttribute("data-total",r-4),j.setAttribute("data-number",r>4?4:r)}var V=document.createElement("div");if(V.classList.add("jslider-counter"),j.children.length>0)for(var ne=0;ne<j.children.length;ne++){p.options.items.push(j.children[ne]);var ee=document.createElement("div");ee.onclick=function(){var ae=Array.prototype.slice.call(V.children).indexOf(this);p.show(p.currentImage=p.options.items[ae])},V.appendChild(ee)}var H=document.createElement("div");H.className="jslider-caption";var O=document.createElement("div"),U=document.createElement("div");U.className="jslider-close",U.innerHTML="",U.onclick=function(){p.close()},O.appendChild(H),O.appendChild(U)}p.updateCounter=function(ae){for(var he=0;he<V.children.length;he++)if(V.children[he].classList.contains("jslider-counter-focus")){V.children[he].classList.remove("jslider-counter-focus");break}V.children[ae].classList.add("jslider-counter-focus")},p.show=function(ae){if(!ae)var ae=j.children[0];j.classList.add("jslider-focus"),j.classList.remove("jslider-grid"),j.appendChild(O),j.appendChild(V);var he=p.options.items.indexOf(ae);p.updateCounter(he);for(var pe=0;pe<j.children.length;pe++)j.children[pe].style.display="";ae.style.display="block",ae.previousElementSibling?j.classList.add("jslider-left"):j.classList.remove("jslider-left"),ae.nextElementSibling&&ae.nextElementSibling.tagName=="IMG"?j.classList.add("jslider-right"):j.classList.remove("jslider-right"),p.currentImage=ae,p.currentImage.offsetHeight>p.currentImage.offsetWidth&&p.currentImage.classList.add("jslider-vertical"),O.children[0].innerText=p.currentImage.getAttribute("title")},p.open=function(){p.show(),typeof p.options.onopen=="function"&&p.options.onopen(j)},p.close=function(){j.classList.remove("jslider-focus"),j.classList.remove("jslider-left"),j.classList.remove("jslider-right"),p.options.grid&&j.classList.add("jslider-grid");for(var ae=0;ae<j.children.length;ae++)j.children[ae].style.display="";V.remove(),O.remove(),p.currentImage=null,typeof p.options.onclose=="function"&&p.options.onclose(j)},p.reset=function(){j.innerHTML=""},p.next=function(){var ae=p.currentImage.nextElementSibling;ae&&ae.tagName==="IMG"&&p.show(p.currentImage.nextElementSibling)},p.prev=function(){p.currentImage.previousElementSibling&&p.show(p.currentImage.previousElementSibling)};var Q=function(ae){if(ae.target.tagName=="IMG")p.show(ae.target);else if(!ae.target.classList.contains("jslider-close")&&!(ae.target.parentNode.classList.contains("jslider-counter")||ae.target.classList.contains("jslider-counter"))){var he=ae.offsetX||ae.changedTouches[0].clientX;ae.target.clientWidth-he<40?p.next():he<40&&p.prev()}};return"ontouchend"in document.documentElement?j.addEventListener("touchend",Q):j.addEventListener("mouseup",Q),j.addEventListener("swipeleft",function(ae){p.next(),ae.preventDefault(),ae.stopPropagation()}),j.addEventListener("swiperight",function(ae){p.prev(),ae.preventDefault(),ae.stopPropagation()}),j.addEventListener("keydown",function(ae){ae.which==27&&p.close()}),j.slider=p,p}function It(j,T){if(j.tags)return j.tags.setOptions(T,!0);var p={type:"tags"};p.options={};var r=function(){return!!(p.options.limit&&j.children.length>=p.options.limit)},V=null,ne=null;p.setOptions=function(re,ve){var Le={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var X in Le)re&&re.hasOwnProperty(X)?p.options[X]=re[X]:(typeof p.options[X]>"u"||ve===!0)&&(p.options[X]=Le[X]);return p.options.placeholder?j.setAttribute("data-placeholder",p.options.placeholder):j.removeAttribute("data-placeholder"),j.placeholder=p.options.placeholder,p.setValue(p.options.value),U(),p.options.search?ne||(ne=document.createElement("div"),j.parentNode.insertBefore(ne,j.nextSibling),V=Et(ne,{data:p.options.search,onselect:function(Z,E,F){p.selectIndex(E,F)}})):ne&&(V=null,ne.remove(),ne=null),p},p.add=function(re,ve){if(typeof p.options.onbeforechange=="function"){var Le=p.options.onbeforechange(j,p,p.options.value,re);if(Le===!1)return!1;Le!=null&&(re=Le)}if(V&&V.close(),r())typeof p.options.onlimit=="function"?p.options.onlimit(p,p.options.limit):alert(a.translate("You reach the limit number of entries")+" "+p.options.limit);else{var X=l.getNode();if(X&&X.parentNode&&X.parentNode.classList.contains("jtags")&&X.nextSibling&&!(X.nextSibling.innerText&&X.nextSibling.innerText.trim()))Z=X.nextSibling;else{if(j.lastChild&&(j.lastChild.innerText.trim()||j.removeChild(j.lastChild)),!re||typeof re=="string")var Z=H(re,re,X);else for(var E=0;E<=re.length;E++)if(!r()){if(!re[E]||typeof re[E]=="string")var F=re[E]||"",J=null;else var F=re[E].text,J=re[E].value;var Z=H(F,J)}O()}ve&&ee(Z)}},p.setLimit=function(re){for(p.options.limit=re,j.children.length-re;j.children.length>re;)j.removeChild(j.lastChild)},p.remove=function(re){re.parentNode.removeChild(re),j.children.length?O():p.add("",!0),typeof p.options.onremoveitem=="function"&&p.options.onremoveitem(j,p,re)},p.getData=function(){for(var re=[],ve=0;ve<j.children.length;ve++){var Le=j.children[ve].innerText.replace(`
`,""),X=j.children[ve].getAttribute("data-value");X||(X=Le),(Le||X)&&re.push({text:Le,value:X})}return re},p.getValue=function(re){var ve=null;if(re!=null)ve=j.children[re].getAttribute("data-value"),ve||(ve=j.children[re].innerText.replace(`
`,""));else{for(var Le=[],X=0;X<j.children.length;X++)ve=j.children[X].innerText.replace(`
`,""),ve&&Le.push(p.getValue(X));ve=Le.join(",")}return ve},p.setValue=function(re){if(!re)p.reset();else if(j.value!=re)if(Array.isArray(re))p.add(re);else{var ve=(""+re).trim(),Le=ae(ve);j.innerHTML="",p.add(Le)}},p.reset=function(){j.classList.add("jtags-empty"),j.innerHTML="<div></div>",O()},p.isValid=function(){for(var re=0,ve=0;ve<j.children.length;ve++)j.children[ve].classList.contains("jtags_error")&&re++;return re==0},p.selectIndex=function(re,ve){var Le=l.getNode();Le&&(Le.innerText=re,ve&&Le.setAttribute("data-value",ve),Le.classList.remove("jtags_error"),r()||p.add("",!0))},p.search=function(re){re.innerText},p.destroy=function(){j.removeEventListener("mouseup",Oe),j.removeEventListener("keydown",pe),j.removeEventListener("keyup",be),j.removeEventListener("paste",Te),j.removeEventListener("focus",De),j.removeEventListener("blur",qe),j.parentNode.removeChild(j)};var ee=function(re){if(j.children.length){var ve=document.createRange(),Le=window.getSelection();if(!re)var re=j.childNodes[j.childNodes.length-1];ve.setStart(re,re.length),ve.collapse(!0),Le.removeAllRanges(),Le.addRange(ve),j.scrollLeft=j.scrollWidth}},H=function(re,ve,Le){var X=document.createElement("div");return X.textContent=re||"",ve&&X.setAttribute("data-value",ve),Le&&Le.parentNode.classList.contains("jtags")?j.insertBefore(X,Le.nextSibling):j.appendChild(X),X},O=function(){var re=p.getValue();re!=p.options.value&&(p.options.value=re,typeof p.options.onchange=="function"&&p.options.onchange(j,p,p.options.value),j.value!=p.options.value&&(j.value=p.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value}))),U()},U=function(){for(var re=0;re<j.children.length;re++)j.children[re].tagName==="DIV"&&(p.getValue(re)?(j.children[re].classList.add("jtags_label"),typeof p.options.validation=="function"&&p.getValue(re)?p.options.validation(j.children[re],j.children[re].innerText,j.children[re].getAttribute("data-value"))?j.children[re].classList.remove("jtags_error"):j.children[re].classList.add("jtags_error"):j.children[re].classList.remove("jtags_error")):j.children[re].classList.remove("jtags_label"));Q()},Q=function(){j.innerText.trim()?j.classList.remove("jtags-empty"):(!j.children.length||j.children[0].tagName==="BR")&&(j.innerHTML="",ee(H()))},ae=function(re){var ve=[],Le="";if(re=re.trim(),re){for(var X=0;X<re.length;X++)re[X]==","||re[X]==";"||re[X]==`
`?Le&&(ve.push(Le.trim()),Le=""):Le+=re[X];Le&&ve.push(Le)}return ve},he=0,pe=function(re){if(he=window.getSelection().anchorOffset,Q(),re.key==="Tab"||re.key===";"||re.key===","){var ve=window.getSelection().anchorOffset;ve>1&&(r()?typeof p.options.onlimit=="function"&&p.options.onlimit(p,p.options.limit):p.add("",!0)),re.preventDefault()}else if(re.key=="Enter"){if(!V||!V.isOpened()){var ve=window.getSelection().anchorOffset;ve>1&&(r()||p.add("",!0)),re.preventDefault()}}else re.key=="Backspace"&&j.children.length==1&&window.getSelection().anchorOffset<1&&re.preventDefault();V&&V.keydown(re),Q()},be=function(re){if(re.which==39){var ve=window.getSelection().anchorOffset;ve>1&&ve==he&&p.add("",!0)}else re.which==13||re.which==38||re.which==40?re.preventDefault():V&&V.keyup(re);U()},Te=function(re){if(re.clipboardData||re.originalEvent.clipboardData)var ve=(re.originalEvent||re).clipboardData.getData("text/plain");else if(window.clipboardData)var ve=window.clipboardData.getData("Text");var Le=ae(ve);if(typeof p.options.onbeforepaste=="function"){var X=p.options.onbeforepaste(j,p,Le);if(X===!1)return re.preventDefault(),!1;X&&(Le=X)}Le.length>1?(p.add(Le,!0),re.preventDefault()):Le[0]&&(document.execCommand("insertText",!1,Le[0]),re.preventDefault())},Oe=function(re){if(re.target.parentNode&&re.target.parentNode.classList.contains("jtags")&&(re.target.classList.contains("jtags_label")||re.target.classList.contains("jtags_error"))){var ve=re.target.getBoundingClientRect();ve.width-(re.clientX-ve.left)<16&&p.remove(re.target)}re.target==j&&ee()},De=function(){j.classList.contains("jtags-focus")||((!j.children.length||p.getValue(j.children.length-1))&&(r()||H("")),typeof p.options.onfocus=="function"&&p.options.onfocus(j,p,p.getValue()),j.classList.add("jtags-focus"))},qe=function(){if(j.classList.contains("jtags-focus")){V&&V.close();for(var re=0;re<j.children.length-1;re++)p.getValue(re)||j.removeChild(j.children[re]);O(),j.classList.remove("jtags-focus"),typeof p.options.onblur=="function"&&p.options.onblur(j,p,p.getValue())}},We=function(){"touchend"in document.documentElement?j.addEventListener("touchend",Oe):j.addEventListener("mouseup",Oe),j.addEventListener("keydown",pe),j.addEventListener("keyup",be),j.addEventListener("paste",Te),j.addEventListener("focus",De),j.addEventListener("blur",qe),j.setAttribute("contenteditable",!0),j.classList.add("jtags"),p.setOptions(T),typeof p.options.onload=="function"&&p.options.onload(j,p),j.change=p.setValue,j.val=function(re){if(re===void 0)return p.getValue();p.setValue(re)},j.tags=p};return We(),p}function Tt(j,T){var p={};p.options={};var r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var V in r)T&&T.hasOwnProperty(V)?p.options[V]=T[V]:p.options[V]=r[V];p.options.multiple==!0&&j.setAttribute("data-multiple",!0),j.content=[],j.classList.add("jupload"),p.options.input==!0&&j.classList.add("input"),p.add=function(O){if(p.options.multiple==!1&&(j.content=[],j.innerText=""),p.options.type=="image"){var U=document.createElement("img");U.setAttribute("src",O.file),U.setAttribute("tabindex",-1),j.getAttribute("name")||(U.className="jfile",U.content=O),j.appendChild(U)}else{if(O.name)var Q=O.name;else var Q=O.file;var ae=document.createElement("div");ae.innerText=Q||p.options.type,ae.classList.add("jupload-item"),ae.setAttribute("tabindex",-1),j.appendChild(ae)}O.content&&(O.file=l.guid()),j.content.push(O),typeof p.options.onchange=="function"&&p.options.onchange(j,O)},p.addFromFile=function(O){var U=O.type.split("/");if(U[0]==p.options.type){var Q=new FileReader;Q.addEventListener("load",function(ae){var he={file:ae.srcElement.result,extension:O.name.substr(O.name.lastIndexOf(".")+1),name:O.name,size:O.size,lastmodified:O.lastModified,content:ae.srcElement.result};p.add(he)}),Q.readAsDataURL(O)}else alert(a.translate("This extension is not allowed"))},p.addFromUrl=function(O){if(O.substr(0,4)!="data"&&!p.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(O.substr(0,4)=="data"){var U=O.split(";");U=U[0].split("/");var Q=U[0].replace("data:","");if(Q==p.options.type){var ae={file:O,name:"",extension:U[1],content:O};p.add(ae)}else alert(p.options.text.extensionNotAllowed)}else{var U=O.substr(O.lastIndexOf(".")+1);O=p.options.remoteParser+O,L({url:O,type:"GET",dataType:"blob",success:function(pe){}})}};var ne=p.options.type+"/"+p.options.extension,ee=document.createElement("input");ee.type="file",ee.setAttribute("accept",ne),ee.onchange=function(){for(var O=0;O<this.files.length;O++)p.addFromFile(this.files[O])},p.options.multiple==!0&&ee.setAttribute("multiple",!0);var H=null;return j.addEventListener("click",function(O){H=null,!j.children.length||O.target===j?l.click(ee):O.target.parentNode==j&&(H=O.target)}),j.addEventListener("dblclick",function(O){l.click(ee)}),j.addEventListener("dragenter",function(O){j.style.border="1px dashed #000"}),j.addEventListener("dragleave",function(O){j.style.border="1px solid #eee"}),j.addEventListener("dragstop",function(O){j.style.border="1px solid #eee"}),j.addEventListener("dragover",function(O){O.preventDefault()}),j.addEventListener("keydown",function(O){if(H&&O.which==46){var U=Array.prototype.indexOf.call(j.children,H);U>=0&&(j.content.splice(U,1),H.remove(),H=null)}}),j.addEventListener("drop",function(O){O.preventDefault(),O.stopPropagation();var U=(O.originalEvent||O).dataTransfer.getData("text/html"),Q=(O.originalEvent||O).dataTransfer.files;if(Q.length)for(var ae=0;ae<O.dataTransfer.files.length;ae++)p.addFromFile(O.dataTransfer.files[ae]);else if(U){p.options.multiple==!1&&(j.innerText="");let he=[];if(Ne(U,he),he.length)for(var ae=0;ae<he.length;ae++)p.addFromUrl(he[ae])}return j.style.border="1px solid #eee",!1}),j.val=function(O){if(O===void 0)return j.content&&j.content.length?j.content:null;if(j.innerText="",j.content=[],O)if(Array.isArray(O))for(var U=0;U<O.length;U++)typeof O[U]=="string"?p.add({file:O[U]}):p.add(O[U]);else typeof O=="string"&&p.add({file:O})},j.upload=j.image=p,p}var wt=N(195),St=N.n(wt),ct={...a,...l,version:"5.13.3",setExtensions:function(j){if(typeof j=="object")for(var T=Object.keys(j),p=0;p<T.length;p++)ct[T[p]]=j[T[p]]},tracking:I,path:g,sorting:f,lazyLoading:c,ajax:L,animation:k,calendar:ce,color:ge,contextmenu:oe,dropdown:ke,editor:Ie,floating:Pe,form:it,mask:z,modal:ft,notification:Rt,palette:G,picker:Re,progressbar:Mt,rating:Bt,search:Et,slider:Ht,tabs:se,tags:It,toolbar:Se,upload:Tt,validations:Ze};ct.image=Tt,ct.image.create=function(j){var T=document.createElement("img");return T.setAttribute("src",j.file),T.className="jfile",T.setAttribute("tabindex",-1),T.content=j,T},ct.tracker=it,ct.loading=k.loading,ct.sha512=St(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const j=function(re,ve){return re[ve.type]&&re[ve.type]==ve||re.component&&re.component==ve?!0:re.parentNode?j(re.parentNode,ve):!1},T=function(re){let ve=window.jSuitesStateControl;if(ve&&ve.length>0)for(let Le=0;Le<ve.length;Le++)ve[Le]&&!j(re,ve[Le])&&ve[Le].close()};let p=15,r=!1,V={x:null,y:null},ne=document.createElement("div");ne.classList.add("jtooltip");const ee=function(re){return re&&(re.shadowRoot||re.tagName&&re.tagName.includes("-"))},H=function(re){let ve,Le,X=re.path||re.composedPath&&re.composedPath();return X?(Le=X[0],Le&&ee(Le)&&!Le.shadowRoot&&re.toElement&&(Le=re.toElement)):(re.target&&ee(re.target)?ve=re.target.shadowRoot:ve=document,Le=ve.elementFromPoint(x,y)),Le},O=function(re){if(re.changedTouches&&re.changedTouches[0])var ve=re.changedTouches[0].clientX,Le=re.changedTouches[0].clientY;else var ve=re.clientX,Le=re.clientY;let X=H(re),Z=X&&X.tagName==="DIV"&&X.getAttribute("contentEditable"),E=ct.findElement(X,"jpanel");if(E&&!E.classList.contains("readonly")&&!Z){let F=E.getBoundingClientRect(),J=0;E.style.rotate&&(J=parseFloat(E.style.rotate));let de="move";X.getAttribute("data-action")?de=X.getAttribute("data-action"):E.style.cursor?de="resize":E.style.cursor="move",r={action:de,a:J,e:E,x:ve,y:Le,l:F.left,t:F.top,b:F.bottom,r:F.right,w:F.width,h:F.height,d:E.style.cursor,actioned:!1},E.style.width||(E.style.width=F.width+"px"),E.style.height||(E.style.height=F.height+"px")}else r=!1;T(X),be(re)},U=function(re,ve,Le,X,Z,E){const F=Le-re,J=X-ve,de=Z-re,K=E-ve;let fe=Math.atan2(J,F),te=Math.atan2(K,de)-fe;return te=te*(180/Math.PI),te<0&&(te+=360),te},Q=function(re){r&&r.e&&(typeof r.e.refresh=="function"&&V.actioned&&r.e.refresh(),r.e.style.cursor=""),V={x:null,y:null},r=!1},ae=function(re){if(r){let E=re.clientX||re.pageX,F=re.clientY||re.pageY;if(V.x==null&&V.y==null&&(V.x=E,V.y=F),r.action==="move"){var ve=E-V.x,Le=F-V.y,X=r.e.offsetTop+Le,Z=r.e.offsetLeft+ve;r.e.style.top=X+"px",r.e.style.left=Z+"px",typeof r.e.refresh=="function"&&(V.actioned=!0,r.e.refresh("position",X,Z))}else if(r.action==="rotate"){let J=r.l+r.w/2,de=r.t+r.h/2,K=U(J,de,r.x,r.y,E,F);K=K+r.a%360,K=Math.round(K/2)*2,r.e.style.rotate=`${K}deg`,typeof r.e.refresh=="function"&&(V.actioned=!0,r.e.refresh("rotate",K))}else if(r.action==="resize"){let J=null,de=null,K=null,fe=null;r.d=="e-resize"||r.d=="ne-resize"||r.d=="se-resize"?(K=r.e.offsetWidth+(E-V.x),re.shiftKey&&(fe=r.e.offsetHeight+(E-V.x)*(r.e.offsetHeight/r.e.offsetWidth))):(r.d==="w-resize"||r.d=="nw-resize"||r.d=="sw-resize")&&(de=r.e.offsetLeft+(E-V.x),K=r.e.offsetLeft+r.e.offsetWidth-de,re.shiftKey&&(fe=r.e.offsetHeight-(E-V.x)*(r.e.offsetHeight/r.e.offsetWidth))),r.d=="s-resize"||r.d=="se-resize"||r.d=="sw-resize"?fe||(fe=r.e.offsetHeight+(F-V.y)):(r.d==="n-resize"||r.d=="ne-resize"||r.d=="nw-resize")&&(J=r.e.offsetTop+(F-V.y),fe=r.e.offsetTop+r.e.offsetHeight-J),J&&(r.e.style.top=J+"px"),de&&(r.e.style.left=de+"px"),K&&(r.e.style.width=K+"px"),fe&&(r.e.style.height=fe+"px"),typeof r.e.refresh=="function"&&(V.actioned=!0,r.e.refresh("dimensions",K,fe))}V.x=E,V.y=F}else{let E=H(re),F=ct.findElement(E,"jpanel");if(F){if(F.classList.contains("jpanel-controls")){let de=E.getAttribute("data-position");de?F.style.cursor=de:F.style.cursor=""}else if(F.getAttribute("tabindex")){let de=F.getBoundingClientRect();re.clientY-de.top<p?de.width-(re.clientX-de.left)<p?F.style.cursor="ne-resize":re.clientX-de.left<p?F.style.cursor="nw-resize":F.style.cursor="n-resize":de.height-(re.clientY-de.top)<p?de.width-(re.clientX-de.left)<p?F.style.cursor="se-resize":re.clientX-de.left<p?F.style.cursor="sw-resize":F.style.cursor="s-resize":de.width-(re.clientX-de.left)<p?F.style.cursor="e-resize":re.clientX-de.left<p?F.style.cursor="w-resize":F.style.cursor=""}}}};let he=["n","ne","e","se","s","sw","w","nw","rotate"];he.forEach(function(re,ve){he[ve]=document.createElement("div"),he[ve].classList.add("jpanel-action"),re==="rotate"?he[ve].setAttribute("data-action","rotate"):(he[ve].setAttribute("data-action","resize"),he[ve].setAttribute("data-position",re+"-resize"))});let pe;const be=function(re){let ve=H(re),Le=ct.findElement(ve,"jpanel");Le&&!Le.classList.contains("readonly")&&Le.classList.contains("jpanel-controls")?(Le.append(...he),Le.classList.contains("jpanel-rotate")||he[he.length-1].remove(),pe=Le):Te()},Te=function(re){pe&&(he.forEach(function(ve){ve.remove()}),pe=null)},Oe=function(re){var Le=H(re).getAttribute("data-tooltip");if(Le){if(ne.innerText=Le,re.changedTouches&&re.changedTouches[0])var X=re.changedTouches[0].clientX,Z=re.changedTouches[0].clientY;else var X=re.clientX,Z=re.clientY;ne.style.top=Z+"px",ne.style.left=X+"px",document.body.appendChild(ne)}else ne.innerText&&(ne.innerText="",document.body.removeChild(ne))},De=function(re){var ve=document.activeElement;if(ve&&typeof ve.contextmenu=="function")ve.contextmenu(re),re.preventDefault(),re.stopImmediatePropagation();else if(ve=ct.findElement(re.target,function(X){return X.tagName&&X.getAttribute("aria-contextmenu-id")}),ve){var Le=document.querySelector("#"+ve);Le?(Le.contextmenu.open(re),re.preventDefault(),re.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+ve)}},qe=function(re){let ve=document.activeElement;ve&&re.key==="Delete"&&typeof ve.delete=="function"&&(ve.delete(),re.preventDefault(),re.stopImmediatePropagation());let Le=window.jSuitesStateControl;Le&&Le.length>0&&(ve=Le[Le.length-1],ve&&re.key==="Escape"&&typeof ve.isOpened=="function"&&typeof ve.close=="function"&&ve.isOpened()&&(ve.close(),re.preventDefault(),re.stopImmediatePropagation()))},We=function(re){(re.target.getAttribute("data-mask")||re.target.mask)&&ct.mask(re)};document.addEventListener("focusin",be),document.addEventListener("mouseup",Q),document.addEventListener("mousedown",O),document.addEventListener("mousemove",ae),document.addEventListener("mouseover",Oe),document.addEventListener("keydown",qe),document.addEventListener("contextmenu",De),document.addEventListener("input",We)}();var gt=ct})(),o=W.default}(),o})}(jsuites)),jsuites.exports}var dist={exports:{}},hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(n,h){(function(o,d){n.exports=d()})(commonjsGlobal,function(){var o;return function(){var d={765:function(R,m){var a;a=function(v){v.version="1.0.2";var I=Math;function A(ue,oe){for(var xe=0,ke=0;xe<ue.length;++xe)ke=oe*ke+ue[xe];return ke}function l(ue,oe,xe,ke,Re){if(oe===0)return xe;if(oe===1)return ke;for(var Se=2/ue,$e=ke,Y=1;Y<oe;++Y)$e=ke*Y*Se+Re*xe,xe=ke,ke=$e;return $e}function s(ue,oe,xe,ke,Re){return function(Se,$e){if(ke){if(Se===0)return ke==1?-1/0:1/0;if(Se<0)return NaN}return $e===0?ue(Se):$e===1?oe(Se):$e<0?NaN:l(Se,$e|=0,ue(Se),oe(Se),Re)}}var g,f,c,w,L,S,k,_,M,B,z,q,ce,me=function(){var ue=.636619772,oe=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),xe=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),ke=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Re=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Se(Ne){var Ce=0,Ie=0,Be=0,Pe=Ne*Ne;if(Ne<8)Ce=(Ie=A(oe,Pe))/(Be=A(xe,Pe));else{var ze=Ne-.785398164;Ie=A(ke,Pe=64/Pe),Be=A(Re,Pe),Ce=I.sqrt(ue/Ne)*(I.cos(ze)*Ie-I.sin(ze)*Be*8/Ne)}return Ce}var $e=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),Y=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Ae=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Fe=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function rt(Ne){var Ce=0,Ie=0,Be=0,Pe=Ne*Ne,ze=I.abs(Ne)-2.356194491;return Math.abs(Ne)<8?Ce=(Ie=Ne*A($e,Pe))/(Be=A(Y,Pe)):(Ie=A(Ae,Pe=64/Pe),Be=A(Fe,Pe),Ce=I.sqrt(ue/I.abs(Ne))*(I.cos(ze)*Ie-I.sin(ze)*Be*8/I.abs(Ne)),Ne<0&&(Ce=-Ce)),Ce}return function Ne(Ce,Ie){if(Ie=Math.round(Ie),!isFinite(Ce))return isNaN(Ce)?Ce:0;if(Ie<0)return(Ie%2?-1:1)*Ne(Ce,-Ie);if(Ce<0)return(Ie%2?-1:1)*Ne(-Ce,Ie);if(Ie===0)return Se(Ce);if(Ie===1)return rt(Ce);if(Ce===0)return 0;var Be=0;if(Ce>Ie)Be=l(Ce,Ie,Se(Ce),rt(Ce),-1);else{for(var Pe=!1,ze=0,Ze=0,et=1,it=0,dt=2/Ce,ft=2*I.floor((Ie+I.floor(I.sqrt(40*Ie)))/2);ft>0;ft--)it=ft*dt*et-ze,ze=et,et=it,I.abs(et)>1e10&&(et*=1e-10,ze*=1e-10,Be*=1e-10,Ze*=1e-10),Pe&&(Ze+=et),Pe=!Pe,ft==Ie&&(Be=ze);Be/=Ze=2*Ze-et}return Be}}(),G=(g=.636619772,f=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),c=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),w=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),L=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),S=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),k=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),_=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),M=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),s(function(ue){var oe=0,xe=0,ke=0,Re=ue*ue,Se=ue-.785398164;return ue<8?oe=(xe=A(f,Re))/(ke=A(c,Re))+g*me(ue,0)*I.log(ue):(xe=A(w,Re=64/Re),ke=A(L,Re),oe=I.sqrt(g/ue)*(I.sin(Se)*xe+I.cos(Se)*ke*8/ue)),oe},function(ue){var oe=0,xe=0,ke=0,Re=ue*ue,Se=ue-2.356194491;return ue<8?oe=(xe=ue*A(S,Re))/(ke=A(k,Re))+g*(me(ue,1)*I.log(ue)-1/ue):(xe=A(_,Re=64/Re),ke=A(M,Re),oe=I.sqrt(g/ue)*(I.sin(Se)*xe+I.cos(Se)*ke*8/ue)),oe},0,1,-1)),se=(B=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),z=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),q=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),ce=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function ue(oe,xe){if((xe=Math.round(xe))===0)return function(Fe){return Fe<=3.75?A(B,Fe*Fe/14.0625):I.exp(I.abs(Fe))/I.sqrt(I.abs(Fe))*A(z,3.75/I.abs(Fe))}(oe);if(xe===1)return function(Fe){return Fe<3.75?Fe*A(q,Fe*Fe/14.0625):(Fe<0?-1:1)*I.exp(I.abs(Fe))/I.sqrt(I.abs(Fe))*A(ce,3.75/I.abs(Fe))}(oe);if(xe<0)return NaN;if(I.abs(oe)===0)return 0;if(oe==1/0)return 1/0;var ke,Re=0,Se=2/I.abs(oe),$e=0,Y=1,Ae=0;for(ke=2*I.round((xe+I.round(I.sqrt(40*xe)))/2);ke>0;ke--)Ae=ke*Se*Y+$e,$e=Y,Y=Ae,I.abs(Y)>1e10&&(Y*=1e-10,$e*=1e-10,Re*=1e-10),ke==xe&&(Re=$e);return Re*=ue(oe,0)/Y,oe<0&&xe%2?-Re:Re}),ge=function(){var ue=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),oe=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),xe=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),ke=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return s(function(Re){return Re<=2?-I.log(Re/2)*se(Re,0)+A(ue,Re*Re/4):I.exp(-Re)/I.sqrt(Re)*A(oe,2/Re)},function(Re){return Re<=2?I.log(Re/2)*se(Re,1)+1/Re*A(xe,Re*Re/4):I.exp(-Re)/I.sqrt(Re)*A(ke,2/Re)},0,2,1)}();v.besselj=me,v.bessely=G,v.besseli=se,v.besselk=ge},a(typeof DO_NOT_EXPORT_BESSEL>"u"?m:{})},162:function(R){var m;R.exports=(m=function(a,v){var I=Array.prototype.concat,A=Array.prototype.slice,l=Object.prototype.toString;function s(M,B){var z=M>B?M:B;return a.pow(10,17-~~(a.log(z>0?z:-z)*a.LOG10E))}var g=Array.isArray||function(M){return l.call(M)==="[object Array]"};function f(M){return l.call(M)==="[object Function]"}function c(M){return typeof M=="number"&&M-M==0}function w(){return new w._init(arguments)}function L(){return 0}function S(){return 1}function k(M,B){return M===B?1:0}w.fn=w.prototype,w._init=function(M){if(g(M[0]))if(g(M[0][0])){f(M[1])&&(M[0]=w.map(M[0],M[1]));for(var B=0;B<M[0].length;B++)this[B]=M[0][B];this.length=M[0].length}else this[0]=f(M[1])?w.map(M[0],M[1]):M[0],this.length=1;else if(c(M[0]))this[0]=w.seq.apply(null,M),this.length=1;else{if(M[0]instanceof w)return w(M[0].toArray());this[0]=[],this.length=1}return this},w._init.prototype=w.prototype,w._init.constructor=w,w.utils={calcRdx:s,isArray:g,isFunction:f,isNumber:c,toVector:function(M){return I.apply([],M)}},w._random_fn=a.random,w.setRandom=function(M){if(typeof M!="function")throw new TypeError("fn is not a function");w._random_fn=M},w.extend=function(M){var B,z;if(arguments.length===1){for(z in M)w[z]=M[z];return this}for(B=1;B<arguments.length;B++)for(z in arguments[B])M[z]=arguments[B][z];return M},w.rows=function(M){return M.length||1},w.cols=function(M){return M[0].length||1},w.dimensions=function(M){return{rows:w.rows(M),cols:w.cols(M)}},w.row=function(M,B){return g(B)?B.map(function(z){return w.row(M,z)}):M[B]},w.rowa=function(M,B){return w.row(M,B)},w.col=function(M,B){if(g(B)){var z=w.arange(M.length).map(function(){return new Array(B.length)});return B.forEach(function(me,G){w.arange(M.length).forEach(function(se){z[se][G]=M[se][me]})}),z}for(var q=new Array(M.length),ce=0;ce<M.length;ce++)q[ce]=[M[ce][B]];return q},w.cola=function(M,B){return w.col(M,B).map(function(z){return z[0]})},w.diag=function(M){for(var B=w.rows(M),z=new Array(B),q=0;q<B;q++)z[q]=[M[q][q]];return z},w.antidiag=function(M){for(var B=w.rows(M)-1,z=new Array(B),q=0;B>=0;B--,q++)z[q]=[M[q][B]];return z},w.transpose=function(M){var B,z,q,ce,me,G=[];for(g(M[0])||(M=[M]),z=M.length,q=M[0].length,me=0;me<q;me++){for(B=new Array(z),ce=0;ce<z;ce++)B[ce]=M[ce][me];G.push(B)}return G.length===1?G[0]:G},w.map=function(M,B,z){var q,ce,me,G,se;for(g(M[0])||(M=[M]),ce=M.length,me=M[0].length,G=z?M:new Array(ce),q=0;q<ce;q++)for(G[q]||(G[q]=new Array(me)),se=0;se<me;se++)G[q][se]=B(M[q][se],q,se);return G.length===1?G[0]:G},w.cumreduce=function(M,B,z){var q,ce,me,G,se;for(g(M[0])||(M=[M]),ce=M.length,me=M[0].length,G=z?M:new Array(ce),q=0;q<ce;q++)for(G[q]||(G[q]=new Array(me)),me>0&&(G[q][0]=M[q][0]),se=1;se<me;se++)G[q][se]=B(G[q][se-1],M[q][se]);return G.length===1?G[0]:G},w.alter=function(M,B){return w.map(M,B,!0)},w.create=function(M,B,z){var q,ce,me=new Array(M);for(f(B)&&(z=B,B=M),q=0;q<M;q++)for(me[q]=new Array(B),ce=0;ce<B;ce++)me[q][ce]=z(q,ce);return me},w.zeros=function(M,B){return c(B)||(B=M),w.create(M,B,L)},w.ones=function(M,B){return c(B)||(B=M),w.create(M,B,S)},w.rand=function(M,B){return c(B)||(B=M),w.create(M,B,w._random_fn)},w.identity=function(M,B){return c(B)||(B=M),w.create(M,B,k)},w.symmetric=function(M){var B,z,q=M.length;if(M.length!==M[0].length)return!1;for(B=0;B<q;B++)for(z=0;z<q;z++)if(M[z][B]!==M[B][z])return!1;return!0},w.clear=function(M){return w.alter(M,L)},w.seq=function(M,B,z,q){f(q)||(q=!1);var ce,me=[],G=s(M,B),se=(B*G-M*G)/((z-1)*G),ge=M;for(ce=0;ge<=B&&ce<z;ge=(M*G+se*G*++ce)/G)me.push(q?q(ge,ce):ge);return me},w.arange=function(M,B,z){var q,ce=[];if(z=z||1,B===v&&(B=M,M=0),M===B||z===0)return[];if(M<B&&z<0)return[];if(M>B&&z>0)return[];if(z>0)for(q=M;q<B;q+=z)ce.push(q);else for(q=M;q>B;q+=z)ce.push(q);return ce},w.slice=function(){function M(B,z,q,ce){var me,G=[],se=B.length;if(z===v&&q===v&&ce===v)return w.copy(B);if(ce=ce||1,(z=(z=z||0)>=0?z:se+z)===(q=(q=q||B.length)>=0?q:se+q)||ce===0)return[];if(z<q&&ce<0)return[];if(z>q&&ce>0)return[];if(ce>0)for(me=z;me<q;me+=ce)G.push(B[me]);else for(me=z;me>q;me+=ce)G.push(B[me]);return G}return function(B,z){var q,ce;return c((z=z||{}).row)?c(z.col)?B[z.row][z.col]:M(w.rowa(B,z.row),(q=z.col||{}).start,q.end,q.step):c(z.col)?M(w.cola(B,z.col),(ce=z.row||{}).start,ce.end,ce.step):(ce=z.row||{},q=z.col||{},M(B,ce.start,ce.end,ce.step).map(function(me){return M(me,q.start,q.end,q.step)}))}}(),w.sliceAssign=function(M,B,z){var q,ce;if(c(B.row)){if(c(B.col))return M[B.row][B.col]=z;B.col=B.col||{},B.col.start=B.col.start||0,B.col.end=B.col.end||M[0].length,B.col.step=B.col.step||1,q=w.arange(B.col.start,a.min(M.length,B.col.end),B.col.step);var me=B.row;return q.forEach(function(se,ge){M[me][se]=z[ge]}),M}if(c(B.col)){B.row=B.row||{},B.row.start=B.row.start||0,B.row.end=B.row.end||M.length,B.row.step=B.row.step||1,ce=w.arange(B.row.start,a.min(M[0].length,B.row.end),B.row.step);var G=B.col;return ce.forEach(function(se,ge){M[se][G]=z[ge]}),M}return z[0].length===v&&(z=[z]),B.row.start=B.row.start||0,B.row.end=B.row.end||M.length,B.row.step=B.row.step||1,B.col.start=B.col.start||0,B.col.end=B.col.end||M[0].length,B.col.step=B.col.step||1,ce=w.arange(B.row.start,a.min(M.length,B.row.end),B.row.step),q=w.arange(B.col.start,a.min(M[0].length,B.col.end),B.col.step),ce.forEach(function(se,ge){q.forEach(function(ue,oe){M[se][ue]=z[ge][oe]})}),M},w.diagonal=function(M){var B=w.zeros(M.length,M.length);return M.forEach(function(z,q){B[q][q]=z}),B},w.copy=function(M){return M.map(function(B){return c(B)?B:B.map(function(z){return z})})};var _=w.prototype;return _.length=0,_.push=Array.prototype.push,_.sort=Array.prototype.sort,_.splice=Array.prototype.splice,_.slice=Array.prototype.slice,_.toArray=function(){return this.length>1?A.call(this):A.call(this)[0]},_.map=function(M,B){return w(w.map(this,M,B))},_.cumreduce=function(M,B){return w(w.cumreduce(this,M,B))},_.alter=function(M){return w.alter(this,M),this},function(M){for(var B=0;B<M.length;B++)(function(z){_[z]=function(q){var ce,me=this;return q?(setTimeout(function(){q.call(me,_[z].call(me))}),this):(ce=w[z](this),g(ce)?w(ce):ce)}})(M[B])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(M){for(var B=0;B<M.length;B++)(function(z){_[z]=function(q,ce){var me=this;return ce?(setTimeout(function(){ce.call(me,_[z].call(me,q))}),this):w(w[z](this,q))}})(M[B])}("row col".split(" ")),function(M){for(var B=0;B<M.length;B++)(function(z){_[z]=function(){return w(w[z].apply(null,arguments))}})(M[B])}("create zeros ones rand identity".split(" ")),w}(Math),function(a,v){var I=a.utils.isFunction;function A(g,f){return g-f}function l(g,f,c){return v.max(f,v.min(g,c))}a.sum=function(g){for(var f=0,c=g.length;--c>=0;)f+=g[c];return f},a.sumsqrd=function(g){for(var f=0,c=g.length;--c>=0;)f+=g[c]*g[c];return f},a.sumsqerr=function(g){for(var f,c=a.mean(g),w=0,L=g.length;--L>=0;)w+=(f=g[L]-c)*f;return w},a.sumrow=function(g){for(var f=0,c=g.length;--c>=0;)f+=g[c];return f},a.product=function(g){for(var f=1,c=g.length;--c>=0;)f*=g[c];return f},a.min=function(g){for(var f=g[0],c=0;++c<g.length;)g[c]<f&&(f=g[c]);return f},a.max=function(g){for(var f=g[0],c=0;++c<g.length;)g[c]>f&&(f=g[c]);return f},a.unique=function(g){for(var f={},c=[],w=0;w<g.length;w++)f[g[w]]||(f[g[w]]=!0,c.push(g[w]));return c},a.mean=function(g){return a.sum(g)/g.length},a.meansqerr=function(g){return a.sumsqerr(g)/g.length},a.geomean=function(g){var f=g.map(v.log),c=a.mean(f);return v.exp(c)},a.median=function(g){var f=g.length,c=g.slice().sort(A);return 1&f?c[f/2|0]:(c[f/2-1]+c[f/2])/2},a.cumsum=function(g){return a.cumreduce(g,function(f,c){return f+c})},a.cumprod=function(g){return a.cumreduce(g,function(f,c){return f*c})},a.diff=function(g){var f,c=[],w=g.length;for(f=1;f<w;f++)c.push(g[f]-g[f-1]);return c},a.rank=function(g){var f,c=[],w={};for(f=0;f<g.length;f++)w[_=g[f]]?w[_]++:(w[_]=1,c.push(_));var L=c.sort(A),S={},k=1;for(f=0;f<L.length;f++){var _,M=w[_=L[f]],B=(k+(k+M-1))/2;S[_]=B,k+=M}return g.map(function(z){return S[z]})},a.mode=function(g){var f,c=g.length,w=g.slice().sort(A),L=1,S=0,k=0,_=[];for(f=0;f<c;f++)w[f]===w[f+1]?L++:(L>S?(_=[w[f]],S=L,k=0):L===S&&(_.push(w[f]),k++),L=1);return k===0?_[0]:_},a.range=function(g){return a.max(g)-a.min(g)},a.variance=function(g,f){return a.sumsqerr(g)/(g.length-(f?1:0))},a.pooledvariance=function(g){return g.reduce(function(f,c){return f+a.sumsqerr(c)},0)/(g.reduce(function(f,c){return f+c.length},0)-g.length)},a.deviation=function(g){for(var f=a.mean(g),c=g.length,w=new Array(c),L=0;L<c;L++)w[L]=g[L]-f;return w},a.stdev=function(g,f){return v.sqrt(a.variance(g,f))},a.pooledstdev=function(g){return v.sqrt(a.pooledvariance(g))},a.meandev=function(g){for(var f=a.mean(g),c=[],w=g.length-1;w>=0;w--)c.push(v.abs(g[w]-f));return a.mean(c)},a.meddev=function(g){for(var f=a.median(g),c=[],w=g.length-1;w>=0;w--)c.push(v.abs(g[w]-f));return a.median(c)},a.coeffvar=function(g){return a.stdev(g)/a.mean(g)},a.quartiles=function(g){var f=g.length,c=g.slice().sort(A);return[c[v.round(f/4)-1],c[v.round(f/2)-1],c[v.round(3*f/4)-1]]},a.quantiles=function(g,f,c,w){var L,S,k,_,M,B=g.slice().sort(A),z=[f.length],q=g.length;for(c===void 0&&(c=.375),w===void 0&&(w=.375),L=0;L<f.length;L++)k=q*(S=f[L])+(c+S*(1-c-w)),_=v.floor(l(k,1,q-1)),M=l(k-_,0,1),z[L]=(1-M)*B[_-1]+M*B[_];return z},a.percentile=function(g,f,c){var w=g.slice().sort(A),L=f*(w.length+(c?1:-1))+(c?0:1),S=parseInt(L),k=L-S;return S+1<w.length?w[S-1]+k*(w[S]-w[S-1]):w[S-1]},a.percentileOfScore=function(g,f,c){var w,L,S=0,k=g.length,_=!1;for(c==="strict"&&(_=!0),L=0;L<k;L++)w=g[L],(_&&w<f||!_&&w<=f)&&S++;return S/k},a.histogram=function(g,f){f=f||4;var c,w=a.min(g),L=(a.max(g)-w)/f,S=g.length,k=[];for(c=0;c<f;c++)k[c]=0;for(c=0;c<S;c++)k[v.min(v.floor((g[c]-w)/L),f-1)]+=1;return k},a.covariance=function(g,f){var c,w=a.mean(g),L=a.mean(f),S=g.length,k=new Array(S);for(c=0;c<S;c++)k[c]=(g[c]-w)*(f[c]-L);return a.sum(k)/(S-1)},a.corrcoeff=function(g,f){return a.covariance(g,f)/a.stdev(g,1)/a.stdev(f,1)},a.spearmancoeff=function(g,f){return g=a.rank(g),f=a.rank(f),a.corrcoeff(g,f)},a.stanMoment=function(g,f){for(var c=a.mean(g),w=a.stdev(g),L=g.length,S=0,k=0;k<L;k++)S+=v.pow((g[k]-c)/w,f);return S/g.length},a.skewness=function(g){return a.stanMoment(g,3)},a.kurtosis=function(g){return a.stanMoment(g,4)-3};var s=a.prototype;(function(g){for(var f=0;f<g.length;f++)(function(c){s[c]=function(w,L){var S=[],k=0,_=this;if(I(w)&&(L=w,w=!1),L)return setTimeout(function(){L.call(_,s[c].call(_,w))}),this;if(this.length>1){for(_=w===!0?this:this.transpose();k<_.length;k++)S[k]=a[c](_[k]);return S}return a[c](this[0],w)}})(g[f])})("cumsum cumprod".split(" ")),function(g){for(var f=0;f<g.length;f++)(function(c){s[c]=function(w,L){var S=[],k=0,_=this;if(I(w)&&(L=w,w=!1),L)return setTimeout(function(){L.call(_,s[c].call(_,w))}),this;if(this.length>1){for(c!=="sumrow"&&(_=w===!0?this:this.transpose());k<_.length;k++)S[k]=a[c](_[k]);return w===!0?a[c](a.utils.toVector(S)):S}return a[c](this[0],w)}})(g[f])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(g){for(var f=0;f<g.length;f++)(function(c){s[c]=function(){var w,L=[],S=0,k=this,_=Array.prototype.slice.call(arguments);if(I(_[_.length-1])){w=_[_.length-1];var M=_.slice(0,_.length-1);return setTimeout(function(){w.call(k,s[c].apply(k,M))}),this}w=void 0;var B=function(z){return a[c].apply(k,[z].concat(_))};if(this.length>1){for(k=k.transpose();S<k.length;S++)L[S]=B(k[S]);return L}return B(this[0])}})(g[f])}("quantiles percentileOfScore".split(" "))}(m,Math),function(a,v){a.gammaln=function(I){var A,l,s,g=0,f=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],c=1.000000000190015;for(s=(l=A=I)+5.5,s-=(A+.5)*v.log(s);g<6;g++)c+=f[g]/++l;return v.log(2.5066282746310007*c/A)-s},a.loggam=function(I){var A,l,s,g,f,c,w,L=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(A=I,w=0,I==1||I==2)return 0;for(I<=7&&(A=I+(w=v.floor(7-I))),l=1/(A*A),s=2*v.PI,f=L[9],c=8;c>=0;c--)f*=l,f+=L[c];if(g=f/A+.5*v.log(s)+(A-.5)*v.log(A)-A,I<=7)for(c=1;c<=w;c++)g-=v.log(A-1),A-=1;return g},a.gammafn=function(I){var A,l,s,g,f=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],c=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],w=!1,L=0,S=0,k=0,_=I;if(I>171.6243769536076)return 1/0;if(_<=0){if(!(g=_%1+36e-17))return 1/0;w=(1&_?-1:1)*v.PI/v.sin(v.PI*g),_=1-_}for(s=_,l=_<1?_++:(_-=L=(0|_)-1)-1,A=0;A<8;++A)k=(k+f[A])*l,S=S*l+c[A];if(g=k/S+1,s<_)g/=s;else if(s>_)for(A=0;A<L;++A)g*=_,_++;return w&&(g=w/g),g},a.gammap=function(I,A){return a.lowRegGamma(I,A)*a.gammafn(I)},a.lowRegGamma=function(I,A){var l,s=a.gammaln(I),g=I,f=1/I,c=f,w=A+1-I,L=1/1e-30,S=1/w,k=S,_=1,M=-~(8.5*v.log(I>=1?I:1/I)+.4*I+17);if(A<0||I<=0)return NaN;if(A<I+1){for(;_<=M;_++)f+=c*=A/++g;return f*v.exp(-A+I*v.log(A)-s)}for(;_<=M;_++)k*=(S=1/(S=(l=-_*(_-I))*S+(w+=2)))*(L=w+l/L);return 1-k*v.exp(-A+I*v.log(A)-s)},a.factorialln=function(I){return I<0?NaN:a.gammaln(I+1)},a.factorial=function(I){return I<0?NaN:a.gammafn(I+1)},a.combination=function(I,A){return I>170||A>170?v.exp(a.combinationln(I,A)):a.factorial(I)/a.factorial(A)/a.factorial(I-A)},a.combinationln=function(I,A){return a.factorialln(I)-a.factorialln(A)-a.factorialln(I-A)},a.permutation=function(I,A){return a.factorial(I)/a.factorial(I-A)},a.betafn=function(I,A){if(!(I<=0||A<=0))return I+A>170?v.exp(a.betaln(I,A)):a.gammafn(I)*a.gammafn(A)/a.gammafn(I+A)},a.betaln=function(I,A){return a.gammaln(I)+a.gammaln(A)-a.gammaln(I+A)},a.betacf=function(I,A,l){var s,g,f,c,w=1e-30,L=1,S=A+l,k=A+1,_=A-1,M=1,B=1-S*I/k;for(v.abs(B)<w&&(B=w),c=B=1/B;L<=100&&(B=1+(g=L*(l-L)*I/((_+(s=2*L))*(A+s)))*B,v.abs(B)<w&&(B=w),M=1+g/M,v.abs(M)<w&&(M=w),c*=(B=1/B)*M,B=1+(g=-(A+L)*(S+L)*I/((A+s)*(k+s)))*B,v.abs(B)<w&&(B=w),M=1+g/M,v.abs(M)<w&&(M=w),c*=f=(B=1/B)*M,!(v.abs(f-1)<3e-7));L++);return c},a.gammapinv=function(I,A){var l,s,g,f,c,w,L=0,S=A-1,k=a.gammaln(A);if(I>=1)return v.max(100,A+100*v.sqrt(A));if(I<=0)return 0;for(A>1?(c=v.log(S),w=v.exp(S*(c-1)-k),f=I<.5?I:1-I,l=(2.30753+.27061*(s=v.sqrt(-2*v.log(f))))/(1+s*(.99229+.04481*s))-s,I<.5&&(l=-l),l=v.max(.001,A*v.pow(1-1/(9*A)-l/(3*v.sqrt(A)),3))):l=I<(s=1-A*(.253+.12*A))?v.pow(I/s,1/A):1-v.log(1-(I-s)/(1-s));L<12;L++){if(l<=0)return 0;if((l-=s=(g=(a.lowRegGamma(A,l)-I)/(s=A>1?w*v.exp(-(l-S)+S*(v.log(l)-c)):v.exp(-l+S*v.log(l)-k)))/(1-.5*v.min(1,g*((A-1)/l-1))))<=0&&(l=.5*(l+s)),v.abs(s)<1e-8*l)break}return l},a.erf=function(I){var A,l,s,g,f=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],c=f.length-1,w=!1,L=0,S=0;for(I<0&&(I=-I,w=!0),l=4*(A=2/(2+I))-2;c>0;c--)s=L,L=l*L-S+f[c],S=s;return g=A*v.exp(-I*I+.5*(f[0]+l*L)-S),w?g-1:1-g},a.erfc=function(I){return 1-a.erf(I)},a.erfcinv=function(I){var A,l,s,g,f=0;if(I>=2)return-100;if(I<=0)return 100;for(g=I<1?I:2-I,A=-.70711*((2.30753+.27061*(s=v.sqrt(-2*v.log(g/2))))/(1+s*(.99229+.04481*s))-s);f<2;f++)A+=(l=a.erfc(A)-g)/(1.1283791670955126*v.exp(-A*A)-A*l);return I<1?A:-A},a.ibetainv=function(I,A,l){var s,g,f,c,w,L,S,k,_,M,B=A-1,z=l-1,q=0;if(I<=0)return 0;if(I>=1)return 1;for(A>=1&&l>=1?(f=I<.5?I:1-I,L=(2.30753+.27061*(c=v.sqrt(-2*v.log(f))))/(1+c*(.99229+.04481*c))-c,I<.5&&(L=-L),S=(L*L-3)/6,k=2/(1/(2*A-1)+1/(2*l-1)),_=L*v.sqrt(S+k)/k-(1/(2*l-1)-1/(2*A-1))*(S+.8333333333333334-2/(3*k)),L=A/(A+l*v.exp(2*_))):(s=v.log(A/(A+l)),g=v.log(l/(A+l)),L=I<(c=v.exp(A*s)/A)/(_=c+(w=v.exp(l*g)/l))?v.pow(A*_*I,1/A):1-v.pow(l*_*(1-I),1/l)),M=-a.gammaln(A)-a.gammaln(l)+a.gammaln(A+l);q<10;q++){if(L===0||L===1)return L;if((L-=c=(w=(a.ibeta(L,A,l)-I)/(c=v.exp(B*v.log(L)+z*v.log(1-L)+M)))/(1-.5*v.min(1,w*(B/L-z/(1-L)))))<=0&&(L=.5*(L+c)),L>=1&&(L=.5*(L+c+1)),v.abs(c)<1e-8*L&&q>0)break}return L},a.ibeta=function(I,A,l){var s=I===0||I===1?0:v.exp(a.gammaln(A+l)-a.gammaln(A)-a.gammaln(l)+A*v.log(I)+l*v.log(1-I));return!(I<0||I>1)&&(I<(A+1)/(A+l+2)?s*a.betacf(I,A,l)/A:1-s*a.betacf(1-I,l,A)/l)},a.randn=function(I,A){var l,s,g,f,c;if(A||(A=I),I)return a.create(I,A,function(){return a.randn()});do l=a._random_fn(),s=1.7156*(a._random_fn()-.5),c=(g=l-.449871)*g+(f=v.abs(s)+.386595)*(.196*f-.25472*g);while(c>.27597&&(c>.27846||s*s>-4*v.log(l)*l*l));return s/l},a.randg=function(I,A,l){var s,g,f,c,w,L,S=I;if(l||(l=A),I||(I=1),A)return(L=a.zeros(A,l)).alter(function(){return a.randg(I)}),L;I<1&&(I+=1),s=I-.3333333333333333,g=1/v.sqrt(9*s);do{do c=1+g*(w=a.randn());while(c<=0);c*=c*c,f=a._random_fn()}while(f>1-.331*v.pow(w,4)&&v.log(f)>.5*w*w+s*(1-c+v.log(c)));if(I==S)return s*c;do f=a._random_fn();while(f===0);return v.pow(f,1/S)*s*c},function(I){for(var A=0;A<I.length;A++)(function(l){a.fn[l]=function(){return a(a.map(this,function(s){return a[l](s)}))}})(I[A])}("gammaln gammafn factorial factorialln".split(" ")),function(I){for(var A=0;A<I.length;A++)(function(l){a.fn[l]=function(){return a(a[l].apply(null,arguments))}})(I[A])}("randn".split(" "))}(m,Math),function(a,v){function I(l,s,g,f){for(var c,w=0,L=1,S=1,k=1,_=0,M=0;v.abs((S-M)/S)>f;)M=S,L=k+(c=-(s+_)*(s+g+_)*l/(s+2*_)/(s+2*_+1))*L,S=(w=S+c*w)+(c=(_+=1)*(g-_)*l/(s+2*_-1)/(s+2*_))*S,w/=k=L+c*k,L/=k,S/=k,k=1;return S/s}function A(l,s,g){var f=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],c=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],w=.5*l;if(w>=8)return 1;var L,S=2*a.normal.cdf(w,0,1,1,0)-1;S=S>=v.exp(-50/g)?v.pow(S,g):0;for(var k=w,_=(8-w)/(L=l>3?2:3),M=k+_,B=0,z=g-1,q=1;q<=L;q++){for(var ce=0,me=.5*(M+k),G=.5*(M-k),se=1;se<=12;se++){var ge,ue=me+G*(6<se?f[(ge=12-se+1)-1]:-f[(ge=se)-1]),oe=ue*ue;if(oe>60)break;var xe=2*a.normal.cdf(ue,0,1,1,0)*.5-2*a.normal.cdf(ue,l,1,1,0)*.5;xe>=v.exp(-30/z)&&(ce+=xe=c[ge-1]*v.exp(-.5*oe)*v.pow(xe,z))}B+=ce*=2*G*g/v.sqrt(2*v.PI),k=M,M+=_}return(S+=B)<=v.exp(-30/s)?0:(S=v.pow(S,s))>=1?1:S}(function(l){for(var s=0;s<l.length;s++)(function(g){a[g]=function f(c,w,L){return this instanceof f?(this._a=c,this._b=w,this._c=L,this):new f(c,w,L)},a.fn[g]=function(f,c,w){var L=a[g](f,c,w);return L.data=this,L},a[g].prototype.sample=function(f){var c=this._a,w=this._b,L=this._c;return f?a.alter(f,function(){return a[g].sample(c,w,L)}):a[g].sample(c,w,L)},function(f){for(var c=0;c<f.length;c++)(function(w){a[g].prototype[w]=function(L){var S=this._a,k=this._b,_=this._c;return L||L===0||(L=this.data),typeof L!="number"?a.fn.map.call(L,function(M){return a[g][w](M,S,k,_)}):a[g][w](L,S,k,_)}})(f[c])}("pdf cdf inv".split(" ")),function(f){for(var c=0;c<f.length;c++)(function(w){a[g].prototype[w]=function(){return a[g][w](this._a,this._b,this._c)}})(f[c])}("mean median mode variance".split(" "))})(l[s])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),a.extend(a.beta,{pdf:function(l,s,g){return l>1||l<0?0:s==1&&g==1?1:s<512&&g<512?v.pow(l,s-1)*v.pow(1-l,g-1)/a.betafn(s,g):v.exp((s-1)*v.log(l)+(g-1)*v.log(1-l)-a.betaln(s,g))},cdf:function(l,s,g){return l>1||l<0?1*(l>1):a.ibeta(l,s,g)},inv:function(l,s,g){return a.ibetainv(l,s,g)},mean:function(l,s){return l/(l+s)},median:function(l,s){return a.ibetainv(.5,l,s)},mode:function(l,s){return(l-1)/(l+s-2)},sample:function(l,s){var g=a.randg(l);return g/(g+a.randg(s))},variance:function(l,s){return l*s/(v.pow(l+s,2)*(l+s+1))}}),a.extend(a.centralF,{pdf:function(l,s,g){var f;return l<0?0:s<=2?l===0&&s<2?1/0:l===0&&s===2?1:1/a.betafn(s/2,g/2)*v.pow(s/g,s/2)*v.pow(l,s/2-1)*v.pow(1+s/g*l,-(s+g)/2):(f=s*l/(g+l*s),s*(g/(g+l*s))/2*a.binomial.pdf((s-2)/2,(s+g-2)/2,f))},cdf:function(l,s,g){return l<0?0:a.ibeta(s*l/(s*l+g),s/2,g/2)},inv:function(l,s,g){return g/(s*(1/a.ibetainv(l,s/2,g/2)-1))},mean:function(l,s){return s>2?s/(s-2):void 0},mode:function(l,s){return l>2?s*(l-2)/(l*(s+2)):void 0},sample:function(l,s){return 2*a.randg(l/2)/l/(2*a.randg(s/2)/s)},variance:function(l,s){if(!(s<=4))return 2*s*s*(l+s-2)/(l*(s-2)*(s-2)*(s-4))}}),a.extend(a.cauchy,{pdf:function(l,s,g){return g<0?0:g/(v.pow(l-s,2)+v.pow(g,2))/v.PI},cdf:function(l,s,g){return v.atan((l-s)/g)/v.PI+.5},inv:function(l,s,g){return s+g*v.tan(v.PI*(l-.5))},median:function(l){return l},mode:function(l){return l},sample:function(l,s){return a.randn()*v.sqrt(1/(2*a.randg(.5)))*s+l}}),a.extend(a.chisquare,{pdf:function(l,s){return l<0?0:l===0&&s===2?.5:v.exp((s/2-1)*v.log(l)-l/2-s/2*v.log(2)-a.gammaln(s/2))},cdf:function(l,s){return l<0?0:a.lowRegGamma(s/2,l/2)},inv:function(l,s){return 2*a.gammapinv(l,.5*s)},mean:function(l){return l},median:function(l){return l*v.pow(1-2/(9*l),3)},mode:function(l){return l-2>0?l-2:0},sample:function(l){return 2*a.randg(l/2)},variance:function(l){return 2*l}}),a.extend(a.exponential,{pdf:function(l,s){return l<0?0:s*v.exp(-s*l)},cdf:function(l,s){return l<0?0:1-v.exp(-s*l)},inv:function(l,s){return-v.log(1-l)/s},mean:function(l){return 1/l},median:function(l){return 1/l*v.log(2)},mode:function(){return 0},sample:function(l){return-1/l*v.log(a._random_fn())},variance:function(l){return v.pow(l,-2)}}),a.extend(a.gamma,{pdf:function(l,s,g){return l<0?0:l===0&&s===1?1/g:v.exp((s-1)*v.log(l)-l/g-a.gammaln(s)-s*v.log(g))},cdf:function(l,s,g){return l<0?0:a.lowRegGamma(s,l/g)},inv:function(l,s,g){return a.gammapinv(l,s)*g},mean:function(l,s){return l*s},mode:function(l,s){if(l>1)return(l-1)*s},sample:function(l,s){return a.randg(l)*s},variance:function(l,s){return l*s*s}}),a.extend(a.invgamma,{pdf:function(l,s,g){return l<=0?0:v.exp(-(s+1)*v.log(l)-g/l-a.gammaln(s)+s*v.log(g))},cdf:function(l,s,g){return l<=0?0:1-a.lowRegGamma(s,g/l)},inv:function(l,s,g){return g/a.gammapinv(1-l,s)},mean:function(l,s){return l>1?s/(l-1):void 0},mode:function(l,s){return s/(l+1)},sample:function(l,s){return s/a.randg(l)},variance:function(l,s){if(!(l<=2))return s*s/((l-1)*(l-1)*(l-2))}}),a.extend(a.kumaraswamy,{pdf:function(l,s,g){return l===0&&s===1?g:l===1&&g===1?s:v.exp(v.log(s)+v.log(g)+(s-1)*v.log(l)+(g-1)*v.log(1-v.pow(l,s)))},cdf:function(l,s,g){return l<0?0:l>1?1:1-v.pow(1-v.pow(l,s),g)},inv:function(l,s,g){return v.pow(1-v.pow(1-l,1/g),1/s)},mean:function(l,s){return s*a.gammafn(1+1/l)*a.gammafn(s)/a.gammafn(1+1/l+s)},median:function(l,s){return v.pow(1-v.pow(2,-1/s),1/l)},mode:function(l,s){if(l>=1&&s>=1&&l!==1&&s!==1)return v.pow((l-1)/(l*s-1),1/l)},variance:function(){throw new Error("variance not yet implemented")}}),a.extend(a.lognormal,{pdf:function(l,s,g){return l<=0?0:v.exp(-v.log(l)-.5*v.log(2*v.PI)-v.log(g)-v.pow(v.log(l)-s,2)/(2*g*g))},cdf:function(l,s,g){return l<0?0:.5+.5*a.erf((v.log(l)-s)/v.sqrt(2*g*g))},inv:function(l,s,g){return v.exp(-1.4142135623730951*g*a.erfcinv(2*l)+s)},mean:function(l,s){return v.exp(l+s*s/2)},median:function(l){return v.exp(l)},mode:function(l,s){return v.exp(l-s*s)},sample:function(l,s){return v.exp(a.randn()*s+l)},variance:function(l,s){return(v.exp(s*s)-1)*v.exp(2*l+s*s)}}),a.extend(a.noncentralt,{pdf:function(l,s,g){return v.abs(g)<1e-14?a.studentt.pdf(l,s):v.abs(l)<1e-14?v.exp(a.gammaln((s+1)/2)-g*g/2-.5*v.log(v.PI*s)-a.gammaln(s/2)):s/l*(a.noncentralt.cdf(l*v.sqrt(1+2/s),s+2,g)-a.noncentralt.cdf(l,s,g))},cdf:function(l,s,g){var f=1e-14;if(v.abs(g)<f)return a.studentt.cdf(l,s);var c=!1;l<0&&(c=!0,g=-g);for(var w=a.normal.cdf(-g,0,1),L=f+1,S=L,k=l*l/(l*l+s),_=0,M=v.exp(-g*g/2),B=v.exp(-g*g/2-.5*v.log(2)-a.gammaln(1.5))*g;_<200||S>f||L>f;)S=L,_>0&&(M*=g*g/(2*_),B*=g*g/(2*(_+.5))),w+=.5*(L=M*a.beta.cdf(k,_+.5,s/2)+B*a.beta.cdf(k,_+1,s/2)),_++;return c?1-w:w}}),a.extend(a.normal,{pdf:function(l,s,g){return v.exp(-.5*v.log(2*v.PI)-v.log(g)-v.pow(l-s,2)/(2*g*g))},cdf:function(l,s,g){return .5*(1+a.erf((l-s)/v.sqrt(2*g*g)))},inv:function(l,s,g){return-1.4142135623730951*g*a.erfcinv(2*l)+s},mean:function(l){return l},median:function(l){return l},mode:function(l){return l},sample:function(l,s){return a.randn()*s+l},variance:function(l,s){return s*s}}),a.extend(a.pareto,{pdf:function(l,s,g){return l<s?0:g*v.pow(s,g)/v.pow(l,g+1)},cdf:function(l,s,g){return l<s?0:1-v.pow(s/l,g)},inv:function(l,s,g){return s/v.pow(1-l,1/g)},mean:function(l,s){if(!(s<=1))return s*v.pow(l,s)/(s-1)},median:function(l,s){return l*(s*v.SQRT2)},mode:function(l){return l},variance:function(l,s){if(!(s<=2))return l*l*s/(v.pow(s-1,2)*(s-2))}}),a.extend(a.studentt,{pdf:function(l,s){return s=s>1e100?1e100:s,1/(v.sqrt(s)*a.betafn(.5,s/2))*v.pow(1+l*l/s,-(s+1)/2)},cdf:function(l,s){var g=s/2;return a.ibeta((l+v.sqrt(l*l+s))/(2*v.sqrt(l*l+s)),g,g)},inv:function(l,s){var g=a.ibetainv(2*v.min(l,1-l),.5*s,.5);return g=v.sqrt(s*(1-g)/g),l>.5?g:-g},mean:function(l){return l>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(l){return a.randn()*v.sqrt(l/(2*a.randg(l/2)))},variance:function(l){return l>2?l/(l-2):l>1?1/0:void 0}}),a.extend(a.weibull,{pdf:function(l,s,g){return l<0||s<0||g<0?0:g/s*v.pow(l/s,g-1)*v.exp(-v.pow(l/s,g))},cdf:function(l,s,g){return l<0?0:1-v.exp(-v.pow(l/s,g))},inv:function(l,s,g){return s*v.pow(-v.log(1-l),1/g)},mean:function(l,s){return l*a.gammafn(1+1/s)},median:function(l,s){return l*v.pow(v.log(2),1/s)},mode:function(l,s){return s<=1?0:l*v.pow((s-1)/s,1/s)},sample:function(l,s){return l*v.pow(-v.log(a._random_fn()),1/s)},variance:function(l,s){return l*l*a.gammafn(1+2/s)-v.pow(a.weibull.mean(l,s),2)}}),a.extend(a.uniform,{pdf:function(l,s,g){return l<s||l>g?0:1/(g-s)},cdf:function(l,s,g){return l<s?0:l<g?(l-s)/(g-s):1},inv:function(l,s,g){return s+l*(g-s)},mean:function(l,s){return .5*(l+s)},median:function(l,s){return a.mean(l,s)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(l,s){return l/2+s/2+(s/2-l/2)*(2*a._random_fn()-1)},variance:function(l,s){return v.pow(s-l,2)/12}}),a.extend(a.binomial,{pdf:function(l,s,g){return g===0||g===1?s*g===l?1:0:a.combination(s,l)*v.pow(g,l)*v.pow(1-g,s-l)},cdf:function(l,s,g){var f,c=1e-10;if(l<0)return 0;if(l>=s)return 1;if(g<0||g>1||s<=0)return NaN;var w=g,L=(l=v.floor(l))+1,S=s-l,k=L+S,_=v.exp(a.gammaln(k)-a.gammaln(S)-a.gammaln(L)+L*v.log(w)+S*v.log(1-w));return f=w<(L+1)/(k+2)?_*I(w,L,S,c):1-_*I(1-w,S,L,c),v.round(1/c*(1-f))/(1/c)}}),a.extend(a.negbin,{pdf:function(l,s,g){return l===l>>>0&&(l<0?0:a.combination(l+s-1,s-1)*v.pow(1-g,l)*v.pow(g,s))},cdf:function(l,s,g){var f=0,c=0;if(l<0)return 0;for(;c<=l;c++)f+=a.negbin.pdf(c,s,g);return f}}),a.extend(a.hypgeom,{pdf:function(l,s,g,f){if(l!=l|0)return!1;if(l<0||l<g-(s-f)||l>f||l>g)return 0;if(2*g>s)return 2*f>s?a.hypgeom.pdf(s-g-f+l,s,s-g,s-f):a.hypgeom.pdf(f-l,s,s-g,f);if(2*f>s)return a.hypgeom.pdf(g-l,s,g,s-f);if(g<f)return a.hypgeom.pdf(l,s,f,g);for(var c=1,w=0,L=0;L<l;L++){for(;c>1&&w<f;)c*=1-g/(s-w),w++;c*=(f-L)*(g-L)/((L+1)*(s-g-f+L+1))}for(;w<f;w++)c*=1-g/(s-w);return v.min(1,v.max(0,c))},cdf:function(l,s,g,f){if(l<0||l<g-(s-f))return 0;if(l>=f||l>=g)return 1;if(2*g>s)return 2*f>s?a.hypgeom.cdf(s-g-f+l,s,s-g,s-f):1-a.hypgeom.cdf(f-l-1,s,s-g,f);if(2*f>s)return 1-a.hypgeom.cdf(g-l-1,s,g,s-f);if(g<f)return a.hypgeom.cdf(l,s,f,g);for(var c=1,w=1,L=0,S=0;S<l;S++){for(;c>1&&L<f;){var k=1-g/(s-L);w*=k,c*=k,L++}c+=w*=(f-S)*(g-S)/((S+1)*(s-g-f+S+1))}for(;L<f;L++)c*=1-g/(s-L);return v.min(1,v.max(0,c))}}),a.extend(a.poisson,{pdf:function(l,s){return s<0||l%1!=0||l<0?0:v.pow(s,l)*v.exp(-s)/a.factorial(l)},cdf:function(l,s){var g=[],f=0;if(l<0)return 0;for(;f<=l;f++)g.push(a.poisson.pdf(f,s));return a.sum(g)},mean:function(l){return l},variance:function(l){return l},sampleSmall:function(l){var s=1,g=0,f=v.exp(-l);do g++,s*=a._random_fn();while(s>f);return g-1},sampleLarge:function(l){var s,g,f,c,w,L,S,k,_,M,B=l;for(c=v.sqrt(B),w=v.log(B),L=.02483*(S=.931+2.53*c)-.059,k=1.1239+1.1328/(S-3.4),_=.9277-3.6224/(S-2);;)if(g=v.random()-.5,f=v.random(),M=.5-v.abs(g),s=v.floor((2*L/M+S)*g+B+.43),M>=.07&&f<=_||!(s<0||M<.013&&f>M)&&v.log(f)+v.log(k)-v.log(L/(M*M)+S)<=s*w-B-a.loggam(s+1))return s},sample:function(l){return l<10?this.sampleSmall(l):this.sampleLarge(l)}}),a.extend(a.triangular,{pdf:function(l,s,g,f){return g<=s||f<s||f>g?NaN:l<s||l>g?0:l<f?2*(l-s)/((g-s)*(f-s)):l===f?2/(g-s):2*(g-l)/((g-s)*(g-f))},cdf:function(l,s,g,f){return g<=s||f<s||f>g?NaN:l<=s?0:l>=g?1:l<=f?v.pow(l-s,2)/((g-s)*(f-s)):1-v.pow(g-l,2)/((g-s)*(g-f))},inv:function(l,s,g,f){return g<=s||f<s||f>g?NaN:l<=(f-s)/(g-s)?s+(g-s)*v.sqrt(l*((f-s)/(g-s))):s+(g-s)*(1-v.sqrt((1-l)*(1-(f-s)/(g-s))))},mean:function(l,s,g){return(l+s+g)/3},median:function(l,s,g){return g<=(l+s)/2?s-v.sqrt((s-l)*(s-g))/v.sqrt(2):g>(l+s)/2?l+v.sqrt((s-l)*(g-l))/v.sqrt(2):void 0},mode:function(l,s,g){return g},sample:function(l,s,g){var f=a._random_fn();return f<(g-l)/(s-l)?l+v.sqrt(f*(s-l)*(g-l)):s-v.sqrt((1-f)*(s-l)*(s-g))},variance:function(l,s,g){return(l*l+s*s+g*g-l*s-l*g-s*g)/18}}),a.extend(a.arcsine,{pdf:function(l,s,g){return g<=s?NaN:l<=s||l>=g?0:2/v.PI*v.pow(v.pow(g-s,2)-v.pow(2*l-s-g,2),-.5)},cdf:function(l,s,g){return l<s?0:l<g?2/v.PI*v.asin(v.sqrt((l-s)/(g-s))):1},inv:function(l,s,g){return s+(.5-.5*v.cos(v.PI*l))*(g-s)},mean:function(l,s){return s<=l?NaN:(l+s)/2},median:function(l,s){return s<=l?NaN:(l+s)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(l,s){return(l+s)/2+(s-l)/2*v.sin(2*v.PI*a.uniform.sample(0,1))},variance:function(l,s){return s<=l?NaN:v.pow(s-l,2)/8}}),a.extend(a.laplace,{pdf:function(l,s,g){return g<=0?0:v.exp(-v.abs(l-s)/g)/(2*g)},cdf:function(l,s,g){return g<=0?0:l<s?.5*v.exp((l-s)/g):1-.5*v.exp(-(l-s)/g)},mean:function(l){return l},median:function(l){return l},mode:function(l){return l},variance:function(l,s){return 2*s*s},sample:function(l,s){var g,f=a._random_fn()-.5;return l-s*((g=f)/v.abs(g))*v.log(1-2*v.abs(f))}}),a.extend(a.tukey,{cdf:function(l,s,g){var f=s,c=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],w=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(l<=0)return 0;if(g<2||f<2)return NaN;if(!Number.isFinite(l))return 1;if(g>25e3)return A(l,1,f);var L,S=.5*g,k=S*v.log(g)-g*v.log(2)-a.gammaln(S),_=S-1,M=.25*g;L=g<=100?1:g<=800?.5:g<=5e3?.25:.125,k+=v.log(L);for(var B=0,z=1;z<=50;z++){for(var q=0,ce=(2*z-1)*L,me=1;me<=16;me++){var G,se;8<me?(G=me-8-1,se=k+_*v.log(ce+c[G]*L)-(c[G]*L+ce)*M):(G=me-1,se=k+_*v.log(ce-c[G]*L)+(c[G]*L-ce)*M),se>=-30&&(q+=A(8<me?l*v.sqrt(.5*(c[G]*L+ce)):l*v.sqrt(.5*(-c[G]*L+ce)),1,f)*w[G]*v.exp(se))}if(z*L>=1&&q<=1e-14)break;B+=q}if(q>1e-14)throw new Error("tukey.cdf failed to converge");return B>1&&(B=1),B},inv:function(l,s,g){if(g<2||s<2)return NaN;if(l<0||l>1)return NaN;if(l===0)return 0;if(l===1)return 1/0;var f,c=function(_,M,B){var z=.5-.5*_,q=v.sqrt(v.log(1/(z*z))),ce=q+((((-453642210148e-16*q-.204231210125)*q-.342242088547)*q-1)*q+.322232421088)/((((.0038560700634*q+.10353775285)*q+.531103462366)*q+.588581570495)*q+.099348462606);B<120&&(ce+=(ce*ce*ce+ce)/B/4);var me=.8832-.2368*ce;return B<120&&(me+=-1.214/B+1.208*ce/B),ce*(me*v.log(M-1)+1.4142)}(l,s,g),w=a.tukey.cdf(c,s,g)-l;f=w>0?v.max(0,c-1):c+1;for(var L,S=a.tukey.cdf(f,s,g)-l,k=1;k<50;k++)if(L=f-S*(f-c)/(S-w),w=S,c=f,L<0&&(L=0,S=-l),S=a.tukey.cdf(L,s,g)-l,f=L,v.abs(f-c)<1e-4)return L;throw new Error("tukey.inv failed to converge")}})}(m,Math),function(a,v){var I,A,l=Array.prototype.push,s=a.utils.isArray;function g(f){return s(f)||f instanceof a}a.extend({add:function(f,c){return g(c)?(g(c[0])||(c=[c]),a.map(f,function(w,L,S){return w+c[L][S]})):a.map(f,function(w){return w+c})},subtract:function(f,c){return g(c)?(g(c[0])||(c=[c]),a.map(f,function(w,L,S){return w-c[L][S]||0})):a.map(f,function(w){return w-c})},divide:function(f,c){return g(c)?(g(c[0])||(c=[c]),a.multiply(f,a.inv(c))):a.map(f,function(w){return w/c})},multiply:function(f,c){var w,L,S,k,_,M,B,z;if(f.length===void 0&&c.length===void 0)return f*c;if(_=f.length,M=f[0].length,B=a.zeros(_,S=g(c)?c[0].length:M),z=0,g(c)){for(;z<S;z++)for(w=0;w<_;w++){for(k=0,L=0;L<M;L++)k+=f[w][L]*c[L][z];B[w][z]=k}return _===1&&z===1?B[0][0]:B}return a.map(f,function(q){return q*c})},outer:function(f,c){return a.multiply(f.map(function(w){return[w]}),[c])},dot:function(f,c){g(f[0])||(f=[f]),g(c[0])||(c=[c]);for(var w,L,S=f[0].length===1&&f.length!==1?a.transpose(f):f,k=c[0].length===1&&c.length!==1?a.transpose(c):c,_=[],M=0,B=S.length,z=S[0].length;M<B;M++){for(_[M]=[],w=0,L=0;L<z;L++)w+=S[M][L]*k[M][L];_[M]=w}return _.length===1?_[0]:_},pow:function(f,c){return a.map(f,function(w){return v.pow(w,c)})},exp:function(f){return a.map(f,function(c){return v.exp(c)})},log:function(f){return a.map(f,function(c){return v.log(c)})},abs:function(f){return a.map(f,function(c){return v.abs(c)})},norm:function(f,c){var w=0,L=0;for(isNaN(c)&&(c=2),g(f[0])&&(f=f[0]);L<f.length;L++)w+=v.pow(v.abs(f[L]),c);return v.pow(w,1/c)},angle:function(f,c){return v.acos(a.dot(f,c)/(a.norm(f)*a.norm(c)))},aug:function(f,c){var w,L=[];for(w=0;w<f.length;w++)L.push(f[w].slice());for(w=0;w<L.length;w++)l.apply(L[w],c[w]);return L},inv:function(f){for(var c,w=f.length,L=f[0].length,S=a.identity(w,L),k=a.gauss_jordan(f,S),_=[],M=0;M<w;M++)for(_[M]=[],c=L;c<k[0].length;c++)_[M][c-L]=k[M][c];return _},det:function f(c){if(c.length===2)return c[0][0]*c[1][1]-c[0][1]*c[1][0];for(var w=0,L=0;L<c.length;L++){for(var S=[],k=1;k<c.length;k++){S[k-1]=[];for(var _=0;_<c.length;_++)_<L?S[k-1][_]=c[k][_]:_>L&&(S[k-1][_-1]=c[k][_])}var M=L%2?-1:1;w+=f(S)*c[0][L]*M}return w},gauss_elimination:function(f,c){var w,L,S,k,_=0,M=0,B=f.length,z=f[0].length,q=1,ce=0,me=[];for(w=(f=a.aug(f,c))[0].length,_=0;_<B;_++){for(L=f[_][_],M=_,k=_+1;k<z;k++)L<v.abs(f[k][_])&&(L=f[k][_],M=k);if(M!=_)for(k=0;k<w;k++)S=f[_][k],f[_][k]=f[M][k],f[M][k]=S;for(M=_+1;M<B;M++)for(q=f[M][_]/f[_][_],k=_;k<w;k++)f[M][k]=f[M][k]-q*f[_][k]}for(_=B-1;_>=0;_--){for(ce=0,M=_+1;M<=B-1;M++)ce+=me[M]*f[_][M];me[_]=(f[_][w-1]-ce)/f[_][_]}return me},gauss_jordan:function(f,c){var w,L,S,k=a.aug(f,c),_=k.length,M=k[0].length,B=0;for(L=0;L<_;L++){var z=L;for(S=L+1;S<_;S++)v.abs(k[S][L])>v.abs(k[z][L])&&(z=S);var q=k[L];for(k[L]=k[z],k[z]=q,S=L+1;S<_;S++)for(B=k[S][L]/k[L][L],w=L;w<M;w++)k[S][w]-=k[L][w]*B}for(L=_-1;L>=0;L--){for(B=k[L][L],S=0;S<L;S++)for(w=M-1;w>L-1;w--)k[S][w]-=k[L][w]*k[S][L]/B;for(k[L][L]/=B,w=_;w<M;w++)k[L][w]/=B}return k},triaUpSolve:function(f,c){var w,L=f[0].length,S=a.zeros(1,L)[0],k=!1;return c[0].length!=null&&(c=c.map(function(_){return _[0]}),k=!0),a.arange(L-1,-1,-1).forEach(function(_){w=a.arange(_+1,L).map(function(M){return S[M]*f[_][M]}),S[_]=(c[_]-a.sum(w))/f[_][_]}),k?S.map(function(_){return[_]}):S},triaLowSolve:function(f,c){var w,L=f[0].length,S=a.zeros(1,L)[0],k=!1;return c[0].length!=null&&(c=c.map(function(_){return _[0]}),k=!0),a.arange(L).forEach(function(_){w=a.arange(_).map(function(M){return f[_][M]*S[M]}),S[_]=(c[_]-a.sum(w))/f[_][_]}),k?S.map(function(_){return[_]}):S},lu:function(f){var c,w=f.length,L=a.identity(w),S=a.zeros(f.length,f[0].length);return a.arange(w).forEach(function(k){S[0][k]=f[0][k]}),a.arange(1,w).forEach(function(k){a.arange(k).forEach(function(_){c=a.arange(_).map(function(M){return L[k][M]*S[M][_]}),L[k][_]=(f[k][_]-a.sum(c))/S[_][_]}),a.arange(k,w).forEach(function(_){c=a.arange(k).map(function(M){return L[k][M]*S[M][_]}),S[k][_]=f[c.length][_]-a.sum(c)})}),[L,S]},cholesky:function(f){var c,w=f.length,L=a.zeros(f.length,f[0].length);return a.arange(w).forEach(function(S){c=a.arange(S).map(function(k){return v.pow(L[S][k],2)}),L[S][S]=v.sqrt(f[S][S]-a.sum(c)),a.arange(S+1,w).forEach(function(k){c=a.arange(S).map(function(_){return L[S][_]*L[k][_]}),L[k][S]=(f[S][k]-a.sum(c))/L[S][S]})}),L},gauss_jacobi:function(f,c,w,L){for(var S,k,_,M,B=0,z=0,q=f.length,ce=[],me=[],G=[];B<q;B++)for(ce[B]=[],me[B]=[],G[B]=[],z=0;z<q;z++)B>z?(ce[B][z]=f[B][z],me[B][z]=G[B][z]=0):B<z?(me[B][z]=f[B][z],ce[B][z]=G[B][z]=0):(G[B][z]=f[B][z],ce[B][z]=me[B][z]=0);for(_=a.multiply(a.multiply(a.inv(G),a.add(ce,me)),-1),k=a.multiply(a.inv(G),c),S=w,M=a.add(a.multiply(_,w),k),B=2;v.abs(a.norm(a.subtract(M,S)))>L;)S=M,M=a.add(a.multiply(_,S),k),B++;return M},gauss_seidel:function(f,c,w,L){for(var S,k,_,M,B,z=0,q=f.length,ce=[],me=[],G=[];z<q;z++)for(ce[z]=[],me[z]=[],G[z]=[],S=0;S<q;S++)z>S?(ce[z][S]=f[z][S],me[z][S]=G[z][S]=0):z<S?(me[z][S]=f[z][S],ce[z][S]=G[z][S]=0):(G[z][S]=f[z][S],ce[z][S]=me[z][S]=0);for(M=a.multiply(a.multiply(a.inv(a.add(G,ce)),me),-1),_=a.multiply(a.inv(a.add(G,ce)),c),k=w,B=a.add(a.multiply(M,w),_),z=2;v.abs(a.norm(a.subtract(B,k)))>L;)k=B,B=a.add(a.multiply(M,k),_),z+=1;return B},SOR:function(f,c,w,L,S){for(var k,_,M,B,z,q=0,ce=f.length,me=[],G=[],se=[];q<ce;q++)for(me[q]=[],G[q]=[],se[q]=[],k=0;k<ce;k++)q>k?(me[q][k]=f[q][k],G[q][k]=se[q][k]=0):q<k?(G[q][k]=f[q][k],me[q][k]=se[q][k]=0):(se[q][k]=f[q][k],me[q][k]=G[q][k]=0);for(B=a.multiply(a.inv(a.add(se,a.multiply(me,S))),a.subtract(a.multiply(se,1-S),a.multiply(G,S))),M=a.multiply(a.multiply(a.inv(a.add(se,a.multiply(me,S))),c),S),_=w,z=a.add(a.multiply(B,w),M),q=2;v.abs(a.norm(a.subtract(z,_)))>L;)_=z,z=a.add(a.multiply(B,_),M),q++;return z},householder:function(f){for(var c,w,L,S,k=f.length,_=f[0].length,M=0,B=[],z=[];M<k-1;M++){for(c=0,S=M+1;S<_;S++)c+=f[S][M]*f[S][M];for(c=(f[M+1][M]>0?-1:1)*v.sqrt(c),w=v.sqrt((c*c-f[M+1][M]*c)/2),(B=a.zeros(k,1))[M+1][0]=(f[M+1][M]-c)/(2*w),L=M+2;L<k;L++)B[L][0]=f[L][M]/(2*w);z=a.subtract(a.identity(k,_),a.multiply(a.multiply(B,a.transpose(B)),2)),f=a.multiply(z,a.multiply(f,z))}return f},QR:(I=a.sum,A=a.arange,function(f){var c,w,L,S=f.length,k=f[0].length,_=a.zeros(k,k);for(f=a.copy(f),w=0;w<k;w++){for(_[w][w]=v.sqrt(I(A(S).map(function(M){return f[M][w]*f[M][w]}))),c=0;c<S;c++)f[c][w]=f[c][w]/_[w][w];for(L=w+1;L<k;L++)for(_[w][L]=I(A(S).map(function(M){return f[M][w]*f[M][L]})),c=0;c<S;c++)f[c][L]=f[c][L]-f[c][w]*_[w][L]}return[f,_]}),lstsq:function(f,c){var w=!1;c[0].length===void 0&&(c=c.map(function(ce){return[ce]}),w=!0);var L=a.QR(f),S=L[0],k=L[1],_=f[0].length,M=a.slice(S,{col:{end:_}}),B=function(ce){var me=(ce=a.copy(ce)).length,G=a.identity(me);return a.arange(me-1,-1,-1).forEach(function(se){a.sliceAssign(G,{row:se},a.divide(a.slice(G,{row:se}),ce[se][se])),a.sliceAssign(ce,{row:se},a.divide(a.slice(ce,{row:se}),ce[se][se])),a.arange(se).forEach(function(ge){var ue=a.multiply(ce[ge][se],-1),oe=a.slice(ce,{row:ge}),xe=a.multiply(a.slice(ce,{row:se}),ue);a.sliceAssign(ce,{row:ge},a.add(oe,xe));var ke=a.slice(G,{row:ge}),Re=a.multiply(a.slice(G,{row:se}),ue);a.sliceAssign(G,{row:ge},a.add(ke,Re))})}),G}(a.slice(k,{row:{end:_}})),z=a.transpose(M);z[0].length===void 0&&(z=[z]);var q=a.multiply(a.multiply(B,z),c);return q.length===void 0&&(q=[[q]]),w?q.map(function(ce){return ce[0]}):q},jacobi:function(f){for(var c,w,L,S,k,_,M,B=1,z=f.length,q=a.identity(z,z),ce=[];B===1;){for(k=f[0][1],L=0,S=1,c=0;c<z;c++)for(w=0;w<z;w++)c!=w&&k<v.abs(f[c][w])&&(k=v.abs(f[c][w]),L=c,S=w);for(_=f[L][L]===f[S][S]?f[L][S]>0?v.PI/4:-v.PI/4:v.atan(2*f[L][S]/(f[L][L]-f[S][S]))/2,(M=a.identity(z,z))[L][L]=v.cos(_),M[L][S]=-v.sin(_),M[S][L]=v.sin(_),M[S][S]=v.cos(_),q=a.multiply(q,M),f=a.multiply(a.multiply(a.inv(M),f),M),B=0,c=1;c<z;c++)for(w=1;w<z;w++)c!=w&&v.abs(f[c][w])>.001&&(B=1)}for(c=0;c<z;c++)ce.push(f[c][c]);return[q,ce]},rungekutta:function(f,c,w,L,S,k){var _,M,B;if(k===2)for(;L<=w;)S+=((_=c*f(L,S))+(M=c*f(L+c,S+_)))/2,L+=c;if(k===4)for(;L<=w;)S+=((_=c*f(L,S))+2*(M=c*f(L+c/2,S+_/2))+2*(B=c*f(L+c/2,S+M/2))+c*f(L+c,S+B))/6,L+=c;return S},romberg:function(f,c,w,L){for(var S,k,_,M,B,z=0,q=(w-c)/2,ce=[],me=[],G=[];z<L/2;){for(B=f(c),_=c,M=0;_<=w;_+=q,M++)ce[M]=_;for(S=ce.length,_=1;_<S-1;_++)B+=(_%2!=0?4:2)*f(ce[_]);B=q/3*(B+f(w)),G[z]=B,q/=2,z++}for(k=G.length,S=1;k!==1;){for(_=0;_<k-1;_++)me[_]=(v.pow(4,S)*G[_+1]-G[_])/(v.pow(4,S)-1);k=me.length,G=me,me=[],S++}return G},richardson:function(f,c,w,L){function S(se,ge){for(var ue,oe=0,xe=se.length;oe<xe;oe++)se[oe]===ge&&(ue=oe);return ue}for(var k,_,M,B,z,q=v.abs(w-f[S(f,w)+1]),ce=0,me=[],G=[];L>=q;)k=S(f,w+L),_=S(f,w),me[ce]=(c[k]-2*c[_]+c[2*_-k])/(L*L),L/=2,ce++;for(B=me.length,M=1;B!=1;){for(z=0;z<B-1;z++)G[z]=(v.pow(4,M)*me[z+1]-me[z])/(v.pow(4,M)-1);B=G.length,me=G,G=[],M++}return me},simpson:function(f,c,w,L){for(var S,k=(w-c)/L,_=f(c),M=[],B=c,z=0,q=1;B<=w;B+=k,z++)M[z]=B;for(S=M.length;q<S-1;q++)_+=(q%2!=0?4:2)*f(M[q]);return k/3*(_+f(w))},hermite:function(f,c,w,L){for(var S,k=f.length,_=0,M=0,B=[],z=[],q=[],ce=[];M<k;M++){for(B[M]=1,S=0;S<k;S++)M!=S&&(B[M]*=(L-f[S])/(f[M]-f[S]));for(z[M]=0,S=0;S<k;S++)M!=S&&(z[M]+=1/(f[M]-f[S]));q[M]=(1-2*(L-f[M])*z[M])*(B[M]*B[M]),ce[M]=(L-f[M])*(B[M]*B[M]),_+=q[M]*c[M]+ce[M]*w[M]}return _},lagrange:function(f,c,w){for(var L,S,k=0,_=0,M=f.length;_<M;_++){for(S=c[_],L=0;L<M;L++)_!=L&&(S*=(w-f[L])/(f[_]-f[L]));k+=S}return k},cubic_spline:function(f,c,w){for(var L,S,k=f.length,_=0,M=[],B=[],z=[],q=[],ce=[],me=[];_<k-1;_++)q[_]=f[_+1]-f[_];for(z[0]=0,_=1;_<k-1;_++)z[_]=3/q[_]*(c[_+1]-c[_])-3/q[_-1]*(c[_]-c[_-1]);for(_=1;_<k-1;_++)M[_]=[],B[_]=[],M[_][_-1]=q[_-1],M[_][_]=2*(q[_-1]+q[_]),M[_][_+1]=q[_],B[_][0]=z[_];for(S=a.multiply(a.inv(M),B),L=0;L<k-1;L++)ce[L]=(c[L+1]-c[L])/q[L]-q[L]*(S[L+1][0]+2*S[L][0])/3,me[L]=(S[L+1][0]-S[L][0])/(3*q[L]);for(L=0;L<k&&!(f[L]>w);L++);return c[L-=1]+(w-f[L])*ce[L]+a.sq(w-f[L])*S[L]+(w-f[L])*a.sq(w-f[L])*me[L]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var c,w,L,S,k,_=f.length,M=f[0].length,B=0,z=[],q=[],ce=[],me=[],G=[],se=[],ge=[];for(B=0;B<_;B++)z[B]=a.sum(f[B])/M;for(B=0;B<M;B++)for(G[B]=[],c=0;c<_;c++)G[B][c]=f[c][B]-z[c];for(G=a.transpose(G),B=0;B<_;B++)for(se[B]=[],c=0;c<_;c++)se[B][c]=a.dot([G[B]],[G[c]])/(M-1);for(k=(L=a.jacobi(se))[0],q=L[1],ge=a.transpose(k),B=0;B<q.length;B++)for(c=B;c<q.length;c++)q[B]<q[c]&&(w=q[B],q[B]=q[c],q[c]=w,ce=ge[B],ge[B]=ge[c],ge[c]=ce);for(S=a.transpose(G),B=0;B<_;B++)for(me[B]=[],c=0;c<S.length;c++)me[B][c]=a.dot([ge[B]],[S[c]]);return[f,q,ge,me]}}),function(f){for(var c=0;c<f.length;c++)(function(w){a.fn[w]=function(L,S){var k=this;return S?(setTimeout(function(){S.call(k,a.fn[w].call(k,L))},15),this):typeof a[w](this,L)=="number"?a[w](this,L):a(a[w](this,L))}})(f[c])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(m,Math),function(a,v){var I=[].slice,A=a.utils.isNumber,l=a.utils.isArray;function s(g,f,c,w){if(g>1||c>1||g<=0||c<=0)throw new Error("Proportions should be greater than 0 and less than 1");var L=(g*f+c*w)/(f+w);return(g-c)/v.sqrt(L*(1-L)*(1/f+1/w))}a.extend({zscore:function(){var g=I.call(arguments);return A(g[1])?(g[0]-g[1])/g[2]:(g[0]-a.mean(g[1]))/a.stdev(g[1],g[2])},ztest:function(){var g,f=I.call(arguments);return l(f[1])?(g=a.zscore(f[0],f[1],f[3]),f[2]===1?a.normal.cdf(-v.abs(g),0,1):2*a.normal.cdf(-v.abs(g),0,1)):f.length>2?(g=a.zscore(f[0],f[1],f[2]),f[3]===1?a.normal.cdf(-v.abs(g),0,1):2*a.normal.cdf(-v.abs(g),0,1)):(g=f[0],f[1]===1?a.normal.cdf(-v.abs(g),0,1):2*a.normal.cdf(-v.abs(g),0,1))}}),a.extend(a.fn,{zscore:function(g,f){return(g-this.mean())/this.stdev(f)},ztest:function(g,f,c){var w=v.abs(this.zscore(g,c));return f===1?a.normal.cdf(-w,0,1):2*a.normal.cdf(-w,0,1)}}),a.extend({tscore:function(){var g=I.call(arguments);return g.length===4?(g[0]-g[1])/(g[2]/v.sqrt(g[3])):(g[0]-a.mean(g[1]))/(a.stdev(g[1],!0)/v.sqrt(g[1].length))},ttest:function(){var g,f=I.call(arguments);return f.length===5?(g=v.abs(a.tscore(f[0],f[1],f[2],f[3])),f[4]===1?a.studentt.cdf(-g,f[3]-1):2*a.studentt.cdf(-g,f[3]-1)):A(f[1])?(g=v.abs(f[0]),f[2]==1?a.studentt.cdf(-g,f[1]-1):2*a.studentt.cdf(-g,f[1]-1)):(g=v.abs(a.tscore(f[0],f[1])),f[2]==1?a.studentt.cdf(-g,f[1].length-1):2*a.studentt.cdf(-g,f[1].length-1))}}),a.extend(a.fn,{tscore:function(g){return(g-this.mean())/(this.stdev(!0)/v.sqrt(this.cols()))},ttest:function(g,f){return f===1?1-a.studentt.cdf(v.abs(this.tscore(g)),this.cols()-1):2*a.studentt.cdf(-v.abs(this.tscore(g)),this.cols()-1)}}),a.extend({anovafscore:function(){var g,f,c,w,L,S,k,_,M=I.call(arguments);if(M.length===1){for(L=new Array(M[0].length),k=0;k<M[0].length;k++)L[k]=M[0][k];M=L}for(f=new Array,k=0;k<M.length;k++)f=f.concat(M[k]);for(c=a.mean(f),g=0,k=0;k<M.length;k++)g+=M[k].length*v.pow(a.mean(M[k])-c,2);for(g/=M.length-1,S=0,k=0;k<M.length;k++)for(w=a.mean(M[k]),_=0;_<M[k].length;_++)S+=v.pow(M[k][_]-w,2);return g/(S/(f.length-M.length))},anovaftest:function(){var g,f,c,w,L=I.call(arguments);if(A(L[0]))return 1-a.centralF.cdf(L[0],L[1],L[2]);var S=a.anovafscore(L);for(g=L.length-1,c=0,w=0;w<L.length;w++)c+=L[w].length;return f=c-g-1,1-a.centralF.cdf(S,g,f)},ftest:function(g,f,c){return 1-a.centralF.cdf(g,f,c)}}),a.extend(a.fn,{anovafscore:function(){return a.anovafscore(this.toArray())},anovaftes:function(){var g,f=0;for(g=0;g<this.length;g++)f+=this[g].length;return a.ftest(this.anovafscore(),this.length-1,f-this.length)}}),a.extend({qscore:function(){var g,f,c,w,L,S=I.call(arguments);return A(S[0])?(g=S[0],f=S[1],c=S[2],w=S[3],L=S[4]):(g=a.mean(S[0]),f=a.mean(S[1]),c=S[0].length,w=S[1].length,L=S[2]),v.abs(g-f)/(L*v.sqrt((1/c+1/w)/2))},qtest:function(){var g,f=I.call(arguments);f.length===3?(g=f[0],f=f.slice(1)):f.length===7?(g=a.qscore(f[0],f[1],f[2],f[3],f[4]),f=f.slice(5)):(g=a.qscore(f[0],f[1],f[2]),f=f.slice(3));var c=f[0],w=f[1];return 1-a.tukey.cdf(g,w,c-w)},tukeyhsd:function(g){for(var f=a.pooledstdev(g),c=g.map(function(M){return a.mean(M)}),w=g.reduce(function(M,B){return M+B.length},0),L=[],S=0;S<g.length;++S)for(var k=S+1;k<g.length;++k){var _=a.qtest(c[S],c[k],g[S].length,g[k].length,f,w,g.length);L.push([[S,k],_])}return L}}),a.extend({normalci:function(){var g,f=I.call(arguments),c=new Array(2);return g=f.length===4?v.abs(a.normal.inv(f[1]/2,0,1)*f[2]/v.sqrt(f[3])):v.abs(a.normal.inv(f[1]/2,0,1)*a.stdev(f[2])/v.sqrt(f[2].length)),c[0]=f[0]-g,c[1]=f[0]+g,c},tci:function(){var g,f=I.call(arguments),c=new Array(2);return g=f.length===4?v.abs(a.studentt.inv(f[1]/2,f[3]-1)*f[2]/v.sqrt(f[3])):v.abs(a.studentt.inv(f[1]/2,f[2].length-1)*a.stdev(f[2],!0)/v.sqrt(f[2].length)),c[0]=f[0]-g,c[1]=f[0]+g,c},significant:function(g,f){return g<f}}),a.extend(a.fn,{normalci:function(g,f){return a.normalci(g,f,this.toArray())},tci:function(g,f){return a.tci(g,f,this.toArray())}}),a.extend(a.fn,{oneSidedDifferenceOfProportions:function(g,f,c,w){var L=s(g,f,c,w);return a.ztest(L,1)},twoSidedDifferenceOfProportions:function(g,f,c,w){var L=s(g,f,c,w);return a.ztest(L,2)}})}(m,Math),m.models=function(){function a(I,A){var l=I.length,s=A[0].length-1,g=l-s-1,f=m.lstsq(A,I),c=m.multiply(A,f.map(function(M){return[M]})).map(function(M){return M[0]}),w=m.subtract(I,c),L=m.mean(I),S=m.sum(c.map(function(M){return Math.pow(M-L,2)})),k=m.sum(I.map(function(M,B){return Math.pow(M-c[B],2)})),_=S+k;return{exog:A,endog:I,nobs:l,df_model:s,df_resid:g,coef:f,predict:c,resid:w,ybar:L,SST:_,SSE:S,SSR:k,R2:S/_}}function v(I){var A,l,s=(A=I.exog,l=A[0].length,m.arange(l).map(function(k){var _=m.arange(l).filter(function(M){return M!==k});return a(m.col(A,k).map(function(M){return M[0]}),m.col(A,_))})),g=Math.sqrt(I.SSR/I.df_resid),f=s.map(function(k){var _=k.SST,M=k.R2;return g/Math.sqrt(_*(1-M))}),c=I.coef.map(function(k,_){return(k-0)/f[_]}),w=c.map(function(k){var _=m.studentt.cdf(k,I.df_resid);return 2*(_>.5?1-_:_)}),L=m.studentt.inv(.975,I.df_resid),S=I.coef.map(function(k,_){var M=L*f[_];return[k-M,k+M]});return{se:f,t:c,p:w,sigmaHat:g,interval95:S}}return{ols:function(I,A){var l=a(I,A),s=v(l),g=function(c){var w,L,S,k=c.R2/c.df_model/((1-c.R2)/c.df_resid);return{F_statistic:k,pvalue:1-(w=k,L=c.df_model,S=c.df_resid,m.beta.cdf(w/(S/L+w),L/2,S/2))}}(l),f=1-(1-l.R2)*((l.nobs-1)/l.df_resid);return l.t=s,l.f=g,l.adjust_R2=f,l}}}(),m.extend({buildxmatrix:function(){for(var a=new Array(arguments.length),v=0;v<arguments.length;v++)a[v]=[1].concat(arguments[v]);return m(a)},builddxmatrix:function(){for(var a=new Array(arguments[0].length),v=0;v<arguments[0].length;v++)a[v]=[1].concat(arguments[0][v]);return m(a)},buildjxmatrix:function(a){for(var v=new Array(a.length),I=0;I<a.length;I++)v[I]=a[I];return m.builddxmatrix(v)},buildymatrix:function(a){return m(a).transpose()},buildjymatrix:function(a){return a.transpose()},matrixmult:function(a,v){var I,A,l,s,g;if(a.cols()==v.rows()){if(v.rows()>1){for(s=[],I=0;I<a.rows();I++)for(s[I]=[],A=0;A<v.cols();A++){for(g=0,l=0;l<a.cols();l++)g+=a.toArray()[I][l]*v.toArray()[l][A];s[I][A]=g}return m(s)}for(s=[],I=0;I<a.rows();I++)for(s[I]=[],A=0;A<v.cols();A++){for(g=0,l=0;l<a.cols();l++)g+=a.toArray()[I][l]*v.toArray()[A];s[I][A]=g}return m(s)}},regress:function(a,v){var I=m.xtranspxinv(a),A=a.transpose(),l=m.matrixmult(m(I),A);return m.matrixmult(l,v)},regresst:function(a,v,I){var A=m.regress(a,v),l={anova:{}},s=m.jMatYBar(a,A);l.yBar=s;var g=v.mean();l.anova.residuals=m.residuals(v,s),l.anova.ssr=m.ssr(s,g),l.anova.msr=l.anova.ssr/(a[0].length-1),l.anova.sse=m.sse(v,s),l.anova.mse=l.anova.sse/(v.length-(a[0].length-1)-1),l.anova.sst=m.sst(v,g),l.anova.mst=l.anova.sst/(v.length-1),l.anova.r2=1-l.anova.sse/l.anova.sst,l.anova.r2<0&&(l.anova.r2=0),l.anova.fratio=l.anova.msr/l.anova.mse,l.anova.pvalue=m.anovaftest(l.anova.fratio,a[0].length-1,v.length-(a[0].length-1)-1),l.anova.rmse=Math.sqrt(l.anova.mse),l.anova.r2adj=1-l.anova.mse/l.anova.mst,l.anova.r2adj<0&&(l.anova.r2adj=0),l.stats=new Array(a[0].length);for(var f,c,w,L=m.xtranspxinv(a),S=0;S<A.length;S++)f=Math.sqrt(l.anova.mse*Math.abs(L[S][S])),c=Math.abs(A[S]/f),w=m.ttest(c,v.length-a[0].length-1,I),l.stats[S]=[A[S],f,c,w];return l.regress=A,l},xtranspx:function(a){return m.matrixmult(a.transpose(),a)},xtranspxinv:function(a){var v=m.matrixmult(a.transpose(),a);return m.inv(v)},jMatYBar:function(a,v){var I=m.matrixmult(a,v);return new m(I)},residuals:function(a,v){return m.matrixsubtract(a,v)},ssr:function(a,v){for(var I=0,A=0;A<a.length;A++)I+=Math.pow(a[A]-v,2);return I},sse:function(a,v){for(var I=0,A=0;A<a.length;A++)I+=Math.pow(a[A]-v[A],2);return I},sst:function(a,v){for(var I=0,A=0;A<a.length;A++)I+=Math.pow(a[A]-v,2);return I},matrixsubtract:function(a,v){for(var I=new Array(a.length),A=0;A<a.length;A++){I[A]=new Array(a[A].length);for(var l=0;l<a[A].length;l++)I[A][l]=a[A][l]-v[A][l]}return m(I)}}),m.jStat=m,m)},960:function(R,m,a){const v=a(592);R.exports=function(I){function A(S,k){const _=k.split(".");let M=S;for(const B of _){if(M==null)return;M=M[B]}return M}for(let S=0;S<Object.keys(v).length;S++){let k,_=Object.keys(v)[S],M=[];if(typeof v[_]=="object"){M=Object.keys(v[_]),k=Object.values(v[_]);for(let B=0;B<k.length;B++)if(typeof k[B]=="object"){let z=M[B];v[_][z]&&(M=[...M,...Object.keys(v[_][z]).map(q=>z+"."+q)],M.splice(M.indexOf(z),1))}}if(M.length<1)I[_]=v[_];else for(let B=0;B<M.length;B++)typeof A(v[_],M[B])=="function"&&(I[_]=A(v[_],M[B]))}let l=function(S){return typeof S=="number"&&(S=parseInt(S)),S},s=null,g=null,f=null;I.TABLE=function(){return f},I.COLUMN=I.COL=function(){return f.tracking&&f.tracking.push(L.getColumnNameFromCoords(l(s),l(g))),l(s)+1},I.ROW=function(){return f.tracking&&f.tracking.push(L.getColumnNameFromCoords(l(s),l(g))),l(g)+1},I.CELL=function(){return L.getColumnNameFromCoords(s,g)},I.VALUE=function(S,k,_){return f.getValueFromCoords(l(S)-1,l(k)-1,_)},I.THISROWCELL=function(S){return f.getValueFromCoords(l(S)-1,l(g))};const c=function(S,k){for(let _=0;_<S.length;_++){let M=L.getTokensFromRange(S[_]);k=k.replace(S[_],"["+M.join(",")+"]")}return k},w=function(S){return typeof S=="string"&&(S=S.trim()),!isNaN(S)&&S!==null&&S!==""},L=function(S,k,_,M,B){f=B,s=_,g=M;let z="",q={};if(k)if(k.size){let G,se=null;k.forEach(function(ge,ue){G=ue.replace(/!/g,"."),G.indexOf(".")!==-1&&(G=G.split("."),q[G[0]]=!0)}),G=Object.keys(q);for(let ge=0;ge<G.length;ge++)z+="var "+G[ge]+" = {};";k.forEach(function(ge,ue){G=ue.replace(/!/g,"."),ge===null||w(ge)||(se=ge.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),se&&se.length&&(ge=updateRanges(se,ge))),G.indexOf(".")>0?z+=G+" = "+k.get(ue)+`;
`:z+="var "+G+" = "+ge+`;
`})}else{let G=Object.keys(k);if(G.length){let se,ge={};for(let ue=0;ue<G.length;ue++)if(se=G[ue].replace(/\!/g,"."),se.indexOf(".")>0){let oe=oe.split(".");ge[oe[0]]={}}se=Object.keys(ge);for(let ue=0;ue<se.length;ue++)z+="var "+se[ue]+" = {};";for(let ue=0;ue<G.length;ue++){if(se=G[ue].replace(/!/g,"."),k[G[ue]]!==null&&!w(k[G[ue]])){let oe=k[G[ue]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);oe&&oe.length&&(k[G[ue]]=c(oe,k[G[ue]]))}se.indexOf(".")>0?z+=se+" = "+k[G[ue]]+`;
`:z+="var "+se+" = "+k[G[ue]]+`;
`}}}let ce=(S=function(G,se){let ge="",ue=0,oe=["=","!",">","<"];for(let xe=0;xe<G.length;xe++)G[xe]==='"'&&(ue=ue===0?1:0),ue===1?ge+=G[xe]:(ge+=G[xe].toUpperCase(),xe>0&&G[xe]==="="&&oe.indexOf(G[xe-1])===-1&&oe.indexOf(G[xe+1])===-1&&(ge+="="));return ge=ge.replace(/\^/g,"**"),ge=ge.replace(/<>/g,"!="),ge=ge.replace(/&/g,"+"),ge=ge.replace(/\$/g,""),ge}(S=(S=S.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ce&&ce.length&&(S=c(ce,S));let me=new Function(z+"; return "+S)();return me===null&&(me=0),me};return L.getColumnNameFromCoords=function(S,k){return _=parseInt(S),M="",_>701?(M+=String.fromCharCode(64+parseInt(_/676)),M+=String.fromCharCode(64+parseInt(_%676/26))):_>25&&(M+=String.fromCharCode(64+parseInt(_/26))),M+String.fromCharCode(65+_%26)+(parseInt(k)+1);var _,M},L.getCoordsFromColumnName=function(S){var k=/^[a-zA-Z]+/.exec(S);if(k){for(var _=0,M=0;M<k[0].length;M++)_+=parseInt(k[0].charCodeAt(M)-64)*Math.pow(26,k[0].length-1-M);--_<0&&(_=0);var B=parseInt(/[0-9]+$/.exec(S))||null;return B>0&&B--,[_,B]}},L.getRangeFromTokens=function(S){S=S.filter(function(B){return B!="#REF!"});for(var k="",_="",M=0;M<S.length;M++)S[M].indexOf(".")>=0?k=".":S[M].indexOf("!")>=0&&(k="!"),k&&(_=S[M].split(k),S[M]=_[1],_=_[0]+k);return S.sort(function(B,z){var q=Helpers.getCoordsFromColumnName(B),ce=Helpers.getCoordsFromColumnName(z);return q[1]>ce[1]?1:q[1]<ce[1]?-1:q[0]>ce[0]?1:q[0]<ce[0]?-1:0}),S.length?_+(S[0]+":")+S[S.length-1]:"#REF!"},L.getTokensFromRange=function(S){if(S.indexOf(".")>0){var k=S.split(".");S=k[1],k=k[0]+"."}else S.indexOf("!")>0?(k=S.split("!"),S=k[1],k=k[0]+"!"):k="";S=S.split(":");var _=L.getCoordsFromColumnName(S[0]),M=L.getCoordsFromColumnName(S[1]);if(_[0]<=M[0])var B=_[0],z=M[0];else B=M[0],z=_[0];if(_[1]===null&&M[1]==null)for(var q=null,ce=null,me=Object.keys(vars),G=0;G<me.length;G++){var se=L.getCoordsFromColumnName(me[G]);se[0]===_[0]&&(q===null||se[1]<q)&&(q=se[1]),se[0]===M[0]&&(ce===null||se[1]>ce)&&(ce=se[1])}else _[1]<=M[1]?(q=_[1],ce=M[1]):(q=M[1],ce=_[1]);for(var ge=[],ue=q;ue<=ce;ue++){var oe=[];for(G=B;G<=z;G++)oe.push(k+L.getColumnNameFromCoords(G,ue));ge.push(oe)}return ge},L.setFormula=function(S){let k=Object.keys(S);for(let _=0;_<k.length;_++)typeof S[k[_]]=="function"&&(I[k[_]]=S[k[_]])},L.basic=!0,L}(typeof window>"u"?a.g:window)},592:function(R,m,a){var v=a(162),I=a(765);const A=new Error("#NULL!"),l=new Error("#DIV/0!"),s=new Error("#VALUE!"),g=new Error("#REF!"),f=new Error("#NAME?"),c=new Error("#NUM!"),w=new Error("#N/A"),L=new Error("#ERROR!"),S=new Error("#GETTING_DATA");var k=Object.freeze({__proto__:null,data:S,div0:l,error:L,na:w,name:f,nil:A,num:c,ref:g,value:s});function _(e){const t=[];return M(e,u=>{t.push(u)}),t}function M(e,t){let u=-1;const b=e.length;for(;++u<b&&t(e[u],u,e)!==!1;);return e}function B(e){let t,u=e.length;for(;u--;)if(t=e[u],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const b=Y(t);e[u]=b instanceof Error?0:b}}else e[u]=0;else e[u]=1;return e}function z(e,t){if(!e)return s;e.every(D=>Array.isArray(D))&&e.length!==0||(e=[[...e]]),e.map((D,P)=>{D.map(($,ie)=>{$||(e[P][ie]=0)})});const u=e.reduce((D,P,$)=>P.length>e[D].length?$:D,0),b=e[u].length;return e.map(D=>[...D,...Array(b-D.length).fill(0)])}function q(){let e;if(arguments.length===1){const u=arguments[0];e=(t=u)!=null&&typeof t.length=="number"&&typeof t!="string"?_.apply(null,arguments):[u]}else e=Array.from(arguments);for(var t;!me(e);)e=ce(e);return e}function ce(e){return e&&e.reduce?e.reduce((t,u)=>{const b=Array.isArray(t),D=Array.isArray(u);return b&&D?t.concat(u):b?(t.push(u),t):D?[t].concat(u):[t,u]}):[e]}function me(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function G(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function se(e){return e?e[0].map((t,u)=>e.map(b=>b[u])):s}function ge(e,t){let u=null;return M(e,(b,D)=>{if(b[0]===t)return u=D,!1}),u??s}function ue(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function oe(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function xe(e){return Math.round(e*1e14)/1e14}function ke(){return q.apply(null,arguments).filter(e=>typeof e=="number")}function Re(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||s}function Se(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?c:function(u){u<60&&(u+=1);const b=Math.floor(u-25569),D=new Date(86400*b*1e3),P=u-Math.floor(u)+1e-7;let $=Math.floor(86400*P);const ie=$%60;$-=ie;const ye=Math.floor($/3600),Me=Math.floor($/60)%60;let _e=D.getUTCDate(),Ve=D.getUTCMonth();return u>=60&&u<61&&(_e=29,Ve=1),new Date(D.getUTCFullYear(),Ve,_e,ye,Me,ie)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?s:e}function $e(e){let t,u=e.length;for(;u--;){if(t=Se(e[u]),t===s)return t;e[u]=t}return e}function Y(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?s:parseFloat(e))}function Ae(e){let t,u;if(!e||(t=e.length)===0)return s;for(;t--;){if(e[t]instanceof Error)return e[t];if(u=Y(e[t]),u instanceof Error)return u;e[t]=u}return e}function Fe(e){return e instanceof Error?e:e==null?"":e.toString()}function rt(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function Ne(e){return e!=null}const Ce="=",Ie=[">",">=","<","<=","=","<>"],Be="operator",Pe="literal",ze=[Be,Pe],Ze=Be,et=Pe;function it(e,t){if(ze.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function dt(e){return function(t){let u="";const b=[];for(let D=0;D<t.length;D++){const P=t[D];D===0&&Ie.indexOf(P)>=0?b.push(it(P,Ze)):u+=P}return u.length>0&&b.push(it(function(D){return typeof D!="string"||/^\d+(\.\d+)?$/.test(D)&&(D=D.indexOf(".")===-1?parseInt(D,10):parseFloat(D)),D}(u),et)),b.length>0&&b[0].type!==Ze&&b.unshift(it(Ce,Ze)),b}(function(t){const u=t.length,b=[];let D=0,P="",$="";for(;D<u;){const ie=t.charAt(D);switch(ie){case">":case"<":case"=":$+=ie,P.length>0&&(b.push(P),P="");break;default:$.length>0&&(b.push($),$=""),P+=ie}D++}return P.length>0&&b.push(P),$.length>0&&b.push($),b}(e))}const ft=function(e){const t=[];let u;for(let b=0;b<e.length;b++){const D=e[b];switch(D.type){case Ze:u=D.value;break;case et:t.push(D.value)}}return function(b,D){let P=!1;switch(D){case">":P=b[0]>b[1];break;case">=":P=b[0]>=b[1];break;case"<":P=b[0]<b[1];break;case"<=":P=b[0]<=b[1];break;case"=":P=b[0]==b[1];break;case"<>":P=b[0]!=b[1]}return P}(t,u)},kt={};function Rt(e){return[s,g,l,c,f,A].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function Mt(e){return Rt(e)||e===w}function Bt(e){return e===!0||e===!1}function Et(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function Ht(e){return typeof e=="string"}function It(){const e=[];for(let t=0;t<arguments.length;++t){let u=!1;const b=arguments[t];for(let D=0;D<e.length&&(u=e[D]===b,!u);++D);u||e.push(b)}return e}function Tt(e,t,u,b){if(!t||!u)return w;b=!(b===0||b===!1);let D=w;const P=typeof e=="number";let $=!1;for(let ie=0;ie<t.length;ie++){const ye=t[ie];if(ye[0]===e){D=u<ye.length+1?ye[u-1]:g;break}!$&&(P&&b&&ye[0]<=e||b&&typeof ye[0]=="string"&&ye[0].localeCompare(e)<0)&&(D=u<ye.length+1?ye[u-1]:g),P&&ye[0]>e&&($=!0)}return D}function wt(){const e=q(arguments).filter(Ne);if(e.length===0)return l;const t=ue.apply(void 0,e);if(t)return t;const u=ke(e),b=u.length;let D,P=0,$=0;for(let ie=0;ie<b;ie++)P+=u[ie],$+=1;return D=P/$,isNaN(D)&&(D=c),D}function St(){const e=q(arguments).filter(Ne);if(e.length===0)return l;const t=ue.apply(void 0,e);if(t)return t;const u=e,b=u.length;let D,P=0,$=0;for(let ie=0;ie<b;ie++){const ye=u[ie];typeof ye=="number"&&(P+=ye),ye===!0&&P++,ye!==null&&$++}return D=P/$,isNaN(D)&&(D=c),D}kt.TYPE=e=>{switch(e){case A:return 1;case l:return 2;case s:return 3;case g:return 4;case f:return 5;case c:return 6;case w:return 7;case S:return 8}return w};const ct={DIST:function(e,t,u,b,D,P){return arguments.length<4?s:(D=D===void 0?0:D,P=P===void 0?1:P,oe(e=Y(e),t=Y(t),u=Y(u),D=Y(D),P=Y(P))?s:(e=(e-D)/(P-D),b?v.beta.cdf(e,t,u):v.beta.pdf(e,t,u)))},INV:(e,t,u,b,D)=>(b=b===void 0?0:b,D=D===void 0?1:D,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b),D=Y(D))?s:v.beta.inv(e,t,u)*(D-b)+b)},Nt={DIST:(e,t,u,b)=>oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b))?s:b?v.binomial.cdf(e,t,u):v.binomial.pdf(e,t,u)};Nt.DIST.RANGE=(e,t,u,b)=>{if(b=b===void 0?u:b,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b)))return s;let D=0;for(let P=u;P<=b;P++)D+=Ye(e,P)*Math.pow(t,P)*Math.pow(1-t,e-P);return D},Nt.INV=(e,t,u)=>{if(oe(e=Y(e),t=Y(t),u=Y(u)))return s;let b=0;for(;b<=e;){if(v.binomial.cdf(b,e,t)>=u)return b;b++}};const gt={DIST:(e,t,u)=>oe(e=Y(e),t=Y(t))?s:u?v.chisquare.cdf(e,t):v.chisquare.pdf(e,t)};gt.DIST.RT=(e,t)=>!e|!t?w:e<1||t>Math.pow(10,10)?c:typeof e!="number"||typeof t!="number"?s:1-v.chisquare.cdf(e,t),gt.INV=(e,t)=>oe(e=Y(e),t=Y(t))?s:v.chisquare.inv(e,t),gt.INV.RT=(e,t)=>!e|!t?w:e<0||e>1||t<1||t>Math.pow(10,10)?c:typeof e!="number"||typeof t!="number"?s:v.chisquare.inv(1-e,t),gt.TEST=function(e,t){if(arguments.length!==2)return w;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return s;const u=e.length;let b,D,P;for(D=0;D<u;D++)e[D]instanceof Array||(b=e[D],e[D]=[],e[D].push(b)),t[D]instanceof Array||(b=t[D],t[D]=[],t[D].push(b));const $=e[0].length,ie=$===1?u-1:(u-1)*($-1);let ye=0;const Me=Math.PI;for(D=0;D<u;D++)for(P=0;P<$;P++)ye+=Math.pow(e[D][P]-t[D][P],2)/t[D][P];return Math.round(1e6*function(_e,Ve){let He=Math.exp(-.5*_e);Ve%2==1&&(He*=Math.sqrt(2*_e/Me));let Xe=Ve;for(;Xe>=2;)He=He*_e/Xe,Xe-=2;let Qe=He,nt=Ve;for(;Qe>1e-10*He;)nt+=2,Qe=Qe*_e/nt,He+=Qe;return 1-He}(ye,ie))/1e6};const j={};function T(){return ke(q(arguments)).length}function p(){const e=q(arguments);return e.length-r(e)}function r(){const e=q(arguments);let t,u=0;for(let b=0;b<e.length;b++)t=e[b],t!=null&&t!==""||u++;return u}j.NORM=(e,t,u)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:v.normalci(1,e,t,u)[1]-1,j.T=(e,t,u)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:v.tci(1,e,t,u)[1]-1;const V={P:(e,t)=>{if(oe(e=Ae(q(e)),t=Ae(q(t))))return s;const u=v.mean(e),b=v.mean(t);let D=0;const P=e.length;for(let $=0;$<P;$++)D+=(e[$]-u)*(t[$]-b);return D/P},S:(e,t)=>oe(e=Ae(q(e)),t=Ae(q(t)))?s:v.covariance(e,t)},ne={DIST:(e,t,u)=>oe(e=Y(e),t=Y(t))?s:u?v.exponential.cdf(e,t):v.exponential.pdf(e,t)},ee={};function H(e,t,u){if(oe(e=Y(e),t=Ae(q(t)),u=Ae(q(u))))return s;const b=v.mean(u),D=v.mean(t),P=u.length;let $=0,ie=0;for(let Me=0;Me<P;Me++)$+=(u[Me]-b)*(t[Me]-D),ie+=Math.pow(u[Me]-b,2);const ye=$/ie;return D-ye*b+ye*e}function O(e){return(e=Y(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?c:v.gammafn(e)}function U(e){return(e=Y(e))instanceof Error?e:v.gammaln(e)}ee.DIST=(e,t,u,b)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:b?v.centralF.cdf(e,t,u):v.centralF.pdf(e,t,u),ee.DIST.RT=function(e,t,u){return arguments.length!==3?w:e<0||t<1||u<1?c:typeof e!="number"||typeof t!="number"||typeof u!="number"?s:1-v.centralF.cdf(e,t,u)},ee.INV=(e,t,u)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:e<=0||e>1?c:v.centralF.inv(e,t,u),ee.INV.RT=function(e,t,u){return arguments.length!==3?w:e<0||e>1||t<1||t>Math.pow(10,10)||u<1||u>Math.pow(10,10)?c:typeof e!="number"||typeof t!="number"||typeof u!="number"?s:v.centralF.inv(1-e,t,u)},ee.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return w;if(e.length<2||t.length<2)return l;const u=(P,$)=>{let ie=0;for(let ye=0;ye<P.length;ye++)ie+=Math.pow(P[ye]-$,2);return ie},b=vt(e)/e.length,D=vt(t)/t.length;return u(e,b)/(e.length-1)/(u(t,D)/(t.length-1))},O.DIST=function(e,t,u,b){return arguments.length!==4?w:e<0||t<=0||u<=0||typeof e!="number"||typeof t!="number"||typeof u!="number"?s:b?v.gamma.cdf(e,t,u,!0):v.gamma.pdf(e,t,u,!1)},O.INV=function(e,t,u){return arguments.length!==3?w:e<0||e>1||t<=0||u<=0?c:typeof e!="number"||typeof t!="number"||typeof u!="number"?s:v.gamma.inv(e,t,u)},U.PRECISE=function(e){return arguments.length!==1?w:e<=0?c:typeof e!="number"?s:v.gammaln(e)};const Q={};function ae(e,t){return oe(e=Ae(q(e)),t=Y(t))?e:t<0||e.length<t?s:e.sort((u,b)=>b-u)[t-1]}function he(e,t){if(oe(e=Ae(q(e)),t=Ae(q(t))))return s;const u=v.mean(e),b=v.mean(t),D=t.length;let P=0,$=0;for(let ye=0;ye<D;ye++)P+=(t[ye]-b)*(e[ye]-u),$+=Math.pow(t[ye]-b,2);const ie=P/$;return[ie,u-ie*b]}Q.DIST=(e,t,u,b,D)=>{if(oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b)))return s;function P($,ie,ye,Me){return Ye(ye,$)*Ye(Me-ye,ie-$)/Ye(Me,ie)}return D?function($,ie,ye,Me){let _e=0;for(let Ve=0;Ve<=$;Ve++)_e+=P(Ve,ie,ye,Me);return _e}(e,t,u,b):P(e,t,u,b)};const pe={};function be(){const e=q(arguments),t=ue.apply(void 0,e);if(t)return t;const u=ke(e);return u.length===0?0:Math.max.apply(Math,u)}function Te(){const e=q(arguments),t=ue.apply(void 0,e);if(t)return t;const u=B(e);let b=v.median(u);return isNaN(b)&&(b=c),b}function Oe(){const e=q(arguments),t=ue.apply(void 0,e);if(t)return t;const u=ke(e);return u.length===0?0:Math.min.apply(Math,u)}pe.DIST=(e,t,u,b)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:b?v.lognormal.cdf(e,t,u):v.lognormal.pdf(e,t,u),pe.INV=(e,t,u)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:v.lognormal.inv(e,t,u);const De={MULT:function(){const e=Ae(q(arguments));if(e instanceof Error)return e;const t=e.length,u={};let b,D=[],P=0;for(let $=0;$<t;$++)b=e[$],u[b]=u[b]?u[b]+1:1,u[b]>P&&(P=u[b],D=[]),u[b]===P&&(D[D.length]=b);return D},SNGL:function(){const e=Ae(q(arguments));return e instanceof Error?e:De.MULT(e).sort((t,u)=>t-u)[0]}},qe={DIST:(e,t,u,b)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:b?v.negbin.cdf(e,t,u):v.negbin.pdf(e,t,u)},We={};function re(e,t){if(oe(t=Ae(q(t)),e=Ae(q(e))))return s;const u=v.mean(e),b=v.mean(t),D=e.length;let P=0,$=0,ie=0;for(let ye=0;ye<D;ye++)P+=(e[ye]-u)*(t[ye]-b),$+=Math.pow(e[ye]-u,2),ie+=Math.pow(t[ye]-b,2);return P/Math.sqrt($*ie)}We.DIST=(e,t,u,b)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:u<=0?c:b?v.normal.cdf(e,t,u):v.normal.pdf(e,t,u),We.INV=(e,t,u)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:v.normal.inv(e,t,u),We.S={},We.S.DIST=(e,t)=>(e=Y(e))instanceof Error?s:t?v.normal.cdf(e,0,1):v.normal.pdf(e,0,1),We.S.INV=e=>(e=Y(e))instanceof Error?s:v.normal.inv(e,0,1);const ve={EXC:(e,t)=>{if(oe(e=Ae(q(e)),t=Y(t)))return s;const u=(e=e.sort((P,$)=>P-$)).length;if(t<1/(u+1)||t>1-1/(u+1))return c;const b=t*(u+1)-1,D=Math.floor(b);return xe(b===D?e[b]:e[D]+(b-D)*(e[D+1]-e[D]))},INC:(e,t)=>{if(oe(e=Ae(q(e)),t=Y(t)))return s;const u=t*((e=e.sort((D,P)=>D-P)).length-1),b=Math.floor(u);return xe(u===b?e[u]:e[b]+(u-b)*(e[b+1]-e[b]))}},Le={EXC:(e,t,u)=>{if(u=u===void 0?3:u,oe(e=Ae(q(e)),t=Y(t),u=Y(u)))return s;e=e.sort((_e,Ve)=>_e-Ve);const b=It.apply(null,e),D=e.length,P=b.length,$=Math.pow(10,u);let ie=0,ye=!1,Me=0;for(;!ye&&Me<P;)t===b[Me]?(ie=(e.indexOf(b[Me])+1)/(D+1),ye=!0):t>=b[Me]&&(t<b[Me+1]||Me===P-1)&&(ie=(e.indexOf(b[Me])+1+(t-b[Me])/(b[Me+1]-b[Me]))/(D+1),ye=!0),Me++;return Math.floor(ie*$)/$},INC:(e,t,u)=>{if(u=u===void 0?3:u,oe(e=Ae(q(e)),t=Y(t),u=Y(u)))return s;e=e.sort((_e,Ve)=>_e-Ve);const b=It.apply(null,e),D=e.length,P=b.length,$=Math.pow(10,u);let ie=0,ye=!1,Me=0;for(;!ye&&Me<P;)t===b[Me]?(ie=e.indexOf(b[Me])/(D-1),ye=!0):t>=b[Me]&&(t<b[Me+1]||Me===P-1)&&(ie=(e.indexOf(b[Me])+(t-b[Me])/(b[Me+1]-b[Me]))/(D-1),ye=!0),Me++;return Math.floor(ie*$)/$}},X={DIST:(e,t,u)=>oe(e=Y(e),t=Y(t))?s:u?v.poisson.cdf(e,t):v.poisson.pdf(e,t)},Z={EXC:(e,t)=>{if(oe(e=Ae(q(e)),t=Y(t)))return s;switch(t){case 1:return ve.EXC(e,.25);case 2:return ve.EXC(e,.5);case 3:return ve.EXC(e,.75);default:return c}},INC:(e,t)=>{if(oe(e=Ae(q(e)),t=Y(t)))return s;switch(t){case 1:return ve.INC(e,.25);case 2:return ve.INC(e,.5);case 3:return ve.INC(e,.75);default:return c}}},E={};function F(){const e=Ae(q(arguments));if(e instanceof Error)return e;const t=v.mean(e),u=e.length;let b=0;for(let D=0;D<u;D++)b+=Math.pow(e[D]-t,3);return u*b/((u-1)*(u-2)*Math.pow(v.stdev(e,!0),3))}function J(e,t){return oe(e=Ae(q(e)),t=Y(t))?e:e.sort((u,b)=>u-b)[t-1]}E.AVG=(e,t,u)=>{if(oe(e=Y(e),t=Ae(q(t))))return s;const b=(u=u||!1)?($,ie)=>$-ie:($,ie)=>ie-$,D=(t=(t=q(t)).sort(b)).length;let P=0;for(let $=0;$<D;$++)t[$]===e&&P++;return P>1?(2*t.indexOf(e)+P+1)/2:t.indexOf(e)+1},E.EQ=(e,t,u)=>{if(oe(e=Y(e),t=Ae(q(t))))return s;const b=(u=u||!1)?(D,P)=>D-P:(D,P)=>P-D;return(t=t.sort(b)).indexOf(e)+1},F.P=function(){const e=Ae(q(arguments));if(e instanceof Error)return e;const t=v.mean(e),u=e.length;let b=0,D=0;for(let P=0;P<u;P++)D+=Math.pow(e[P]-t,3),b+=Math.pow(e[P]-t,2);return D/=u,b/=u,D/Math.pow(b,1.5)};const de={P:function(){const e=fe.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=c),t},S:function(){const e=fe.S.apply(this,arguments);return Math.sqrt(e)}},K={DIST:(e,t,u)=>u!==1&&u!==2?c:u===1?K.DIST.RT(e,t):K.DIST["2T"](e,t)};K.DIST["2T"]=function(e,t){return arguments.length!==2?w:e<0||t<1?c:typeof e!="number"||typeof t!="number"?s:2*(1-v.studentt.cdf(e,t))},K.DIST.RT=function(e,t){return arguments.length!==2?w:e<0||t<1?c:typeof e!="number"||typeof t!="number"?s:1-v.studentt.cdf(e,t)},K.INV=(e,t)=>oe(e=Y(e),t=Y(t))?s:v.studentt.inv(e,t),K.INV["2T"]=(e,t)=>(e=Y(e),t=Y(t),e<=0||e>1||t<1?c:oe(e,t)?s:Math.abs(v.studentt.inv(e/2,t))),K.TEST=(e,t)=>{if(oe(e=Ae(q(e)),t=Ae(q(t))))return s;const u=v.mean(e),b=v.mean(t);let D,P=0,$=0;for(D=0;D<e.length;D++)P+=Math.pow(e[D]-u,2);for(D=0;D<t.length;D++)$+=Math.pow(t[D]-b,2);P/=e.length-1,$/=t.length-1;const ie=Math.abs(u-b)/Math.sqrt(P/e.length+$/t.length);return K.DIST["2T"](ie,e.length+t.length-2)};const fe={};function Ee(){const e=q(arguments),t=e.length;let u=0,b=0;const D=St(e);for(let P=0;P<t;P++){const $=e[P];u+=Math.pow(typeof $=="number"?$-D:$===!0?1-D:0-D,2),$!==null&&b++}return u/(b-1)}function te(){const e=q(arguments),t=e.length;let u=0,b=0;const D=St(e);let P;for(let $=0;$<t;$++){const ie=e[$];u+=Math.pow(typeof ie=="number"?ie-D:ie===!0?1-D:0-D,2),ie!==null&&b++}return P=u/b,isNaN(P)&&(P=c),P}fe.P=function(){const e=ke(q(arguments)),t=e.length;let u=0;const b=wt(e);let D;for(let P=0;P<t;P++)u+=Math.pow(e[P]-b,2);return D=u/t,isNaN(D)&&(D=c),D},fe.S=function(){const e=ke(q(arguments)),t=e.length;let u=0;const b=wt(e);for(let D=0;D<t;D++)u+=Math.pow(e[D]-b,2);return u/(t-1)};const le={DIST:(e,t,u,b)=>oe(e=Y(e),t=Y(t),u=Y(u))?s:b?1-Math.exp(-Math.pow(e/u,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/u,t))*t/Math.pow(u,t)},we={};function je(e,t,u){const b=ue(e=Y(e),t=Y(t),u=Y(u));if(b)return b;if(t===0)return 0;t=Math.abs(t);const D=-Math.floor(Math.log(t)/Math.log(10));return e>=0?mt(Math.ceil(e/t)*t,D):u===0?-mt(Math.floor(Math.abs(e)/t)*t,D):-mt(Math.ceil(Math.abs(e)/t)*t,D)}function Ye(e,t){return ue(e=Y(e),t=Y(t))||(e<t?c:Je(e)/(Je(t)*Je(e-t)))}we.TEST=(e,t,u)=>{if(oe(e=Ae(q(e)),t=Y(t)))return s;u=u||de.S(e);const b=e.length;return 1-We.S.DIST((wt(e)-t)/(u/Math.sqrt(b)),!0)},je.MATH=je,je.PRECISE=je;const Ue=[];function Je(e){if((e=Y(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(Ue[t]>0||(Ue[t]=Je(t-1)*t),Ue[t])}function Ge(e,t){const u=ue(e=Y(e),t=Y(t));if(u)return u;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return c;t=Math.abs(t);const b=-Math.floor(Math.log(t)/Math.log(10));return e>=0?mt(Math.floor(e/t)*t,b):-mt(Math.ceil(Math.abs(e)/t),b)}Ge.MATH=(e,t,u)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const b=ue(e=Y(e),t=Y(t),u=Y(u));if(b)return b;if(t===0)return 0;t=t?Math.abs(t):1;const D=-Math.floor(Math.log(t)/Math.log(10));return e>=0?mt(Math.floor(e/t)*t,D):u===0||u===void 0?-mt(Math.ceil(Math.abs(e)/t)*t,D):-mt(Math.floor(Math.abs(e)/t)*t,D)},Ge.PRECISE=Ge.MATH;const tt={CEILING:je};function Ot(e,t){const u=ue(e=Y(e),t=Y(t));if(u)return u;if(e===0&&t===0)return c;const b=Math.pow(e,t);return isNaN(b)?c:b}function zt(){const e=q(arguments).filter(b=>b!=null);if(e.length===0)return 0;const t=Ae(e);if(t instanceof Error)return t;let u=1;for(let b=0;b<t.length;b++)u*=t[b];return u}function mt(e,t){return ue(e=Y(e),t=Y(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function vt(){let e=0;return M(_(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const u=parseFloat(t);!isNaN(u)&&(e+=u)}else if(Array.isArray(t)){const u=vt.apply(null,t);u instanceof Error?e=u:e+=u}}),e}var yt=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?w:ue(e=Y(e),t=Y(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?w:ue(e=Y(e),t=Y(t))||(t===0?l:e/t)},EQ:function(e,t){return arguments.length!==2?w:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?w:e instanceof Error?e:t instanceof Error?t:(rt(e,t)?(e=Fe(e),t=Fe(t)):(e=Y(e),t=Y(t)),ue(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?w:(rt(e,t)?(e=Fe(e),t=Fe(t)):(e=Y(e),t=Y(t)),ue(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?w:(rt(e,t)?(e=Fe(e),t=Fe(t)):(e=Y(e),t=Y(t)),ue(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?w:(rt(e,t)?(e=Fe(e),t=Fe(t)):(e=Y(e),t=Y(t)),ue(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?w:ue(e=Y(e),t=Y(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?w:ue(e=Y(e),t=Y(t))||e*t},NE:function(e,t){return arguments.length!==2?w:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?w:Ot(e,t)}});const at=new Date(Date.UTC(1900,0,1)),Ke=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],hn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Ft=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Dt(e,t,u){u=u.toUpperCase(),e=Se(e),t=Se(t);const b=e.getFullYear(),D=e.getMonth(),P=e.getDate(),$=t.getFullYear(),ie=t.getMonth(),ye=t.getDate();let Me;switch(u){case"Y":Me=Math.floor(Gt(e,t));break;case"D":Me=jt(t,e);break;case"M":Me=ie-D+12*($-b),ye<P&&Me--;break;case"MD":P<=ye?Me=ye-P:(ie===0?(e.setFullYear($-1),e.setMonth(12)):(e.setFullYear($),e.setMonth(ie-1)),Me=jt(t,e));break;case"YM":Me=ie-D+12*($-b),ye<P&&Me--,Me%=12;break;case"YD":ie>D||ie===D&&ye<P?e.setFullYear($):e.setFullYear($-1),Me=jt(t,e)}return Me}function Pt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function jt(e,t){return e=Se(e),t=Se(t),e instanceof Error?e:t instanceof Error?t:sn(Pt(e))-sn(Pt(t))}function xt(e,t,u){if(u=Re(u||"false"),e=Se(e),t=Se(t),e instanceof Error)return e;if(t instanceof Error)return t;if(u instanceof Error)return u;const b=e.getMonth();let D,P,$=t.getMonth();if(u)D=e.getDate()===31?30:e.getDate(),P=t.getDate()===31?30:t.getDate();else{const ie=new Date(e.getFullYear(),b+1,0).getDate(),ye=new Date(t.getFullYear(),$+1,0).getDate();D=e.getDate()===ie?30:e.getDate(),t.getDate()===ye?D<30?($++,P=1):P=30:P=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*($-b)+(P-D)}function on(e){if((e=Se(e))instanceof Error)return e;(e=Pt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Vt(e,t,u){return Vt.INTL(e,t,1,u)}function Ut(e,t,u){return Ut.INTL(e,t,1,u)}function Xt(e){return new Date(e,1,29).getMonth()===1}function qt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function Gt(e,t,u){if((e=Se(e))instanceof Error)return e;if((t=Se(t))instanceof Error)return t;u=u||0;let b=e.getDate();const D=e.getMonth()+1,P=e.getFullYear();let $=t.getDate();const ie=t.getMonth()+1,ye=t.getFullYear();switch(u){case 0:return b===31&&$===31?(b=30,$=30):b===31?b=30:b===30&&$===31&&($=30),($+30*ie+360*ye-(b+30*D+360*P))/360;case 1:{const Me=(Xe,Qe)=>{const nt=Xe.getFullYear(),pt=new Date(nt,2,1);if(Xt(nt)&&Xe<pt&&Qe>=pt)return!0;const lt=Qe.getFullYear(),Ct=new Date(lt,2,1);return Xt(lt)&&Qe>=Ct&&Xe<Ct};let _e=365;if(P===ye||P+1===ye&&(D>ie||D===ie&&b>=$))return(P===ye&&Xt(P)||Me(e,t)||ie===1&&$===29)&&(_e=366),qt(e,t)/_e;const Ve=ye-P+1,He=(new Date(ye+1,0,1)-new Date(P,0,1))/1e3/60/60/24/Ve;return qt(e,t)/He}case 2:return qt(e,t)/360;case 3:return qt(e,t)/365;case 4:return($+30*ie+360*ye-(b+30*D+360*P))/360}}function sn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-at)/864e5)+t}function an(e){return(e=Y(e))===0?s:e instanceof Error?e:String.fromCharCode(e)}function ln(e){if(oe(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=s),t}function cn(){const e=q(arguments),t=ue.apply(void 0,e);if(t)return t;let u=0;for(;(u=e.indexOf(!0))>-1;)e[u]="TRUE";let b=0;for(;(b=e.indexOf(!1))>-1;)e[b]="FALSE";return e.join("")}Vt.INTL=(e,t,u,b)=>{if((e=Se(e))instanceof Error)return e;if((t=Se(t))instanceof Error)return t;let D=!1;const P=[],$=[1,2,3,4,5,6,0],ie=new RegExp("^[0|1]{7}$");if(u===void 0)u=Ft[1];else if(typeof u=="string"&&ie.test(u)){D=!0,u=u.split("");for(let Ve=0;Ve<u.length;Ve++)u[Ve]==="1"&&P.push($[Ve])}else u=Ft[u];if(!(u instanceof Array))return s;b===void 0?b=[]:b instanceof Array||(b=[b]);for(let Ve=0;Ve<b.length;Ve++){const He=Se(b[Ve]);if(He instanceof Error)return He;b[Ve]=He}const ye=Math.round((t-e)/864e5)+1;let Me=ye;const _e=e;for(let Ve=0;Ve<ye;Ve++){const He=new Date().getTimezoneOffset()>0?_e.getUTCDay():_e.getDay();let Xe=D?P.includes(He):He===u[0]||He===u[1];for(let Qe=0;Qe<b.length;Qe++){const nt=b[Qe];if(nt.getDate()===_e.getDate()&&nt.getMonth()===_e.getMonth()&&nt.getFullYear()===_e.getFullYear()){Xe=!0;break}}Xe&&Me--,_e.setDate(_e.getDate()+1)}return Me},Ut.INTL=(e,t,u,b)=>{if((e=Se(e))instanceof Error)return e;if((t=Y(t))instanceof Error)return t;if(t<0)return c;if(!((u=u===void 0?Ft[1]:Ft[u])instanceof Array))return s;b===void 0?b=[]:b instanceof Array||(b=[b]);for(let P=0;P<b.length;P++){const $=Se(b[P]);if($ instanceof Error)return $;b[P]=$}let D=0;for(;D<t;){e.setDate(e.getDate()+1);const P=e.getDay();if(P!==u[0]&&P!==u[1]){for(let $=0;$<b.length;$++){const ie=b[$];if(ie.getDate()===e.getDate()&&ie.getMonth()===e.getMonth()&&ie.getFullYear()===e.getFullYear()){D--;break}}D++}}return e};const gn=cn;function un(e,t=2,u=!1){if(e=Y(e),isNaN(e)||(t=Y(t),isNaN(t)))return s;if(t<0){const b=Math.pow(10,-t);e=Math.round(e/b)*b}else e=e.toFixed(t);if(u)e=e.toString().replace(/,/g,"");else{const b=e.toString().split(".");b[0]=b[0].replace(/\B(?=(\d{3})+$)/g,","),e=b.join(".")}return e}function ht(e,t){return ue(e,t)||(e=Fe(e),(t=Y(t))instanceof Error?t:new Array(t+1).join(e))}const mn=an,vn=ln;function $t(e){return/^[01]{1,10}$/.test(e)}function ut(e,t,u){if(oe(e=Y(e),t=Y(t)))return e;if((u=u===void 0?"i":u)!=="i"&&u!=="j")return s;if(e===0&&t===0)return 0;if(e===0)return t===1?u:t.toString()+u;if(t===0)return e.toString();{const b=t>0?"+":"";return e.toString()+b+(t===1?u:t.toString()+u)}}function Kt(e,t){return t=t===void 0?0:t,oe(e=Y(e),t=Y(t))?s:v.erf(e)}function Jt(e){return isNaN(e)?s:v.erfc(e)}function Qt(e){const t=st(e),u=ot(e);return oe(t,u)?s:Math.sqrt(Math.pow(t,2)+Math.pow(u,2))}function ot(e){if(e===void 0||e===!0||e===!1)return s;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),u=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),u===0&&(u=e.indexOf("-",1));const b=e.substring(e.length-1,e.length),D=b==="i"||b==="j";return t>=0||u>=0?D?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?c:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,u))||isNaN(e.substring(u+1,e.length-1))?c:-Number(e.substring(u+1,e.length-1)):c:D?isNaN(e.substring(0,e.length-1))?c:e.substring(0,e.length-1):isNaN(e)?c:0}function Zt(e){const t=st(e),u=ot(e);return oe(t,u)?s:t===0&&u===0?l:t===0&&u>0?Math.PI/2:t===0&&u<0?-Math.PI/2:u===0&&t>0?0:u===0&&t<0?-Math.PI:t>0?Math.atan(u/t):t<0&&u>=0?Math.atan(u/t)+Math.PI:Math.atan(u/t)-Math.PI}function Wt(e){const t=st(e),u=ot(e);if(oe(t,u))return s;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ut(Math.cos(t)*(Math.exp(u)+Math.exp(-u))/2,-Math.sin(t)*(Math.exp(u)-Math.exp(-u))/2,b)}function dn(e){const t=st(e),u=ot(e);if(oe(t,u))return s;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ut(Math.cos(u)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(u)*(Math.exp(t)-Math.exp(-t))/2,b)}function At(e,t){const u=st(e),b=ot(e),D=st(t),P=ot(t);if(oe(u,b,D,P))return s;const $=e.substring(e.length-1),ie=t.substring(t.length-1);let ye="i";if(($==="j"||ie==="j")&&(ye="j"),D===0&&P===0)return c;const Me=D*D+P*P;return ut((u*D+b*P)/Me,(b*D-u*P)/Me,ye)}function st(e){if(e===void 0||e===!0||e===!1)return s;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),u=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),u===0&&(u=e.indexOf("-",1));const b=e.substring(e.length-1,e.length),D=b==="i"||b==="j";return t>=0||u>=0?D?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?c:Number(e.substring(0,t)):isNaN(e.substring(0,u))||isNaN(e.substring(u+1,e.length-1))?c:Number(e.substring(0,u)):c:D?isNaN(e.substring(0,e.length-1))?c:0:isNaN(e)?c:e}function Yt(e){const t=st(e),u=ot(e);if(oe(t,u))return s;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ut(Math.sin(t)*(Math.exp(u)+Math.exp(-u))/2,Math.cos(t)*(Math.exp(u)-Math.exp(-u))/2,b)}function fn(e){const t=st(e),u=ot(e);if(oe(t,u))return s;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ut(Math.cos(u)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(u)*(Math.exp(t)+Math.exp(-t))/2,b)}Kt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Jt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const yn=ct.DIST,bn=ct.INV,wn=Nt.DIST,xn=je.MATH,Cn=je.PRECISE,En=gt.DIST,jn=gt.DIST.RT,An=gt.INV,Ln=gt.INV.RT,Mn=gt.TEST,Nn=V.P,In=V.P,Tn=V.S,Sn=Nt.INV,On=Jt.PRECISE,Dn=Kt.PRECISE,_n=ne.DIST,kn=ee.DIST,Rn=ee.DIST.RT,Bn=ee.INV,Hn=ee.INV.RT,Fn=Ge.MATH,Pn=Ge.PRECISE,Vn=ee.TEST,Un=O.DIST,qn=O.INV,Wn=U.PRECISE,Yn=Q.DIST,zn=pe.INV,Xn=pe.DIST,Gn=pe.INV,$n=De.MULT,Kn=De.SNGL,Jn=qe.DIST,Qn=Vt.INTL,Zn=We.DIST,er=We.INV,tr=We.S.DIST,nr=We.S.INV,rr=ve.EXC,or=ve.INC,sr=Le.EXC,ir=Le.INC,ar=X.DIST,lr=Z.EXC,cr=Z.INC,ur=E.AVG,dr=E.EQ,fr=F.P,pr=de.P,hr=de.S,gr=K.DIST,mr=K.DIST.RT,vr=K.INV,yr=K.TEST,br=fe.P,wr=fe.S,xr=le.DIST,Cr=Ut.INTL,Er=we.TEST;function en(e){const t=[];return M(e,u=>{u&&t.push(u)}),t}function bt(e,t){const u={};for(let P=1;P<e[0].length;++P)u[P]=!0;let b=t[0].length;for(let P=1;P<t.length;++P)t[P].length>b&&(b=t[P].length);for(let P=1;P<e.length;++P)for(let $=1;$<e[P].length;++$){let ie=!1,ye=!1;for(let Me=0;Me<t.length;++Me){const _e=t[Me];if(_e.length<b)continue;const Ve=_e[0];if(e[P][0]===Ve){ye=!0;for(let He=1;He<_e.length;++He)if(!ie)if(_e[He]===void 0||_e[He]==="*")ie=!0;else{const Xe=dt(_e[He]+""),Qe=[it(e[P][$],et)].concat(Xe);ie=ft(Qe)}}}ye&&(u[$]=u[$]&&ie)}const D=[];for(let P=0;P<e[0].length;++P)u[P]&&D.push(P-1);return D}function tn(e){return e&&e.getTime&&!isNaN(e.getTime())}function nn(e){return e instanceof Date?e:new Date(e)}function Lt(e,t,u,b,D){if(b=b||0,D=D||0,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b),D=Y(D)))return s;let P;if(e===0)P=b+u*t;else{const $=Math.pow(1+e,t);P=D===1?b*$+u*(1+e)*($-1)/e:b*$+u*($-1)/e}return-P}function pn(e,t,u,b,D,P){if(D=D||0,P=P||0,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b),D=Y(D),P=Y(P)))return s;const $=_t(e,u,b,D,P);return(t===1?P===1?0:-b:P===1?Lt(e,t-2,$,b,1)-$:Lt(e,t-1,$,b,0))*e}function rn(){const e=Ae(q(arguments));if(e instanceof Error)return e;const t=e[0];let u=0;for(let b=1;b<e.length;b++)u+=e[b]/Math.pow(1+t,b);return u}function _t(e,t,u,b,D){if(b=b||0,D=D||0,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b),D=Y(D)))return s;let P;if(e===0)P=(u+b)/t;else{const $=Math.pow(1+e,t);P=D===1?(b*e/($-1)+u*e/(1-1/$))/(1+e):b*e/($-1)+u*e/(1-1/$)}return-P}const jr={errors:k,symbols:yt};m.ABS=function(e){return(e=Y(e))instanceof Error?e:Math.abs(e)},m.ACCRINT=function(e,t,u,b,D,P,$){return e=nn(e),t=nn(t),u=nn(u),tn(e)&&tn(t)&&tn(u)?b<=0||D<=0||[1,2,4].indexOf(P)===-1||[0,1,2,3,4].indexOf($)===-1||u<=e?c:(D=D||0)*b*Gt(e,u,$=$||0):s},m.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},m.ACOS=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=c),t},m.ACOSH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=c),t},m.ACOT=function(e){return(e=Y(e))instanceof Error?e:Math.atan(1/e)},m.ACOTH=function(e){if((e=Y(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=c),t},m.AGGREGATE=function(e,t,u,b){if(oe(e=Y(e),Y(e)))return s;switch(e){case 1:return wt(u);case 2:return T(u);case 3:return p(u);case 4:return be(u);case 5:return Oe(u);case 6:return zt(u);case 7:return de.S(u);case 8:return de.P(u);case 9:return vt(u);case 10:return fe.S(u);case 11:return fe.P(u);case 12:return Te(u);case 13:return De.SNGL(u);case 14:return ae(u,b);case 15:return J(u,b);case 16:return ve.INC(u,b);case 17:return Z.INC(u,b);case 18:return ve.EXC(u,b);case 19:return Z.EXC(u,b)}},m.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},m.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},m.AND=function(){const e=q(arguments);let t=s;for(let u=0;u<e.length;u++){if(e[u]instanceof Error)return e[u];e[u]!==void 0&&e[u]!==null&&typeof e[u]!="string"&&(t===s&&(t=!0),e[u]||(t=!1))}return t},m.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return s;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,u=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[u]}),t},m.ASC=function(){throw new Error("ASC is not implemented")},m.ASIN=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=c),t},m.ASINH=function(e){return(e=Y(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},m.ATAN=function(e){return(e=Y(e))instanceof Error?e:Math.atan(e)},m.ATAN2=function(e,t){return ue(e=Y(e),t=Y(t))||Math.atan2(e,t)},m.ATANH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=c),t},m.AVEDEV=function(){const e=q(arguments).filter(Ne);if(e.length===0)return c;const t=Ae(e);return t instanceof Error?t:v.sum(v(t).subtract(v.mean(t)).abs()[0])/t.length},m.AVERAGE=wt,m.AVERAGEA=St,m.AVERAGEIF=function(e,t,u){if(arguments.length<=1)return w;if(u=Ae(q(u=u||e).filter(Ne)),e=q(e),u instanceof Error)return u;let b=0,D=0;const P=t===void 0||t==="*",$=P?null:dt(t+"");for(let ie=0;ie<e.length;ie++){const ye=e[ie];if(P)D+=u[ie],b++;else{const Me=[it(ye,et)].concat($);ft(Me)&&(D+=u[ie],b++)}}return D/b},m.AVERAGEIFS=function(){const e=_(arguments),t=(e.length-1)/2,u=q(e[0]);let b=0,D=0;for(let $=0;$<u.length;$++){let ie=!1;for(let ye=0;ye<t;ye++){const Me=e[2*ye+1][$],_e=e[2*ye+2];let Ve=!1;if(_e===void 0||_e==="*")Ve=!0;else{const He=dt(_e+""),Xe=[it(Me,et)].concat(He);Ve=ft(Xe)}if(!Ve){ie=!1;break}ie=!0}ie&&(D+=u[$],b++)}const P=D/b;return isNaN(P)?0:P},m.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},m.BASE=function(e,t,u){const b=ue(e=Y(e),t=Y(t),u=Y(u));if(b)return b;if(t===0)return c;const D=e.toString(t);return new Array(Math.max(u+1-D.length,0)).join("0")+D},m.BESSELI=function(e,t){return oe(e=Y(e),t=Y(t))?s:I.besseli(e,t)},m.BESSELJ=function(e,t){return oe(e=Y(e),t=Y(t))?s:I.besselj(e,t)},m.BESSELK=function(e,t){return oe(e=Y(e),t=Y(t))?s:I.besselk(e,t)},m.BESSELY=function(e,t){return oe(e=Y(e),t=Y(t))?s:I.bessely(e,t)},m.BETA=ct,m.BETADIST=yn,m.BETAINV=bn,m.BIN2DEC=function(e){if(!$t(e))return c;const t=parseInt(e,2),u=e.toString();return u.length===10&&u.substring(0,1)==="1"?parseInt(u.substring(1),2)-512:t},m.BIN2HEX=function(e,t){if(!$t(e))return c;const u=e.toString();if(u.length===10&&u.substring(0,1)==="1")return(0xfffffffe00+parseInt(u.substring(1),2)).toString(16);const b=parseInt(e,2).toString(16);return t===void 0?b:isNaN(t)?s:t<0?c:(t=Math.floor(t))>=b.length?ht("0",t-b.length)+b:c},m.BIN2OCT=function(e,t){if(!$t(e))return c;const u=e.toString();if(u.length===10&&u.substring(0,1)==="1")return(1073741312+parseInt(u.substring(1),2)).toString(8);const b=parseInt(e,2).toString(8);return t===void 0?b:isNaN(t)?s:t<0?c:(t=Math.floor(t))>=b.length?ht("0",t-b.length)+b:c},m.BINOM=Nt,m.BINOMDIST=wn,m.BITAND=function(e,t){return oe(e=Y(e),t=Y(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?c:e&t},m.BITLSHIFT=function(e,t){return oe(e=Y(e),t=Y(t))?s:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?c:t>=0?e<<t:e>>-t},m.BITOR=function(e,t){return oe(e=Y(e),t=Y(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?c:e|t},m.BITRSHIFT=function(e,t){return oe(e=Y(e),t=Y(t))?s:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?c:t>=0?e>>t:e<<-t},m.BITXOR=function(e,t){return oe(e=Y(e),t=Y(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?c:e^t},m.CEILING=je,m.CEILINGMATH=xn,m.CEILINGPRECISE=Cn,m.CELL=function(){throw new Error("CELL is not implemented")},m.CHAR=an,m.CHIDIST=En,m.CHIDISTRT=jn,m.CHIINV=An,m.CHIINVRT=Ln,m.CHISQ=gt,m.CHITEST=Mn,m.CHOOSE=function(){if(arguments.length<2)return w;const e=arguments[0];return e<1||e>254||arguments.length<e+1?s:arguments[e]},m.CLEAN=function(e){return oe(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},m.CODE=ln,m.COLUMN=function(e,t){return arguments.length!==2?w:t<0?c:e instanceof Array&&typeof t=="number"?e.length!==0?v.col(e,t):void 0:s},m.COLUMNS=function(e){return arguments.length!==1?w:e instanceof Array?e.length===0?0:v.cols(e):s},m.COMBIN=Ye,m.COMBINA=function(e,t){return ue(e=Y(e),t=Y(t))||(e<t?c:e===0&&t===0?1:Ye(e+t-1,e-1))},m.COMPLEX=ut,m.CONCAT=gn,m.CONCATENATE=cn,m.CONFIDENCE=j,m.CONVERT=function(e,t,u){if((e=Y(e))instanceof Error)return e;const b=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],D={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},P={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let $,ie=null,ye=null,Me=t,_e=u,Ve=1,He=1;for(let Xe=0;Xe<b.length;Xe++)$=b[Xe][2]===null?[]:b[Xe][2],(b[Xe][1]===Me||$.indexOf(Me)>=0)&&(ie=b[Xe]),(b[Xe][1]===_e||$.indexOf(_e)>=0)&&(ye=b[Xe]);if(ie===null){const Xe=D[t.substring(0,2)];let Qe=P[t.substring(0,1)];t.substring(0,2)==="da"&&(Qe=["dekao",10,"da"]),Xe?(Ve=Xe[2],Me=t.substring(2)):Qe&&(Ve=Qe[1],Me=t.substring(Qe[2].length));for(let nt=0;nt<b.length;nt++)$=b[nt][2]===null?[]:b[nt][2],(b[nt][1]===Me||$.indexOf(Me)>=0)&&(ie=b[nt])}if(ye===null){const Xe=D[u.substring(0,2)];let Qe=P[u.substring(0,1)];u.substring(0,2)==="da"&&(Qe=["dekao",10,"da"]),Xe?(He=Xe[2],_e=u.substring(2)):Qe&&(He=Qe[1],_e=u.substring(Qe[2].length));for(let nt=0;nt<b.length;nt++)$=b[nt][2]===null?[]:b[nt][2],(b[nt][1]===_e||$.indexOf(_e)>=0)&&(ye=b[nt])}return ie===null||ye===null||ie[3]!==ye[3]?w:e*ie[6]*Ve/(ye[6]*He)},m.CORREL=function(e,t){return oe(e=Ae(q(e)),t=Ae(q(t)))?s:v.corrcoeff(e,t)},m.COS=function(e){return(e=Y(e))instanceof Error?e:Math.cos(e)},m.COSH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},m.COT=function(e){return(e=Y(e))instanceof Error?e:e===0?l:1/Math.tan(e)},m.COTH=function(e){if((e=Y(e))instanceof Error)return e;if(e===0)return l;const t=Math.exp(2*e);return(t+1)/(t-1)},m.COUNT=T,m.COUNTA=p,m.COUNTBLANK=r,m.COUNTIF=function(e,t){if(e=q(e),t===void 0||t==="*")return e.length;let u=0;const b=dt(t+"");for(let D=0;D<e.length;D++){const P=[it(e[D],et)].concat(b);ft(P)&&u++}return u},m.COUNTIFS=function(){const e=_(arguments),t=new Array(q(e[0]).length);for(let b=0;b<t.length;b++)t[b]=!0;for(let b=0;b<e.length;b+=2){const D=q(e[b]),P=e[b+1];if(P!==void 0&&P!=="*"){const $=dt(P+"");for(let ie=0;ie<D.length;ie++){const ye=[it(D[ie],et)].concat($);t[ie]=t[ie]&&ft(ye)}}}let u=0;for(let b=0;b<t.length;b++)t[b]&&u++;return u},m.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},m.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},m.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},m.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},m.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},m.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},m.COVAR=Nn,m.COVARIANCE=V,m.COVARIANCEP=In,m.COVARIANCES=Tn,m.CRITBINOM=Sn,m.CSC=function(e){return(e=Y(e))instanceof Error?e:e===0?l:1/Math.sin(e)},m.CSCH=function(e){return(e=Y(e))instanceof Error?e:e===0?l:2/(Math.exp(e)-Math.exp(-e))},m.CUMIPMT=function(e,t,u,b,D,P){if(oe(e=Y(e),t=Y(t),u=Y(u)))return s;if(e<=0||t<=0||u<=0||b<1||D<1||b>D||P!==0&&P!==1)return c;const $=_t(e,t,u,0,P);let ie=0;b===1&&(P===0&&(ie=-u),b++);for(let ye=b;ye<=D;ye++)ie+=P===1?Lt(e,ye-2,$,u,1)-$:Lt(e,ye-1,$,u,0);return ie*=e,ie},m.CUMPRINC=function(e,t,u,b,D,P){if(oe(e=Y(e),t=Y(t),u=Y(u)))return s;if(e<=0||t<=0||u<=0||b<1||D<1||b>D||P!==0&&P!==1)return c;const $=_t(e,t,u,0,P);let ie=0;b===1&&(ie=P===0?$+u*e:$,b++);for(let ye=b;ye<=D;ye++)ie+=P>0?$-(Lt(e,ye-2,$,u,1)-$)*e:$-Lt(e,ye-1,$,u,0)*e;return ie},m.DATE=function(e,t,u){let b;return oe(e=Y(e),t=Y(t),u=Y(u))?b=s:(b=new Date(e,t-1,u),b.getFullYear()<0&&(b=c)),b},m.DATEDIF=Dt,m.DATEVALUE=function(e){if(typeof e!="string")return s;const t=Date.parse(e);return isNaN(t)?s:new Date(e)},m.DAVERAGE=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);let P=0;return M(b,$=>{P+=D[$]}),b.length===0?l:P/b.length},m.DAY=function(e){const t=Se(e);return t instanceof Error?t:t.getDate()},m.DAYS=jt,m.DAYS360=xt,m.DB=function(e,t,u,b,D){if(D=D===void 0?12:D,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b),D=Y(D)))return s;if(e<0||t<0||u<0||b<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(D)===-1||b>u)return c;if(t>=e)return 0;const P=(1-Math.pow(t/e,1/u)).toFixed(3),$=e*P*D/12;let ie=$,ye=0;const Me=b===u?u-1:b;for(let _e=2;_e<=Me;_e++)ye=(e-ie)*P,ie+=ye;return b===1?$:b===u?(e-ie)*P:ye},m.DBCS=function(){throw new Error("DBCS is not implemented")},m.DCOUNT=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);const P=[];return M(b,$=>{P.push(D[$])}),T(P)},m.DCOUNTA=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);const P=[];return M(b,$=>{P.push(D[$])}),p(P)},m.DDB=function(e,t,u,b,D){if(D=D===void 0?2:D,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b),D=Y(D)))return s;if(e<0||t<0||u<0||b<0||D<=0||b>u)return c;if(t>=e)return 0;let P=0,$=0;for(let ie=1;ie<=b;ie++)$=Math.min(D/u*(e-P),e-t-P),P+=$;return $},m.DEC2BIN=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return c;if(e<0)return"1"+ht("0",9-(512+e).toString(2).length)+(512+e).toString(2);const u=parseInt(e,10).toString(2);return t===void 0?u:isNaN(t)?s:t<0?c:(t=Math.floor(t))>=u.length?ht("0",t-u.length)+u:c},m.DEC2HEX=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return c;if(e<0)return(1099511627776+e).toString(16);const u=parseInt(e,10).toString(16);return t===void 0?u:isNaN(t)?s:t<0?c:(t=Math.floor(t))>=u.length?ht("0",t-u.length)+u:c},m.DEC2OCT=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return c;if(e<0)return(1073741824+e).toString(8);const u=parseInt(e,10).toString(8);return t===void 0?u:isNaN(t)?s:t<0?c:(t=Math.floor(t))>=u.length?ht("0",t-u.length)+u:c},m.DECIMAL=function(e,t){return arguments.length<1?s:ue(e=Y(e),t=Y(t))||(t===0?c:parseInt(e,t))},m.DEGREES=function(e){return(e=Y(e))instanceof Error?e:180*e/Math.PI},m.DELTA=function(e,t){return t=t===void 0?0:t,oe(e=Y(e),t=Y(t))?s:e===t?1:0},m.DEVSQ=function(){const e=Ae(q(arguments));if(e instanceof Error)return e;const t=v.mean(e);let u=0;for(let b=0;b<e.length;b++)u+=Math.pow(e[b]-t,2);return u},m.DGET=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];return D=G(typeof t=="string"?e[ge(e,t)]:e[t]),b.length===0?s:b.length>1?c:D[b[0]]},m.DISC=function(e,t,u,b,D){if(oe(e=Se(e),t=Se(t),u=Y(u),b=Y(b),D=(D=Y(D))||0))return s;if(u<=0||b<=0)return c;if(e>=t)return s;let P,$;switch(D){case 0:P=360,$=xt(e,t,!1);break;case 1:case 3:P=365,$=Dt(e,t,"D");break;case 2:P=360,$=Dt(e,t,"D");break;case 4:P=360,$=xt(e,t,!0);break;default:return c}return(b-u)/b*P/$},m.DMAX=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);let P=D[b[0]];return M(b,$=>{P<D[$]&&(P=D[$])}),P},m.DMIN=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);let P=D[b[0]];return M(b,$=>{P>D[$]&&(P=D[$])}),P},m.DOLLAR=function(e,t=2){if(e=Y(e),isNaN(e))return s;const u={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},b=(e=mt(e,t)).toLocaleString("en-US",u);return e<0?"$("+b.slice(2)+")":b},m.DOLLARDE=function(e,t){if(oe(e=Y(e),t=Y(t)))return s;if(t<0)return c;if(t>=0&&t<1)return l;t=parseInt(t,10);let u=parseInt(e,10);u+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const b=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return u=Math.round(u*b)/b,u},m.DOLLARFR=function(e,t){if(oe(e=Y(e),t=Y(t)))return s;if(t<0)return c;if(t>=0&&t<1)return l;t=parseInt(t,10);let u=parseInt(e,10);return u+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,u},m.DPRODUCT=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const ie=ge(e,t);D=G(e[ie])}else D=G(e[t]);let P=[];M(b,ie=>{P.push(D[ie])}),P=en(P);let $=1;return M(P,ie=>{$*=ie}),$},m.DSTDEV=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);let P=[];return M(b,$=>{P.push(D[$])}),P=en(P),de.S(P)},m.DSTDEVP=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);let P=[];return M(b,$=>{P.push(D[$])}),P=en(P),de.P(P)},m.DSUM=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);const P=[];return M(b,$=>{P.push(D[$])}),vt(P)},m.DURATION=function(){throw new Error("DURATION is not implemented")},m.DVAR=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);const P=[];return M(b,$=>{P.push(D[$])}),fe.S(P)},m.DVARP=function(e,t,u){if(isNaN(t)&&typeof t!="string")return s;const b=bt(e,u);let D=[];if(typeof t=="string"){const $=ge(e,t);D=G(e[$])}else D=G(e[t]);const P=[];return M(b,$=>{P.push(D[$])}),fe.P(P)},m.EDATE=function(e,t){return(e=Se(e))instanceof Error?e:isNaN(t)?s:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},m.EFFECT=function(e,t){return oe(e=Y(e),t=Y(t))?s:e<=0||t<1?c:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},m.EOMONTH=function(e,t){return(e=Se(e))instanceof Error?e:isNaN(t)?s:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},m.ERF=Kt,m.ERFC=Jt,m.ERFCPRECISE=On,m.ERFPRECISE=Dn,m.ERROR=kt,m.EVEN=function(e){return(e=Y(e))instanceof Error?e:je(e,-2,-1)},m.EXACT=function(e,t){return arguments.length!==2?w:ue(e,t)||(e=Fe(e))===Fe(t)},m.EXP=function(e){return arguments.length<1?w:arguments.length>1?L:(e=Y(e))instanceof Error?e:e=Math.exp(e)},m.EXPON=ne,m.EXPONDIST=_n,m.F=ee,m.FACT=Je,m.FACTDOUBLE=function e(t){if((t=Y(t))instanceof Error)return t;const u=Math.floor(t);return u<=0?1:u*e(u-2)},m.FALSE=function(){return!1},m.FDIST=kn,m.FDISTRT=Rn,m.FIND=function(e,t,u){if(arguments.length<2)return w;e=Fe(e),u=u===void 0?0:u;const b=(t=Fe(t)).indexOf(e,u-1);return b===-1?s:b+1},m.FINV=Bn,m.FINVRT=Hn,m.FISHER=function(e){return(e=Y(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},m.FISHERINV=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},m.FIXED=un,m.FLOOR=Ge,m.FLOORMATH=Fn,m.FLOORPRECISE=Pn,m.FORECAST=H,m.FREQUENCY=function(e,t){if(oe(e=Ae(q(e)),t=Ae(q(t))))return s;const u=e.length,b=t.length,D=[];for(let P=0;P<=b;P++){D[P]=0;for(let $=0;$<u;$++)P===0?e[$]<=t[0]&&(D[0]+=1):P<b?e[$]>t[P-1]&&e[$]<=t[P]&&(D[P]+=1):P===b&&e[$]>t[b-1]&&(D[b]+=1)}return D},m.FTEST=Vn,m.FV=Lt,m.FVSCHEDULE=function(e,t){if(oe(e=Y(e),t=Ae(q(t))))return s;const u=t.length;let b=e;for(let D=0;D<u;D++)b*=1+t[D];return b},m.GAMMA=O,m.GAMMADIST=Un,m.GAMMAINV=qn,m.GAMMALN=U,m.GAMMALNPRECISE=Wn,m.GAUSS=function(e){return(e=Y(e))instanceof Error?e:v.normal.cdf(e,0,1)-.5},m.GCD=function(){const e=Ae(q(arguments));if(e instanceof Error)return e;const t=e.length,u=e[0];let b=u<0?-u:u;for(let D=1;D<t;D++){const P=e[D];let $=P<0?-P:P;for(;b&&$;)b>$?b%=$:$%=b;b+=$}return b},m.GEOMEAN=function(){const e=Ae(q(arguments));return e instanceof Error?e:v.geomean(e)},m.GESTEP=function(e,t){return oe(t=t||0,e=Y(e))?e:e>=t?1:0},m.GROWTH=function(e,t,u,b){if((e=Ae(e))instanceof Error)return e;let D;if(t===void 0)for(t=[],D=1;D<=e.length;D++)t.push(D);if(u===void 0)for(u=[],D=1;D<=e.length;D++)u.push(D);if(oe(t=Ae(t),u=Ae(u)))return s;b===void 0&&(b=!0);const P=e.length;let $,ie,ye=0,Me=0,_e=0,Ve=0;for(D=0;D<P;D++){const Xe=t[D],Qe=Math.log(e[D]);ye+=Xe,Me+=Qe,_e+=Xe*Qe,Ve+=Xe*Xe}ye/=P,Me/=P,_e/=P,Ve/=P,b?($=(_e-ye*Me)/(Ve-ye*ye),ie=Me-$*ye):($=_e/Ve,ie=0);const He=[];for(D=0;D<u.length;D++)He.push(Math.exp(ie+$*u[D]));return He},m.HARMEAN=function(){const e=Ae(q(arguments));if(e instanceof Error)return e;const t=e.length;let u=0;for(let b=0;b<t;b++)u+=1/e[b];return t/u},m.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return c;const u=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),b=u?parseInt(e,16)-1099511627776:parseInt(e,16);if(b<-512||b>511)return c;if(u)return"1"+ht("0",9-(512+b).toString(2).length)+(512+b).toString(2);const D=b.toString(2);return t===void 0?D:isNaN(t)?s:t<0?c:(t=Math.floor(t))>=D.length?ht("0",t-D.length)+D:c},m.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return c;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},m.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return c;const u=parseInt(e,16);if(u>536870911&&u<0xffe0000000)return c;if(u>=0xffe0000000)return(u-0xffc0000000).toString(8);const b=u.toString(8);return t===void 0?b:isNaN(t)?s:t<0?c:(t=Math.floor(t))>=b.length?ht("0",t-b.length)+b:c},m.HLOOKUP=function(e,t,u,b){return Tt(e,se(t),u,b)},m.HOUR=function(e){return(e=Se(e))instanceof Error?e:e.getHours()},m.HYPGEOM=Q,m.HYPGEOMDIST=Yn,m.IF=function(e,t,u){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(u=arguments.length===3&&u)==null&&(u=0),e?t:u)},m.IFERROR=function(e,t){return Mt(e)?t:e},m.IFNA=function(e,t){return e===w?t:e},m.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return w},m.IMABS=Qt,m.IMAGINARY=ot,m.IMARGUMENT=Zt,m.IMCONJUGATE=function(e){const t=st(e),u=ot(e);if(oe(t,u))return s;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",u!==0?ut(t,-u,b):e},m.IMCOS=Wt,m.IMCOSH=dn,m.IMCOT=function(e){return oe(st(e),ot(e))?s:At(Wt(e),Yt(e))},m.IMCSC=function(e){return e===!0||e===!1?s:oe(st(e),ot(e))?c:At("1",Yt(e))},m.IMCSCH=function(e){return e===!0||e===!1?s:oe(st(e),ot(e))?c:At("1",fn(e))},m.IMDIV=At,m.IMEXP=function(e){const t=st(e),u=ot(e);if(oe(t,u))return s;let b=e.substring(e.length-1);b=b==="i"||b==="j"?b:"i";const D=Math.exp(t);return ut(D*Math.cos(u),D*Math.sin(u),b)},m.IMLN=function(e){const t=st(e),u=ot(e);if(oe(t,u))return s;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ut(Math.log(Math.sqrt(t*t+u*u)),Math.atan(u/t),b)},m.IMLOG10=function(e){const t=st(e),u=ot(e);if(oe(t,u))return s;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ut(Math.log(Math.sqrt(t*t+u*u))/Math.log(10),Math.atan(u/t)/Math.log(10),b)},m.IMLOG2=function(e){const t=st(e),u=ot(e);if(oe(t,u))return s;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ut(Math.log(Math.sqrt(t*t+u*u))/Math.log(2),Math.atan(u/t)/Math.log(2),b)},m.IMPOWER=function(e,t){if(oe(t=Y(t),st(e),ot(e)))return s;let u=e.substring(e.length-1);u=u==="i"||u==="j"?u:"i";const b=Math.pow(Qt(e),t),D=Zt(e);return ut(b*Math.cos(t*D),b*Math.sin(t*D),u)},m.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return s;for(let t=1;t<arguments.length;t++){const u=st(e),b=ot(e),D=st(arguments[t]),P=ot(arguments[t]);if(oe(u,b,D,P))return s;e=ut(u*D-b*P,u*P+b*D)}return e},m.IMREAL=st,m.IMSEC=function(e){return e===!0||e===!1||oe(st(e),ot(e))?s:At("1",Wt(e))},m.IMSECH=function(e){return oe(st(e),ot(e))?s:At("1",dn(e))},m.IMSIN=Yt,m.IMSINH=fn,m.IMSQRT=function(e){if(oe(st(e),ot(e)))return s;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const u=Math.sqrt(Qt(e)),b=Zt(e);return ut(u*Math.cos(b/2),u*Math.sin(b/2),t)},m.IMSUB=function(e,t){const u=st(e),b=ot(e),D=st(t),P=ot(t);if(oe(u,b,D,P))return s;const $=e.substring(e.length-1),ie=t.substring(t.length-1);let ye="i";return($==="j"||ie==="j")&&(ye="j"),ut(u-D,b-P,ye)},m.IMSUM=function(){if(!arguments.length)return s;const e=q(arguments);let t=e[0];for(let u=1;u<e.length;u++){const b=st(t),D=ot(t),P=st(e[u]),$=ot(e[u]);if(oe(b,D,P,$))return s;t=ut(b+P,D+$)}return t},m.IMTAN=function(e){return e===!0||e===!1||oe(st(e),ot(e))?s:At(Yt(e),Wt(e))},m.INDEX=function(e,t,u){const b=ue(e,t,u);if(b)return b;if(!Array.isArray(e))return s;const D=e.length>0&&!Array.isArray(e[0]);return D&&!u?(u=t,t=1):(u=u||1,t=t||1),u<0||t<0?s:D&&t===1&&u<=e.length?e[u-1]:t<=e.length&&u<=e[t-1].length?e[t-1][u-1]:g},m.INFO=function(){throw new Error("INFO is not implemented")},m.INT=function(e){return(e=Y(e))instanceof Error?e:Math.floor(e)},m.INTERCEPT=function(e,t){return oe(e=Ae(e),t=Ae(t))?s:e.length!==t.length?w:H(0,e,t)},m.INTRATE=function(){throw new Error("INTRATE is not implemented")},m.IPMT=pn,m.IRR=function(e,t){if(t=t||0,oe(e=Ae(q(e)),t=Y(t)))return s;const u=(He,Xe,Qe)=>{const nt=Qe+1;let pt=He[0];for(let lt=1;lt<He.length;lt++)pt+=He[lt]/Math.pow(nt,(Xe[lt]-Xe[0])/365);return pt},b=(He,Xe,Qe)=>{const nt=Qe+1;let pt=0;for(let lt=1;lt<He.length;lt++){const Ct=(Xe[lt]-Xe[0])/365;pt-=Ct*He[lt]/Math.pow(nt,Ct+1)}return pt},D=[];let P=!1,$=!1;for(let He=0;He<e.length;He++)D[He]=He===0?0:D[He-1]+365,e[He]>0&&(P=!0),e[He]<0&&($=!0);if(!P||!$)return c;let ie,ye,Me,_e=t=t===void 0?.1:t,Ve=!0;do Me=u(e,D,_e),ie=_e-Me/b(e,D,_e),ye=Math.abs(ie-_e),_e=ie,Ve=ye>1e-10&&Math.abs(Me)>1e-10;while(Ve);return _e},m.ISBLANK=function(e){return e===null},m.ISERR=Rt,m.ISERROR=Mt,m.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},m.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},m.ISLOGICAL=Bt,m.ISNA=function(e){return e===w},m.ISNONTEXT=function(e){return typeof e!="string"},m.ISNUMBER=Et,m.ISO=tt,m.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},m.ISOWEEKNUM=on,m.ISPMT=function(e,t,u,b){return oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b))?s:b*e*(t/u-1)},m.ISREF=function(){throw new Error("ISREF is not implemented")},m.ISTEXT=Ht,m.KURT=function(){const e=Ae(q(arguments));if(e instanceof Error)return e;const t=v.mean(e),u=e.length;let b=0;for(let D=0;D<u;D++)b+=Math.pow(e[D]-t,4);return b/=Math.pow(v.stdev(e,!0),4),u*(u+1)/((u-1)*(u-2)*(u-3))*b-3*(u-1)*(u-1)/((u-2)*(u-3))},m.LARGE=ae,m.LCM=function(){const e=Ae(q(arguments));if(e instanceof Error)return e;for(var t,u,b,D,P=1;(b=e.pop())!==void 0;){if(b===0)return 0;for(;b>1;){if(b%2){for(t=3,u=Math.floor(Math.sqrt(b));t<=u&&b%t;t+=2);D=t<=u?t:b}else D=2;for(b/=D,P*=D,t=e.length;t;e[--t]%D==0&&(e[t]/=D)==1&&e.splice(t,1));}}return P},m.LEFT=function(e,t){return ue(e,t)||(e=Fe(e),(t=Y(t=t===void 0?1:t))instanceof Error||typeof e!="string"?s:e.substring(0,t))},m.LEN=function(e){return arguments.length===0?L:e instanceof Error?e:Array.isArray(e)?s:Fe(e).length},m.LINEST=he,m.LN=function(e){return(e=Y(e))instanceof Error?e:e===0?c:Math.log(e)},m.LOG=function(e,t){return ue(e=Y(e),t=Y(t))||(e===0||t===0?c:Math.log(e)/Math.log(t))},m.LOG10=function(e){return(e=Y(e))instanceof Error?e:e===0?c:Math.log(e)/Math.log(10)},m.LOGEST=function(e,t){if(oe(e=Ae(q(e)),t=Ae(q(t)))||e.length!==t.length)return s;for(let b=0;b<e.length;b++)e[b]=Math.log(e[b]);const u=he(e,t);return u[0]=Math.round(1e6*Math.exp(u[0]))/1e6,u[1]=Math.round(1e6*Math.exp(u[1]))/1e6,u},m.LOGINV=zn,m.LOGNORM=pe,m.LOGNORMDIST=Xn,m.LOGNORMINV=Gn,m.LOOKUP=function(e,t,u){t=q(t),u=u?q(u):t;const b=typeof e=="number";let D=w;for(let P=0;P<t.length;P++){if(t[P]===e)return u[P];if(b&&t[P]<=e||typeof t[P]=="string"&&t[P].localeCompare(e)<0)D=u[P];else if(b&&t[P]>e)return D}return D},m.LOWER=function(e){return arguments.length!==1?s:oe(e=Fe(e))?e:e.toLowerCase()},m.MATCH=function(e,t,u){if(!e||!t||(arguments.length===2&&(u=1),!((t=q(t))instanceof Array))||u!==-1&&u!==0&&u!==1)return w;let b,D;for(let P=0;P<t.length;P++)if(u===1){if(t[P]===e)return P+1;t[P]<e&&(D?t[P]>D&&(b=P+1,D=t[P]):(b=P+1,D=t[P]))}else if(u===0){if(typeof e=="string"&&typeof t[P]=="string"){const $=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+$+"$").test(t[P].toLowerCase()))return P+1}else if(t[P]===e)return P+1}else if(u===-1){if(t[P]===e)return P+1;t[P]>e&&(D?t[P]<D&&(b=P+1,D=t[P]):(b=P+1,D=t[P]))}return b||w},m.MAX=be,m.MAXA=function(){const e=q(arguments),t=ue.apply(void 0,e);if(t)return t;let u=B(e);return u=u.map(b=>b??0),u.length===0?0:Math.max.apply(Math,u)},m.MDURATION=function(){throw new Error("MDURATION is not implemented")},m.MEDIAN=Te,m.MID=function(e,t,u){if(t==null)return s;if(oe(t=Y(t),u=Y(u))||typeof e!="string")return u;const b=t-1,D=b+u;return e.substring(b,D)},m.MIN=Oe,m.MINA=function(){const e=q(arguments),t=ue.apply(void 0,e);if(t)return t;let u=B(e);return u=u.map(b=>b??0),u.length===0?0:Math.min.apply(Math,u)},m.MINUTE=function(e){return(e=Se(e))instanceof Error?e:e.getMinutes()},m.MIRR=function(e,t,u){if(oe(e=Ae(q(e)),t=Y(t),u=Y(u)))return s;const b=e.length,D=[],P=[];for(let ye=0;ye<b;ye++)e[ye]<0?D.push(e[ye]):P.push(e[ye]);const $=-rn(u,P)*Math.pow(1+u,b-1),ie=rn(t,D)*(1+t);return Math.pow($/ie,1/(b-1))-1},m.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(u=>!u.length)||t.some(u=>!u.length)||ce(e).some(u=>typeof u!="number")||ce(t).some(u=>typeof u!="number")||e[0].length!==t.length?s:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((u,b)=>u.map((D,P)=>e[b].reduce(($,ie,ye)=>$+ie*t[ye][P],0)))},m.MOD=function(e,t){const u=ue(e=Y(e),t=Y(t));if(u)return u;if(t===0)return l;let b=Math.abs(e%t);return b=e<0?t-b:b,t>0?b:-b},m.MODE=De,m.MODEMULT=$n,m.MODESNGL=Kn,m.MONTH=function(e){return(e=Se(e))instanceof Error?e:e.getMonth()+1},m.MROUND=function(e,t){return ue(e=Y(e),t=Y(t))||(e*t==0?0:e*t<0?c:Math.round(e/t)*t)},m.MULTINOMIAL=function(){const e=Ae(q(arguments));if(e instanceof Error)return e;let t=0,u=1;for(let b=0;b<e.length;b++)t+=e[b],u*=Je(e[b]);return Je(t)/u},m.MUNIT=function(e){return arguments.length>1?w:!(e=parseInt(e))||e<=0?s:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,u)=>(t[u]=1,t))},m.N=function(e){return Et(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:Mt(e)?e:0},m.NA=function(){return w},m.NEGBINOM=qe,m.NEGBINOMDIST=Jn,m.NETWORKDAYS=Vt,m.NETWORKDAYSINTL=Qn,m.NOMINAL=function(e,t){return oe(e=Y(e),t=Y(t))?s:e<=0||t<1?c:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},m.NORM=We,m.NORMDIST=Zn,m.NORMINV=er,m.NORMSDIST=tr,m.NORMSINV=nr,m.NOT=function(e){return typeof e=="string"?s:e instanceof Error?e:!e},m.NOW=function(){return new Date},m.NPER=function(e,t,u,b,D){if(D=D===void 0?0:D,b=b===void 0?0:b,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b),D=Y(D)))return s;if(e===0)return-(u+b)/t;{const P=t*(1+e*D)-b*e,$=u*e+t*(1+e*D);return Math.log(P/$)/Math.log(1+e)}},m.NPV=rn,m.NUMBERVALUE=function(e,t,u){return typeof(e=Ne(e)?e:"")=="number"?e:typeof e!="string"?w:(t=t===void 0?".":t,u=u===void 0?",":u,Number(e.replace(t,".").replace(u,"")))},m.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return c;const u=!(e.length!==10||e.substring(0,1)!=="7"),b=u?parseInt(e,8)-1073741824:parseInt(e,8);if(b<-512||b>511)return c;if(u)return"1"+ht("0",9-(512+b).toString(2).length)+(512+b).toString(2);const D=b.toString(2);return t===void 0?D:isNaN(t)?s:t<0?c:(t=Math.floor(t))>=D.length?ht("0",t-D.length)+D:c},m.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return c;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},m.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return c;const u=parseInt(e,8);if(u>=536870912)return"ff"+(u+3221225472).toString(16);const b=u.toString(16);return t===void 0?b:isNaN(t)?s:t<0?c:(t=Math.floor(t))>=b.length?ht("0",t-b.length)+b:c},m.ODD=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},m.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},m.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},m.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},m.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},m.OR=function(){const e=q(arguments);let t=s;for(let u=0;u<e.length;u++){if(e[u]instanceof Error)return e[u];e[u]!==void 0&&e[u]!==null&&typeof e[u]!="string"&&(t===s&&(t=!1),e[u]&&(t=!0))}return t},m.PDURATION=function(e,t,u){return oe(e=Y(e),t=Y(t),u=Y(u))?s:e<=0?c:(Math.log(u)-Math.log(t))/Math.log(1+e)},m.PEARSON=re,m.PERCENTILE=ve,m.PERCENTILEEXC=rr,m.PERCENTILEINC=or,m.PERCENTRANK=Le,m.PERCENTRANKEXC=sr,m.PERCENTRANKINC=ir,m.PERMUT=function(e,t){return oe(e=Y(e),t=Y(t))?s:Je(e)/Je(e-t)},m.PERMUTATIONA=function(e,t){return oe(e=Y(e),t=Y(t))?s:Math.pow(e,t)},m.PHI=function(e){return(e=Y(e))instanceof Error?s:Math.exp(-.5*e*e)/2.5066282746310002},m.PI=function(){return Math.PI},m.PMT=_t,m.POISSON=X,m.POISSONDIST=ar,m.POWER=Ot,m.PPMT=function(e,t,u,b,D,P){return D=D||0,P=P||0,oe(e=Y(e),u=Y(u),b=Y(b),D=Y(D),P=Y(P))?s:_t(e,u,b,D,P)-pn(e,t,u,b,D,P)},m.PRICE=function(){throw new Error("PRICE is not implemented")},m.PRICEDISC=function(e,t,u,b,D){if(oe(e=Se(e),t=Se(t),u=Y(u),b=Y(b),D=(D=Y(D))||0))return s;if(u<=0||b<=0)return c;if(e>=t)return s;let P,$;switch(D){case 0:P=360,$=xt(e,t,!1);break;case 1:case 3:P=365,$=Dt(e,t,"D");break;case 2:P=360,$=Dt(e,t,"D");break;case 4:P=360,$=xt(e,t,!0);break;default:return c}return b-u*b*$/P},m.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},m.PROB=function(e,t,u,b){if(u===void 0)return 0;if(b=b===void 0?u:b,oe(e=Ae(q(e)),t=Ae(q(t)),u=Y(u),b=Y(b)))return s;if(u===b)return e.indexOf(u)>=0?t[e.indexOf(u)]:0;const D=e.sort((ie,ye)=>ie-ye),P=D.length;let $=0;for(let ie=0;ie<P;ie++)D[ie]>=u&&D[ie]<=b&&($+=t[e.indexOf(D[ie])]);return $},m.PRODUCT=zt,m.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},m.PROPER=function(e){return oe(e)?e:isNaN(e)&&typeof e=="number"?s:(e=Fe(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},m.PV=function(e,t,u,b,D){return b=b||0,D=D||0,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b),D=Y(D))?s:e===0?-u*t-b:((1-Math.pow(1+e,t))/e*u*(1+e*D)-b)/Math.pow(1+e,t)},m.QUARTILE=Z,m.QUARTILEEXC=lr,m.QUARTILEINC=cr,m.QUOTIENT=function(e,t){return ue(e=Y(e),t=Y(t))||parseInt(e/t,10)},m.RADIANS=function(e){return(e=Y(e))instanceof Error?e:e*Math.PI/180},m.RAND=function(){return Math.random()},m.RANDBETWEEN=function(e,t){return ue(e=Y(e),t=Y(t))||e+Math.ceil((t-e+1)*Math.random())-1},m.RANK=E,m.RANKAVG=ur,m.RANKEQ=dr,m.RATE=function(e,t,u,b,D,P){if(P=P===void 0?.01:P,b=b===void 0?0:b,D=D===void 0?0:D,oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b),D=Y(D),P=Y(P)))return s;const $=1e-10;let ie=P;D=D?1:0;for(let ye=0;ye<20;ye++){if(ie<=-1)return c;let Me,_e,Ve;if(Math.abs(ie)<$?Me=u*(1+e*ie)+t*(1+ie*D)*e+b:(_e=Math.pow(1+ie,e),Me=u*_e+t*(1/ie+D)*(_e-1)+b),Math.abs(Me)<$)return ie;if(Math.abs(ie)<$)Ve=u*e+t*D*e;else{_e=Math.pow(1+ie,e);const He=e*Math.pow(1+ie,e-1);Ve=u*He+t*(1/ie+D)*He+t*(-1/(ie*ie))*(_e-1)}ie-=Me/Ve}return ie},m.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},m.REPLACE=function(e,t,u,b){return oe(t=Y(t),u=Y(u))||typeof e!="string"||typeof b!="string"?s:e.substr(0,t-1)+b+e.substr(t-1+u)},m.REPT=ht,m.RIGHT=function(e,t){return ue(e,t)||(e=Fe(e),(t=Y(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},m.ROMAN=function(e){if((e=Y(e))instanceof Error)return e;const t=String(e).split(""),u=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let b="",D=3;for(;D--;)b=(u[+t.pop()+10*D]||"")+b;return new Array(+t.join("")+1).join("M")+b},m.ROUND=mt,m.ROUNDDOWN=function(e,t){return ue(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},m.ROUNDUP=function(e,t){return ue(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},m.ROW=function(e,t){return arguments.length!==2?w:t<0?c:e instanceof Array&&typeof t=="number"?e.length!==0?v.row(e,t):void 0:s},m.ROWS=function(e){return arguments.length!==1?w:e instanceof Array?e.length===0?0:v.rows(e):s},m.RRI=function(e,t,u){return oe(e=Y(e),t=Y(t),u=Y(u))?s:e===0||t===0?c:Math.pow(u/t,1/e)-1},m.RSQ=function(e,t){return oe(e=Ae(q(e)),t=Ae(q(t)))?s:Math.pow(re(e,t),2)},m.SEARCH=function(e,t,u){let b;return typeof e!="string"||typeof t!="string"?s:(u=u===void 0?0:u,b=t.toLowerCase().indexOf(e.toLowerCase(),u-1)+1,b===0?s:b)},m.SEC=function(e){return(e=Y(e))instanceof Error?e:1/Math.cos(e)},m.SECH=function(e){return(e=Y(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},m.SECOND=function(e){return(e=Se(e))instanceof Error?e:e.getSeconds()},m.SERIESSUM=function(e,t,u,b){if(oe(e=Y(e),t=Y(t),u=Y(u),b=Ae(b)))return s;let D=b[0]*Math.pow(e,t);for(let P=1;P<b.length;P++)D+=b[P]*Math.pow(e,t+P*u);return D},m.SHEET=function(){throw new Error("SHEET is not implemented")},m.SHEETS=function(){throw new Error("SHEETS is not implemented")},m.SIGN=function(e){return(e=Y(e))instanceof Error?e:e<0?-1:e===0?0:1},m.SIN=function(e){return(e=Y(e))instanceof Error?e:Math.sin(e)},m.SINH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},m.SKEW=F,m.SKEWP=fr,m.SLN=function(e,t,u){return oe(e=Y(e),t=Y(t),u=Y(u))?s:u===0?c:(e-t)/u},m.SLOPE=function(e,t){if(oe(e=Ae(q(e)),t=Ae(q(t))))return s;const u=v.mean(t),b=v.mean(e),D=t.length;let P=0,$=0;for(let ie=0;ie<D;ie++)P+=(t[ie]-u)*(e[ie]-b),$+=Math.pow(t[ie]-u,2);return P/$},m.SMALL=J,m.SORT=function(e,t=1,u=1,b=!1){if(!e||!Array.isArray(e))return w;if(e.length===0)return 0;if(!(t=Y(t))||t<1||(u=Y(u))!==1&&u!==-1)return s;if(typeof(b=Re(b))!="boolean")return f;const D=ie=>ie.sort((ye,Me)=>(ye=Fe(ye[t-1]),Me=Fe(Me[t-1]),u===1?ye<Me?-1*u:u:ye>Me?u:-1*u)),P=z(e),$=b?se(P):P;return t>=1&&t<=$[0].length?b?se(D($)):D($):s},m.SQRT=function(e){return(e=Y(e))instanceof Error?e:e<0?c:Math.sqrt(e)},m.SQRTPI=function(e){return(e=Y(e))instanceof Error?e:Math.sqrt(e*Math.PI)},m.STANDARDIZE=function(e,t,u){return oe(e=Y(e),t=Y(t),u=Y(u))?s:(e-t)/u},m.STDEV=de,m.STDEVA=function(){const e=Ee.apply(this,arguments);return Math.sqrt(e)},m.STDEVP=pr,m.STDEVPA=function(){const e=te.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=c),t},m.STDEVS=hr,m.STEYX=function(e,t){if(oe(e=Ae(q(e)),t=Ae(q(t))))return s;const u=v.mean(t),b=v.mean(e),D=t.length;let P=0,$=0,ie=0;for(let ye=0;ye<D;ye++)P+=Math.pow(e[ye]-b,2),$+=(t[ye]-u)*(e[ye]-b),ie+=Math.pow(t[ye]-u,2);return Math.sqrt((P-$*$/ie)/(D-2))},m.SUBSTITUTE=function(e,t,u,b){if(arguments.length<3)return w;if(e&&t){if(b===void 0)return e.split(t).join(u);{if(b=Math.floor(Number(b)),Number.isNaN(b)||b<=0)return s;let D=0,P=0;for(;D>-1&&e.indexOf(t,D)>-1;)if(D=e.indexOf(t,D+1),P++,D>-1&&P===b)return e.substring(0,D)+u+e.substring(D+t.length);return e}}return e},m.SUBTOTAL=function(e,t){if((e=Y(e))instanceof Error)return e;switch(e){case 1:case 101:return wt(t);case 2:case 102:return T(t);case 3:case 103:return p(t);case 4:case 104:return be(t);case 5:case 105:return Oe(t);case 6:case 106:return zt(t);case 7:case 107:return de.S(t);case 8:case 108:return de.P(t);case 9:case 109:return vt(t);case 10:case 110:return fe.S(t);case 11:case 111:return fe.P(t)}},m.SUM=vt,m.SUMIF=function(e,t,u){if(e=q(e),u=u?q(u):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let b=0;const D=t==="*",P=D?null:dt(t+"");for(let $=0;$<e.length;$++){const ie=e[$],ye=u[$];if(D)b+=ie;else{const Me=[it(ie,et)].concat(P);b+=ft(Me)?ye:0}}return b},m.SUMIFS=function(){const e=_(arguments),t=Ae(q(e.shift()));if(t instanceof Error)return t;const u=e,b=u.length/2;for(let P=0;P<b;P++)u[2*P]=q(u[2*P]);let D=0;for(let P=0;P<t.length;P++){let $=!1;for(let ie=0;ie<b;ie++){const ye=u[2*ie][P],Me=u[2*ie+1];let _e=!1;if(Me===void 0||Me==="*")_e=!0;else{const Ve=dt(Me+""),He=[it(ye,et)].concat(Ve);_e=ft(He)}if(!_e){$=!1;break}$=!0}$&&(D+=t[P])}return D},m.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return s;const e=arguments.length+1;let t,u,b,D,P=0;for(let $=0;$<arguments[0].length;$++)if(arguments[0][$]instanceof Array)for(let ie=0;ie<arguments[0][$].length;ie++){for(t=1,u=1;u<e;u++){const ye=arguments[u-1][$][ie];if(ye instanceof Error)return ye;if(D=Y(ye),D instanceof Error)return D;t*=D}P+=t}else{for(t=1,u=1;u<e;u++){const ie=arguments[u-1][$];if(ie instanceof Error)return ie;if(b=Y(ie),b instanceof Error)return b;t*=b}P+=t}return P},m.SUMSQ=function(){const e=Ae(q(arguments));if(e instanceof Error)return e;let t=0;const u=e.length;for(let b=0;b<u;b++)t+=Et(e[b])?e[b]*e[b]:0;return t},m.SUMX2MY2=function(e,t){if(oe(e=Ae(q(e)),t=Ae(q(t))))return s;let u=0;for(let b=0;b<e.length;b++)u+=e[b]*e[b]-t[b]*t[b];return u},m.SUMX2PY2=function(e,t){if(oe(e=Ae(q(e)),t=Ae(q(t))))return s;let u=0;e=Ae(q(e)),t=Ae(q(t));for(let b=0;b<e.length;b++)u+=e[b]*e[b]+t[b]*t[b];return u},m.SUMXMY2=function(e,t){if(oe(e=Ae(q(e)),t=Ae(q(t))))return s;let u=0;e=q(e),t=q(t);for(let b=0;b<e.length;b++)u+=Math.pow(e[b]-t[b],2);return u},m.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],u=arguments.length-1,b=Math.floor(u/2);let D=!1;const P=u%2!=0,$=u%2==0?null:arguments[arguments.length-1];if(b){for(let ie=0;ie<b;ie++)if(t===arguments[2*ie+1]){e=arguments[2*ie+2],D=!0;break}}D||(e=P?$:w)}else e=s;return e},m.SYD=function(e,t,u,b){return oe(e=Y(e),t=Y(t),u=Y(u),b=Y(b))?s:u===0||b<1||b>u?c:(e-t)*(u-(b=parseInt(b,10))+1)*2/(u*(u+1))},m.T=function(e){return e instanceof Error||typeof e=="string"?e:""},m.TAN=function(e){return(e=Y(e))instanceof Error?e:Math.tan(e)},m.TANH=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},m.TBILLEQ=function(e,t,u){return oe(e=Se(e),t=Se(t),u=Y(u))?s:u<=0||e>t||t-e>31536e6?c:365*u/(360-u*xt(e,t,!1))},m.TBILLPRICE=function(e,t,u){return oe(e=Se(e),t=Se(t),u=Y(u))?s:u<=0||e>t||t-e>31536e6?c:100*(1-u*xt(e,t,!1)/360)},m.TBILLYIELD=function(e,t,u){return oe(e=Se(e),t=Se(t),u=Y(u))?s:u<=0||e>t||t-e>31536e6?c:360*(100-u)/(u*xt(e,t,!1))},m.TDIST=gr,m.TDISTRT=mr,m.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return w;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return s;const u=t.startsWith("$")?"$":"",b=t.endsWith("%");return b&&(e*=100),e=(e=un(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+u+(e=e.replace("-","")):u+e,b&&(e+="%"),e},m.TEXTJOIN=function(e,t,...u){if(typeof t!="boolean"&&(t=Re(t)),arguments.length<3)return w;e=e??"";let b=q(u),D=t?b.filter(P=>P):b;if(Array.isArray(e)){e=q(e);let P=D.map(ie=>[ie]),$=0;for(let ie=0;ie<P.length-1;ie++)P[ie].push(e[$]),$++,$===e.length&&($=0);return D=q(P),D.join("")}return D.join(e)},m.TIME=function(e,t,u){return oe(e=Y(e),t=Y(t),u=Y(u))?s:e<0||t<0||u<0?c:(3600*e+60*t+u)/86400},m.TIMEVALUE=function(e){return(e=Se(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},m.TINV=vr,m.TODAY=function(){return Pt(new Date)},m.TRANSPOSE=function(e){return e?se(z(e)):w},m.TREND=function(e,t,u){if(oe(e=Ae(q(e)),t=Ae(q(t)),u=Ae(q(u))))return s;const b=he(e,t),D=b[0],P=b[1],$=[];return u.forEach(ie=>{$.push(D*ie+P)}),$},m.TRIM=function(e){return(e=Fe(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},m.TRIMMEAN=function(e,t){if(oe(e=Ae(q(e)),t=Y(t)))return s;const u=Ge(e.length*t,2)/2;return v.mean((D=(D=u)||1,(b=G(e.sort((P,$)=>P-$),u))&&typeof b.slice=="function"?b.slice(0,b.length-D):b));var b,D},m.TRUE=function(){return!0},m.TRUNC=function(e,t){return ue(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},m.TTEST=yr,m.TYPE=function(e){return Et(e)?1:Ht(e)?2:Bt(e)?4:Mt(e)?16:Array.isArray(e)?64:void 0},m.UNICHAR=mn,m.UNICODE=vn,m.UNIQUE=It,m.UPPER=function(e){return(e=Fe(e))instanceof Error?e:e.toUpperCase()},m.VALUE=function(e){const t=ue(e);if(t)return t;if(typeof e=="number")return e;if(Ne(e)||(e=""),typeof e!="string")return s;const u=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let b=Number(e);return isNaN(b)?s:(b=b||0,u&&(b*=.01),b)},m.VAR=fe,m.VARA=Ee,m.VARP=br,m.VARPA=te,m.VARS=wr,m.VDB=function(){throw new Error("VDB is not implemented")},m.VLOOKUP=Tt,m.WEEKDAY=function(e,t){if((e=Se(e))instanceof Error)return e;t===void 0&&(t=1);const u=e.getDay();return hn[t][u]},m.WEEKNUM=function(e,t){if((e=Se(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return on(e);const u=Ke[t];let b=new Date(e.getFullYear(),0,1);const D=b.getDay()<u?1:0;return b-=24*Math.abs(b.getDay()-u)*60*60*1e3,Math.floor((e-b)/864e5/7+1)+D},m.WEIBULL=le,m.WEIBULLDIST=xr,m.WORKDAY=Ut,m.WORKDAYINTL=Cr,m.XIRR=function(e,t,u){if(oe(e=Ae(q(e)),t=$e(q(t)),u=Y(u)))return s;const b=(He,Xe,Qe)=>{const nt=Qe+1;let pt=He[0];for(let lt=1;lt<He.length;lt++)pt+=He[lt]/Math.pow(nt,jt(Xe[lt],Xe[0])/365);return pt},D=(He,Xe,Qe)=>{const nt=Qe+1;let pt=0;for(let lt=1;lt<He.length;lt++){const Ct=jt(Xe[lt],Xe[0])/365;pt-=Ct*He[lt]/Math.pow(nt,Ct+1)}return pt};let P=!1,$=!1;for(let He=0;He<e.length;He++)e[He]>0&&(P=!0),e[He]<0&&($=!0);if(!P||!$)return c;let ie,ye,Me,_e=u=u||.1,Ve=!0;do Me=b(e,t,_e),ie=_e-Me/D(e,t,_e),ye=Math.abs(ie-_e),_e=ie,Ve=ye>1e-10&&Math.abs(Me)>1e-10;while(Ve);return _e},m.XNPV=function(e,t,u){if(oe(e=Y(e),t=Ae(q(t)),u=$e(q(u))))return s;let b=0;for(let D=0;D<t.length;D++)b+=t[D]/Math.pow(1+e,jt(u[D],u[0])/365);return b},m.XOR=function(){const e=q(arguments);let t=s;for(let u=0;u<e.length;u++){if(e[u]instanceof Error)return e[u];e[u]!==void 0&&e[u]!==null&&typeof e[u]!="string"&&(t===s&&(t=0),e[u]&&t++)}return t===s?t:!!(1&Math.floor(Math.abs(t)))},m.YEAR=function(e){return(e=Se(e))instanceof Error?e:e.getFullYear()},m.YEARFRAC=Gt,m.YIELD=function(){throw new Error("YIELD is not implemented")},m.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},m.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},m.Z=we,m.ZTEST=Er,m.utils=jr}},C={};function N(R){var m=C[R];if(m!==void 0)return m.exports;var a=C[R]={exports:{}};return d[R].call(a.exports,a,a.exports,N),a.exports}N.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var W=N(960);o=W}(),o})}(dist)),dist.exports}(function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();if(!formula&&typeof commonjsRequire=="function")var formula=requireDist();(function(n,h){module.exports=h()})(commonjsGlobal,function(){var jspreadsheet;return function(){var __webpack_modules__={94:function(n,h,o){o.d(h,{My:function(){return v},Th:function(){return m},iY:function(){return a}});var d=o(911),C=o(805),N=o(530),W=o(497),R=o(829);const m=function(I,A){const l=this;for(let s=0;s<l.headers.length;s++)l.headers[s].classList.remove("arrow-up"),l.headers[s].classList.remove("arrow-down");A?l.headers[I].classList.add("arrow-up"):l.headers[I].classList.add("arrow-down")},a=function(I){const A=this;let l=[];for(let s=0;s<I.length;s++)l[s]=A.options.data[I[s]];A.options.data=l,l=[];for(let s=0;s<I.length;s++){l[s]=A.records[I[s]];for(let g=0;g<l[s].length;g++)l[s][g].y=s}A.records=l,l=[];for(let s=0;s<I.length;s++)l[s]=A.rows[I[s]],l[s].y=s;if(A.rows=l,N.o8.call(A),A.results&&A.results.length)A.searchInput.value?A.search(A.searchInput.value):R.F8.call(A);else if(A.results=null,A.pageNumber=0,A.options.pagination>0)A.page(0);else if(A.options.lazyLoading==1)W.wu.call(A,0);else for(let s=0;s<A.rows.length;s++)A.tbody.appendChild(A.rows[s].element)},v=function(I,A){const l=this;if(I>=0){if(l.options.mergeCells&&Object.keys(l.options.mergeCells).length>0){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;l.destroyMerge()}A=A==null?l.headers[I].classList.contains("arrow-down")?1:0:A?1:0;let s=[];if(l.options.columns&&l.options.columns[I]&&(l.options.columns[I].type=="number"||l.options.columns[I].type=="numeric"||l.options.columns[I].type=="percentage"||l.options.columns[I].type=="autonumber"||l.options.columns[I].type=="color"))for(let f=0;f<l.options.data.length;f++)s[f]=[f,Number(l.options.data[f][I])];else if(l.options.columns&&l.options.columns[I]&&(l.options.columns[I].type=="calendar"||l.options.columns[I].type=="checkbox"||l.options.columns[I].type=="radio"))for(let f=0;f<l.options.data.length;f++)s[f]=[f,l.options.data[f][I]];else for(let f=0;f<l.options.data.length;f++)s[f]=[f,l.records[f][I].element.textContent.toLowerCase()];typeof l.parent.config.sorting!="function"&&(l.parent.config.sorting=function(f){return function(c,w){const L=c[1],S=w[1];return f?L===""&&S!==""?1:L!==""&&S===""||L>S?-1:L<S?1:0:L===""&&S!==""?1:L!==""&&S===""?-1:L>S?1:L<S?-1:0}}),s=s.sort(l.parent.config.sorting(A));const g=[];for(let f=0;f<s.length;f++)g[f]=s[f][0];return d.Dh.call(l,{action:"orderBy",rows:g,column:I,order:A}),m.call(l,I,A),a.call(l,g),C.A.call(l,"onsort",l,I,A,g.map(f=>f)),!0}}},160:function(n,h,o){o.d(h,{e:function(){return C}});var d=o(530);const C=function(N){const W=this;if(N&&(W.options.footers=N),W.options.footers){W.tfoot||(W.tfoot=document.createElement("tfoot"),W.table.appendChild(W.tfoot));for(let R=0;R<W.options.footers.length;R++){let m;if(W.tfoot.children[R])m=W.tfoot.children[R];else{m=document.createElement("tr");const a=document.createElement("td");m.appendChild(a),W.tfoot.appendChild(m)}for(let a=0;a<W.headers.length;a++){let v;if(W.options.footers[R][a]||(W.options.footers[R][a]=""),W.tfoot.children[R].children[a+1])v=W.tfoot.children[R].children[a+1];else{v=document.createElement("td"),m.appendChild(v);const I=W.options.columns[a].align||W.options.defaultColAlign||"center";v.style.textAlign=I}v.textContent=d.$x.call(W,+W.records.length+a,R,W.options.footers[R][a]),v.style.display=W.cols[a].colElement.style.display}}}}},167:function(n,h,o){o.d(h,{$f:function(){return m},IV:function(){return W},MY:function(){return R},ho:function(){return N}});var d=o(805),C=o(657);const N=function(a){const v=this;return v.options.search!=1&&v.options.filters!=1||!v.results||(a=v.results.indexOf(a)),Math.ceil((parseInt(a)+1)/parseInt(v.options.pagination))-1},W=function(){const a=this;if(a.pagination.children[0].innerHTML="",a.pagination.children[1].innerHTML="",a.options.pagination){let v;if(v=a.options.search!=1&&a.options.filters!=1||!a.results?a.rows.length:a.results.length,v){const I=Math.ceil(v/a.options.pagination);let A,l;if(a.pageNumber<6?(A=1,l=I<10?I:10):I-a.pageNumber<5?(A=I-9,l=I,A<1&&(A=1)):(A=a.pageNumber-4,l=a.pageNumber+5),A>1){const g=document.createElement("div");g.className="jss_page",g.innerHTML="<",g.title=1,a.pagination.children[1].appendChild(g)}for(let g=A;g<=l;g++){const f=document.createElement("div");f.className="jss_page",f.innerHTML=g,a.pagination.children[1].appendChild(f),a.pageNumber==g-1&&f.classList.add("jss_page_selected")}if(l<I){const g=document.createElement("div");g.className="jss_page",g.innerHTML=">",g.title=I,a.pagination.children[1].appendChild(g)}const s=function(g){const f=Array.prototype.slice.call(arguments,1);return g.replace(/{(\d+)}/g,function(c,w){return f[w]!==void 0?f[w]:c})};a.pagination.children[0].innerHTML=s(jSuites.translate("Showing page {0} of {1} entries"),a.pageNumber+1,I)}else a.pagination.children[0].innerHTML=jSuites.translate("No records found")}},R=function(a){const v=this,I=v.pageNumber;let A;A=v.options.search!=1&&v.options.filters!=1||!v.results?v.rows:v.results;const l=parseInt(v.options.pagination);a!=null&&a!=-1||(a=Math.ceil(A.length/l)-1),v.pageNumber=a;let s=a*l,g=a*l+l;for(g>A.length&&(g=A.length),s<0&&(s=0);v.tbody.firstChild;)v.tbody.removeChild(v.tbody.firstChild);for(let f=s;f<g;f++)v.options.search!=1&&v.options.filters!=1||!v.results?v.tbody.appendChild(v.rows[f].element):v.tbody.appendChild(v.rows[A[f]].element);v.options.pagination>0&&W.call(v),C.Aq.call(v),d.A.call(v,"onchangepage",v,a,I,v.options.pagination)},m=function(){const a=this;let v;return v=a.options.search!=1&&a.options.filters!=1||!a.results?a.rows.length:a.results.length,Math.ceil(v/a.options.pagination)}},296:function(n,h,o){o.d(h,{w:function(){return d}});const d=function(){const C=this;let N=0;if(C.options.freezeColumns>0)for(let W=0;W<C.options.freezeColumns;W++){let R;R=C.options.columns&&C.options.columns[W]&&C.options.columns[W].width!==void 0?parseInt(C.options.columns[W].width):C.options.defaultColWidth!==void 0?parseInt(C.options.defaultColWidth):100,N+=R}return N}},344:function(n){n.exports=JSON.parse('{"fr_FR":{"SOMME":"SUM","MOYENNE":"AVERAGE","MIN":"MIN","MAX":"MAX","SI":"IF","ET":"AND","OU":"OR","NON":"NOT","NB":"COUNT","NBVAL":"COUNTA","PRODUIT":"PRODUCT","ARRONDI":"ROUND","ARRONDI.INF":"ROUNDDOWN","ARRONDI.SUP":"ROUNDUP","SOMME.SI":"SUMIF","SOMME.SI.ENS":"SUMIFS","MOYENNE.SI":"AVERAGEIF","MOYENNE.SI.ENS":"AVERAGEIFS","NB.SI":"COUNTIF","NB.SI.ENS":"COUNTIFS","CONCATENER":"CONCATENATE","CONCAT":"CONCAT","TEXTE":"TEXT","GAUCHE":"LEFT","DROITE":"RIGHT","STXT":"MID","CHERCHE":"SEARCH","TROUVE":"FIND","SUBSTITUE":"SUBSTITUTE","REMPLACER":"REPLACE","MAJUSCULE":"UPPER","MINUSCULE":"LOWER","NOMPROPRE":"PROPER","AUJOURDHUI":"TODAY","MAINTENANT":"NOW","DATE":"DATE","ANNEE":"YEAR","MOIS":"MONTH","JOUR":"DAY","HEURE":"HOUR","MINUTE":"MINUTE","SECONDE":"SECOND","ABS":"ABS","MOD":"MOD","PUISSANCE":"POWER","RANG":"RANK","ALEA":"RAND","ALEA.ENTRE.BORNES":"RANDBETWEEN","SIERREUR":"IFERROR","ESTERREUR":"ISERROR","ESTNUM":"ISNUMBER","ESTTEXTE":"ISTEXT","ESTVIDE":"ISBLANK","NB.JOURS.OUVRES":"NETWORKDAYS","NB.JOURS.OUVRES.INTL":"NETWORKDAYS.INTL","JOURSEM":"WEEKDAY","NB.JOURS":"DAYS","NB.JOURS360":"DAYS360"},"es_ES":{"SUMA":"SUM","PROMEDIO":"AVERAGE","MIN":"MIN","MAX":"MAX","SI":"IF","Y":"AND","O":"OR","NO":"NOT","CONTAR":"COUNT","CONTARA":"COUNTA","PRODUCTO":"PRODUCT","REDONDEAR":"ROUND","REDONDEAR.MENOS":"ROUNDDOWN","REDONDEAR.MAS":"ROUNDUP","SUMAR.SI":"SUMIF","SUMAR.SI.CONJUNTO":"SUMIFS","PROMEDIO.SI":"AVERAGEIF","PROMEDIO.SI.CONJUNTO":"AVERAGEIFS","CONTAR.SI":"COUNTIF","CONTAR.SI.CONJUNTO":"COUNTIFS","CONCATENAR":"CONCATENATE","CONCAT":"CONCAT","TEXTO":"TEXT","IZQUIERDA":"LEFT","DERECHA":"RIGHT","EXTRAE":"MID","HALLAR":"SEARCH","ENCONTRAR":"FIND","SUSTITUIR":"SUBSTITUTE","REEMPLAZAR":"REPLACE","MAYUSC":"UPPER","MINUSC":"LOWER","NOMPROPIO":"PROPER","HOY":"TODAY","AHORA":"NOW","FECHA":"DATE","AÑO":"YEAR","MES":"MONTH","DIA":"DAY","HORA":"HOUR","MINUTO":"MINUTE","SEGUNDO":"SECOND","ABS":"ABS","RESIDUO":"MOD","POTENCIA":"POWER","JERARQUIA":"RANK","ALEATORIO":"RAND","ALEATORIO.ENTRE":"RANDBETWEEN","SI.ERROR":"IFERROR","ESERROR":"ISERROR","ESNUMERO":"ISNUMBER","ESTEXTO":"ISTEXT","ESBLANCO":"ISBLANK","DIAS.LAB":"NETWORKDAYS","DIAS.LAB.INTL":"NETWORKDAYS.INTL","DIASEM":"WEEKDAY","DIAS":"DAYS","DIAS360":"DAYS360"}}')},392:function(n,h,o){o.d(h,{Ar:function(){return I},ll:function(){return v},nK:function(){return a}});var d=o(978),C=o(530);const N=function(A,l){l.options.editable!=0?A.classList.remove("jtoolbar-disabled"):A.classList.add("jtoolbar-disabled")},W=function(){const A=[],l=this,s=function(){return C.eN.call(l)};A.push({content:"undo",onclick:function(){s().undo()}}),A.push({content:"redo",onclick:function(){s().redo()}}),A.push({content:"save",onclick:function(){const f=s();f&&f.download()}}),A.push({type:"divisor"}),A.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(f){return'<span style="font-family:'+f+'">'+f+"</span>"},onchange:function(f,c,w,L,S){const k=s();let _=k.getSelected(!0);if(_){let M=S?L:"";k.setStyle(Object.fromEntries(_.map(function(B){return[B,"font-family: "+M]})))}},updateState:function(f,c,w){N(w,s())}}),A.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(f){return'<span style="font-size:'+f+'">'+f+"</span>"},onchange:function(f,c,w,L){const S=s();let k=S.getSelected(!0);k&&S.setStyle(Object.fromEntries(k.map(function(_){return[_,"font-size: "+L]})))},updateState:function(f,c,w){N(w,s())}}),A.push({type:"select",options:["left","center","right","justify"],render:function(f){return'<i class="material-icons">format_align_'+f+"</i>"},onchange:function(f,c,w,L){const S=s();let k=S.getSelected(!0);k&&S.setStyle(Object.fromEntries(k.map(function(_){return[_,"text-align: "+L]})))},updateState:function(f,c,w){N(w,s())}}),A.push({content:"format_bold",onclick:function(){const f=s();let c=f.getSelected(!0);c&&f.setStyle(Object.fromEntries(c.map(function(w){return[w,"font-weight:bold"]})))},updateState:function(f,c,w){N(w,s())}}),A.push({type:"color",content:"format_color_text",k:"color",updateState:function(f,c,w){N(w,s())}}),A.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(f,c,w,L){N(w,s())}});let g=["top","middle","bottom"];return A.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(f){return'<i class="material-icons">'+f+"</i>"},value:1,onchange:function(f,c,w,L,S){const k=s();let _=k.getSelected(!0);_&&k.setStyle(Object.fromEntries(_.map(function(M){return[M,"vertical-align: "+g[S]]})))},updateState:function(f,c,w){N(w,s())}}),A.push({content:"web",tooltip:jSuites.translate("Merge the selected cells"),onclick:function(){const f=s();if(f.selectedCell&&confirm(jSuites.translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){const c=[Math.min(f.selectedCell[0],f.selectedCell[2]),Math.min(f.selectedCell[1],f.selectedCell[3]),Math.max(f.selectedCell[0],f.selectedCell[2]),Math.max(f.selectedCell[1],f.selectedCell[3])];let w=(0,d.getCellNameFromCoords)(c[0],c[1]);if(f.records[c[1]][c[0]].element.getAttribute("data-merged"))f.removeMerge(w);else{let L=c[2]-c[0]+1,S=c[3]-c[1]+1;L===1&&S===1||f.setMerge(w,L,S)}}},updateState:function(f,c,w){N(w,s())}}),A.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(f){return'<i class="material-icons">'+f+"</i>"},right:!0,onchange:function(f,c,w,L){const S=s();if(S.selectedCell){const k=[Math.min(S.selectedCell[0],S.selectedCell[2]),Math.min(S.selectedCell[1],S.selectedCell[3]),Math.max(S.selectedCell[0],S.selectedCell[2]),Math.max(S.selectedCell[1],S.selectedCell[3])];let _=L;if(k){let M=c.thickness||1,B=c.color||"black";const z=c.style||"solid";z==="double"&&(M+=2);let q={},ce=k[0],me=k[1],G=k[2],se=k[3];const ge=function(ue,oe,xe){let ke=["","","",""];ke[0]=(_==="border_top"||_==="border_outer")&&xe===me||(_==="border_inner"||_==="border_horizontal")&&xe>me||_==="border_all"?"border-top: "+M+"px "+z+" "+B:"border-top: ",ke[1]=_!=="border_all"&&_!=="border_right"&&_!=="border_outer"||oe!==G?"border-right: ":"border-right: "+M+"px "+z+" "+B,ke[2]=_!=="border_all"&&_!=="border_bottom"&&_!=="border_outer"||xe!==se?"border-bottom: ":"border-bottom: "+M+"px "+z+" "+B,ke[3]=(_==="border_left"||_==="border_outer")&&oe===ce||(_==="border_inner"||_==="border_vertical")&&oe>ce||_==="border_all"?"border-left: "+M+"px "+z+" "+B:"border-left: ",q[ue]=ke.join(";")};for(let ue=k[1];ue<=k[3];ue++)for(let oe=k[0];oe<=k[2];oe++)ge((0,d.getCellNameFromCoords)(oe,ue),oe,ue),S.records[ue][oe].element.getAttribute("data-merged")&&ge((0,d.getCellNameFromCoords)(k[0],k[1]),oe,ue);Object.keys(q)&&S.setStyle(q)}}},onload:function(f,c){let w=document.createElement("div"),L=document.createElement("div");w.appendChild(L);let S=jSuites.color(L,{closeOnChange:!1,onchange:function(M,B){M.parentNode.children[1].style.color=B,c.color=B}}),k=document.createElement("i");k.classList.add("material-icons"),k.innerHTML="color_lens",k.onclick=function(){S.open()},w.appendChild(k),f.children[1].appendChild(w),L=document.createElement("div"),jSuites.picker(L,{type:"select",data:[1,2,3,4,5],render:function(M){return'<div style="height: '+M+'px; width: 30px; background-color: black;"></div>'},onchange:function(M,B,z,q){c.thickness=q},width:"50px"}),f.children[1].appendChild(L);const _=document.createElement("div");jSuites.picker(_,{type:"select",data:["solid","dotted","dashed","double"],render:function(M){return M==="double"?'<div style="width: 30px; border-top: 3px '+M+' black;"></div>':'<div style="width: 30px; border-top: 2px '+M+' black;"></div>'},onchange:function(M,B,z,q){c.style=q},width:"50px"}),f.children[1].appendChild(_),L=document.createElement("div"),L.style.flex="1",f.children[1].appendChild(L)},updateState:function(f,c,w){N(w,s())}}),A.push({type:"divisor"}),A.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(f,c,w){w.children[0].textContent==="fullscreen"?(l.fullscreen(!0),w.children[0].textContent="fullscreen_exit"):(l.fullscreen(!1),w.children[0].textContent="fullscreen")},updateState:function(f,c,w,L){L.parent.config.fullscreen===!0?w.children[0].textContent="fullscreen_exit":w.children[0].textContent="fullscreen"}}),A},R=function(A){const l=this,s=A.items;for(let g=0;g<s.length;g++)s[g].tooltip&&(s[g].title=s[g].tooltip,delete s[g].tooltip),s[g].type=="select"?s[g].options?(s[g].data=s[g].options,delete s[g].options):(s[g].data=s[g].v,delete s[g].v,s[g].k&&!s[g].onchange&&(s[g].onchange=function(f,c,w){const L=C.eN.call(l),S=L.getSelected(!0);L.setStyle(Object.fromEntries(S.map(function(k){return[k,s[g].k+": "+w]})))})):s[g].type=="color"&&(s[g].type="i",s[g].onclick=function(f,c,w){w.color||(jSuites.color(w,{onchange:function(L,S){const k=C.eN.call(l),_=k.getSelected(!0);k.setStyle(Object.fromEntries(_.map(function(M){return[M,s[g].k+": "+S]})))},onopen:function(L){L.color.select("")}}),w.color.open())})},m=function(A){const l=this,s=document.createElement("div");return s.classList.add("jss_toolbar"),R.call(l,A),typeof l.plugins=="object"&&Object.entries(l.plugins).forEach(function([,g]){if(typeof g.toolbar=="function"){const f=g.toolbar(A);f&&(A=f)}}),jSuites.toolbar(s,A),s},a=function(A){A.parent.toolbar&&A.parent.toolbar.toolbar.update(A)},v=function(){const A=this;if(A.config.toolbar&&!A.toolbar){let l;Array.isArray(A.config.toolbar)?l={items:A.config.toolbar}:typeof A.config.toolbar=="object"?l=A.config.toolbar:(l={items:W.call(A)},typeof A.config.toolbar=="function"&&(l=A.config.toolbar(l))),A.toolbar=A.element.insertBefore(m.call(A,l),A.element.children[1])}},I=function(){const A=this;A.toolbar&&(A.toolbar.parentNode.removeChild(A.toolbar),delete A.toolbar)}},497:function(n,h,o){o.d(h,{AG:function(){return C},G_:function(){return N},p6:function(){return W},wu:function(){return d}});const d=function(R){const m=this;let a;a=m.options.search!=1&&m.options.filters!=1||!m.results?m.rows:m.results;const v=100;R!=null&&R!=-1||(R=Math.ceil(a.length/v)-1);let I=R*v,A=R*v+v;A>a.length&&(A=a.length),I=A-100,I<0&&(I=0);for(let l=I;l<A;l++)m.options.search!=1&&m.options.filters!=1||!m.results?m.tbody.appendChild(m.rows[l].element):m.tbody.appendChild(m.rows[a[l]].element),m.tbody.children.length>v&&m.tbody.removeChild(m.tbody.firstChild)},C=function(){const R=this;if(R.selectedCell){const m=parseInt(R.tbody.firstChild.getAttribute("data-y"))/100,a=parseInt(R.selectedCell[3]/100),v=parseInt(R.rows.length/100);if(m!=a&&a<=v&&!Array.prototype.indexOf.call(R.tbody.children,R.rows[R.selectedCell[3]].element))return R.loadPage(a),!0}return!1},N=function(){const R=this;let m;m=R.options.search!=1&&R.options.filters!=1||!R.results?R.rows:R.results;let a=0;if(m.length>100){let v=parseInt(R.tbody.firstChild.getAttribute("data-y"));if(R.options.search!=1&&R.options.filters!=1||!R.results||(v=m.indexOf(v)),v>0)for(let I=0;I<30;I++)v-=1,v>-1&&(R.options.search!=1&&R.options.filters!=1||!R.results?R.tbody.insertBefore(R.rows[v].element,R.tbody.firstChild):R.tbody.insertBefore(R.rows[m[v]].element,R.tbody.firstChild),R.tbody.children.length>100&&(R.tbody.removeChild(R.tbody.lastChild),a=1))}return a},W=function(){const R=this;let m;m=R.options.search!=1&&R.options.filters!=1||!R.results?R.rows:R.results;let a=0;if(m.length>100){let v=parseInt(R.tbody.lastChild.getAttribute("data-y"));if(R.options.search!=1&&R.options.filters!=1||!R.results||(v=m.indexOf(v)),v<R.rows.length-1)for(let I=0;I<=30;I++)v<m.length&&(R.options.search!=1&&R.options.filters!=1||!R.results?R.tbody.appendChild(R.rows[v].element):R.tbody.appendChild(R.rows[m[v]].element),R.tbody.children.length>100&&(R.tbody.removeChild(R.tbody.firstChild),a=1)),v+=1}return a}},530:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$O:function(){return getWorksheetActive},$x:function(){return parseValue},C6:function(){return showIndex},Em:function(){return executeFormula},P9:function(){return createCell},Rs:function(){return updateScroll},TI:function(){return hideIndex},Xr:function(){return getCellFromCoords},Y5:function(){return fullscreen},am:function(){return updateTable},dw:function(){return isFormula},eN:function(){return getWorksheetInstance},hG:function(){return updateResult},ju:function(){return createNestedHeader},k9:function(){return updateCell},o8:function(){return updateTableReferences},p9:function(){return getLabel},rS:function(){return getMask},tT:function(){return getCell},xF:function(){return updateFormulaChain},yB:function(){return updateFormula}});var _dispatch_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(805),_selection_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(657),_helpers_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(978),_meta_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(654),_freeze_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(296),_pagination_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(167),_footer_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(160),_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(689),_formulasTranslater_json__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(344);const locale=(navigator.language||navigator.userLanguage).replace("-","_")||"en_US",updateTable=function(){const n=this;if(n.options.minSpareRows>0){let h=0;for(let o=n.rows.length-1;o>=0;o--){let d=!1;for(let C=0;C<n.headers.length;C++)n.options.data[o][C]&&(d=!0);if(d)break;h++}n.options.minSpareRows-h>0&&n.insertRow(n.options.minSpareRows-h)}if(n.options.minSpareCols>0){let h=0;for(let o=n.headers.length-1;o>=0;o--){let d=!1;for(let C=0;C<n.rows.length;C++)n.options.data[C][o]&&(d=!0);if(d)break;h++}n.options.minSpareCols-h>0&&n.insertColumn(n.options.minSpareCols-h)}n.options.footers&&_footer_js__WEBPACK_IMPORTED_MODULE_6__.e.call(n),n.options.columns.length<n.options.minDimensions[0]&&(n.options.minDimensions[0]=n.options.columns.length),setTimeout(function(){_selection_js__WEBPACK_IMPORTED_MODULE_1__.Aq.call(n)},0)},parseNumber=function(n,h){const o=h&&this.options.columns[h].decimal?this.options.columns[h].decimal:".";let d=""+n;return d=d.split(o),d[0]=d[0].match(/[+-]?[0-9]/g),d[0]&&(d[0]=d[0].join("")),d[1]&&(d[1]=d[1].match(/[0-9]*/g).join("")),d[0]&&Number.isInteger(Number(d[0]))?d[1]?+(d[0]+"."+d[1]):+(d[0]+".00"):null};function translateFormula(n){const h=_formulasTranslater_json__WEBPACK_IMPORTED_MODULE_8__[locale]||{};return n.replace(/^=([A-ZÉÈÀÙÂÊÎÔÛÇ]+)\s*\(/i,function(o,d){const C=h[d.toUpperCase()];return C?"="+C+"(":o})}const executeFormula=function(expression,x,y){const obj=this,formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){const parentId=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;const tokensUpdate=function(n){for(let h=0;h<n.length;h++){const o=[],d=n[h].split(":"),C=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(d[0],!0),N=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(d[1],!0);let W,R,m,a;C[0]<=N[0]?(W=C[0],R=N[0]):(W=N[0],R=C[0]),C[1]<=N[1]?(m=C[1],a=N[1]):(m=N[1],a=C[1]);for(let v=m;v<=a;v++)for(let I=W;I<=R;I++)o.push((0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([I,v]));expression=expression.replace(n[h],o.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");let tokens=expression.match(/([A-Z]+[0-9]+):([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";{const formulaExpressions={};if(tokens){for(let i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){const n=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(tokens[i],1);let h;if(h=obj.options.data[n[1]]!==void 0&&obj.options.data[n[1]][n[0]]!==void 0?obj.options.data[n[1]][n[0]]:"",(""+h).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?h=formulaResults[tokens[i]]:(h=execute(translateFormula(h),n[0],n[1]),formulaResults[tokens[i]]=h)),(""+h).trim()=="")formulaExpressions[tokens[i]]=null;else if(h==Number(h)&&obj.parent.config.autoCasting!=0)formulaExpressions[tokens[i]]=Number(h);else{const o=parseNumber.call(obj,h,n[0]);obj.parent.config.autoCasting!=0&&o?formulaExpressions[tokens[i]]=o:formulaExpressions[tokens[i]]='"'+h+'"'}}}const ret=_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(obj,"onbeforeformula",obj,expression,x,y);if(ret===!1)return expression;let res;ret&&(expression=ret);try{res=formula(expression.substr(1),formulaExpressions,x,y,obj),typeof res=="function"&&(res="#ERROR")}catch(n){res="#ERROR",obj.parent.config.debugFormulas===!0&&console.log(expression.substr(1),formulaExpressions,n)}return res}};return execute(translateFormula(expression),x,y)},parseValue=function(n,h,o,d){const C=this;(""+o).substr(0,1)=="="&&C.parent.config.parseFormulas!=0&&(o=executeFormula.call(C,o,n,h));const N=C.options.columns&&C.options.columns[n];if(N&&!isFormula(o)){let W=null;if(W=getMask(N)){o&&o==Number(o)&&(o=Number(o));let R=jSuites.mask.render(o,W,!0);if(d&&W.mask){const m=W.mask.split(";");m[1]&&(m[1].match(new RegExp("\\[Red\\]","gi"))&&(o<0?d.classList.add("red"):d.classList.remove("red")),m[1].match(new RegExp("\\(","gi"))&&o<0&&(R="("+R+")"))}R&&(o=R)}}return o},getDropDownValue=function(n,h){const o=this,d=[];if(o.options.columns&&o.options.columns[n]&&o.options.columns[n].source){const C=[],N=o.options.columns[n].source;for(let R=0;R<N.length;R++)typeof N[R]=="object"?C[N[R].id]=N[R].name:C[N[R]]=N[R];const W=Array.isArray(h)?h:(""+h).split(";");for(let R=0;R<W.length;R++)typeof W[R]=="object"?d.push(C[W[R].id]):C[W[R]]&&d.push(C[W[R]])}else console.error("Invalid column");return d.length>0?d.join("; "):""},validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])},stripScript=function(n){const h=new Option;h.innerHTML=n;let o=null;for(n=h.getElementsByTagName("script");o=n[0];)o.parentNode.removeChild(o);return h.innerHTML},createCell=function(n,h,o){const d=this;let C=document.createElement("td");if(C.setAttribute("data-x",n),C.setAttribute("data-y",h),d.headers[n].style.display==="none"&&(C.style.display="none"),(""+o).substr(0,1)=="="&&d.options.secureFormulas==1){const W=secureFormula(o);W!=o&&(o=W)}if(d.options.columns&&d.options.columns[n]&&typeof d.options.columns[n].type=="object")d.parent.config.parseHTML===!0?C.innerHTML=o:C.textContent=o,typeof d.options.columns[n].type.createCell=="function"&&d.options.columns[n].type.createCell(C,o,parseInt(n),parseInt(h),d,d.options.columns[n]);else if(d.options.columns&&d.options.columns[n]&&d.options.columns[n].type=="hidden")C.style.display="none",C.textContent=o;else if(d.options.columns&&d.options.columns[n]&&(d.options.columns[n].type=="checkbox"||d.options.columns[n].type=="radio")){const W=document.createElement("input");W.type=d.options.columns[n].type,W.name="c"+n,W.checked=o==1||o==1||o=="true",W.onclick=function(){d.setValue(C,this.checked)},d.options.columns[n].readOnly!=1&&d.options.editable!=0||W.setAttribute("disabled","disabled"),C.appendChild(W),d.options.data[h][n]=W.checked}else if(d.options.columns&&d.options.columns[n]&&d.options.columns[n].type=="calendar"){let W=null;if(!validDate(o)){const R=jSuites.calendar.extractDateFromString(o,d.options.columns[n].options&&d.options.columns[n].options.format||"YYYY-MM-DD");R&&(W=R)}C.textContent=jSuites.calendar.getDateString(W||o,d.options.columns[n].options&&d.options.columns[n].options.format)}else if(d.options.columns&&d.options.columns[n]&&d.options.columns[n].type=="dropdown")C.classList.add("jss_dropdown"),C.textContent=getDropDownValue.call(d,n,o);else if(d.options.columns&&d.options.columns[n]&&d.options.columns[n].type=="color")if(d.options.columns[n].render=="square"){const W=document.createElement("div");W.className="color",W.style.backgroundColor=o,C.appendChild(W)}else C.style.color=o,C.textContent=o;else if(d.options.columns&&d.options.columns[n]&&d.options.columns[n].type=="image"){if(o&&o.substr(0,10)=="data:image"){const W=document.createElement("img");W.src=o,C.appendChild(W)}}else d.options.columns&&d.options.columns[n]&&d.options.columns[n].type=="html"||d.parent.config.parseHTML===!0?C.innerHTML=stripScript(parseValue.call(this,n,h,o,C)):C.textContent=parseValue.call(this,n,h,o,C);d.options.columns&&d.options.columns[n]&&d.options.columns[n].readOnly==1&&(C.className="readonly");const N=d.options.columns&&d.options.columns[n]&&d.options.columns[n].align||d.options.defaultColAlign||"center";return C.style.textAlign=N,d.options.columns&&d.options.columns[n]&&d.options.columns[n].wordWrap==0||!(d.options.wordWrap==1||d.options.columns&&d.options.columns[n]&&d.options.columns[n].wordWrap==1||C.innerHTML.length>200)||(C.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(o||C.innerHTML?d.records[h][n-1].element.style.overflow="hidden":n==d.options.columns.length-1&&(C.style.overflow="hidden")),_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(d,"oncreatecell",d,C,n,h,o),C},updateCell=function(n,h,o,d){const C=this;let N;if(C.records[h][n].element.classList.contains("readonly")!=1||d){if((""+o).substr(0,1)=="="&&C.options.secureFormulas==1){const m=secureFormula(o);m!=o&&(o=m)}const W=_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(C,"onbeforechange",C,C.records[h][n].element,n,h,o);if(W!=null&&(o=W),C.options.columns&&C.options.columns[n]&&typeof C.options.columns[n].type=="object"&&typeof C.options.columns[n].type.updateCell=="function"){const m=C.options.columns[n].type.updateCell(C.records[h][n].element,o,parseInt(n),parseInt(h),C,C.options.columns[n]);m!==void 0&&(o=m)}N={x:n,y:h,col:n,row:h,value:o,oldValue:C.options.data[h][n]};let R=C.options.columns&&C.options.columns[n]&&typeof C.options.columns[n].type=="object"?C.options.columns[n].type:null;if(R)C.options.data[h][n]=o,typeof R.setValue=="function"&&R.setValue(C.records[h][n].element,o);else if(C.options.columns&&C.options.columns[n]&&(C.options.columns[n].type=="checkbox"||C.options.columns[n].type=="radio")){if(C.options.columns[n].type=="radio")for(let m=0;m<C.options.data.length;m++)C.options.data[m][n]=!1;C.records[h][n].element.children[0].checked=o==1||o==1||o=="true"||o=="TRUE",C.options.data[h][n]=C.records[h][n].element.children[0].checked}else if(C.options.columns&&C.options.columns[n]&&C.options.columns[n].type=="dropdown")C.options.data[h][n]=o,C.records[h][n].element.textContent=getDropDownValue.call(C,n,o);else if(C.options.columns&&C.options.columns[n]&&C.options.columns[n].type=="calendar"){let m=null;if(!validDate(o)){const a=jSuites.calendar.extractDateFromString(o,C.options.columns[n].options&&C.options.columns[n].options.format||"YYYY-MM-DD");a&&(m=a)}C.options.data[h][n]=o,C.records[h][n].element.textContent=jSuites.calendar.getDateString(m||o,C.options.columns[n].options&&C.options.columns[n].options.format)}else if(C.options.columns&&C.options.columns[n]&&C.options.columns[n].type=="color")if(C.options.data[h][n]=o,C.options.columns[n].render=="square"){const m=document.createElement("div");m.className="color",m.style.backgroundColor=o,C.records[h][n].element.textContent="",C.records[h][n].element.appendChild(m)}else C.records[h][n].element.style.color=o,C.records[h][n].element.textContent=o;else if(C.options.columns&&C.options.columns[n]&&C.options.columns[n].type=="image"){if(o=""+o,C.options.data[h][n]=o,C.records[h][n].element.innerHTML="",o&&o.substr(0,10)=="data:image"){const m=document.createElement("img");m.src=o,C.records[h][n].element.appendChild(m)}}else C.options.data[h][n]=o,C.options.columns&&C.options.columns[n]&&C.options.columns[n].type=="html"?C.records[h][n].element.innerHTML=stripScript(parseValue.call(C,n,h,o)):C.parent.config.parseHTML===!0?C.records[h][n].element.innerHTML=stripScript(parseValue.call(C,n,h,o,C.records[h][n].element)):C.records[h][n].element.textContent=parseValue.call(C,n,h,o,C.records[h][n].element),C.options.columns&&C.options.columns[n]&&C.options.columns[n].wordWrap==0||!(C.options.wordWrap==1||C.options.columns&&C.options.columns[n]&&C.options.columns[n].wordWrap==1||C.records[h][n].element.innerHTML.length>200)?C.records[h][n].element.style.whiteSpace="":C.records[h][n].element.style.whiteSpace="pre-wrap";n>0&&(C.records[h][n-1].element.style.overflow=o?"hidden":""),C.options.columns&&C.options.columns[n]&&typeof C.options.columns[n].render=="function"&&C.options.columns[n].render(C.records[h]&&C.records[h][n]?C.records[h][n].element:null,o,parseInt(n),parseInt(h),C,C.options.columns[n]),_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(C,"onchange",C,C.records[h]&&C.records[h][n]?C.records[h][n].element:null,n,h,o,N.oldValue)}else N={x:n,y:h,col:n,row:h};return N},isFormula=function(n){const h=(""+n)[0];return h=="="||h=="#"},getMask=function(n){if(n.format||n.mask||n.locale){const h={};return n.mask?h.mask=n.mask:n.format?h.mask=n.format:(h.locale=n.locale,h.options=n.options),n.decimal&&(h.options||(h.options={}),h.options={decimal:n.decimal}),h}return null},secureFormula=function(n){let h="",o=0;for(let d=0;d<n.length;d++)n[d]=='"'&&(o=o==0?1:0),h+=o==1?n[d]:n[d].toUpperCase();return h};let chainLoopProtection=[];const updateFormulaChain=function(n,h,o){const d=this,C=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([n,h]);if(d.formula[C]&&d.formula[C].length>0)if(chainLoopProtection[C])d.records[h][n].element.innerHTML="#ERROR",d.formula[C]="";else{chainLoopProtection[C]=!0;for(let N=0;N<d.formula[C].length;N++){const W=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(d.formula[C][N],!0),R=""+d.options.data[W[1]][W[0]];R.substr(0,1)=="="?o.push(updateCell.call(d,W[0],W[1],R,!0)):Object.keys(d.formula)[N]=null,updateFormulaChain.call(d,W[0],W[1],o)}}chainLoopProtection=[]},updateFormula=function(n,h){const o=/[A-Z]/,d=/[0-9]/;let C="",N=null,W=null,R="";for(let m=0;m<n.length;m++)o.exec(n[m])?(N=1,W=0,R+=n[m]):d.exec(n[m])?(W=N?1:0,R+=n[m]):(N&&W&&(R=h[R]?h[R]:R),C+=R,C+=n[m],N=0,W=0,R="");return R&&(N&&W&&(R=h[R]?h[R]:R),C+=R),C},updateFormulas=function(n){const h=this;for(let C=0;C<h.options.data.length;C++)for(let N=0;N<h.options.data[0].length;N++){const W=""+h.options.data[C][N];if(W.substr(0,1)=="="){const R=updateFormula(W,n);R!=W&&(h.options.data[C][N]=R)}}const o=[],d=Object.keys(h.formula);for(let C=0;C<d.length;C++){let N=d[C];const W=h.formula[N];n[N]&&(N=n[N]),o[N]=[];for(let R=0;R<W.length;R++){let m=W[R];n[m]&&(m=n[m]),o[N].push(m)}}h.formula=o},updateTableReferences=function(){const n=this;if(n.skipUpdateTableReferences)return;for(let N=0;N<n.headers.length;N++)n.headers[N].getAttribute("data-x")!=N&&(n.headers[N].setAttribute("data-x",N),n.headers[N].getAttribute("title")||(n.headers[N].innerHTML=(0,_helpers_js__WEBPACK_IMPORTED_MODULE_2__.getColumnName)(N)));for(let N=0;N<n.rows.length;N++)n.rows[N]&&n.rows[N].element.getAttribute("data-y")!=N&&(n.rows[N].element.setAttribute("data-y",N),n.rows[N].element.children[0].setAttribute("data-y",N),n.rows[N].element.children[0].innerHTML=N+1);const h=[],o=[],d=function(N,W,R,m){if(N!=R&&n.records[m][R].element.setAttribute("data-x",R),W!=m&&n.records[m][R].element.setAttribute("data-y",m),N!=R||W!=m){const a=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([N,W]),v=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([R,m]);h[a]=v}};for(let N=0;N<n.records.length;N++)for(let W=0;W<n.records[0].length;W++)if(n.records[N][W]){const R=n.records[N][W].element.getAttribute("data-x"),m=n.records[N][W].element.getAttribute("data-y");if(n.records[N][W].element.getAttribute("data-merged")){const a=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([R,m]),v=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([W,N]);if(o[a]==null)if(a==v)o[a]=!1;else{const I=parseInt(W-R),A=parseInt(N-m);o[a]=[v,I,A]}}else d(R,m,W,N)}const C=Object.keys(o);if(C.length){for(let N=0;N<C.length;N++)if(o[C[N]]){const W=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(C[N],!0);let R=W[0],m=W[1];d(R,m,R+o[C[N]][1],m+o[C[N]][2]);const a=C[N],v=o[C[N]][0];for(let I=0;I<n.options.mergeCells[a][2].length;I++)R=parseInt(n.options.mergeCells[a][2][I].getAttribute("data-x")),m=parseInt(n.options.mergeCells[a][2][I].getAttribute("data-y")),n.options.mergeCells[a][2][I].setAttribute("data-x",R+o[C[N]][1]),n.options.mergeCells[a][2][I].setAttribute("data-y",m+o[C[N]][2]);n.options.mergeCells[v]=n.options.mergeCells[a],delete n.options.mergeCells[a]}}updateFormulas.call(n,h),_meta_js__WEBPACK_IMPORTED_MODULE_3__.hs.call(n,h),_selection_js__WEBPACK_IMPORTED_MODULE_1__.G9.call(n),updateTable.call(n)},updateScroll=function(n){const h=this,o=h.content.getBoundingClientRect(),d=o.left,C=o.top,N=o.width,W=o.height,R=h.records[h.selectedCell[3]][h.selectedCell[2]].element.getBoundingClientRect(),m=R.left,a=R.top,v=R.width,I=R.height;let A,l;n==0||n==1?(A=m-d+h.content.scrollLeft,l=a-C+h.content.scrollTop-2):(A=m-d+h.content.scrollLeft+v,l=a-C+h.content.scrollTop+I),l>h.content.scrollTop+30&&l<h.content.scrollTop+W||(l<h.content.scrollTop+30?h.content.scrollTop=l-I:h.content.scrollTop=l-(W-2));const s=_freeze_js__WEBPACK_IMPORTED_MODULE_4__.w.call(h);A>h.content.scrollLeft+s&&A<h.content.scrollLeft+N||(A<h.content.scrollLeft+30?(h.content.scrollLeft=A,h.content.scrollLeft<50&&(h.content.scrollLeft=0)):A<h.content.scrollLeft+s?h.content.scrollLeft=A-s-1:h.content.scrollLeft=A-(N-20))},updateResult=function(){const n=this;let h=0,o=0;for(h=n.options.lazyLoading==1?100:n.options.pagination>0?n.options.pagination:n.results?n.results.length:n.rows.length;n.tbody.firstChild;)n.tbody.removeChild(n.tbody.firstChild);for(let d=0;d<n.rows.length;d++)!n.results||n.results.indexOf(d)>-1?(o<h&&(n.tbody.appendChild(n.rows[d].element),o++),n.rows[d].element.style.display=""):n.rows[d].element.style.display="none";return n.options.pagination>0&&_pagination_js__WEBPACK_IMPORTED_MODULE_5__.IV.call(n),_selection_js__WEBPACK_IMPORTED_MODULE_1__.Aq.call(n),_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(n,"onupdateresult",n,n.results),h},getCell=function(n,h){if(typeof n=="string"){const o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(n,!0);n=o[0],h=o[1]}return this.records[h][n].element},getCellFromCoords=function(n,h){return this.records[h][n].element},getLabel=function(n,h){if(typeof n=="string"){const o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(n,!0);n=o[0],h=o[1]}return this.records[h][n].element.innerHTML},fullscreen=function(n){const h=this;n==null&&(n=!h.config.fullscreen),h.config.fullscreen!=n&&(h.config.fullscreen=n,n==1?h.element.classList.add("fullscreen"):h.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(n){const h=this,o=document.createElement("tr");o.classList.add("jss_nested");const d=document.createElement("td");d.classList.add("jss_selectall"),o.appendChild(d),n.element=o;let C=0;for(let N=0;N<n.length;N++){n[N].colspan||(n[N].colspan=1),n[N].title||(n[N].title=""),n[N].id||(n[N].id="");let W=n[N].colspan;const R=[];for(let a=0;a<W;a++)h.options.columns[C]&&h.options.columns[C].type=="hidden"&&W++,R.push(C),C++;const m=document.createElement("td");m.setAttribute("data-column",R.join(",")),m.setAttribute("colspan",n[N].colspan),m.setAttribute("align",n[N].align||"center"),m.setAttribute("id",n[N].id),m.textContent=n[N].title,o.appendChild(m)}return o},getWorksheetActive=function(){const n=this.parent?this.parent:this;return n.element.tabs?n.element.tabs.getActive():0},getWorksheetInstance=function(n){const h=n!==void 0?n:getWorksheetActive.call(this);return this.worksheets[h]}},654:function(n,h,o){o.d(h,{IQ:function(){return C},hs:function(){return N},iZ:function(){return W}});var d=o(805);const C=function(R,m){const a=this;return R?m?a.options.meta&&a.options.meta[R]&&a.options.meta[R][m]?a.options.meta[R][m]:null:a.options.meta&&a.options.meta[R]?a.options.meta[R]:null:a.options.meta},N=function(R){const m=this;if(m.options.meta){const a={},v=Object.keys(m.options.meta);for(let I=0;I<v.length;I++)R[v[I]]?a[R[v[I]]]=m.options.meta[v[I]]:a[v[I]]=m.options.meta[v[I]];m.options.meta=a}},W=function(R,m,a){const v=this;if(v.options.meta||(v.options.meta={}),m&&a)v.options.meta[R]||(v.options.meta[R]={}),v.options.meta[R][m]=a,d.A.call(v,"onchangemeta",v,{[R]:{[m]:a}});else{const I=Object.keys(R);for(let A=0;A<I.length;A++){v.options.meta[I[A]]||(v.options.meta[I[A]]={});const l=Object.keys(R[I[A]]);for(let s=0;s<l.length;s++)v.options.meta[I[A]][l[s]]=R[I[A]][l[s]]}d.A.call(v,"onchangemeta",v,R)}}},657:function(n,h,o){o.d(h,{AH:function(){return s},Aq:function(){return v},G9:function(){return f},Jg:function(){return g},Lo:function(){return B},R5:function(){return _},Ub:function(){return M},at:function(){return k},c6:function(){return A},eO:function(){return q},ef:function(){return z},gE:function(){return I},gG:function(){return c},kA:function(){return l},kF:function(){return L},kV:function(){return me},sp:function(){return ce},tW:function(){return S}});var d=o(805),C=o(296),N=o(978),W=o(911),R=o(530),m=o(689),a=o(392);const v=function(){const G=this;if(G.highlighted&&G.highlighted.length){const se=G.highlighted[G.highlighted.length-1].element,ge=se.getAttribute("data-x"),ue=G.content.getBoundingClientRect(),oe=ue.left,xe=ue.top,ke=se.getBoundingClientRect(),Re=ke.left,Se=ke.top,$e=ke.width,Y=ke.height,Ae=Re-oe+G.content.scrollLeft+$e-4,Fe=Se-xe+G.content.scrollTop+Y-4;if(G.corner.style.top=Fe+"px",G.corner.style.left=Ae+"px",G.options.freezeColumns){const rt=C.w.call(G);ge>G.options.freezeColumns-1&&Re-oe+$e<rt?G.corner.style.display="none":G.options.selectionCopy!=0&&(G.corner.style.display="")}else G.options.selectionCopy!=0&&(G.corner.style.display="")}else G.corner.style.top="-2000px",G.corner.style.left="-2000px";(0,a.nK)(G)},I=function(G){const se=this;let ge;if(se.highlighted&&se.highlighted.length){ge=1;for(let ue=0;ue<se.highlighted.length;ue++){se.highlighted[ue].element.classList.remove("highlight"),se.highlighted[ue].element.classList.remove("highlight-left"),se.highlighted[ue].element.classList.remove("highlight-right"),se.highlighted[ue].element.classList.remove("highlight-top"),se.highlighted[ue].element.classList.remove("highlight-bottom"),se.highlighted[ue].element.classList.remove("highlight-selected");const oe=parseInt(se.highlighted[ue].element.getAttribute("data-x")),xe=parseInt(se.highlighted[ue].element.getAttribute("data-y"));let ke,Re;if(se.highlighted[ue].element.getAttribute("data-merged")){const Se=parseInt(se.highlighted[ue].element.getAttribute("colspan")),$e=parseInt(se.highlighted[ue].element.getAttribute("rowspan"));ke=Se>0?oe+(Se-1):oe,Re=$e>0?xe+($e-1):xe}else ke=oe,Re=xe;for(let Se=oe;Se<=ke;Se++)se.headers[Se]&&se.headers[Se].classList.remove("selected");for(let Se=xe;Se<=Re;Se++)se.rows[Se]&&se.rows[Se].element.classList.remove("selected")}}else ge=0;return se.highlighted=[],se.selectedCell=null,se.corner.style.top="-2000px",se.corner.style.left="-2000px",G==1&&ge==1&&d.A.call(se,"onblur",se),ge},A=function(G,se,ge){const ue=G.getAttribute("data-x"),oe=G.getAttribute("data-y");let xe,ke;se?(xe=se.getAttribute("data-x"),ke=se.getAttribute("data-y")):(xe=ue,ke=oe),s.call(this,ue,oe,xe,ke,ge)},l=function(){const G=document.querySelectorAll(".jss_worksheet .copying");for(let se=0;se<G.length;se++)G[se].classList.remove("copying"),G[se].classList.remove("copying-left"),G[se].classList.remove("copying-right"),G[se].classList.remove("copying-top"),G[se].classList.remove("copying-bottom")},s=function(G,se,ge,ue,oe){const xe=this;if(se==null){if(se=0,ue=xe.rows.length-1,G==null)return}else G==null&&(G=0,ge=xe.options.data[0].length-1);ge==null&&(ge=G),ue==null&&(ue=se),G>=xe.headers.length&&(G=xe.headers.length-1),se>=xe.rows.length&&(se=xe.rows.length-1),ge>=xe.headers.length&&(ge=xe.headers.length-1),ue>=xe.rows.length&&(ue=xe.rows.length-1);let ke,Re,Se,$e,Y=null,Ae=null,Fe=null,rt=null;parseInt(G)<parseInt(ge)?(ke=parseInt(G),Re=parseInt(ge)):(ke=parseInt(ge),Re=parseInt(G)),parseInt(se)<parseInt(ue)?(Se=parseInt(se),$e=parseInt(ue)):(Se=parseInt(ue),$e=parseInt(se));for(let Ce=ke;Ce<=Re;Ce++)for(let Ie=Se;Ie<=$e;Ie++)if(xe.records[Ie][Ce]&&xe.records[Ie][Ce].element.getAttribute("data-merged")){const Be=parseInt(xe.records[Ie][Ce].element.getAttribute("data-x")),Pe=parseInt(xe.records[Ie][Ce].element.getAttribute("data-y")),ze=parseInt(xe.records[Ie][Ce].element.getAttribute("colspan")),Ze=parseInt(xe.records[Ie][Ce].element.getAttribute("rowspan"));ze>1&&(Be<ke&&(ke=Be),Be+ze>Re&&(Re=Be+ze-1)),Ze&&(Pe<Se&&(Se=Pe),Pe+Ze>$e&&($e=Pe+Ze-1))}for(let Ce=Se;Ce<=$e;Ce++)xe.rows[Ce].element.style.display!="none"&&(Fe==null&&(Fe=Ce),rt=Ce);for(let Ce=ke;Ce<=Re;Ce++)for(let Ie=Se;Ie<=$e;Ie++)xe.options.columns&&xe.options.columns[Ce]&&xe.options.columns[Ce].type=="hidden"||(Y==null&&(Y=Ce),Ae=Ce);if(Y||(Y=0),Ae||(Ae=0),d.A.call(xe,"onbeforeselection",xe,Y,Fe,Ae,rt,oe)===!1)return!1;const Ne=xe.resetSelection();xe.selectedCell=[G,se,ge,ue],xe.records[se][G]&&xe.records[se][G].element.classList.add("highlight-selected");for(let Ce=ke;Ce<=Re;Ce++)for(let Ie=Se;Ie<=$e;Ie++)xe.rows[Ie].element.style.display!="none"&&xe.records[Ie][Ce].element.style.display!="none"&&(xe.records[Ie][Ce].element.classList.add("highlight"),xe.highlighted.push(xe.records[Ie][Ce]));for(let Ce=Y;Ce<=Ae;Ce++)xe.options.columns&&xe.options.columns[Ce]&&xe.options.columns[Ce].type=="hidden"||!xe.cols[Ce].colElement.style||xe.cols[Ce].colElement.style.display=="none"||(xe.records[Fe]&&xe.records[Fe][Ce]&&xe.records[Fe][Ce].element.classList.add("highlight-top"),xe.records[rt]&&xe.records[rt][Ce]&&xe.records[rt][Ce].element.classList.add("highlight-bottom"),xe.headers[Ce].classList.add("selected"));for(let Ce=Fe;Ce<=rt;Ce++)xe.rows[Ce]&&xe.rows[Ce].element.style.display!="none"&&(xe.records[Ce][Y].element.classList.add("highlight-left"),xe.records[Ce][Ae].element.classList.add("highlight-right"),xe.rows[Ce].element.classList.add("selected"));xe.selectedContainer=[Y,Fe,Ae,rt],Ne==0&&(d.A.call(xe,"onfocus",xe),l()),d.A.call(xe,"onselection",xe,Y,Fe,Ae,rt,oe),v.call(xe)},g=function(G){const se=this;if(!se.selectedCell)return[];const ge=[];for(let ue=Math.min(se.selectedCell[0],se.selectedCell[2]);ue<=Math.max(se.selectedCell[0],se.selectedCell[2]);ue++)G&&se.headers[ue].style.display=="none"||ge.push(ue);return ge},f=function(){const G=this;G.selectedCell&&G.updateSelectionFromCoords(G.selectedCell[0],G.selectedCell[1],G.selectedCell[2],G.selectedCell[3])},c=function(){const G=this;for(let se=0;se<G.selection.length;se++)G.selection[se].classList.remove("selection"),G.selection[se].classList.remove("selection-left"),G.selection[se].classList.remove("selection-right"),G.selection[se].classList.remove("selection-top"),G.selection[se].classList.remove("selection-bottom");G.selection=[]},w=function(G){return(G=""+G).length==1&&(G="0"+G),G},L=function(G,se){const ge=this,ue=ge.getData(!0,!1),oe=ge.selectedContainer,xe=parseInt(G.getAttribute("data-x")),ke=parseInt(G.getAttribute("data-y")),Re=parseInt(se.getAttribute("data-x")),Se=parseInt(se.getAttribute("data-y")),$e=[];let Y,Ae,Fe=!1;oe[0]==xe?(Y=ke<oe[1]?ke-oe[1]:1,Ae=0):(Ae=xe<oe[0]?xe-oe[0]:1,Y=0);let rt=0,Ne=0;for(let Ie=ke;Ie<=Se;Ie++)if(!ge.rows[Ie]||ge.rows[Ie].element.style.display!="none"){ue[Ne]==null&&(Ne=0),rt=0,oe[0]!=xe&&(Ae=xe<oe[0]?xe-oe[0]:1);for(let Be=xe;Be<=Re;Be++){if(ge.records[Ie][Be]&&!ge.records[Ie][Be].element.classList.contains("readonly")&&ge.records[Ie][Be].element.style.display!="none"&&Fe==0){if(!ge.selection.length&&ge.options.data[Ie][Be]!=""){Fe=!0;continue}(ue[Ne]==null||ue[Ne][rt]==null)&&(rt=0);let Pe=ue[Ne][rt];if(Pe&&!ue[1]&&ge.parent.config.autoIncrement!=0)if(!ge.options.columns||!ge.options.columns[Be]||ge.options.columns[Be].type&&ge.options.columns[Be].type!="text"&&ge.options.columns[Be].type!="number"){if(ge.options.columns&&ge.options.columns[Be]&&ge.options.columns[Be].type=="calendar"){const ze=new Date(Pe);ze.setDate(ze.getDate()+Y),Pe=ze.getFullYear()+"-"+w(parseInt(ze.getMonth()+1))+"-"+w(ze.getDate())+" 00:00:00"}}else if((""+Pe).substr(0,1)=="="){const ze=Pe.match(/([A-Z]+[0-9]+)/g);if(ze){const Ze=[];for(let et=0;et<ze.length;et++){const it=(0,m.vu)(ze[et],1);it[0]+=Ae,it[1]+=Y,it[1]<0&&(it[1]=0);const dt=(0,m.t3)([it[0],it[1]]);dt!=ze[et]&&(Ze[ze[et]]=dt)}Ze&&(Pe=(0,R.yB)(Pe,Ze))}}else Pe==Number(Pe)&&(Pe=Number(Pe)+Y);$e.push(R.k9.call(ge,Be,Ie,Pe)),R.xF.call(ge,Be,Ie,$e)}rt++,oe[0]!=xe&&Ae++}Ne++,Y++}W.Dh.call(ge,{action:"setValue",records:$e,selection:ge.selectedCell}),R.am.call(ge);const Ce=$e.map(function(Ie){return{x:Ie.x,y:Ie.y,value:Ie.value,oldValue:Ie.oldValue}});d.A.call(ge,"onafterchanges",ge,Ce)},S=function(G){let se,ge,ue=0;if(!G||G.length===0)return ue;for(se=0;se<G.length;se++)ge=G.charCodeAt(se),ue=(ue<<5)-ue+ge,ue|=0;return ue},k=function(G,se,ge){const ue=this;if(G==1){if(ue.selectedCell&&(se>=ue.selectedCell[1]&&se<=ue.selectedCell[3]||ge>=ue.selectedCell[1]&&ge<=ue.selectedCell[3]))return void ue.resetSelection()}else if(ue.selectedCell&&(se>=ue.selectedCell[0]&&se<=ue.selectedCell[2]||ge>=ue.selectedCell[0]&&ge<=ue.selectedCell[2]))return void ue.resetSelection()},_=function(G){const se=this;if(!se.selectedCell)return[];const ge=[];for(let ue=Math.min(se.selectedCell[1],se.selectedCell[3]);ue<=Math.max(se.selectedCell[1],se.selectedCell[3]);ue++)G&&se.rows[ue].element.style.display=="none"||ge.push(ue);return ge},M=function(){const G=this;G.selectedCell||(G.selectedCell=[]),G.selectedCell[0]=0,G.selectedCell[1]=0,G.selectedCell[2]=G.headers.length-1,G.selectedCell[3]=G.records.length-1,G.updateSelectionFromCoords(G.selectedCell[0],G.selectedCell[1],G.selectedCell[2],G.selectedCell[3])},B=function(){const G=this;return G.selectedCell?[Math.min(G.selectedCell[0],G.selectedCell[2]),Math.min(G.selectedCell[1],G.selectedCell[3]),Math.max(G.selectedCell[0],G.selectedCell[2]),Math.max(G.selectedCell[1],G.selectedCell[3])]:null},z=function(G){const se=this,ge=B.call(se);if(!ge)return[];const ue=[];for(let oe=ge[1];oe<=ge[3];oe++)for(let xe=ge[0];xe<=ge[2];xe++)G?ue.push((0,N.getCellNameFromCoords)(xe,oe)):ue.push(se.records[oe][xe]);return ue},q=function(){const G=this,se=B.call(G);if(!se)return"";const ge=(0,N.getCellNameFromCoords)(se[0],se[1]),ue=(0,N.getCellNameFromCoords)(se[2],se[3]);return ge===ue?G.options.worksheetName+"!"+ge:G.options.worksheetName+"!"+ge+":"+ue},ce=function(G,se){const ge=B.call(this);return G>=ge[0]&&G<=ge[2]&&se>=ge[1]&&se<=ge[3]},me=function(){const G=B.call(this);return G?[G]:[]}},689:function(n,h,o){o.d(h,{Hh:function(){return C},t3:function(){return W},vu:function(){return N}});var d=o(978);const C=function(R,m,a){if(m<=R.length)return R.slice(0,m).concat(a).concat(R.slice(m));const v=R.slice(0,R.length);for(;m>v.length;)v.push(void 0);return v.concat(a)},N=function(R,m){const a=/^[a-zA-Z]+/.exec(R);if(a){let v=0;for(let A=0;A<a[0].length;A++)v+=parseInt(a[0].charCodeAt(A)-64)*Math.pow(26,a[0].length-1-A);v--,v<0&&(v=0);let I=parseInt(/[0-9]+$/.exec(R));I>0&&I--,R=m==1?[v,I]:v+"-"+I}return R},W=function(R){return Array.isArray(R)||(R=R.split("-")),(0,d.getColumnName)(parseInt(R[0]))+(parseInt(R[1])+1)}},805:function(n,h){const o=function(N){const W=this,R=[];for(let m=0;m<N.length;m++){const a=N[m].x,v=N[m].y,I=W.options.columns[a].name?W.options.columns[a].name:a;R[v]||(R[v]={row:v,data:{}}),R[v].data[I]=N[m].value}return R.filter(function(m){return m!=null})},d=function(N,W){const R=this,m=C.call(R.parent,"onbeforesave",R.parent,R,W);if(m)W=m;else if(m===!1)return!1;jSuites.ajax({url:N,method:"POST",dataType:"json",data:{data:JSON.stringify(W)},success:function(a){C.call(R,"onsave",R.parent,R,W)}})},C=function(N){const W=this;let R=null,m=W.parent?W.parent:W;if(!m.ignoreEvents&&(typeof m.config.onevent=="function"&&(R=m.config.onevent.apply(this,arguments)),typeof m.config[N]=="function"&&(R=m.config[N].apply(this,Array.prototype.slice.call(arguments,1))),typeof m.plugins=="object")){const a=Object.keys(m.plugins);for(let v=0;v<a.length;v++){const I=a[v],A=m.plugins[I];typeof A.onevent=="function"&&(R=A.onevent.apply(this,arguments))}}if(N=="onafterchanges"){const a=arguments;if(typeof m.plugins=="object"&&Object.entries(m.plugins).forEach(function([,v]){typeof v.persistence=="function"&&v.persistence(W,"setValue",{data:a[2]})}),W.options.persistence){const v=W.options.persistence==1?W.options.url:W.options.persistence,I=o.call(W,arguments[2]);d.call(W,v,I)}}return R};h.A=C},829:function(n,h,o){o.d(h,{F8:function(){return W},N$:function(){return N},dr:function(){return R}});var d=o(530),C=o(657);const N=function(m){const a=this;if(a.options.filters){m=parseInt(m),a.resetSelection();let v=[];if(a.options.columns[m].type=="checkbox")v.push({id:"true",name:"True"}),v.push({id:"false",name:"False"});else{const l=[];let s=!1;for(let f=0;f<a.options.data.length;f++){const c=a.options.data[f][m],w=a.records[f][m].element.innerHTML;c&&w?l[c]=w:s=!0}const g=Object.keys(l);v=[];for(let f=0;f<g.length;f++)v.push({id:g[f],name:l[g[f]]});s&&v.push({value:"",id:"",name:"(Blanks)"})}const I=document.createElement("div");a.filter.children[m+1].innerHTML="",a.filter.children[m+1].appendChild(I),a.filter.children[m+1].style.paddingLeft="0px",a.filter.children[m+1].style.paddingRight="0px",a.filter.children[m+1].style.overflow="initial";const A={data:v,multiple:!0,autocomplete:!0,opened:!0,value:a.filters[m]!==void 0?a.filters[m]:null,width:"100%",position:a.options.tableOverflow==1||a.parent.config.fullscreen==1,onclose:function(l){R.call(a),a.filters[m]=l.dropdown.getValue(!0),a.filter.children[m+1].innerHTML=l.dropdown.getText(),a.filter.children[m+1].style.paddingLeft="",a.filter.children[m+1].style.paddingRight="",a.filter.children[m+1].style.overflow="",W.call(a,m),C.G9.call(a)}};jSuites.dropdown(I,A)}else console.log("Jspreadsheet: filters not enabled.")},W=function(m){const a=this;if(!m)for(let A=0;A<a.filter.children.length;A++)a.filters[A]&&(m=A);const v=function(A,l,s){for(let g=0;g<A.length;g++){const f=""+a.options.data[s][l],c=""+a.records[s][l].element.innerHTML;if(A[g]==f||A[g]==c)return!0}return!1},I=a.filters[m];a.results=[];for(let A=0;A<a.options.data.length;A++)v(I,m,A)&&a.results.push(A);a.results.length||(a.results=null),d.hG.call(a)},R=function(){const m=this;if(m.options.filters)for(let a=0;a<m.filter.children.length;a++)m.filter.children[a].innerHTML="&nbsp;",m.filters[a]=null;m.results=null,d.hG.call(m)}},910:function(n,h,o){o.d(h,{D0:function(){return a},FU:function(){return I},Lt:function(){return m},VP:function(){return l},Zp:function(){return A},fd:function(){return v}});var d=o(689),C=o(530),N=o(911),W=o(805),R=o(657);const m=function(s,g){const f=this,c=[];if(f.options.mergeCells){const w=Object.keys(f.options.mergeCells);for(let L=0;L<w.length;L++){const S=(0,d.vu)(w[L],!0),k=f.options.mergeCells[w[L]][0],_=S[0],M=S[0]+(k>1?k-1:0);g==null?_<=s&&M>=s&&c.push(w[L]):g?_<s&&M>=s&&c.push(w[L]):_<=s&&M>s&&c.push(w[L])}}return c},a=function(s,g){const f=this,c=[];if(f.options.mergeCells){const w=Object.keys(f.options.mergeCells);for(let L=0;L<w.length;L++){const S=(0,d.vu)(w[L],!0),k=f.options.mergeCells[w[L]][1],_=S[1],M=S[1]+(k>1?k-1:0);g==null?_<=s&&M>=s&&c.push(w[L]):g?_<s&&M>=s&&c.push(w[L]):_<=s&&M>s&&c.push(w[L])}}return c},v=function(s){const g=this;let f={};if(s)f=g.options.mergeCells&&g.options.mergeCells[s]?[g.options.mergeCells[s][0],g.options.mergeCells[s][1]]:null;else if(g.options.mergeCells){g.options.mergeCells;const c=Object.keys(g.options.mergeCells);for(let w=0;w<c.length;w++)f[c[w]]=[g.options.mergeCells[c[w]][0],g.options.mergeCells[c[w]][1]]}return f},I=function(s,g,f,c){const w=this;let L=!1;if(s){if(typeof s!="string")return null}else{if(!w.highlighted.length)return alert(jSuites.translate("No cells selected")),null;{const k=parseInt(w.highlighted[0].getAttribute("data-x")),_=parseInt(w.highlighted[0].getAttribute("data-y")),M=parseInt(w.highlighted[w.highlighted.length-1].getAttribute("data-x")),B=parseInt(w.highlighted[w.highlighted.length-1].getAttribute("data-y"));s=(0,d.t3)([k,_]),g=M-k+1,f=B-_+1}}const S=(0,d.vu)(s,!0);if(w.options.mergeCells&&w.options.mergeCells[s])w.records[S[1]][S[0]].element.getAttribute("data-merged")&&(L="Cell already merged");else if((!g||g<2)&&(!f||f<2))L="Invalid merged properties";else for(let k=S[1];k<S[1]+f;k++)for(let _=S[0];_<S[0]+g;_++)(0,d.t3)([_,k]),w.records[k][_].element.getAttribute("data-merged")&&(L="There is a conflict with another merged cell");if(L)alert(jSuites.translate(L));else{g>1?w.records[S[1]][S[0]].element.setAttribute("colspan",g):g=1,f>1?w.records[S[1]][S[0]].element.setAttribute("rowspan",f):f=1,w.options.mergeCells||(w.options.mergeCells={}),w.options.mergeCells[s]=[g,f,[]],w.records[S[1]][S[0]].element.setAttribute("data-merged","true"),w.records[S[1]][S[0]].element.style.overflow="hidden";const k=[];for(let _=S[1];_<S[1]+f;_++)for(let M=S[0];M<S[0]+g;M++)S[0]==M&&S[1]==_||(k.push(w.options.data[_][M]),C.k9.call(w,M,_,"",!0),w.options.mergeCells[s][2].push(w.records[_][M].element),w.records[_][M].element.style.display="none",w.records[_][M].element=w.records[S[1]][S[0]].element);R.c6.call(w,w.records[S[1]][S[0]].element),c||(N.Dh.call(w,{action:"setMerge",column:s,colspan:g,rowspan:f,data:k}),W.A.call(w,"onmerge",w,{[s]:[g,f]}))}},A=function(s,g,f){const c=this;if(c.options.mergeCells&&c.options.mergeCells[s]){const w={[s]:c.options.mergeCells[s]},L=(0,d.vu)(s,!0);c.records[L[1]][L[0]].element.removeAttribute("colspan"),c.records[L[1]][L[0]].element.removeAttribute("rowspan"),c.records[L[1]][L[0]].element.removeAttribute("data-merged");const S=c.options.mergeCells[s];let k,_,M=0;for(k=0;k<S[1];k++)for(_=0;_<S[0];_++)(k>0||_>0)&&(c.records[L[1]+k][L[0]+_].element=S[2][M],c.records[L[1]+k][L[0]+_].element.style.display="",g&&g[M]&&C.k9.call(c,L[0]+_,L[1]+k,g[M]),M++);R.c6.call(c,c.records[L[1]][L[0]].element,c.records[L[1]+k-1][L[0]+_-1].element),f||delete c.options.mergeCells[s],W.A.call(c,"onunmerge",c,s,w)}},l=function(s){const g=this;if(g.options.mergeCells){g.options.mergeCells;const f=Object.keys(g.options.mergeCells);for(let c=0;c<f.length;c++)A.call(g,f[c],null,s)}}},911:function(n,h,o){o.d(h,{Dh:function(){return a},ZS:function(){return l},tN:function(){return A}});var d=o(805),C=o(689),N=o(530),W=o(910),R=o(94),m=o(657);const a=function(s){const g=this;if(g.ignoreHistory!=1){const f=++g.historyIndex;g.history=g.history=g.history.slice(0,f+1),g.history[f]=s}},v=function(s,g){const f=this,c=g.insertBefore?+g.rowNumber:g.rowNumber+1;if(f.options.search==1&&f.results&&f.results.length!=f.rows.length&&f.resetSearch(),s==1){const w=g.numOfRows;for(let L=c;L<w+c;L++)f.rows[L].element.parentNode.removeChild(f.rows[L].element);f.records.splice(c,w),f.options.data.splice(c,w),f.rows.splice(c,w),m.at.call(f,1,c,w+c-1)}else{const w=g.rowRecords.map(k=>[...k]);f.records=(0,C.Hh)(f.records,c,w);const L=g.rowData.map(k=>[...k]);f.options.data=(0,C.Hh)(f.options.data,c,L),f.rows=(0,C.Hh)(f.rows,c,g.rowNode);let S=0;for(let k=c;k<g.numOfRows+c;k++)f.tbody.insertBefore(g.rowNode[S].element,f.tbody.children[k]),S++}for(let w=c;w<f.rows.length;w++)f.rows[w].y=w;for(let w=c;w<f.records.length;w++)for(let L=0;L<f.records[w].length;L++)f.records[w][L].y=w;f.options.pagination>0&&f.page(f.pageNumber),N.o8.call(f)},I=function(s,g){const f=this,c=g.insertBefore?g.columnNumber:g.columnNumber+1;if(s==1){const w=g.numOfColumns;f.options.columns.splice(c,w);for(let L=c;L<w+c;L++)f.headers[L].parentNode.removeChild(f.headers[L]),f.cols[L].colElement.parentNode.removeChild(f.cols[L].colElement);f.headers.splice(c,w),f.cols.splice(c,w);for(let L=0;L<g.data.length;L++){for(let S=c;S<w+c;S++)f.records[L][S].element.parentNode.removeChild(f.records[L][S].element);f.records[L].splice(c,w),f.options.data[L].splice(c,w)}if(f.options.footers)for(let L=0;L<f.options.footers.length;L++)f.options.footers[L].splice(c,w)}else{f.options.columns=(0,C.Hh)(f.options.columns,c,g.columns),f.headers=(0,C.Hh)(f.headers,c,g.headers),f.cols=(0,C.Hh)(f.cols,c,g.cols);let w=0;for(let L=c;L<g.numOfColumns+c;L++)f.headerContainer.insertBefore(g.headers[w],f.headerContainer.children[L+1]),f.colgroupContainer.insertBefore(g.cols[w].colElement,f.colgroupContainer.children[L+1]),w++;for(let L=0;L<g.data.length;L++){f.options.data[L]=(0,C.Hh)(f.options.data[L],c,g.data[L]),f.records[L]=(0,C.Hh)(f.records[L],c,g.records[L]);let S=0;for(let k=c;k<g.numOfColumns+c;k++)f.rows[L].element.insertBefore(g.records[L][S].element,f.rows[L].element.children[k+1]),S++}if(f.options.footers)for(let L=0;L<f.options.footers.length;L++)f.options.footers[L]=(0,C.Hh)(f.options.footers[L],c,g.footers[L])}for(let w=c;w<f.cols.length;w++)f.cols[w].x=w;for(let w=0;w<f.records.length;w++)for(let L=c;L<f.records[w].length;L++)f.records[w][L].x=L;if(f.options.nestedHeaders&&f.options.nestedHeaders.length>0&&f.options.nestedHeaders[0]&&f.options.nestedHeaders[0][0])for(let w=0;w<f.options.nestedHeaders.length;w++){let L;L=s==1?parseInt(f.options.nestedHeaders[w][f.options.nestedHeaders[w].length-1].colspan)-g.numOfColumns:parseInt(f.options.nestedHeaders[w][f.options.nestedHeaders[w].length-1].colspan)+g.numOfColumns,f.options.nestedHeaders[w][f.options.nestedHeaders[w].length-1].colspan=L,f.thead.children[w].children[f.thead.children[w].children.length-1].setAttribute("colspan",L)}N.o8.call(f)},A=function(){const s=this,g=!!s.parent.ignoreEvents,f=!!s.ignoreHistory;s.parent.ignoreEvents=!0,s.ignoreHistory=!0;const c=[];let w;if(s.historyIndex>=0){if(w=s.history[s.historyIndex--],w.action=="insertRow")v.call(s,1,w);else if(w.action=="deleteRow")v.call(s,0,w);else if(w.action=="insertColumn")I.call(s,1,w);else if(w.action=="deleteColumn")I.call(s,0,w);else if(w.action=="moveRow")s.moveRow(w.newValue,w.oldValue);else if(w.action=="moveColumn")s.moveColumn(w.newValue,w.oldValue);else if(w.action=="setMerge")s.removeMerge(w.column,w.data);else if(w.action=="setStyle")s.setStyle(w.oldValue,null,null,1);else if(w.action=="setWidth")s.setWidth(w.column,w.oldValue);else if(w.action=="setHeight")s.setHeight(w.row,w.oldValue);else if(w.action=="setHeader")s.setHeader(w.column,w.oldValue);else if(w.action=="setComments")s.setComments(w.oldValue);else if(w.action=="orderBy"){let L=[];for(let S=0;S<w.rows.length;S++)L[w.rows[S]]=S;R.Th.call(s,w.column,w.order?0:1),R.iY.call(s,L)}else if(w.action=="setValue"){for(let L=0;L<w.records.length;L++)c.push({x:w.records[L].x,y:w.records[L].y,value:w.records[L].oldValue}),w.oldStyle&&s.resetStyle(w.oldStyle);s.setValue(c),w.selection&&s.updateSelectionFromCoords(w.selection[0],w.selection[1],w.selection[2],w.selection[3])}}s.parent.ignoreEvents=g,s.ignoreHistory=f,d.A.call(s,"onundo",s,w)},l=function(){const s=this,g=!!s.parent.ignoreEvents,f=!!s.ignoreHistory;let c;if(s.parent.ignoreEvents=!0,s.ignoreHistory=!0,s.historyIndex<s.history.length-1){if(c=s.history[++s.historyIndex],c.action=="insertRow")v.call(s,0,c);else if(c.action=="deleteRow")v.call(s,1,c);else if(c.action=="insertColumn")I.call(s,0,c);else if(c.action=="deleteColumn")I.call(s,1,c);else if(c.action=="moveRow")s.moveRow(c.oldValue,c.newValue);else if(c.action=="moveColumn")s.moveColumn(c.oldValue,c.newValue);else if(c.action=="setMerge")W.FU.call(s,c.column,c.colspan,c.rowspan,1);else if(c.action=="setStyle")s.setStyle(c.newValue,null,null,1);else if(c.action=="setWidth")s.setWidth(c.column,c.newValue);else if(c.action=="setHeight")s.setHeight(c.row,c.newValue);else if(c.action=="setHeader")s.setHeader(c.column,c.newValue);else if(c.action=="setComments")s.setComments(c.newValue);else if(c.action=="orderBy")R.Th.call(s,c.column,c.order),R.iY.call(s,c.rows);else if(c.action=="setValue"){s.setValue(c.records);for(let w=0;w<c.records.length;w++)c.oldStyle&&s.resetStyle(c.newStyle);c.selection&&s.updateSelectionFromCoords(c.selection[0],c.selection[1],c.selection[2],c.selection[3])}}s.parent.ignoreEvents=g,s.ignoreHistory=f,d.A.call(s,"onredo",s,c)}},978:function(n,h,o){o.r(h),o.d(h,{createFromTable:function(){return I},getCaretIndex:function(){return C},getCellNameFromCoords:function(){return R},getColumnName:function(){return W},getCoordsFromCellName:function(){return m},getCoordsFromRange:function(){return a},invert:function(){return N},parseCSV:function(){return v}});var d=o(689);const C=function(A){let l;l=this.config.root?this.config.root:window;let s=0;const g=l.getSelection();if(g&&g.rangeCount!==0){const f=g.getRangeAt(0),c=f.cloneRange();c.selectNodeContents(A),c.setEnd(f.endContainer,f.endOffset),s=c.toString().length}return s},N=function(A){const l=[],s=Object.keys(A);for(let g=0;g<s.length;g++)l[A[s[g]]]=s[g];return l},W=function(A){let l,s=A+1,g="";for(;s>0;)l=(s-1)%26,g=String.fromCharCode(65+l).toString()+g,s=parseInt((s-l)/26);return g},R=function(A,l){return W(parseInt(A))+(parseInt(l)+1)},m=function(A){const l=/^[a-zA-Z]+/.exec(A);if(l){let s=0;for(let f=0;f<l[0].length;f++)s+=parseInt(l[0].charCodeAt(f)-64)*Math.pow(26,l[0].length-1-f);s--,s<0&&(s=0);let g=parseInt(/[0-9]+$/.exec(A))||null;return g>0&&g--,[s,g]}},a=function(A){const[l,s]=A.split(":");return[...m(l),...m(s)]},v=function(A,l){l=l||",",A=A.replace(/\r?\n$|\r$|\n$/g,"");const s=[];let g=!1,f=0,c=0,w=0;for(let L=0;L<A.length;L++){const S=A[L],k=A[L+1];s[c]=s[c]||[],s[c][w]=s[c][w]||"",S=='"'&&g&&k=='"'?(s[c][w]+=S,++L):S!='"'?S!=l||g?S!="\r"||k!=`
`||g?S==`
`&&!g||S=="\r"&&!g?(++c,f=Math.max(f,w),w=0):s[c][w]+=S:(++c,f=Math.max(f,w),w=0,++L):++w:g=!g}return s.forEach((L,S)=>{for(let k=L.length;k<=f;k++)L.push("")}),s},I=function(A,l){if(A.tagName=="TABLE"){l||(l={}),l.columns=[],l.data=[];const s=A.querySelectorAll("colgroup > col");if(s.length)for(let B=0;B<s.length;B++){let z=s[B].style.width;z||(z=s[B].getAttribute("width")),z&&(l.columns[B]||(l.columns[B]={}),l.columns[B].width=z)}const g=function(B,z){let q=B.getBoundingClientRect();const ce=q.width>50?q.width:50;l.columns[z]||(l.columns[z]={}),B.getAttribute("data-celltype")?l.columns[z].type=B.getAttribute("data-celltype"):l.columns[z].type="text",l.columns[z].width=ce+"px",l.columns[z].title=B.innerHTML,B.style.textAlign&&(l.columns[z].align=B.style.textAlign),(q=B.getAttribute("name"))&&(l.columns[z].name=q),(q=B.getAttribute("id"))&&(l.columns[z].id=q),(q=B.getAttribute("data-mask"))&&(l.columns[z].mask=q)},f=[];let c=A.querySelectorAll(":scope > thead > tr");if(c.length){for(let B=0;B<c.length-1;B++){const z=[];for(let q=0;q<c[B].children.length;q++){const ce={title:c[B].children[q].textContent,colspan:c[B].children[q].getAttribute("colspan")||1};z.push(ce)}f.push(z)}c=c[c.length-1].children;for(let B=0;B<c.length;B++)g(c[B],B)}let w=0;const L={},S={},k={},_={};let M=A.querySelectorAll(":scope > tr, :scope > tbody > tr");for(let B=0;B<M.length;B++)if(l.data[w]=[],l.parseTableFirstRowAsHeader!=1||c.length||B!=0){for(let z=0;z<M[B].children.length;z++){let q=M[B].children[z].getAttribute("data-formula");q?q.substr(0,1)!="="&&(q="="+q):q=M[B].children[z].innerHTML,l.data[w].push(q);const ce=(0,d.t3)([z,B]),me=M[B].children[z].getAttribute("class");me&&(_[ce]=me);const G=parseInt(M[B].children[z].getAttribute("colspan"))||0,se=parseInt(M[B].children[z].getAttribute("rowspan"))||0;(G||se)&&(L[ce]=[G||1,se||1]),M[B].children[z].style&&M[B].children[z].style.display=="none"&&(M[B].children[z].style.display="");const ge=M[B].children[z].getAttribute("style");ge&&(k[ce]=ge),M[B].children[z].classList.contains("styleBold")&&(k[ce]?k[ce]+="; font-weight:bold;":k[ce]="font-weight:bold;")}M[B].style&&M[B].style.height&&(S[B]={height:M[B].style.height}),w++}else for(let z=0;z<M[B].children.length;z++)g(M[B].children[z],z);if(Object.keys(f).length>0&&(l.nestedHeaders=f),Object.keys(k).length>0&&(l.style=k),Object.keys(L).length>0&&(l.mergeCells=L),Object.keys(S).length>0&&(l.rows=S),Object.keys(_).length>0&&(l.classes=_),M=A.querySelectorAll("tfoot tr"),M.length){const B=[];for(let z=0;z<M.length;z++){let q=[];for(let ce=0;ce<M[z].children.length;ce++)q.push(M[z].children[ce].textContent);B.push(q)}Object.keys(B).length>0&&(l.footers=B)}if(l.parseTableAutoCellType==1){const B=[];for(let z=0;z<l.columns.length;z++){let q=!0,ce=!0;B[z]=[];for(let G=0;G<l.data.length;G++){const se=l.data[G][z];B[z][se]||(B[z][se]=0),B[z][se]++,se.length>25&&(q=!1),se.length==10&&se.substr(4,1)=="-"&&se.substr(7,1)=="-"||(ce=!1)}const me=Object.keys(B[z]).length;ce?l.columns[z].type="calendar":q==1&&me>1&&me<=parseInt(.1*l.data.length)&&(l.columns[z].type="dropdown",l.columns[z].source=Object.keys(B[z]))}}return l}console.log("Element is not a table")}}},__webpack_module_cache__={};function __webpack_require__(n){var h=__webpack_module_cache__[n];if(h!==void 0)return h.exports;var o=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n](o,o.exports,__webpack_require__),o.exports}__webpack_require__.d=function(n,h){for(var o in h)__webpack_require__.o(h,o)&&!__webpack_require__.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:h[o]})},__webpack_require__.o=function(n,h){return Object.prototype.hasOwnProperty.call(n,h)},__webpack_require__.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var __webpack_exports__={};__webpack_require__.d(__webpack_exports__,{default:function(){return src}});const lib={jspreadsheet:{}};var libraryBase=lib,dispatch=__webpack_require__(805),internal=__webpack_require__(530),utils_history=__webpack_require__(911),helpers=__webpack_require__(978);const openEditor=function(n,h,o){const d=this,C=n.getAttribute("data-y"),N=n.getAttribute("data-x");dispatch.A.call(d,"oneditionstart",d,n,parseInt(N),parseInt(C)),N>0&&(d.records[C][N-1].element.style.overflow="hidden");const W=function(R){const m=n.getBoundingClientRect(),a=document.createElement(R);return a.style.width=m.width+"px",a.style.height=m.height-2+"px",a.style.minHeight=m.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(a),a};if(n.classList.contains("readonly")!=1){if(d.edition=[d.records[C][N].element,d.records[C][N].element.innerHTML,N,C],d.options.columns&&d.options.columns[N]&&typeof d.options.columns[N].type=="object")d.options.columns[N].type.openEditor(n,d.options.data[C][N],parseInt(N),parseInt(C),d,d.options.columns[N],o),dispatch.A.call(d,"oncreateeditor",d,n,parseInt(N),parseInt(C),null,d.options.columns[N]);else if(!(d.options.columns&&d.options.columns[N]&&d.options.columns[N].type=="hidden"))if(d.options.columns&&d.options.columns[N]&&(d.options.columns[N].type=="checkbox"||d.options.columns[N].type=="radio")){const R=!n.children[0].checked;d.setValue(n,R),d.edition=null}else if(d.options.columns&&d.options.columns[N]&&d.options.columns[N].type=="dropdown"){let R,m=d.options.data[C][N];d.options.columns[N].multiple&&!Array.isArray(m)&&(m=m.split(";")),R=typeof d.options.columns[N].filter=="function"?d.options.columns[N].filter(d.element,n,N,C,d.options.columns[N].source):d.options.columns[N].source;const a=[];if(R)for(let A=0;A<R.length;A++)a.push(R[A]);const v=W("div");dispatch.A.call(d,"oncreateeditor",d,n,parseInt(N),parseInt(C),null,d.options.columns[N]);const I={data:a,multiple:!!d.options.columns[N].multiple,autocomplete:!!d.options.columns[N].autocomplete,opened:!0,value:m,width:"100%",height:v.style.minHeight,position:d.options.tableOverflow==1||d.parent.config.fullscreen==1,onclose:function(){closeEditor.call(d,n,!0)}};d.options.columns[N].options&&d.options.columns[N].options.type&&(I.type=d.options.columns[N].options.type),jSuites.dropdown(v,I)}else if(d.options.columns&&d.options.columns[N]&&(d.options.columns[N].type=="calendar"||d.options.columns[N].type=="color")){const R=d.options.data[C][N],m=W("input");dispatch.A.call(d,"oncreateeditor",d,n,parseInt(N),parseInt(C),null,d.options.columns[N]),m.value=R;const a=d.options.columns[N].options?{...d.options.columns[N].options}:{};if(d.options.tableOverflow!=1&&d.parent.config.fullscreen!=1||(a.position=!0),a.value=d.options.data[C][N],a.opened=!0,a.onclose=function(v,I){closeEditor.call(d,n,!0)},d.options.columns[N].type=="color"){jSuites.color(m,a);const v=n.getBoundingClientRect();a.position&&(m.nextSibling.children[1].style.top=v.top+v.height+"px",m.nextSibling.children[1].style.left=v.left+"px")}else a.format||(a.format="YYYY-MM-DD"),jSuites.calendar(m,a);m.focus()}else if(d.options.columns&&d.options.columns[N]&&d.options.columns[N].type=="html"){const R=d.options.data[C][N],m=W("div");dispatch.A.call(d,"oncreateeditor",d,n,parseInt(N),parseInt(C),null,d.options.columns[N]),m.style.position="relative";const a=document.createElement("div");a.classList.add("jss_richtext"),m.appendChild(a),jSuites.editor(a,{focus:!0,value:R});const v=n.getBoundingClientRect(),I=a.getBoundingClientRect();window.innerHeight<v.bottom+I.height?a.style.top=v.bottom-(I.height+2)+"px":a.style.top=v.top+"px",window.innerWidth<v.left+I.width?a.style.left=v.right-(I.width+2)+"px":a.style.left=v.left+"px"}else if(d.options.columns&&d.options.columns[N]&&d.options.columns[N].type=="image"){const R=n.children[0],m=W("div");dispatch.A.call(d,"oncreateeditor",d,n,parseInt(N),parseInt(C),null,d.options.columns[N]),m.style.position="relative";const a=document.createElement("div");a.classList.add("jclose"),R&&R.src&&a.appendChild(R),m.appendChild(a),jSuites.image(a,d.options.columns[N]);const v=n.getBoundingClientRect(),I=a.getBoundingClientRect();window.innerHeight<v.bottom+I.height?a.style.top=v.top-(I.height+2)+"px":a.style.top=v.top+"px",a.style.left=v.left+"px"}else{const R=h==1?"":d.options.data[C][N];let m;m=d.options.columns&&d.options.columns[N]&&d.options.columns[N].wordWrap==0||!(d.options.wordWrap==1||d.options.columns&&d.options.columns[N]&&d.options.columns[N].wordWrap==1)?W("input"):W("textarea"),setTimeout(()=>{const v=n.querySelector("input, textarea");if(v){const I=d.element;I._cellRefHandler&&(I.removeEventListener("mousedown",I._cellRefHandler,!0),I.removeEventListener("mousemove",I._cellRefHandlerMouseMove,!0),I.removeEventListener("mouseup",I._cellRefHandlerMouseUp,!0),I._cellRefHandler=null,I._cellRefHandlerMouseMove=null,I._cellRefHandlerMouseUp=null);let A=null,l=null,s=null,g=null;I._cellRefHandler=function(f){const c=f.target.closest("[data-x][data-y]");c&&n.classList.contains("editor")&&(f.stopImmediatePropagation(),f.preventDefault(),A=(0,helpers.getCellNameFromCoords)(c.getAttribute("data-x"),c.getAttribute("data-y")),c.getAttribute("data-x"),c.getAttribute("data-y"),l=v.value,s=v.selectionStart,g=v.selectionEnd,v.value=l.slice(0,s)+A+l.slice(g),v.selectionStart=v.selectionEnd=s+A.length,v.focus())},I._cellRefHandlerMouseMove=function(f){if(A&&n.classList.contains("editor")&&f.buttons===1){const c=f.target.closest("[data-x][data-y]");if(c){const w=(0,helpers.getCellNameFromCoords)(c.getAttribute("data-x"),c.getAttribute("data-y"));let L=A;w!==A&&(L=A+":"+w),v.value=l.slice(0,s)+L+l.slice(g),v.selectionStart=v.selectionEnd=s+L.length,v.focus()}}},I._cellRefHandlerMouseUp=function(f){if(A&&n.classList.contains("editor")){const c=f.target.closest("[data-x][data-y]");let w=A;c&&(w=(0,helpers.getCellNameFromCoords)(c.getAttribute("data-x"),c.getAttribute("data-y")));let L=A;w!==A&&(L=A+":"+w),v.value=l.slice(0,s)+L+l.slice(g),v.selectionStart=v.selectionEnd=s+L.length,v.focus(),A=null,l=null,s=null,g=null}},I.addEventListener("mousedown",I._cellRefHandler,!0),I.addEventListener("mousemove",I._cellRefHandlerMouseMove,!0),I.addEventListener("mouseup",I._cellRefHandlerMouseUp,!0)}},0),dispatch.A.call(d,"oncreateeditor",d,n,parseInt(N),parseInt(C),null,d.options.columns[N]),m.focus(),m.addEventListener("keydown",function(v){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(v.key)){v.preventDefault(),closeEditor.call(d,n,!0);let I=parseInt(N),A=parseInt(C);if(v.key==="ArrowUp"&&A--,v.key==="ArrowDown"&&A++,v.key==="ArrowLeft"&&I--,v.key==="ArrowRight"&&I++,d.records[A]&&d.records[A][I]){const l=d.records[A][I].element;l&&!l.classList.contains("readonly")&&openEditor.call(d,l,!1)}}}),m.value=R;const a=d.options.columns&&d.options.columns[N];if(!(0,internal.dw)(R)&&a){const v=(0,internal.rS)(a);if(v){if(!a.disabledMaskOnEdition)if(a.mask){const I=a.mask.split(";");m.setAttribute("data-mask",I[0])}else a.locale&&m.setAttribute("data-locale",a.locale);v.input=m,m.mask=v,jSuites.mask.render(R,v,!1)}}m.onblur=function(){closeEditor.call(d,n,!0)},m.scrollLeft=m.scrollWidth}}},closeEditor=function(n,h){const o=this,d=parseInt(n.getAttribute("data-x")),C=parseInt(n.getAttribute("data-y"));let N;if(h==1){if(o.options.columns&&o.options.columns[d]&&typeof o.options.columns[d].type=="object")N=o.options.columns[d].type.closeEditor(n,h,parseInt(d),parseInt(C),o,o.options.columns[d]);else if(!(o.options.columns&&o.options.columns[d]&&(o.options.columns[d].type=="checkbox"||o.options.columns[d].type=="radio"||o.options.columns[d].type=="hidden")))if(o.options.columns&&o.options.columns[d]&&o.options.columns[d].type=="dropdown")N=n.children[0].dropdown.close(!0);else if(o.options.columns&&o.options.columns[d]&&o.options.columns[d].type=="calendar")N=n.children[0].calendar.close(!0);else if(o.options.columns&&o.options.columns[d]&&o.options.columns[d].type=="color")N=n.children[0].color.close(!0);else if(o.options.columns&&o.options.columns[d]&&o.options.columns[d].type=="html")N=n.children[0].children[0].editor.getData();else if(o.options.columns&&o.options.columns[d]&&o.options.columns[d].type=="image"){const W=n.children[0].children[0].children[0];N=W&&W.tagName=="IMG"?W.src:""}else if(o.options.columns&&o.options.columns[d]&&o.options.columns[d].type=="numeric")N=n.children[0].value,(""+N).substr(0,1)!="="&&N==""&&(N=o.options.columns[d].allowEmpty?"":0),n.children[0].onblur=null;else{N=n.children[0].value,n.children[0].onblur=null;const W=o.options.columns&&o.options.columns[d];if(W){const R=(0,internal.rS)(W);if(R&&N!==""&&!(0,internal.dw)(N)&&typeof N!="number"){const m=jSuites.mask.extract(N,R,!0);m&&m.value!==""&&(N=m.value)}}}o.options.data[C][d]==N?n.innerHTML=o.edition[1]:o.setValue(n,N)}else o.options.columns&&o.options.columns[d]&&typeof o.options.columns[d].type=="object"?o.options.columns[d].type.closeEditor(n,h,parseInt(d),parseInt(C),o,o.options.columns[d]):o.options.columns&&o.options.columns[d]&&o.options.columns[d].type=="dropdown"?n.children[0].dropdown.close(!0):o.options.columns&&o.options.columns[d]&&o.options.columns[d].type=="calendar"?n.children[0].calendar.close(!0):o.options.columns&&o.options.columns[d]&&o.options.columns[d].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=o.edition&&o.edition[1]?o.edition[1]:"";dispatch.A.call(o,"oneditionend",o,n,d,C,N,h),n.classList.remove("editor"),o.edition=null},setCheckRadioValue=function(){const n=this,h=[],o=Object.keys(n.highlighted);for(let d=0;d<o.length;d++){const C=n.highlighted[d].element.getAttribute("data-x"),N=n.highlighted[d].element.getAttribute("data-y");n.options.columns[C].type!="checkbox"&&n.options.columns[C].type!="radio"||h.push(internal.k9.call(n,C,N,!n.options.data[N][C]))}if(h.length){utils_history.Dh.call(n,{action:"setValue",records:h,selection:n.selectedCell});const d=h.map(function(C){return{x:C.x,y:C.y,value:C.value,oldValue:C.oldValue}});dispatch.A.call(n,"onafterchanges",n,d)}};var lazyLoading=__webpack_require__(497);const upGet=function(n,h){const o=this;n=parseInt(n);for(let d=(h=parseInt(h))-1;d>=0;d--)if(o.records[d][n].element.style.display!="none"&&o.rows[d].element.style.display!="none"){if(o.records[d][n].element.getAttribute("data-merged")&&o.records[d][n].element==o.records[h][n].element)continue;h=d;break}return h},upVisible=function(n,h){const o=this;let d,C;if(n==0?(d=parseInt(o.selectedCell[0]),C=parseInt(o.selectedCell[1])):(d=parseInt(o.selectedCell[2]),C=parseInt(o.selectedCell[3])),h==0){for(let N=0;N<C;N++)if(o.records[N][d].element.style.display!="none"&&o.rows[N].element.style.display!="none"){C=N;break}}else C=upGet.call(o,d,C);n==0?(o.selectedCell[0]=d,o.selectedCell[1]=C):(o.selectedCell[2]=d,o.selectedCell[3]=C)},up=function(n,h){const o=this;if(n?o.selectedCell[3]>0&&upVisible.call(o,1,h?0:1):(o.selectedCell[1]>0&&upVisible.call(o,0,h?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),o.options.lazyLoading==1)if(o.selectedCell[1]==0||o.selectedCell[3]==0)lazyLoading.wu.call(o,0),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]);else if(lazyLoading.AG.call(o))o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]);else{const d=parseInt(o.tbody.firstChild.getAttribute("data-y"));o.selectedCell[1]-d<30&&(lazyLoading.G_.call(o),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]))}else if(o.options.pagination>0){const d=o.whichPage(o.selectedCell[3]);d!=o.pageNumber&&o.page(d)}internal.Rs.call(o,1)},rightGet=function(n,h){const o=this;n=parseInt(n),h=parseInt(h);for(let d=n+1;d<o.headers.length;d++)if(o.records[h][d].element.style.display!="none"){if(o.records[h][d].element.getAttribute("data-merged")&&o.records[h][d].element==o.records[h][n].element)continue;n=d;break}return n},rightVisible=function(n,h){const o=this;let d,C;if(n==0?(d=parseInt(o.selectedCell[0]),C=parseInt(o.selectedCell[1])):(d=parseInt(o.selectedCell[2]),C=parseInt(o.selectedCell[3])),h==0){for(let N=o.headers.length-1;N>d;N--)if(o.records[C][N].element.style.display!="none"){d=N;break}}else d=rightGet.call(o,d,C);n==0?(o.selectedCell[0]=d,o.selectedCell[1]=C):(o.selectedCell[2]=d,o.selectedCell[3]=C)},right=function(n,h){const o=this;n?o.selectedCell[2]<o.headers.length-1&&rightVisible.call(o,1,h?0:1):(o.selectedCell[0]<o.headers.length-1&&rightVisible.call(o,0,h?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),internal.Rs.call(o,2)},downGet=function(n,h){const o=this;n=parseInt(n);for(let d=(h=parseInt(h))+1;d<o.rows.length;d++)if(o.records[d][n].element.style.display!="none"&&o.rows[d].element.style.display!="none"){if(o.records[d][n].element.getAttribute("data-merged")&&o.records[d][n].element==o.records[h][n].element)continue;h=d;break}return h},downVisible=function(n,h){const o=this;let d,C;if(n==0?(d=parseInt(o.selectedCell[0]),C=parseInt(o.selectedCell[1])):(d=parseInt(o.selectedCell[2]),C=parseInt(o.selectedCell[3])),h==0){for(let N=o.rows.length-1;N>C;N--)if(o.records[N][d].element.style.display!="none"&&o.rows[N].element.style.display!="none"){C=N;break}}else C=downGet.call(o,d,C);n==0?(o.selectedCell[0]=d,o.selectedCell[1]=C):(o.selectedCell[2]=d,o.selectedCell[3]=C)},down=function(n,h){const o=this;if(n?o.selectedCell[3]<o.records.length-1&&downVisible.call(o,1,h?0:1):(o.selectedCell[1]<o.records.length-1&&downVisible.call(o,0,h?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),o.options.lazyLoading==1)o.selectedCell[1]==o.records.length-1||o.selectedCell[3]==o.records.length-1?(lazyLoading.wu.call(o,-1),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3])):lazyLoading.AG.call(o)?o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]):parseInt(o.tbody.lastChild.getAttribute("data-y"))-o.selectedCell[3]<30&&(lazyLoading.p6.call(o),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]));else if(o.options.pagination>0){const d=o.whichPage(o.selectedCell[3]);d!=o.pageNumber&&o.page(d)}internal.Rs.call(o,3)},leftGet=function(n,h){const o=this;n=parseInt(n),h=parseInt(h);for(let d=n-1;d>=0;d--)if(o.records[h][d].element.style.display!="none"){if(o.records[h][d].element.getAttribute("data-merged")&&o.records[h][d].element==o.records[h][n].element)continue;n=d;break}return n},leftVisible=function(n,h){const o=this;let d,C;if(n==0?(d=parseInt(o.selectedCell[0]),C=parseInt(o.selectedCell[1])):(d=parseInt(o.selectedCell[2]),C=parseInt(o.selectedCell[3])),h==0){for(let N=0;N<d;N++)if(o.records[C][N].element.style.display!="none"){d=N;break}}else d=leftGet.call(o,d,C);n==0?(o.selectedCell[0]=d,o.selectedCell[1]=C):(o.selectedCell[2]=d,o.selectedCell[3]=C)},left=function(n,h){const o=this;n?o.selectedCell[2]>0&&leftVisible.call(o,1,h?0:1):(o.selectedCell[0]>0&&leftVisible.call(o,0,h?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),internal.Rs.call(o,0)},first=function(n,h){const o=this;if(n?h?o.selectedCell[3]=0:leftVisible.call(o,1,0):(h?o.selectedCell[1]=0:leftVisible.call(o,0,0),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.options.lazyLoading!=1||o.selectedCell[1]!=0&&o.selectedCell[3]!=0){if(o.options.pagination>0){const d=o.whichPage(o.selectedCell[3]);d!=o.pageNumber&&o.page(d)}}else lazyLoading.wu.call(o,0);o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),internal.Rs.call(o,1)},last=function(n,h){const o=this;if(n?h?o.selectedCell[3]=o.records.length-1:rightVisible.call(o,1,0):(h?o.selectedCell[1]=o.records.length-1:rightVisible.call(o,0,0),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.options.lazyLoading!=1||o.selectedCell[1]!=o.records.length-1&&o.selectedCell[3]!=o.records.length-1){if(o.options.pagination>0){const d=o.whichPage(o.selectedCell[3]);d!=o.pageNumber&&o.page(d)}}else lazyLoading.wu.call(o,-1);o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),internal.Rs.call(o,3)};var merges=__webpack_require__(910),selection=__webpack_require__(657),internalHelpers=__webpack_require__(689);const copy=function(n,h,o,d,C,N,W){const R=this;h||(h="	");const m=new RegExp(h,"ig"),a=[];let v=[],I=[];const A=[],l=[],s=R.options.data[0].length,g=R.options.data.length;let f="",c=!1,w="",L="",S=0,k=0,_=0;for(let z=0;z<g;z++)for(let q=0;q<s;q++)n&&!R.records[z][q].element.classList.contains("highlight")||_<=z&&(_=z);if(C&&(R.parent.config.includeHeadersOnDownload==1||d)){if(R.options.nestedHeaders&&R.options.nestedHeaders.length>0){f=R.options.nestedHeaders;for(let z=0;z<f.length;z++){const q=[];for(let ce=0;ce<f[z].length;ce++){const me=parseInt(f[z][ce].colspan);q.push(f[z][ce].title);for(let G=0;G<me-1;G++)q.push("")}L+=q.join(h)+`\r
`}}c=!0}R.style=[];for(let z=0;z<g;z++){v=[],I=[];for(let q=0;q<s;q++)if(!n||R.records[z][q].element.classList.contains("highlight")){c==1&&a.push(R.headers[q].textContent);let ce,me=R.options.data[z][q];me.match&&(me.match(m)||me.match(/,/g)||me.match(/\n/)||me.match(/"/))&&(me=me.replace(new RegExp('"',"g"),'""'),me='"'+me+'"'),v.push(me),R.options.columns&&R.options.columns[q]&&(R.options.columns[q].type=="checkbox"||R.options.columns[q].type=="radio")?ce=me:(ce=R.records[z][q].element.innerHTML,ce.match&&(ce.match(m)||ce.match(/,/g)||ce.match(/\n/)||ce.match(/"/))&&(ce=ce.replace(new RegExp('"',"g"),'""'),ce='"'+ce+'"')),I.push(ce),f=R.records[z][q].element.getAttribute("style"),f=f.replace("display: none;",""),R.style.push(f||"")}v.length&&(c&&(S=v.length,A.push(a.join(h))),A.push(v.join(h))),I.length&&(k++,c&&(l.push(a.join(h)),c=!1),l.push(I.join(h)))}s==S&&g==k&&(w=L);const M=w+A.join(`\r
`);let B=w+l.join(`\r
`);if(!o){const z=[Math.min(R.selectedCell[0],R.selectedCell[2]),Math.min(R.selectedCell[1],R.selectedCell[3]),Math.max(R.selectedCell[0],R.selectedCell[2]),Math.max(R.selectedCell[1],R.selectedCell[3])],q=dispatch.A.call(R,"oncopy",R,z,B,N);if(q)B=q;else if(q===!1)return!1;R.textarea.value=B,R.textarea.select(),document.execCommand("copy")}if(R.data=W==1?B:M,R.hashString=selection.tW.call(R,R.data),!o&&(selection.kA.call(R),R.highlighted))for(let z=0;z<R.highlighted.length;z++)R.highlighted[z].element.classList.add("copying"),R.highlighted[z].element.classList.contains("highlight-left")&&R.highlighted[z].element.classList.add("copying-left"),R.highlighted[z].element.classList.contains("highlight-right")&&R.highlighted[z].element.classList.add("copying-right"),R.highlighted[z].element.classList.contains("highlight-top")&&R.highlighted[z].element.classList.add("copying-top"),R.highlighted[z].element.classList.contains("highlight-bottom")&&R.highlighted[z].element.classList.add("copying-bottom");return R.data},paste=function(n,h,o){const d=this,C=(0,selection.tW)(o);let N=C==d.hashString?d.style:null;C==d.hashString&&(o=d.data),o=(0,helpers.parseCSV)(o,"	");const W=d.selectedCell[2]-n+1,R=d.selectedCell[3]-h+1,m=o[0].length;if(W>1&Number.isInteger(W/m)){const I=W/m;if(N){const l=[];for(let s=0;s<N.length;s+=m){const g=N.slice(s,s+m);for(let f=0;f<I;f++)l.push(...g)}N=l}o=o.map(function(l,s){return Array.apply(null,{length:I*l.length}).map(function(f,c){return l[c%l.length]})})}const a=o.length;if(R>1&Number.isInteger(R/a)){const I=R/a;if(N){const l=[];for(let s=0;s<I;s++)l.push(...N);N=l}o=Array.apply(null,{length:I*a}).map(function(l,s){return o[s%a]})}const v=dispatch.A.call(d,"onbeforepaste",d,o.map(function(I){return I.map(function(A){return{value:A}})}),n,h);if(v===!1)return!1;if(v&&(o=v),n!=null&&h!=null&&o){let I=0,A=0;const l=[],s={},g={};let f=0,c=parseInt(n),w=parseInt(h),L=null;const S=d.headers.slice(c).filter(me=>me.style.display==="none").length,k=c+S+o[0].length,_=d.headers.length;k>_&&(d.skipUpdateTableReferences=!0,d.insertColumn(k-_));const M=d.rows.slice(w).filter(me=>me.element.style.display==="none").length,B=w+M+o.length,z=d.rows.length;for(B>z&&(d.skipUpdateTableReferences=!0,d.insertRow(B-z)),d.skipUpdateTableReferences&&(d.skipUpdateTableReferences=!1,internal.o8.call(d));L=o[A];){for(I=0,c=parseInt(n);L[I]!=null;){let me=L[I];d.options.columns&&d.options.columns[I]&&d.options.columns[I].type=="calendar"&&(me=jSuites.calendar.extractDateFromString(me,d.options.columns[I].options&&d.options.columns[I].options.format||"YYYY-MM-DD"));const G=internal.k9.call(d,c,w,me);if(l.push(G),internal.xF.call(d,c,w,l),N&&N[f]){const se=(0,internalHelpers.t3)([c,w]);s[se]=N[f],g[se]=d.getStyle(se),d.records[w][c].element.setAttribute("style",N[f]),f++}if(I++,L[I]!=null){if(c>=d.headers.length-1){if(d.options.allowInsertColumn==0)break;d.insertColumn()}c=rightGet.call(d,c,w)}}if(A++,o[A]){if(w>=d.rows.length-1){if(d.options.allowInsertRow==0)break;d.insertRow()}w=downGet.call(d,n,w)}}selection.AH.call(d,n,h,c,w),utils_history.Dh.call(d,{action:"setValue",records:l,selection:d.selectedCell,newStyle:s,oldStyle:g}),internal.am.call(d);const q=[];for(let me=0;me<o.length;me++)for(let G=0;G<o[me].length;G++)q.push({x:G+n,y:me+h,value:o[me][G]});dispatch.A.call(d,"onpaste",d,q);const ce=l.map(function(me){return{x:me.x,y:me.y,value:me.value,oldValue:me.oldValue}});dispatch.A.call(d,"onafterchanges",d,ce)}(0,selection.kA)()};var filter=__webpack_require__(829),footer=__webpack_require__(160);const getNumberOfColumns=function(){const n=this;let h=n.options.columns&&n.options.columns.length||0;if(n.options.data&&n.options.data[0]!==void 0){const o=Object.keys(n.options.data[0]);o.length>h&&(h=o.length)}return n.options.minDimensions&&n.options.minDimensions[0]>h&&(h=n.options.minDimensions[0]),h},createCellHeader=function(n){const h=this,o=h.options.columns&&h.options.columns[n]&&h.options.columns[n].width||h.options.defaultColWidth||100,d=h.options.columns&&h.options.columns[n]&&h.options.columns[n].align||h.options.defaultColAlign||"center";h.headers[n]=document.createElement("td"),h.headers[n].textContent=h.options.columns&&h.options.columns[n]&&h.options.columns[n].title||(0,helpers.getColumnName)(n),h.headers[n].setAttribute("data-x",n),h.headers[n].style.textAlign=d,h.options.columns&&h.options.columns[n]&&h.options.columns[n].title&&h.headers[n].setAttribute("title",h.headers[n].innerText),h.options.columns&&h.options.columns[n]&&h.options.columns[n].id&&h.headers[n].setAttribute("id",h.options.columns[n].id);const C=document.createElement("col");C.setAttribute("width",o),h.cols[n]={colElement:C,x:n},h.options.columns&&h.options.columns[n]&&h.options.columns[n].type=="hidden"&&(h.headers[n].style.display="none",C.style.display="none")},insertColumn=function(n,h,o,d){const C=this;if(C.options.allowInsertColumn!=0){let N,W=[];Array.isArray(n)?(N=1,n&&(W=n)):N=typeof n=="number"?n:1,o=!!o;const R=Math.max(C.options.columns.length,...C.options.data.map(function(c){return c.length}))-1;(h==null||h>=parseInt(R)||h<0)&&(h=R),d||(d=[]);for(let c=0;c<N;c++)d[c]||(d[c]={});const m=[];if(Array.isArray(n)){const c=[];for(let L=0;L<C.options.data.length;L++)c.push(L<n.length?n[L]:"");const w={column:h+(o?0:1),options:Object.assign({},d[0]),data:c};m.push(w)}else for(let c=0;c<n;c++){const w={column:h+c+(o?0:1),options:Object.assign({},d[c])};m.push(w)}if(dispatch.A.call(C,"onbeforeinsertcolumn",C,m)===!1)return!1;if(C.options.mergeCells&&Object.keys(C.options.mergeCells).length>0&&merges.Lt.call(C,h,o).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;C.destroyMerge()}const a=o?h:h+1;C.options.columns=(0,internalHelpers.Hh)(C.options.columns,a,d);const v=C.headers.splice(a),I=C.cols.splice(a),A=[],l=[],s=[],g=[],f=[];for(let c=a;c<N+a;c++)createCellHeader.call(C,c),C.headerContainer.insertBefore(C.headers[c],C.headerContainer.children[c+1]),C.colgroupContainer.insertBefore(C.cols[c].colElement,C.colgroupContainer.children[c+1]),A.push(C.headers[c]),l.push(C.cols[c]);if(C.options.footers)for(let c=0;c<C.options.footers.length;c++){f[c]=[];for(let w=0;w<N;w++)f[c].push("");C.options.footers[c].splice(a,0,f[c])}for(let c=0;c<C.options.data.length;c++){const w=C.options.data[c].splice(a),L=C.records[c].splice(a);g[c]=[],s[c]=[];for(let S=a;S<N+a;S++){const k=W[c]?W[c]:"";C.options.data[c][S]=k;const _=internal.P9.call(C,S,c,C.options.data[c][S]);C.records[c][S]={element:_,y:c},C.rows[c]&&C.rows[c].element.insertBefore(_,C.rows[c].element.children[S+1]),C.options.columns&&C.options.columns[S]&&typeof C.options.columns[S].render=="function"&&C.options.columns[S].render(_,k,parseInt(S),parseInt(c),C,C.options.columns[S]),g[c].push(k),s[c].push({element:_,x:S,y:c})}Array.prototype.push.apply(C.options.data[c],w),Array.prototype.push.apply(C.records[c],L)}Array.prototype.push.apply(C.headers,v),Array.prototype.push.apply(C.cols,I);for(let c=a;c<C.cols.length;c++)C.cols[c].x=c;for(let c=0;c<C.records.length;c++)for(let w=0;w<C.records[c].length;w++)C.records[c][w].x=w;if(C.options.nestedHeaders&&C.options.nestedHeaders.length>0&&C.options.nestedHeaders[0]&&C.options.nestedHeaders[0][0])for(let c=0;c<C.options.nestedHeaders.length;c++){const w=parseInt(C.options.nestedHeaders[c][C.options.nestedHeaders[c].length-1].colspan)+N;C.options.nestedHeaders[c][C.options.nestedHeaders[c].length-1].colspan=w,C.thead.children[c].children[C.thead.children[c].children.length-1].setAttribute("colspan",w);let L=C.thead.children[c].children[C.thead.children[c].children.length-1].getAttribute("data-column");L=L.split(",");for(let S=a;S<N+a;S++)L.push(S);C.thead.children[c].children[C.thead.children[c].children.length-1].setAttribute("data-column",L)}utils_history.Dh.call(C,{action:"insertColumn",columnNumber:h,numOfColumns:N,insertBefore:o,columns:d,headers:A,cols:l,records:s,footers:f,data:g}),internal.o8.call(C),dispatch.A.call(C,"oninsertcolumn",C,m)}},moveColumn=function(n,h){const o=this;if(o.options.mergeCells&&Object.keys(o.options.mergeCells).length>0){let N;if(N=n>h?1:0,merges.Lt.call(o,n).length||merges.Lt.call(o,h,N).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;o.destroyMerge()}}if((n=parseInt(n))>(h=parseInt(h))){o.headerContainer.insertBefore(o.headers[n],o.headers[h]),o.colgroupContainer.insertBefore(o.cols[n].colElement,o.cols[h].colElement);for(let N=0;N<o.rows.length;N++)o.rows[N].element.insertBefore(o.records[N][n].element,o.records[N][h].element)}else{o.headerContainer.insertBefore(o.headers[n],o.headers[h].nextSibling),o.colgroupContainer.insertBefore(o.cols[n].colElement,o.cols[h].colElement.nextSibling);for(let N=0;N<o.rows.length;N++)o.rows[N].element.insertBefore(o.records[N][n].element,o.records[N][h].element.nextSibling)}o.options.columns.splice(h,0,o.options.columns.splice(n,1)[0]),o.headers.splice(h,0,o.headers.splice(n,1)[0]),o.cols.splice(h,0,o.cols.splice(n,1)[0]);const d=Math.min(n,h),C=Math.max(n,h);for(let N=0;N<o.rows.length;N++)o.options.data[N].splice(h,0,o.options.data[N].splice(n,1)[0]),o.records[N].splice(h,0,o.records[N].splice(n,1)[0]);for(let N=d;N<=C;N++)o.cols[N].x=N;for(let N=0;N<o.records.length;N++)for(let W=d;W<=C;W++)o.records[N][W].x=W;if(o.options.footers)for(let N=0;N<o.options.footers.length;N++)o.options.footers[N].splice(h,0,o.options.footers[N].splice(n,1)[0]);utils_history.Dh.call(o,{action:"moveColumn",oldValue:n,newValue:h}),internal.o8.call(o),dispatch.A.call(o,"onmovecolumn",o,n,h,1)},deleteColumn=function(n,h){const o=this;if(o.options.allowDeleteColumn!=0)if(o.headers.length>1){if(n==null){const N=o.getSelectedColumns(!0);N.length?(n=parseInt(N[0]),h=parseInt(N.length)):(n=o.headers.length-1,h=1)}const d=o.options.data[0].length-1;(n==null||n>d||n<0)&&(n=d),h||(h=1),h>o.options.data[0].length-n&&(h=o.options.data[0].length-n);const C=[];for(let N=0;N<h;N++)C.push(N+n);if(dispatch.A.call(o,"onbeforedeletecolumn",o,C)===!1)return!1;if(parseInt(n)>-1){let N=!1;if(o.options.mergeCells&&Object.keys(o.options.mergeCells).length>0)for(let A=n;A<n+h;A++)merges.Lt.call(o,A,null).length&&(N=!0);if(N){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;o.destroyMerge()}const W=o.options.columns?o.options.columns.splice(n,h):void 0;for(let A=n;A<n+h;A++)o.cols[A].colElement.className="",o.headers[A].className="",o.cols[A].colElement.parentNode.removeChild(o.cols[A].colElement),o.headers[A].parentNode.removeChild(o.headers[A]);const R=o.headers.splice(n,h),m=o.cols.splice(n,h),a=[],v=[],I=[];for(let A=0;A<o.options.data.length;A++)for(let l=n;l<n+h;l++)o.records[A][l].element.className="",o.records[A][l].element.parentNode.removeChild(o.records[A][l].element);for(let A=0;A<o.options.data.length;A++)v[A]=o.options.data[A].splice(n,h),a[A]=o.records[A].splice(n,h);for(let A=n;A<o.cols.length;A++)o.cols[A].x=A;for(let A=0;A<o.records.length;A++)for(let l=n;l<o.records[A].length;l++)o.records[A][l].x=l;if(o.options.footers)for(let A=0;A<o.options.footers.length;A++)I[A]=o.options.footers[A].splice(n,h);if(selection.at.call(o,0,n,n+h-1),o.options.nestedHeaders&&o.options.nestedHeaders.length>0&&o.options.nestedHeaders[0]&&o.options.nestedHeaders[0][0])for(let A=0;A<o.options.nestedHeaders.length;A++){const l=parseInt(o.options.nestedHeaders[A][o.options.nestedHeaders[A].length-1].colspan)-h;o.options.nestedHeaders[A][o.options.nestedHeaders[A].length-1].colspan=l,o.thead.children[A].children[o.thead.children[A].children.length-1].setAttribute("colspan",l)}utils_history.Dh.call(o,{action:"deleteColumn",columnNumber:n,numOfColumns:h,insertBefore:1,columns:W,headers:R,cols:m,records:a,footers:I,data:v}),internal.o8.call(o),dispatch.A.call(o,"ondeletecolumn",o,C)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},getWidth=function(n){const h=this;let o;if(n===void 0){o=[];for(let d=0;d<h.headers.length;d++)o.push(h.options.columns&&h.options.columns[d]&&h.options.columns[d].width||h.options.defaultColWidth||100)}else o=parseInt(h.cols[n].colElement.getAttribute("width"));return o},setWidth=function(n,h,o){const d=this;if(h){if(Array.isArray(n)){o||(o=[]);for(let C=0;C<n.length;C++){o[C]||(o[C]=parseInt(d.cols[n[C]].colElement.getAttribute("width")));const N=Array.isArray(h)&&h[C]?h[C]:h;d.cols[n[C]].colElement.setAttribute("width",N),d.options.columns||(d.options.columns=[]),d.options.columns[n[C]]||(d.options.columns[n[C]]={}),d.options.columns[n[C]].width=N}}else o||(o=parseInt(d.cols[n].colElement.getAttribute("width"))),d.cols[n].colElement.setAttribute("width",h),d.options.columns||(d.options.columns=[]),d.options.columns[n]||(d.options.columns[n]={}),d.options.columns[n].width=h;utils_history.Dh.call(d,{action:"setWidth",column:n,oldValue:o,newValue:h}),dispatch.A.call(d,"onresizecolumn",d,n,h,o),selection.Aq.call(d)}},showColumn=function(n){const h=this;Array.isArray(n)||(n=[n]);for(let o=0;o<n.length;o++){const d=n[o];h.headers[d].style.display="",h.cols[d].colElement.style.display="",h.filter&&h.filter.children.length>d+1&&(h.filter.children[d+1].style.display="");for(let C=0;C<h.options.data.length;C++)h.records[C][d].element.style.display=""}h.options.footers&&footer.e.call(h),h.resetSelection()},hideColumn=function(n){const h=this;Array.isArray(n)||(n=[n]);for(let o=0;o<n.length;o++){const d=n[o];h.headers[d].style.display="none",h.cols[d].colElement.style.display="none",h.filter&&h.filter.children.length>d+1&&(h.filter.children[d+1].style.display="none");for(let C=0;C<h.options.data.length;C++)h.records[C][d].element.style.display="none"}h.options.footers&&footer.e.call(h),h.resetSelection()},getColumnData=function(n,h){const o=this,d=[];for(let C=0;C<o.options.data.length;C++)h?d.push(o.records[C][n].element.innerHTML):d.push(o.options.data[C][n]);return d},setColumnData=function(n,h,o){const d=this;for(let C=0;C<d.rows.length;C++){const N=(0,internalHelpers.t3)([n,C]);h[C]!=null&&d.setValue(N,h[C],o)}},createRow=function(n,h){const o=this;o.records[n]||(o.records[n]=[]),h||(h=o.options.data[n]);const d={element:document.createElement("tr"),y:n};o.rows[n]=d,d.element.setAttribute("data-y",n);let C=null;o.options.defaultRowHeight&&(d.element.style.height=o.options.defaultRowHeight+"px"),o.options.rows&&o.options.rows[n]&&(o.options.rows[n].height&&(d.element.style.height=o.options.rows[n].height),o.options.rows[n].title&&(C=o.options.rows[n].title)),C||(C=parseInt(n+1));const N=document.createElement("td");N.innerHTML=C,N.setAttribute("data-y",n),N.className="jss_row",d.element.appendChild(N);const W=getNumberOfColumns.call(o);for(let R=0;R<W;R++)o.records[n][R]={element:internal.P9.call(this,R,n,h[R]),x:R,y:n},d.element.appendChild(o.records[n][R].element),o.options.columns&&o.options.columns[R]&&typeof o.options.columns[R].render=="function"&&o.options.columns[R].render(o.records[n][R].element,h[R],parseInt(R),parseInt(n),o,o.options.columns[R]);return d},insertRow=function(n,h,o){const d=this;if(d.options.allowInsertRow!=0){let C,N=[];Array.isArray(n)?(C=1,n&&(N=n)):C=n!==void 0?n:1,o=!!o;const W=d.options.data.length-1;(h==null||h>=parseInt(W)||h<0)&&(h=W);const R=[];for(let g=0;g<C;g++){const f=[];for(let c=0;c<d.options.columns.length;c++)f[c]=N[c]?N[c]:"";R.push({row:g+h+(o?0:1),data:f})}if(dispatch.A.call(d,"onbeforeinsertrow",d,R)===!1)return!1;if(d.options.mergeCells&&Object.keys(d.options.mergeCells).length>0&&merges.D0.call(d,h,o).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;d.destroyMerge()}if(d.options.search==1){if(d.results&&d.results.length!=d.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;d.resetSearch()}d.results=null}const m=o?h:h+1,a=d.records.splice(m),v=d.options.data.splice(m),I=d.rows.splice(m),A=[],l=[],s=[];for(let g=m;g<C+m;g++){d.options.data[g]=[];for(let c=0;c<d.options.columns.length;c++)d.options.data[g][c]=N[c]?N[c]:"";const f=createRow.call(d,g,d.options.data[g]);I[0]?Array.prototype.indexOf.call(d.tbody.children,I[0].element)>=0&&d.tbody.insertBefore(f.element,I[0].element):Array.prototype.indexOf.call(d.tbody.children,d.rows[h].element)>=0&&d.tbody.appendChild(f.element),A.push([...d.records[g]]),l.push([...d.options.data[g]]),s.push(f)}Array.prototype.push.apply(d.records,a),Array.prototype.push.apply(d.options.data,v),Array.prototype.push.apply(d.rows,I);for(let g=m;g<d.rows.length;g++)d.rows[g].y=g;for(let g=m;g<d.records.length;g++)for(let f=0;f<d.records[g].length;f++)d.records[g][f].y=g;d.options.pagination>0&&d.page(d.pageNumber),utils_history.Dh.call(d,{action:"insertRow",rowNumber:h,numOfRows:C,insertBefore:o,rowRecords:A,rowData:l,rowNode:s}),internal.o8.call(d),dispatch.A.call(d,"oninsertrow",d,R)}},moveRow=function(n,h,o){const d=this;if(d.options.mergeCells&&Object.keys(d.options.mergeCells).length>0){let W;if(W=n>h?1:0,merges.D0.call(d,n).length||merges.D0.call(d,h,W).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;d.destroyMerge()}}if(d.options.search==1){if(d.results&&d.results.length!=d.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;d.resetSearch()}d.results=null}o||(Array.prototype.indexOf.call(d.tbody.children,d.rows[h].element)>=0?n>h?d.tbody.insertBefore(d.rows[n].element,d.rows[h].element):d.tbody.insertBefore(d.rows[n].element,d.rows[h].element.nextSibling):d.tbody.removeChild(d.rows[n].element)),d.rows.splice(h,0,d.rows.splice(n,1)[0]),d.records.splice(h,0,d.records.splice(n,1)[0]),d.options.data.splice(h,0,d.options.data.splice(n,1)[0]);const C=Math.min(n,h),N=Math.max(n,h);for(let W=C;W<=N;W++)d.rows[W].y=W;for(let W=C;W<=N;W++)for(let R=0;R<d.records[W].length;R++)d.records[W][R].y=W;d.options.pagination>0&&d.tbody.children.length!=d.options.pagination&&d.page(d.pageNumber),utils_history.Dh.call(d,{action:"moveRow",oldValue:n,newValue:h}),internal.o8.call(d),dispatch.A.call(d,"onmoverow",d,parseInt(n),parseInt(h),1)},deleteRow=function(n,h){const o=this;if(o.options.allowDeleteRow!=0)if(o.options.allowDeletingAllRows==1||o.options.data.length>1){if(n==null){const N=selection.R5.call(o);N.length===0?(n=o.options.data.length-1,h=1):(n=N[0],h=N.length)}let d=o.options.data.length-1;(n==null||n>d||n<0)&&(n=d),h||(h=1),n+h>=o.options.data.length&&(h=o.options.data.length-n);const C=[];for(let N=0;N<h;N++)C.push(N+n);if(dispatch.A.call(o,"onbeforedeleterow",o,C)===!1)return!1;if(parseInt(n)>-1){let N=!1;if(o.options.mergeCells&&Object.keys(o.options.mergeCells).length>0)for(let a=n;a<n+h;a++)merges.D0.call(o,a,!1).length&&(N=!0);if(N){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;o.destroyMerge()}if(o.options.search==1){if(o.results&&o.results.length!=o.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;o.resetSearch()}o.results=null}o.options.allowDeletingAllRows!=1&&d+1===h&&(h--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(let a=n;a<n+h;a++)Array.prototype.indexOf.call(o.tbody.children,o.rows[a].element)>=0&&(o.rows[a].element.className="",o.rows[a].element.parentNode.removeChild(o.rows[a].element));const W=o.records.splice(n,h),R=o.options.data.splice(n,h),m=o.rows.splice(n,h);for(let a=n;a<o.rows.length;a++)o.rows[a].y=a;for(let a=n;a<o.records.length;a++)for(let v=0;v<o.records[a].length;v++)o.records[a][v].y=a;o.options.pagination>0&&o.tbody.children.length!=o.options.pagination&&o.page(o.pageNumber),selection.at.call(o,1,n,n+h-1),utils_history.Dh.call(o,{action:"deleteRow",rowNumber:n,numOfRows:h,insertBefore:1,rowRecords:W,rowData:R,rowNode:m}),internal.o8.call(o),dispatch.A.call(o,"ondeleterow",o,C)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},getHeight=function(n){const h=this;let o;if(n===void 0){o=[];for(let d=0;d<h.rows.length;d++){const C=h.rows[d].element.style.height;C&&(o[d]=C)}}else typeof n=="object"&&(n=n.getAttribute("data-y")),o=h.rows[n].element.style.height;return o},setHeight=function(n,h,o){const d=this;h>0&&(o||(o=d.rows[n].element.getAttribute("height"))||(o=d.rows[n].element.getBoundingClientRect().height),h=parseInt(h),d.rows[n].element.style.height=h+"px",d.options.rows||(d.options.rows=[]),d.options.rows[n]||(d.options.rows[n]={}),d.options.rows[n].height=h,utils_history.Dh.call(d,{action:"setHeight",row:n,oldValue:o,newValue:h}),dispatch.A.call(d,"onresizerow",d,n,h,o),selection.Aq.call(d))},showRow=function(n){const h=this;Array.isArray(n)||(n=[n]),n.forEach(function(o){h.rows[o].element.style.display=""})},hideRow=function(n){const h=this;Array.isArray(n)||(n=[n]),n.forEach(function(o){h.rows[o].element.style.display="none"})},getRowData=function(n,h){return h?this.records[n].map(function(o){return o.element.innerHTML}):this.options.data[n]},setRowData=function(n,h,o){const d=this;for(let C=0;C<d.headers.length;C++){const N=(0,internalHelpers.t3)([C,n]);h[C]!=null&&d.setValue(N,h[C],o)}};var version={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license].join(`\r
`)]}};const getElement=function(n){let h=0,o=0;return function d(C){C.className&&(C.classList.contains("jss_container")&&(o=C),C.classList.contains("jss_spreadsheet")&&(o=C.querySelector(":scope > .jtabs-content > .jtabs-selected"))),C.tagName=="THEAD"?h=1:C.tagName=="TBODY"&&(h=2),C.parentNode&&(o||d(C.parentNode))}(n),[o,h]},mouseUpControls=function(n){if(libraryBase.jspreadsheet.current)if(libraryBase.jspreadsheet.current.resizing){if(libraryBase.jspreadsheet.current.resizing.column){const h=parseInt(libraryBase.jspreadsheet.current.cols[libraryBase.jspreadsheet.current.resizing.column].colElement.getAttribute("width")),o=libraryBase.jspreadsheet.current.getSelectedColumns();if(o.length>1){const d=[];for(let C=0;C<o.length;C++)d.push(parseInt(libraryBase.jspreadsheet.current.cols[o[C]].colElement.getAttribute("width")));d[o.indexOf(parseInt(libraryBase.jspreadsheet.current.resizing.column))]=libraryBase.jspreadsheet.current.resizing.width,setWidth.call(libraryBase.jspreadsheet.current,o,h,d)}else setWidth.call(libraryBase.jspreadsheet.current,parseInt(libraryBase.jspreadsheet.current.resizing.column),h,libraryBase.jspreadsheet.current.resizing.width);libraryBase.jspreadsheet.current.headers[libraryBase.jspreadsheet.current.resizing.column].classList.remove("resizing");for(let d=0;d<libraryBase.jspreadsheet.current.records.length;d++)libraryBase.jspreadsheet.current.records[d][libraryBase.jspreadsheet.current.resizing.column]&&libraryBase.jspreadsheet.current.records[d][libraryBase.jspreadsheet.current.resizing.column].element.classList.remove("resizing")}else{libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.children[0].classList.remove("resizing");let h=libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.getAttribute("height");setHeight.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.resizing.row,h,libraryBase.jspreadsheet.current.resizing.height),libraryBase.jspreadsheet.current.resizing.element.classList.remove("resizing")}libraryBase.jspreadsheet.current.resizing=null}else if(libraryBase.jspreadsheet.current.dragging){if(libraryBase.jspreadsheet.current.dragging){if(libraryBase.jspreadsheet.current.dragging.column){const h=n.target.getAttribute("data-x");libraryBase.jspreadsheet.current.headers[libraryBase.jspreadsheet.current.dragging.column].classList.remove("dragging");for(let o=0;o<libraryBase.jspreadsheet.current.rows.length;o++)libraryBase.jspreadsheet.current.records[o][libraryBase.jspreadsheet.current.dragging.column]&&libraryBase.jspreadsheet.current.records[o][libraryBase.jspreadsheet.current.dragging.column].element.classList.remove("dragging");for(let o=0;o<libraryBase.jspreadsheet.current.headers.length;o++)libraryBase.jspreadsheet.current.headers[o].classList.remove("dragging-left"),libraryBase.jspreadsheet.current.headers[o].classList.remove("dragging-right");h&&libraryBase.jspreadsheet.current.dragging.column!=libraryBase.jspreadsheet.current.dragging.destination&&libraryBase.jspreadsheet.current.moveColumn(libraryBase.jspreadsheet.current.dragging.column,libraryBase.jspreadsheet.current.dragging.destination)}else{let h;libraryBase.jspreadsheet.current.dragging.element.nextSibling?(h=parseInt(libraryBase.jspreadsheet.current.dragging.element.nextSibling.getAttribute("data-y")),libraryBase.jspreadsheet.current.dragging.row<h&&(h-=1)):h=parseInt(libraryBase.jspreadsheet.current.dragging.element.previousSibling.getAttribute("data-y")),libraryBase.jspreadsheet.current.dragging.row!=libraryBase.jspreadsheet.current.dragging.destination&&moveRow.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.dragging.row,h,!0),libraryBase.jspreadsheet.current.dragging.element.classList.remove("dragging")}libraryBase.jspreadsheet.current.dragging=null}}else libraryBase.jspreadsheet.current.selectedCorner&&(libraryBase.jspreadsheet.current.selectedCorner=!1,libraryBase.jspreadsheet.current.selection.length>0&&(selection.kF.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selection[0],libraryBase.jspreadsheet.current.selection[libraryBase.jspreadsheet.current.selection.length-1]),selection.gG.call(libraryBase.jspreadsheet.current)));libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null),libraryBase.jspreadsheet.isMouseAction=!1},mouseDownControls=function(n){let h;h=(n=n||window.event).buttons?n.buttons:n.button?n.button:n.which;const o=getElement(n.target);if(o[0]?libraryBase.jspreadsheet.current!=o[0].jssWorksheet&&(libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0),libraryBase.jspreadsheet.current.resetSelection()),libraryBase.jspreadsheet.current=o[0].jssWorksheet):libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0),n.target.classList.contains("jss_object")||(selection.gE.call(libraryBase.jspreadsheet.current,!0),libraryBase.jspreadsheet.current=null)),libraryBase.jspreadsheet.current&&h==1){if(n.target.classList.contains("jss_selectall"))libraryBase.jspreadsheet.current&&selection.Ub.call(libraryBase.jspreadsheet.current);else if(n.target.classList.contains("jss_corner"))libraryBase.jspreadsheet.current.options.editable!=0&&(libraryBase.jspreadsheet.current.selectedCorner=!0);else{if(o[1]==1){const d=n.target.getAttribute("data-x");if(d){const C=n.target.getBoundingClientRect();if(libraryBase.jspreadsheet.current.options.columnResize!=0&&C.width-n.offsetX<6){libraryBase.jspreadsheet.current.resizing={mousePosition:n.pageX,column:d,width:C.width},libraryBase.jspreadsheet.current.headers[d].classList.add("resizing");for(let N=0;N<libraryBase.jspreadsheet.current.records.length;N++)libraryBase.jspreadsheet.current.records[N][d]&&libraryBase.jspreadsheet.current.records[N][d].element.classList.add("resizing")}else if(libraryBase.jspreadsheet.current.options.columnDrag!=0&&C.height-n.offsetY<6)if(merges.Lt.call(libraryBase.jspreadsheet.current,d).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current.dragging={element:n.target,column:d,destination:d},libraryBase.jspreadsheet.current.headers[d].classList.add("dragging");for(let N=0;N<libraryBase.jspreadsheet.current.records.length;N++)libraryBase.jspreadsheet.current.records[N][d]&&libraryBase.jspreadsheet.current.records[N][d].element.classList.add("dragging")}else{let N,W;libraryBase.jspreadsheet.current.selectedHeader&&(n.shiftKey||n.ctrlKey)?(N=libraryBase.jspreadsheet.current.selectedHeader,W=d):(libraryBase.jspreadsheet.current.selectedHeader==d&&libraryBase.jspreadsheet.current.options.allowRenameColumn!=0&&(libraryBase.jspreadsheet.timeControl=setTimeout(function(){libraryBase.jspreadsheet.current.setHeader(d)},800)),libraryBase.jspreadsheet.current.selectedHeader=d,N=d,W=d),selection.AH.call(libraryBase.jspreadsheet.current,N,0,W,libraryBase.jspreadsheet.current.options.data.length-1,n)}}else if(n.target.parentNode.classList.contains("jss_nested")){let C,N;if(n.target.getAttribute("data-column")){const W=n.target.getAttribute("data-column").split(",");C=parseInt(W[0]),N=parseInt(W[W.length-1])}else C=0,N=libraryBase.jspreadsheet.current.options.columns.length-1;selection.AH.call(libraryBase.jspreadsheet.current,C,0,N,libraryBase.jspreadsheet.current.options.data.length-1,n)}}else libraryBase.jspreadsheet.current.selectedHeader=!1;if(o[1]==2){const d=parseInt(n.target.getAttribute("data-y"));if(n.target.classList.contains("jss_row")){const C=n.target.getBoundingClientRect();if(libraryBase.jspreadsheet.current.options.rowResize!=0&&C.height-n.offsetY<6)libraryBase.jspreadsheet.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:d,height:C.height},n.target.parentNode.classList.add("resizing");else if(libraryBase.jspreadsheet.current.options.rowDrag!=0&&C.width-n.offsetX<6)merges.D0.call(libraryBase.jspreadsheet.current,d).length?console.error("Jspreadsheet: This row is part of a merged cell"):libraryBase.jspreadsheet.current.options.search==1&&libraryBase.jspreadsheet.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current.dragging={element:n.target.parentNode,row:d,destination:d},n.target.parentNode.classList.add("dragging"));else{let N,W;libraryBase.jspreadsheet.current.selectedRow!=null&&(n.shiftKey||n.ctrlKey)?(N=libraryBase.jspreadsheet.current.selectedRow,W=d):(libraryBase.jspreadsheet.current.selectedRow=d,N=d,W=d),selection.AH.call(libraryBase.jspreadsheet.current,null,N,null,W,n)}}else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0);else{const C=function(W){const R=W.getAttribute("data-x"),m=W.getAttribute("data-y");return R&&m?[R,m]:W.parentNode?C(W.parentNode):void 0},N=C(n.target);if(N){const W=N[0],R=N[1];libraryBase.jspreadsheet.current.edition&&(libraryBase.jspreadsheet.current.edition[2]==W&&libraryBase.jspreadsheet.current.edition[3]==R||closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0)),libraryBase.jspreadsheet.current.edition||(n.shiftKey?selection.AH.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],W,R,n):selection.AH.call(libraryBase.jspreadsheet.current,W,R,void 0,void 0,n)),libraryBase.jspreadsheet.current.selectedHeader=null,libraryBase.jspreadsheet.current.selectedRow=null}}}else libraryBase.jspreadsheet.current.selectedRow=!1;n.target.classList.contains("jss_page")&&(n.target.textContent=="<"?libraryBase.jspreadsheet.current.page(0):n.target.textContent==">"?libraryBase.jspreadsheet.current.page(n.target.getAttribute("title")-1):libraryBase.jspreadsheet.current.page(n.target.textContent-1))}libraryBase.jspreadsheet.current.edition?libraryBase.jspreadsheet.isMouseAction=!1:libraryBase.jspreadsheet.isMouseAction=!0}else libraryBase.jspreadsheet.isMouseAction=!1},mouseMoveControls=function(n){let h;if(h=(n=n||window.event).buttons?n.buttons:n.button?n.button:n.which,h||(libraryBase.jspreadsheet.isMouseAction=!1),libraryBase.jspreadsheet.current)if(libraryBase.jspreadsheet.isMouseAction==1){if(libraryBase.jspreadsheet.current.resizing)if(libraryBase.jspreadsheet.current.resizing.column){const o=n.pageX-libraryBase.jspreadsheet.current.resizing.mousePosition;if(libraryBase.jspreadsheet.current.resizing.width+o>0){const d=libraryBase.jspreadsheet.current.resizing.width+o;libraryBase.jspreadsheet.current.cols[libraryBase.jspreadsheet.current.resizing.column].colElement.setAttribute("width",d),selection.Aq.call(libraryBase.jspreadsheet.current)}}else{const o=n.pageY-libraryBase.jspreadsheet.current.resizing.mousePosition;if(libraryBase.jspreadsheet.current.resizing.height+o>0){const d=libraryBase.jspreadsheet.current.resizing.height+o;libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.setAttribute("height",d),selection.Aq.call(libraryBase.jspreadsheet.current)}}else if(libraryBase.jspreadsheet.current.dragging)if(libraryBase.jspreadsheet.current.dragging.column){const o=n.target.getAttribute("data-x");if(o)if(merges.Lt.call(libraryBase.jspreadsheet.current,o).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(let d=0;d<libraryBase.jspreadsheet.current.headers.length;d++)libraryBase.jspreadsheet.current.headers[d].classList.remove("dragging-left"),libraryBase.jspreadsheet.current.headers[d].classList.remove("dragging-right");libraryBase.jspreadsheet.current.dragging.column==o?libraryBase.jspreadsheet.current.dragging.destination=parseInt(o):n.target.clientWidth/2>n.offsetX?(libraryBase.jspreadsheet.current.dragging.column<o?libraryBase.jspreadsheet.current.dragging.destination=parseInt(o)-1:libraryBase.jspreadsheet.current.dragging.destination=parseInt(o),libraryBase.jspreadsheet.current.headers[o].classList.add("dragging-left")):(libraryBase.jspreadsheet.current.dragging.column<o?libraryBase.jspreadsheet.current.dragging.destination=parseInt(o):libraryBase.jspreadsheet.current.dragging.destination=parseInt(o)+1,libraryBase.jspreadsheet.current.headers[o].classList.add("dragging-right"))}}else{const o=n.target.getAttribute("data-y");if(o)if(merges.D0.call(libraryBase.jspreadsheet.current,o).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{const d=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;libraryBase.jspreadsheet.current.dragging.element!=d&&(n.target.parentNode.parentNode.insertBefore(libraryBase.jspreadsheet.current.dragging.element,d),libraryBase.jspreadsheet.current.dragging.destination=Array.prototype.indexOf.call(libraryBase.jspreadsheet.current.dragging.element.parentNode.children,libraryBase.jspreadsheet.current.dragging.element))}}}else{const o=n.target.getAttribute("data-x"),d=n.target.getAttribute("data-y"),C=n.target.getBoundingClientRect();libraryBase.jspreadsheet.current.cursor&&(libraryBase.jspreadsheet.current.cursor.style.cursor="",libraryBase.jspreadsheet.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&o&&!d&&C.width-(n.clientX-C.left)<6?(libraryBase.jspreadsheet.current.cursor=n.target,libraryBase.jspreadsheet.current.cursor.style.cursor="col-resize"):n.target&&!o&&d&&C.height-(n.clientY-C.top)<6&&(libraryBase.jspreadsheet.current.cursor=n.target,libraryBase.jspreadsheet.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!o&&d&&C.width-(n.clientX-C.left)<6||n.target&&o&&!d&&C.height-(n.clientY-C.top)<6)&&(libraryBase.jspreadsheet.current.cursor=n.target,libraryBase.jspreadsheet.current.cursor.style.cursor="move"))}},updateCopySelection=function(n,h){const o=this;selection.gG.call(o);const d=o.selectedContainer[0],C=o.selectedContainer[1],N=o.selectedContainer[2],W=o.selectedContainer[3];if(n!=null&&h!=null){let R,m,a,v;n-N>0?(R=parseInt(N)+1,m=parseInt(n)):(R=parseInt(n),m=parseInt(d)-1),h-W>0?(a=parseInt(W)+1,v=parseInt(h)):(a=parseInt(h),v=parseInt(C)-1),m-R<=v-a?(R=parseInt(d),m=parseInt(N)):(a=parseInt(C),v=parseInt(W));for(let I=a;I<=v;I++)for(let A=R;A<=m;A++)o.records[I][A]&&o.rows[I].element.style.display!="none"&&o.records[I][A].element.style.display!="none"&&(o.records[I][A].element.classList.add("selection"),o.records[a][A].element.classList.add("selection-top"),o.records[v][A].element.classList.add("selection-bottom"),o.records[I][R].element.classList.add("selection-left"),o.records[I][m].element.classList.add("selection-right"),o.selection.push(o.records[I][A].element))}},mouseOverControls=function(n){let h;if(h=(n=n||window.event).buttons?n.buttons:n.button?n.button:n.which,h||(libraryBase.jspreadsheet.isMouseAction=!1),libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.isMouseAction==1){const o=getElement(n.target);if(o[0]){if(libraryBase.jspreadsheet.current!=o[0].jssWorksheet&&libraryBase.jspreadsheet.current)return!1;let d=n.target.getAttribute("data-x");const C=n.target.getAttribute("data-y");if(!(libraryBase.jspreadsheet.current.resizing||libraryBase.jspreadsheet.current.dragging)){if(o[1]==1&&libraryBase.jspreadsheet.current.selectedHeader){d=n.target.getAttribute("data-x");const N=libraryBase.jspreadsheet.current.selectedHeader,W=d;selection.AH.call(libraryBase.jspreadsheet.current,N,0,W,libraryBase.jspreadsheet.current.options.data.length-1,n)}if(o[1]==2)if(n.target.classList.contains("jss_row")){if(libraryBase.jspreadsheet.current.selectedRow!=null){const N=libraryBase.jspreadsheet.current.selectedRow,W=C;selection.AH.call(libraryBase.jspreadsheet.current,0,N,libraryBase.jspreadsheet.current.options.data[0].length-1,W,n)}}else libraryBase.jspreadsheet.current.edition||d&&C&&(libraryBase.jspreadsheet.current.selectedCorner?updateCopySelection.call(libraryBase.jspreadsheet.current,d,C):libraryBase.jspreadsheet.current.selectedCell&&selection.AH.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],d,C,n))}}}libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null)},doubleClickControls=function(n){if(libraryBase.jspreadsheet.current)if(n.target.classList.contains("jss_corner")){if(libraryBase.jspreadsheet.current.highlighted.length>0){const h=libraryBase.jspreadsheet.current.highlighted[0].element.getAttribute("data-x"),o=parseInt(libraryBase.jspreadsheet.current.highlighted[libraryBase.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-y"))+1,d=libraryBase.jspreadsheet.current.highlighted[libraryBase.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-x"),C=libraryBase.jspreadsheet.current.records.length-1;selection.kF.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[o][h].element,libraryBase.jspreadsheet.current.records[C][d].element)}}else if(n.target.classList.contains("jss_column_filter")){const h=n.target.getAttribute("data-x");filter.N$.call(libraryBase.jspreadsheet.current,h)}else{const h=getElement(n.target);if(h[1]==1&&libraryBase.jspreadsheet.current.options.columnSorting!=0){const o=n.target.getAttribute("data-x");o&&libraryBase.jspreadsheet.current.orderBy(parseInt(o))}if(h[1]==2&&libraryBase.jspreadsheet.current.options.editable!=0&&!libraryBase.jspreadsheet.current.edition){const o=function(C){if(C.parentNode){const N=C.getAttribute("data-x"),W=C.getAttribute("data-y");return N&&W?C:o(C.parentNode)}},d=o(n.target);d&&d.classList.contains("highlight")&&openEditor.call(libraryBase.jspreadsheet.current,d,void 0,n)}}},pasteControls=function(n){libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.current.selectedCell&&(libraryBase.jspreadsheet.current.edition||libraryBase.jspreadsheet.current.options.editable!=0&&(n&&n.clipboardData?(paste.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&paste.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],window.clipboardData.getData("text"))))},getRole=function(n){if(n.classList.contains("jss_selectall"))return"select-all";if(n.classList.contains("jss_corner"))return"fill-handle";let h=n;for(;!h.classList.contains("jss_spreadsheet");){if(h.classList.contains("jss_row"))return"row";if(h.classList.contains("jss_nested"))return"nested";if(h.classList.contains("jtabs-headers"))return"tabs";if(h.classList.contains("jtoolbar"))return"toolbar";if(h.classList.contains("jss_pagination"))return"pagination";if(h.tagName==="TBODY")return"cell";if(h.tagName==="TFOOT")return getElementIndex(n)===0?"grid":"footer";if(h.tagName==="THEAD")return"header";h=h.parentElement}return"applications"},defaultContextMenu=function(n,h,o,d){const C=[];if(d==="header"&&(n.options.allowInsertColumn!=0&&C.push({title:jSuites.translate("Insert a new column before"),onclick:function(){n.insertColumn(1,parseInt(h),1)}}),n.options.allowInsertColumn!=0&&C.push({title:jSuites.translate("Insert a new column after"),onclick:function(){n.insertColumn(1,parseInt(h),0)}}),n.options.allowDeleteColumn!=0&&C.push({title:jSuites.translate("Delete selected columns"),onclick:function(){n.deleteColumn(n.getSelectedColumns().length?void 0:parseInt(h))}}),n.options.allowRenameColumn!=0&&C.push({title:jSuites.translate("Rename this column"),onclick:function(){const N=n.getHeader(h),W=prompt(jSuites.translate("Column name"),N);n.setHeader(h,W)}}),n.options.columnSorting!=0&&(C.push({type:"line"}),C.push({title:jSuites.translate("Order ascending"),onclick:function(){n.orderBy(h,0)}}),C.push({title:jSuites.translate("Order descending"),onclick:function(){n.orderBy(h,1)}}))),d!=="row"&&d!=="cell"||(n.options.allowInsertRow!=0&&(C.push({title:jSuites.translate("Insert a new row before"),onclick:function(){n.insertRow(1,parseInt(o),1)}}),C.push({title:jSuites.translate("Insert a new row after"),onclick:function(){n.insertRow(1,parseInt(o))}})),n.options.allowDeleteRow!=0&&C.push({title:jSuites.translate("Delete selected rows"),onclick:function(){n.deleteRow(n.getSelectedRows().length?void 0:parseInt(o))}})),d==="cell"&&n.options.allowComments!=0){C.push({type:"line"});const N=n.records[o][h].element.getAttribute("title")||"";C.push({title:jSuites.translate(N?"Edit comments":"Add comments"),onclick:function(){const W=prompt(jSuites.translate("Comments"),N);W&&n.setComments((0,helpers.getCellNameFromCoords)(h,o),W)}}),N&&C.push({title:jSuites.translate("Clear comments"),onclick:function(){n.setComments((0,helpers.getCellNameFromCoords)(h,o),"")}})}return C.length!==0&&C.push({type:"line"}),d!=="header"&&d!=="row"&&d!=="cell"||(C.push({title:jSuites.translate("Copy")+"...",shortcut:"Ctrl + C",onclick:function(){copy.call(n,!0)}}),navigator&&navigator.clipboard&&C.push({title:jSuites.translate("Paste")+"...",shortcut:"Ctrl + V",onclick:function(){n.selectedCell&&navigator.clipboard.readText().then(function(N){N&&paste.call(n,n.selectedCell[0],n.selectedCell[1],N)})}})),n.parent.config.allowExport!=0&&C.push({title:jSuites.translate("Save as")+"...",shortcut:"Ctrl + S",onclick:function(){n.download()}}),n.parent.config.about!=0&&C.push({title:jSuites.translate("About"),onclick:function(){n.parent.config.about===void 0||n.parent.config.about===!0?alert(version.print()):alert(n.parent.config.about)}}),C},getElementIndex=function(n){const h=n.parentElement.children;for(let o=0;o<h.length;o++)if(n===h[o])return o;return-1},contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,libraryBase.jspreadsheet.current){const h=libraryBase.jspreadsheet.current.parent;if(libraryBase.jspreadsheet.current.edition)n.preventDefault();else if(h.contextMenu.contextmenu.close(),libraryBase.jspreadsheet.current){const o=getRole(n.target);let d=null,C=null;if(o==="cell"){let W=n.target;for(;W.tagName!=="TD";)W=W.parentNode;C=W.getAttribute("data-y"),d=W.getAttribute("data-x"),(!libraryBase.jspreadsheet.current.selectedCell||d<parseInt(libraryBase.jspreadsheet.current.selectedCell[0])||d>parseInt(libraryBase.jspreadsheet.current.selectedCell[2])||C<parseInt(libraryBase.jspreadsheet.current.selectedCell[1])||C>parseInt(libraryBase.jspreadsheet.current.selectedCell[3]))&&selection.AH.call(libraryBase.jspreadsheet.current,d,C,d,C,n)}else if(o==="row"||o==="header")o==="row"?C=n.target.getAttribute("data-y"):d=n.target.getAttribute("data-x"),(!libraryBase.jspreadsheet.current.selectedCell||d<parseInt(libraryBase.jspreadsheet.current.selectedCell[0])||d>parseInt(libraryBase.jspreadsheet.current.selectedCell[2])||C<parseInt(libraryBase.jspreadsheet.current.selectedCell[1])||C>parseInt(libraryBase.jspreadsheet.current.selectedCell[3]))&&selection.AH.call(libraryBase.jspreadsheet.current,d,C,d,C,n);else if(o==="nested"){const W=n.target.getAttribute("data-column").split(",");d=getElementIndex(n.target)-1,C=getElementIndex(n.target.parentElement),libraryBase.jspreadsheet.current.selectedCell&&W[0]==parseInt(libraryBase.jspreadsheet.current.selectedCell[0])&&W[W.length-1]==parseInt(libraryBase.jspreadsheet.current.selectedCell[2])&&libraryBase.jspreadsheet.current.selectedCell[1]==null&&libraryBase.jspreadsheet.current.selectedCell[3]==null||selection.AH.call(libraryBase.jspreadsheet.current,W[0],null,W[W.length-1],null,n)}else o==="select-all"?selection.Ub.call(libraryBase.jspreadsheet.current):o==="tabs"?d=getElementIndex(n.target):o==="footer"&&(d=getElementIndex(n.target)-1,C=getElementIndex(n.target.parentElement));let N=defaultContextMenu(libraryBase.jspreadsheet.current,parseInt(d),parseInt(C),o);if(typeof h.config.contextMenu=="function"){const W=h.config.contextMenu(libraryBase.jspreadsheet.current,d,C,n,N,o,d,C);if(W)N=W;else if(W===!1)return}typeof h.plugins=="object"&&Object.entries(h.plugins).forEach(function([,W]){if(typeof W.contextMenu=="function"){const R=W.contextMenu(libraryBase.jspreadsheet.current,d!==null?parseInt(d):null,C!==null?parseInt(C):null,n,N,o,d!==null?parseInt(d):null,C!==null?parseInt(C):null);R&&(N=R)}}),h.contextMenu.contextmenu.open(n,N),n.preventDefault()}}},touchStartControls=function(n){const h=getElement(n.target);if(h[0]?libraryBase.jspreadsheet.current!=h[0].jssWorksheet&&(libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current=h[0].jssWorksheet):libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current=null),libraryBase.jspreadsheet.current&&!libraryBase.jspreadsheet.current.edition){const o=n.target.getAttribute("data-x"),d=n.target.getAttribute("data-y");o&&d&&(selection.AH.call(libraryBase.jspreadsheet.current,o,d,void 0,void 0,n),libraryBase.jspreadsheet.timeControl=setTimeout(function(){libraryBase.jspreadsheet.current.options.columns[o].type=="color"?libraryBase.jspreadsheet.tmpElement=null:libraryBase.jspreadsheet.tmpElement=n.target,openEditor.call(libraryBase.jspreadsheet.current,n.target,!1,n)},500))}},touchEndControls=function(n){libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null,libraryBase.jspreadsheet.tmpElement&&libraryBase.jspreadsheet.tmpElement.children[0].tagName=="INPUT"&&libraryBase.jspreadsheet.tmpElement.children[0].focus(),libraryBase.jspreadsheet.tmpElement=null)},cutControls=function(n){libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition||(copy.call(libraryBase.jspreadsheet.current,!0,void 0,void 0,void 0,void 0,!0),libraryBase.jspreadsheet.current.options.editable!=0&&libraryBase.jspreadsheet.current.setValue(libraryBase.jspreadsheet.current.highlighted.map(function(h){return h.element}),"")))},copyControls=function(n){libraryBase.jspreadsheet.current&&copyControls.enabled&&(libraryBase.jspreadsheet.current.edition||copy.call(libraryBase.jspreadsheet.current,!0))},isMac=function(){return navigator.platform.toUpperCase().indexOf("MAC")>=0},isCtrl=function(n){return isMac()?n.metaKey:n.ctrlKey},keyDownControls=function(n){if(libraryBase.jspreadsheet.current){if(libraryBase.jspreadsheet.current.edition)if(n.which==27)libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type=="calendar")closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0);else if(!(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type=="dropdown"))if((libraryBase.jspreadsheet.current.options.wordWrap==1||libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].wordWrap==1||libraryBase.jspreadsheet.current.options.data[libraryBase.jspreadsheet.current.edition[3]][libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.data[libraryBase.jspreadsheet.current.edition[3]][libraryBase.jspreadsheet.current.edition[2]].length>200)&&n.altKey){const h=libraryBase.jspreadsheet.current.edition[0].children[0];let o=libraryBase.jspreadsheet.current.edition[0].children[0].value;const d=h.selectionStart;o=o.slice(0,d)+`
`+o.slice(d),h.value=o,h.focus(),h.selectionStart=d+1,h.selectionEnd=d+1}else libraryBase.jspreadsheet.current.edition[0].children[0].blur()}else n.which==9&&(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&["calendar","html"].includes(libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type)?closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0):libraryBase.jspreadsheet.current.edition[0].children[0].blur());if(!libraryBase.jspreadsheet.current.edition&&libraryBase.jspreadsheet.current.selectedCell)if(n.which==37)left.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)right.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)up.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)down.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)first.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)last.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46||n.which==8)libraryBase.jspreadsheet.current.options.editable!=0&&(libraryBase.jspreadsheet.current.selectedRow!=null?libraryBase.jspreadsheet.current.options.allowDeleteRow!=0&&confirm(jSuites.translate("Are you sure to delete the selected rows?"))&&libraryBase.jspreadsheet.current.deleteRow():libraryBase.jspreadsheet.current.selectedHeader?libraryBase.jspreadsheet.current.options.allowDeleteColumn!=0&&confirm(jSuites.translate("Are you sure to delete the selected columns?"))&&libraryBase.jspreadsheet.current.deleteColumn():libraryBase.jspreadsheet.current.setValue(libraryBase.jspreadsheet.current.highlighted.map(function(h){return h.element}),""));else if(n.which==13)n.shiftKey?up.call(libraryBase.jspreadsheet.current):(libraryBase.jspreadsheet.current.options.allowInsertRow!=0&&libraryBase.jspreadsheet.current.options.allowManualInsertRow!=0&&libraryBase.jspreadsheet.current.selectedCell[1]==libraryBase.jspreadsheet.current.options.data.length-1&&libraryBase.jspreadsheet.current.insertRow(),down.call(libraryBase.jspreadsheet.current)),n.preventDefault();else if(n.which==9)n.shiftKey?left.call(libraryBase.jspreadsheet.current):(libraryBase.jspreadsheet.current.options.allowInsertColumn!=0&&libraryBase.jspreadsheet.current.options.allowManualInsertColumn!=0&&libraryBase.jspreadsheet.current.selectedCell[0]==libraryBase.jspreadsheet.current.options.data[0].length-1&&libraryBase.jspreadsheet.current.insertColumn(),right.call(libraryBase.jspreadsheet.current)),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(libraryBase.jspreadsheet.current.selectedCell&&libraryBase.jspreadsheet.current.options.editable!=0){const h=libraryBase.jspreadsheet.current.selectedCell[1],o=libraryBase.jspreadsheet.current.selectedCell[0];n.keyCode==32?(n.preventDefault(),libraryBase.jspreadsheet.current.options.columns[o].type=="checkbox"||libraryBase.jspreadsheet.current.options.columns[o].type=="radio"?setCheckRadioValue.call(libraryBase.jspreadsheet.current):openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[h][o].element,!0,n)):n.keyCode==113?openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[h][o].element,!1,n):n.key.length!==1&&n.key!=="Process"||n.altKey||isCtrl(n)||(openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[h][o].element,!0,n),libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[o]&&libraryBase.jspreadsheet.current.options.columns[o].type=="calendar"&&n.preventDefault())}}else n.which==65?(selection.Ub.call(libraryBase.jspreadsheet.current),n.preventDefault()):n.which==83?(libraryBase.jspreadsheet.current.download(),n.preventDefault()):n.which==89?(libraryBase.jspreadsheet.current.redo(),n.preventDefault()):n.which==90?(libraryBase.jspreadsheet.current.undo(),n.preventDefault()):n.which==67?(copy.call(libraryBase.jspreadsheet.current,!0),n.preventDefault()):n.which==88?(libraryBase.jspreadsheet.current.options.editable!=0?cutControls():copyControls(),n.preventDefault()):n.which==86&&pasteControls();else n.target.classList.contains("jss_search")&&(libraryBase.jspreadsheet.timeControl&&clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=setTimeout(function(){libraryBase.jspreadsheet.current.search(n.target.value)},200))}},wheelControls=function(n){const h=this;h.options.lazyLoading==1&&libraryBase.jspreadsheet.timeControlLoading==null&&(libraryBase.jspreadsheet.timeControlLoading=setTimeout(function(){h.content.scrollTop+h.content.clientHeight>=h.content.scrollHeight-10?lazyLoading.p6.call(h)&&(h.content.scrollTop+h.content.clientHeight>h.content.scrollHeight-10&&(h.content.scrollTop=h.content.scrollTop-h.content.clientHeight),selection.Aq.call(h)):h.content.scrollTop<=h.content.clientHeight&&lazyLoading.G_.call(h)&&(h.content.scrollTop<10&&(h.content.scrollTop=h.content.scrollTop+h.content.clientHeight),selection.Aq.call(h)),libraryBase.jspreadsheet.timeControlLoading=null},100))};let scrollLeft=0;const updateFreezePosition=function(){const n=this;scrollLeft=n.content.scrollLeft;let h=0;if(scrollLeft>50)for(let o=0;o<n.options.freezeColumns;o++){if(o>0&&(!n.options.columns||!n.options.columns[o-1]||n.options.columns[o-1].type!=="hidden")){let d;d=n.options.columns&&n.options.columns[o-1]&&n.options.columns[o-1].width!==void 0?parseInt(n.options.columns[o-1].width):n.options.defaultColWidth!==void 0?parseInt(n.options.defaultColWidth):100,h+=parseInt(d)}n.headers[o].classList.add("jss_freezed"),n.headers[o].style.left=h+"px";for(let d=0;d<n.rows.length;d++)if(n.rows[d]&&n.records[d][o]){const C=scrollLeft+(o>0?n.records[d][o-1].element.style.width:0)-51+"px";n.records[d][o].element.classList.add("jss_freezed"),n.records[d][o].element.style.left=C}}else for(let o=0;o<n.options.freezeColumns;o++){n.headers[o].classList.remove("jss_freezed"),n.headers[o].style.left="";for(let d=0;d<n.rows.length;d++)n.records[d][o]&&(n.records[d][o].element.classList.remove("jss_freezed"),n.records[d][o].element.style.left="")}selection.Aq.call(n)},scrollControls=function(n){const h=this;wheelControls.call(h),h.options.freezeColumns>0&&h.content.scrollLeft!=scrollLeft&&updateFreezePosition.call(h),h.options.lazyLoading!=1&&h.options.tableOverflow!=1||h.edition&&n.target.className.substr(0,9)!="jdropdown"&&closeEditor.call(h,h.edition[0],!0)},setEvents=function(n){destroyEvents(n),n.addEventListener("mouseup",mouseUpControls),n.addEventListener("mousedown",mouseDownControls),n.addEventListener("mousemove",mouseMoveControls),n.addEventListener("mouseover",mouseOverControls),n.addEventListener("dblclick",doubleClickControls),n.addEventListener("paste",pasteControls),n.addEventListener("contextmenu",contextMenuControls),n.addEventListener("touchstart",touchStartControls),n.addEventListener("touchend",touchEndControls),n.addEventListener("touchcancel",touchEndControls),n.addEventListener("touchmove",touchEndControls),document.addEventListener("keydown",keyDownControls)},destroyEvents=function(n){n.removeEventListener("mouseup",mouseUpControls),n.removeEventListener("mousedown",mouseDownControls),n.removeEventListener("mousemove",mouseMoveControls),n.removeEventListener("mouseover",mouseOverControls),n.removeEventListener("dblclick",doubleClickControls),n.removeEventListener("paste",pasteControls),n.removeEventListener("contextmenu",contextMenuControls),n.removeEventListener("touchstart",touchStartControls),n.removeEventListener("touchend",touchEndControls),n.removeEventListener("touchcancel",touchEndControls),document.removeEventListener("keydown",keyDownControls)};var toolbar=__webpack_require__(392),pagination=__webpack_require__(167);const setData=function(n){const h=this;if(n&&(h.options.data=n),h.options.data||(h.options.data=[]),h.options.data&&h.options.data[0]&&!Array.isArray(h.options.data[0])){n=[];for(let A=0;A<h.options.data.length;A++){const l=[];for(let s=0;s<h.options.columns.length;s++)l[s]=h.options.data[A][h.options.columns[s].name];n.push(l)}h.options.data=n}let o=0,d=0;const C=h.options.columns&&h.options.columns.length||0,N=h.options.data.length,W=h.options.minDimensions[0],R=h.options.minDimensions[1],m=W>C?W:C,a=R>N?R:N;for(o=0;o<a;o++)for(d=0;d<m;d++)h.options.data[o]==null&&(h.options.data[o]=[]),h.options.data[o][d]==null&&(h.options.data[o][d]="");let v,I;for(h.rows=[],h.results=null,h.records=[],h.history=[],h.historyIndex=-1,h.tbody.innerHTML="",h.options.lazyLoading==1?(v=0,I=h.options.data.length<100?h.options.data.length:100,h.options.pagination&&(h.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):h.options.pagination?(h.pageNumber||(h.pageNumber=0),h.options.pagination,v=h.options.pagination*h.pageNumber,I=h.options.pagination*h.pageNumber+h.options.pagination,h.options.data.length<I&&(I=h.options.data.length)):(v=0,I=h.options.data.length),o=0;o<h.options.data.length;o++){const A=createRow.call(h,o,h.options.data[o]);o>=v&&o<I&&h.tbody.appendChild(A.element)}if(h.options.lazyLoading==1||h.options.pagination&&pagination.IV.call(h),h.options.mergeCells){const A=Object.keys(h.options.mergeCells);for(let l=0;l<A.length;l++){const s=h.options.mergeCells[A[l]];merges.FU.call(h,A[l],s[0],s[1],1)}}internal.am.call(h)},getValue=function(n,h){const o=this;let d,C;if(typeof n!="string")return null;d=(n=(0,internalHelpers.vu)(n,!0))[0],C=n[1];let N=null;return d!=null&&C!=null&&(o.records[C]&&o.records[C][d]&&h?N=o.records[C][d].element.innerHTML:o.options.data[C]&&o.options.data[C][d]!="undefined"&&(N=o.options.data[C][d])),N},getValueFromCoords=function(n,h,o){const d=this;let C=null;return n!=null&&h!=null&&(d.records[h]&&d.records[h][n]&&o?C=d.records[h][n].element.innerHTML:d.options.data[h]&&d.options.data[h][n]!="undefined"&&(C=d.options.data[h][n])),C},setValue=function(n,h,o){const d=this,C=[];if(typeof n=="string"){const W=(0,internalHelpers.vu)(n,!0),R=W[0],m=W[1];C.push(internal.k9.call(d,R,m,h,o)),internal.xF.call(d,R,m,C)}else{let W=null,R=null;if(n&&n.getAttribute&&(W=n.getAttribute("data-x"),R=n.getAttribute("data-y")),W!=null&&R!=null)C.push(internal.k9.call(d,W,R,h,o)),internal.xF.call(d,W,R,C);else{const m=Object.keys(n);if(m.length>0)for(let a=0;a<m.length;a++){let v,I;if(typeof n[a]=="string"){const A=(0,internalHelpers.vu)(n[a],!0);v=A[0],I=A[1]}else n[a].x!=null&&n[a].y!=null?(v=n[a].x,I=n[a].y,n[a].value!=null&&(h=n[a].value)):(v=n[a].getAttribute("data-x"),I=n[a].getAttribute("data-y"));v!=null&&I!=null&&(C.push(internal.k9.call(d,v,I,h,o)),internal.xF.call(d,v,I,C))}}}utils_history.Dh.call(d,{action:"setValue",records:C,selection:d.selectedCell}),internal.am.call(d);const N=C.map(function(W){return{x:W.x,y:W.y,value:W.value,oldValue:W.oldValue}});dispatch.A.call(d,"onafterchanges",d,N)},setValueFromCoords=function(n,h,o,d){const C=this,N=[];N.push(internal.k9.call(C,n,h,o,d)),internal.xF.call(C,n,h,N),utils_history.Dh.call(C,{action:"setValue",records:N,selection:C.selectedCell}),internal.am.call(C);const W=N.map(function(R){return{x:R.x,y:R.y,value:R.value,oldValue:R.oldValue}});dispatch.A.call(C,"onafterchanges",C,W)},getData=function(n,h,o,d){const C=this,N=[];let W=0,R=0;const m=Math.max(...C.options.data.map(function(v){return v.length})),a=C.options.data.length;for(let v=0;v<a;v++){W=0;for(let I=0;I<m;I++)n&&!C.records[v][I].element.classList.contains("highlight")||(N[R]||(N[R]=[]),N[R][W]=h?C.records[v][I].element.innerHTML:C.options.data[v][I],W++);W>0&&R++}return o?N.map(function(v){return v.join(o)}).join(`\r
`)+`\r
`:d?N.map(function(v){const I={};return v.forEach(function(A,l){I[l]=A}),I}):N},getDataFromRange=function(n,h){const o=this,d=(0,helpers.getCoordsFromRange)(n),C=[];for(let N=d[1];N<=d[3];N++){C.push([]);for(let W=d[0];W<=d[2];W++)h?C[C.length-1].push(o.records[N][W].element.innerHTML):C[C.length-1].push(o.options.data[N][W])}return C},search=function(n){const h=this;if(h.options.filters&&filter.dr.call(h),h.resetSelection(),h.pageNumber=0,h.results=[],n){h.searchInput.value!==n&&(h.searchInput.value=n);const o=function(N,W,R){for(let m=0;m<N.length;m++)if((""+N[m]).toLowerCase().search(W)>=0||(""+h.records[R][m].element.innerHTML).toLowerCase().search(W)>=0)return!0;return!1},d=function(N){h.results.indexOf(N)==-1&&h.results.push(N)};let C=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");C=new RegExp(C,"i"),h.options.data.forEach(function(N,W){if(o(N,C,W)){const R=merges.D0.call(h,W);if(R.length)for(let m=0;m<R.length;m++){const a=(0,internalHelpers.vu)(R[m],!0);for(let v=0;v<h.options.mergeCells[R[m]][1];v++)d(a[1]+v)}else d(W)}})}else h.results=null;internal.hG.call(h)},resetSearch=function(){const n=this;n.searchInput.value="",n.search(""),n.results=null},getHeader=function(n){return this.headers[n].textContent},getHeaders=function(n){const h=this,o=[];for(let d=0;d<h.headers.length;d++)o.push(h.getHeader(d));return n?o:o.join(h.options.csvDelimiter)},setHeader=function(n,h){const o=this;if(o.headers[n]){const d=o.headers[n].textContent,C=o.options.columns&&o.options.columns[n]&&o.options.columns[n].title||"";h||(h=(0,helpers.getColumnName)(n)),o.headers[n].textContent=h,o.headers[n].setAttribute("title",h),o.options.columns||(o.options.columns=[]),o.options.columns[n]||(o.options.columns[n]={}),o.options.columns[n].title=h,utils_history.Dh.call(o,{action:"setHeader",column:n,oldValue:d,newValue:h}),dispatch.A.call(o,"onchangeheader",o,parseInt(n),h,C)}},getStyle=function(n,h){const o=this;if(n)return n=(0,internalHelpers.vu)(n,!0),h?o.records[n[1]][n[0]].element.style[h]:o.records[n[1]][n[0]].element.getAttribute("style");{const d={},C=o.options.data[0].length,N=o.options.data.length;for(let W=0;W<N;W++)for(let R=0;R<C;R++){const m=h?o.records[W][R].element.style[h]:o.records[W][R].element.getAttribute("style");m&&(d[(0,internalHelpers.t3)([R,W])]=m)}return d}},setStyle=function(n,h,o,d,C){const N=this,W={},R={},m=function(v,I,A){const l=(0,internalHelpers.vu)(v,!0);if(N.records[l[1]]&&N.records[l[1]][l[0]]&&(N.records[l[1]][l[0]].element.classList.contains("readonly")==0||d)){const s=N.records[l[1]][l[0]].element.style[I];s!=A||d?N.records[l[1]][l[0]].element.style[I]=A:(A="",N.records[l[1]][l[0]].element.style[I]=""),R[v]||(R[v]=[]),W[v]||(W[v]=[]),R[v].push([I+":"+s]),W[v].push([I+":"+A])}};if(h&&o)typeof n=="string"&&m(n,h,o);else{const v=Object.keys(n);for(let I=0;I<v.length;I++){let A=n[v[I]];typeof A=="string"&&(A=A.split(";"));for(let l=0;l<A.length;l++)typeof A[l]=="string"&&(A[l]=A[l].split(":")),A[l][0].trim()&&m(v[I],A[l][0].trim(),A[l][1])}}let a=Object.keys(R);for(let v=0;v<a.length;v++)R[a[v]]=R[a[v]].join(";");a=Object.keys(W);for(let v=0;v<a.length;v++)W[a[v]]=W[a[v]].join(";");C||utils_history.Dh.call(N,{action:"setStyle",oldValue:R,newValue:W}),dispatch.A.call(N,"onchangestyle",N,W)},resetStyle=function(n,h){const o=this,d=Object.keys(n);for(let C=0;C<d.length;C++){const N=(0,internalHelpers.vu)(d[C],!0);o.records[N[1]]&&o.records[N[1]][N[0]]&&o.records[N[1]][N[0]].element.setAttribute("style","")}o.setStyle(n,null,null,null,h)},download=function(n,h){const o=this;if(o.parent.config.allowExport==0)console.error("Export not allowed");else{let d="";d+=copy.call(o,!1,o.options.csvDelimiter,!0,n,!0,void 0,h);const C=new Blob(["\uFEFF"+d],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(C,(o.options.csvFileName||o.options.worksheetName)+".csv");else{const N=document.createElement("a");N.setAttribute("target","_top");const W=URL.createObjectURL(C);N.href=W,N.setAttribute("download",(o.options.csvFileName||o.options.worksheetName)+".csv"),document.body.appendChild(N),N.click(),N.parentNode.removeChild(N)}}},getComments=function(n){const h=this;if(n)return typeof n!="string"?getComments.call(h):(n=(0,internalHelpers.vu)(n,!0),h.records[n[1]][n[0]].element.getAttribute("title")||"");{const o={};for(let d=0;d<h.options.data.length;d++)for(let C=0;C<h.options.columns.length;C++){const N=h.records[d][C].element.getAttribute("title");N&&(o[(0,internalHelpers.t3)([C,d])]=N)}return o}},setComments=function(n,h){const o=this;let d;d=typeof n=="string"?{[n]:h}:n;const C={};Object.entries(d).forEach(function([N,W]){const R=(0,helpers.getCoordsFromCellName)(N);C[N]=o.records[R[1]][R[0]].element.getAttribute("title"),o.records[R[1]][R[0]].element.setAttribute("title",W||""),W?(o.records[R[1]][R[0]].element.classList.add("jss_comments"),o.options.comments||(o.options.comments={}),o.options.comments[N]=W):(o.records[R[1]][R[0]].element.classList.remove("jss_comments"),o.options.comments&&o.options.comments[N]&&delete o.options.comments[N])}),utils_history.Dh.call(o,{action:"setComments",newValue:d,oldValue:C}),dispatch.A.call(o,"oncomments",o,d,C)};var orderBy=__webpack_require__(94);const getWorksheetConfig=function(){return this.options},getSpreadsheetConfig=function(){return this.config},setConfig=function(n,h){const o=this,d=Object.keys(n);let C;o.parent?C=o.parent:(h=!0,C=o),d.forEach(function(N){h?(C.config[N]=n[N],N==="toolbar"&&(n[N]===!0?C.showToolbar():n[N]===!1&&C.hideToolbar())):o.options[N]=n[N]})};var meta=__webpack_require__(654);const setReadOnly=function(n,h){const o=this;let d;if(typeof n=="string"){const C=(0,helpers.getCoordsFromCellName)(n);d=o.records[C[1]][C[0]]}else{const C=parseInt(n.getAttribute("data-x")),N=parseInt(n.getAttribute("data-y"));d=o.records[N][C]}h?d.element.classList.add("readonly"):d.element.classList.remove("readonly")},isReadOnly=function(n,h){return typeof n=="string"&&h===void 0&&([n,h]=(0,helpers.getCoordsFromCellName)(n)),this.records[h][n].element.classList.contains("readonly")},setWorksheetFunctions=function(n){for(let h=0;h<worksheetPublicMethodsLength;h++){const[o,d]=worksheetPublicMethods[h];n[o]=d.bind(n)}},createTable=function(){let n=this;setWorksheetFunctions(n),n.table=document.createElement("table"),n.thead=document.createElement("thead"),n.tbody=document.createElement("tbody"),n.headers=[],n.cols=[],n.content=document.createElement("div"),n.content.classList.add("jss_content"),n.content.onscroll=function(I){scrollControls.call(n,I)},n.content.onwheel=function(I){wheelControls.call(n,I)};const h=document.createElement("div"),o=document.createElement("label");o.innerHTML=jSuites.translate("Search")+": ",h.appendChild(o),n.searchInput=document.createElement("input"),n.searchInput.classList.add("jss_search"),o.appendChild(n.searchInput),n.searchInput.onfocus=function(){n.resetSelection()};const d=document.createElement("div");if(n.options.pagination>0&&n.options.paginationOptions&&n.options.paginationOptions.length>0){n.paginationDropdown=document.createElement("select"),n.paginationDropdown.classList.add("jss_pagination_dropdown"),n.paginationDropdown.onchange=function(){n.options.pagination=parseInt(this.value),n.page(0)};for(let I=0;I<n.options.paginationOptions.length;I++){const A=document.createElement("option");A.value=n.options.paginationOptions[I],A.innerHTML=n.options.paginationOptions[I],n.paginationDropdown.appendChild(A)}n.paginationDropdown.value=n.options.pagination,d.appendChild(document.createTextNode(jSuites.translate("Show "))),d.appendChild(n.paginationDropdown),d.appendChild(document.createTextNode(jSuites.translate("entries")))}const C=document.createElement("div");C.classList.add("jss_filter"),C.appendChild(d),C.appendChild(h),n.colgroupContainer=document.createElement("colgroup");let N=document.createElement("col");if(N.setAttribute("width","50"),n.colgroupContainer.appendChild(N),n.options.nestedHeaders&&n.options.nestedHeaders.length>0&&n.options.nestedHeaders[0]&&n.options.nestedHeaders[0][0])for(let I=0;I<n.options.nestedHeaders.length;I++)n.thead.appendChild(internal.ju.call(n,n.options.nestedHeaders[I]));n.headerContainer=document.createElement("tr"),N=document.createElement("td"),N.classList.add("jss_selectall"),n.headerContainer.appendChild(N);const W=getNumberOfColumns.call(n);for(let I=0;I<W;I++)createCellHeader.call(n,I),n.headerContainer.appendChild(n.headers[I]),n.colgroupContainer.appendChild(n.cols[I].colElement);if(n.thead.appendChild(n.headerContainer),n.options.filters==1){n.filter=document.createElement("tr");const I=document.createElement("td");n.filter.appendChild(I);for(let A=0;A<n.options.columns.length;A++){const l=document.createElement("td");l.innerHTML="&nbsp;",l.setAttribute("data-x",A),l.className="jss_column_filter",n.options.columns[A].type=="hidden"&&(l.style.display="none"),n.filter.appendChild(l)}n.thead.appendChild(n.filter)}n.table=document.createElement("table"),n.table.classList.add("jss_worksheet"),n.table.setAttribute("cellpadding","0"),n.table.setAttribute("cellspacing","0"),n.table.setAttribute("unselectable","yes"),n.table.appendChild(n.colgroupContainer),n.table.appendChild(n.thead),n.table.appendChild(n.tbody),n.options.textOverflow||n.table.classList.add("jss_overflow"),n.corner=document.createElement("div"),n.corner.className="jss_corner",n.corner.setAttribute("unselectable","on"),n.corner.setAttribute("onselectstart","return false"),n.options.selectionCopy==0&&(n.corner.style.display="none"),n.textarea=document.createElement("textarea"),n.textarea.className="jss_textarea",n.textarea.id="jss_textarea",n.textarea.tabIndex="-1",n.textarea.ariaHidden="true";const R=document.createElement("a");R.setAttribute("href","https://bossanova.uk/jspreadsheet/"),n.ads=document.createElement("div"),n.ads.className="jss_about";const m=document.createElement("span");m.innerHTML="Jspreadsheet CE",R.appendChild(m),n.ads.appendChild(R),document.createElement("div").classList.add("jss_table"),n.pagination=document.createElement("div"),n.pagination.classList.add("jss_pagination");const a=document.createElement("div"),v=document.createElement("div");if(n.pagination.appendChild(a),n.pagination.appendChild(v),n.options.pagination||(n.pagination.style.display="none"),n.options.search==1&&n.element.appendChild(C),n.content.appendChild(n.table),n.content.appendChild(n.corner),n.content.appendChild(n.textarea),n.element.appendChild(n.content),n.element.appendChild(n.pagination),n.element.appendChild(n.ads),n.element.classList.add("jss_container"),n.element.jssWorksheet=n,n.element.jspreadsheet=n,n.options.tableOverflow==1&&(n.options.tableHeight&&(n.content.style["overflow-y"]="auto",n.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",n.content.style.maxHeight=typeof n.options.tableHeight=="string"?n.options.tableHeight:n.options.tableHeight+"px"),n.options.tableWidth&&(n.content.style["overflow-x"]="auto",n.content.style.width=typeof n.options.tableWidth=="string"?n.options.tableWidth:n.options.tableWidth+"px")),n.options.tableOverflow!=1&&n.parent.config.toolbar&&n.element.classList.add("with-toolbar"),n.options.columnDrag!=0&&n.thead.classList.add("draggable"),n.options.columnResize!=0&&n.thead.classList.add("resizable"),n.options.rowDrag!=0&&n.tbody.classList.add("draggable"),n.options.rowResize!=0&&n.tbody.classList.add("resizable"),n.setData.call(n),n.options.style&&(n.setStyle(n.options.style,null,null,1,1),delete n.options.style),Object.defineProperty(n.options,"style",{enumerable:!0,configurable:!0,get(){return n.getStyle()}}),n.options.comments&&n.setComments(n.options.comments),n.options.classes){const I=Object.keys(n.options.classes);for(let A=0;A<I.length;A++){const l=(0,internalHelpers.vu)(I[A],!0);n.records[l[1]][l[0]].element.classList.add(n.options.classes[I[A]])}}},prepareTable=function(){const n=this;n.options.lazyLoading==1&&n.options.tableOverflow!=1&&n.parent.config.fullscreen!=1&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),n.options.lazyLoading=!1),n.options.columns||(n.options.columns=[]);let h,o=n.options.columns.length;if(n.options.data&&n.options.data[0]!==void 0)if(Array.isArray(n.options.data[0])){const C=n.options.data[0].length;C>o&&(o=C)}else h=Object.keys(n.options.data[0]),h.length>o&&(o=h.length);n.options.minDimensions||(n.options.minDimensions=[0,0]),n.options.minDimensions[0]>o&&(o=n.options.minDimensions[0]);const d=[];for(let C=0;C<o;C++)n.options.columns[C]||(n.options.columns[C]={}),!n.options.columns[C].name&&h&&h[C]&&(n.options.columns[C].name=h[C]),n.options.columns[C].type=="dropdown"&&n.options.columns[C].url&&d.push({url:n.options.columns[C].url,index:C,method:"GET",dataType:"json",success:function(N){n.options.columns[this.index].source||(n.options.columns[this.index].source=[]);for(let W=0;W<N.length;W++)n.options.columns[this.index].source.push(N[W])}});d.length?jSuites.ajax(d,function(){createTable.call(n)}):createTable.call(n)},getNextDefaultWorksheetName=function(n){const h=/^Sheet(\d+)$/;let o=0;return n.worksheets.forEach(function(d){const C=h.exec(d.options.worksheetName);C&&(o=Math.max(o,parseInt(C[1])))}),"Sheet"+(o+1)},buildWorksheet=async function(){const n=this,h=(n.element,n.parent);typeof h.plugins=="object"&&Object.entries(h.plugins).forEach(function([,d]){typeof d.beforeinit=="function"&&d.beforeinit(n)}),libraryBase.jspreadsheet.current=n;const o=[];if(n.options.csv){const d=new Promise(C=>{jSuites.ajax({url:n.options.csv,method:"GET",dataType:"text",success:function(N){const W=(0,helpers.parseCSV)(N,n.options.csvDelimiter);if(n.options.csvHeaders==1&&W.length>0){const R=W.shift();if(R.length>0){n.options.columns||(n.options.columns=[]);for(let m=0;m<R.length;m++)n.options.columns[m]||(n.options.columns[m]={}),n.options.columns[m].title===void 0&&(n.options.columns[m].title=R[m])}}n.options.data=W,prepareTable.call(n),C()}})});o.push(d)}else if(n.options.url){const d=new Promise(C=>{jSuites.ajax({url:n.options.url,method:"GET",dataType:"json",success:function(N){n.options.data=N.data?N.data:N,prepareTable.call(n),C()}})});o.push(d)}else prepareTable.call(n);await Promise.all(o),typeof h.plugins=="object"&&Object.entries(h.plugins).forEach(function([,d]){typeof d.init=="function"&&d.init(n)})},createWorksheetObj=function(n){const h=this.parent;n.worksheetName||(n.worksheetName=getNextDefaultWorksheetName(this.parent));const o={parent:h,options:n,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return h.config.worksheets.push(o.options),h.worksheets.push(o),o},createWorksheet=function(n){const h=this.parent;h.creationThroughJss=!0,createWorksheetObj.call(this,n),h.element.tabs.create(n.worksheetName)},openWorksheet=function(n){this.parent.element.tabs.open(n)},deleteWorksheet=function(n){const h=this;h.parent.element.tabs.remove(n);const o=h.parent.worksheets.splice(n,1)[0];dispatch.A.call(h.parent,"ondeleteworksheet",o,n)},worksheetPublicMethods=[["selectAll",selection.Ub],["updateSelectionFromCoords",function(n,h,o,d){return selection.AH.call(this,n,h,o,d)}],["resetSelection",function(){return selection.gE.call(this)}],["getSelection",selection.Lo],["getSelected",selection.ef],["getSelectedColumns",selection.Jg],["getSelectedRows",selection.R5],["getData",getData],["setData",setData],["getValue",getValue],["getValueFromCoords",getValueFromCoords],["setValue",setValue],["setValueFromCoords",setValueFromCoords],["getWidth",getWidth],["setWidth",function(n,h){return setWidth.call(this,n,h)}],["insertRow",insertRow],["moveRow",function(n,h){return moveRow.call(this,n,h)}],["deleteRow",deleteRow],["hideRow",hideRow],["showRow",showRow],["getRowData",getRowData],["setRowData",setRowData],["getHeight",getHeight],["setHeight",function(n,h){return setHeight.call(this,n,h)}],["getMerge",merges.fd],["setMerge",function(n,h,o){return merges.FU.call(this,n,h,o)}],["destroyMerge",function(){return merges.VP.call(this)}],["removeMerge",function(n,h){return merges.Zp.call(this,n,h)}],["search",search],["resetSearch",resetSearch],["getHeader",getHeader],["getHeaders",getHeaders],["setHeader",setHeader],["getStyle",getStyle],["setStyle",function(n,h,o,d){return setStyle.call(this,n,h,o,d)}],["resetStyle",resetStyle],["insertColumn",insertColumn],["moveColumn",moveColumn],["deleteColumn",deleteColumn],["getColumnData",getColumnData],["setColumnData",setColumnData],["whichPage",pagination.ho],["page",pagination.MY],["download",download],["getComments",getComments],["setComments",setComments],["orderBy",orderBy.My],["undo",utils_history.tN],["redo",utils_history.ZS],["getCell",internal.tT],["getCellFromCoords",internal.Xr],["getLabel",internal.p9],["getConfig",getWorksheetConfig],["setConfig",setConfig],["getMeta",function(n){return meta.IQ.call(this,n)}],["setMeta",meta.iZ],["showColumn",showColumn],["hideColumn",hideColumn],["showIndex",internal.C6],["hideIndex",internal.TI],["getWorksheetActive",internal.$O],["openEditor",openEditor],["closeEditor",closeEditor],["createWorksheet",createWorksheet],["openWorksheet",openWorksheet],["deleteWorksheet",deleteWorksheet],["copy",function(n){n?cutControls():copy.call(this,!0)}],["paste",paste],["executeFormula",internal.Em],["getDataFromRange",getDataFromRange],["quantiyOfPages",pagination.$f],["getRange",selection.eO],["isSelected",selection.sp],["setReadOnly",setReadOnly],["isReadOnly",isReadOnly],["getHighlighted",selection.kV],["dispatch",dispatch.A],["down",down],["first",first],["last",last],["left",left],["right",right],["up",up],["openFilter",filter.N$],["resetFilters",filter.dr]],worksheetPublicMethodsLength=worksheetPublicMethods.length,factory=function(){},createWorksheets=async function(n,h,o){let d=h.worksheets;if(!d)throw new Error("JSS: worksheets are not defined");{let C={animation:!0,onbeforecreate:function(m,a){return a||getNextDefaultWorksheetName(n)},oncreate:function(m,a){if(n.creationThroughJss)n.creationThroughJss=!1;else{const I=m.tabs.headers.children[m.tabs.headers.children.length-2].innerHTML;createWorksheetObj.call(n.worksheets[0],{minDimensions:[10,15],worksheetName:I})}const v=n.worksheets[n.worksheets.length-1];v.element=a,buildWorksheet.call(v).then(function(){(0,toolbar.nK)(v),dispatch.A.call(v,"oncreateworksheet",v,h,n.worksheets.length-1)})},onchange:function(m,a,v){n.worksheets.length!=0&&n.worksheets[v]&&(0,toolbar.nK)(n.worksheets[v])}};h.tabs==1?C.allowCreate=!0:C.hideHeaders=!0,C.data=[];let N=1;for(let m=0;m<d.length;m++)d[m].worksheetName||(d[m].worksheetName="Sheet"+N++),C.data.push({title:d[m].worksheetName,content:""});o.classList.add("jss_spreadsheet"),o.tabIndex=0;const W=jSuites.tabs(o,C),R=h.style;delete h.style;for(let m=0;m<d.length;m++)d[m].style&&Object.entries(d[m].style).forEach(function([a,v]){typeof v=="number"&&(d[m].style[a]=R[v])}),n.worksheets.push({parent:n,element:W.content.children[m],options:d[m],filters:[],formula:[],history:[],selection:[],historyIndex:-1}),await buildWorksheet.call(n.worksheets[m])}};factory.spreadsheet=async function(n,h,o){if(n.tagName=="TABLE"){h||(h={}),h.worksheets||(h.worksheets=[]);const C=(0,helpers.createFromTable)(n,h.worksheets[0]);h.worksheets[0]=C;const N=document.createElement("div");n.parentNode.insertBefore(N,n),n.remove(),n=N}let d={worksheets:o,config:h,element:n,el:n};return d.contextMenu=document.createElement("div"),d.contextMenu.className="jss_contextmenu",d.getWorksheetActive=internal.$O.bind(d),d.fullscreen=internal.Y5.bind(d),d.showToolbar=toolbar.ll.bind(d),d.hideToolbar=toolbar.Ar.bind(d),d.getConfig=getSpreadsheetConfig.bind(d),d.setConfig=setConfig.bind(d),d.setPlugins=function(C){d.plugins||(d.plugins={}),typeof C=="object"&&Object.entries(C).forEach(function([N,W]){d.plugins[N]=W.call(libraryBase.jspreadsheet,d,{},d.config)})},d.setPlugins(h.plugins),await createWorksheets(d,h,n),d.element.appendChild(d.contextMenu),jSuites.contextmenu(d.contextMenu,{onclick:function(){d.contextMenu.contextmenu.close(!1)}}),d.config.fullscreen==1&&d.element.classList.add("fullscreen"),toolbar.ll.call(d),h.root?setEvents(h.root):setEvents(document),n.spreadsheet=d,d},factory.worksheet=function(n,h,o){let d={parent:n,options:{}};return o===void 0?n.worksheets.push(d):n.worksheets.splice(o,0,d),Object.assign(d.options,h),d};var utils_factory=factory;libraryBase.jspreadsheet=function(n,h){try{let o=[];return utils_factory.spreadsheet(n,h,o).then(d=>{libraryBase.jspreadsheet.spreadsheet.push(d),dispatch.A.call(d,"onload",d)}),o}catch(o){console.error(o)}},libraryBase.jspreadsheet.getWorksheetInstanceByName=function(n,h){const o=libraryBase.jspreadsheet.spreadsheet.find(d=>d.config.namespace===h);if(o)return{};if(n==null){const d=o.worksheets.map(C=>[C.options.worksheetName,C]);return Object.fromEntries(d)}return o.worksheets.find(d=>d.options.worksheetName===n)},libraryBase.jspreadsheet.setDictionary=function(n){jSuites.setDictionary(n)},libraryBase.jspreadsheet.destroy=function(n,h){if(n.spreadsheet){const o=libraryBase.jspreadsheet.spreadsheet.indexOf(n.spreadsheet);libraryBase.jspreadsheet.spreadsheet.splice(o,1);const d=n.spreadsheet.config.root||document;n.spreadsheet=null,n.innerHTML="",h&&destroyEvents(d)}},libraryBase.jspreadsheet.destroyAll=function(){for(let n=0;n<libraryBase.jspreadsheet.spreadsheet.length;n++){const h=libraryBase.jspreadsheet.spreadsheet[n];libraryBase.jspreadsheet.destroy(h.element)}},libraryBase.jspreadsheet.current=null,libraryBase.jspreadsheet.spreadsheet=[],libraryBase.jspreadsheet.helpers={},libraryBase.jspreadsheet.version=function(){return version},Object.entries(helpers).forEach(([n,h])=>{libraryBase.jspreadsheet.helpers[n]=h});var src=libraryBase.jspreadsheet;jspreadsheet=__webpack_exports__.default}(),jspreadsheet})})(dist$1);var distExports=dist$1.exports;const jspreadsheet=getDefaultExportFromCjs(distExports);class MySpreadsheetElement extends HTMLElement{_spreadsheet=null;_buttonListener;_customListeners={};constructor(){super(),this._spreadsheet=null}addListener(h,o){this.addEventListener(h,o),this._customListeners[h]=o}static create({id:h,data:o=[],minDimensions:d=[5,5],style:C={},columns:N=[],interactif:W=!1}={}){const R=new MySpreadsheetElement;return h&&(R.id=h),R.setAttribute("data",JSON.stringify(o)),R.setAttribute("min-dimensions",JSON.stringify(d)),R.setAttribute("style",JSON.stringify(C)),R.setAttribute("columns",JSON.stringify(N)),R.setAttribute("interactif",W?"true":"false"),R}connectedCallback(){this.innerHTML="<div></div>";const h=this.firstElementChild??document.createElement("div");let o=[],d=[5,5],C={},N=[];try{this.getAttribute("data")&&(o=JSON.parse(this.getAttribute("data")??""))}catch{}try{this.getAttribute("min-dimensions")&&(d=JSON.parse(this.getAttribute("min-dimensions")??""))}catch{}try{this.getAttribute("style")&&(C=JSON.parse(this.getAttribute("style")??""))}catch{}try{this.getAttribute("columns")&&(N=JSON.parse(this.getAttribute("columns")??"[]"))}catch{}this._spreadsheet=jspreadsheet(h,{tabs:!1,toolbar:!1,worksheets:[{data:o,minDimensions:d,tableOverflow:!0,tableHeight:"300px",style:C,columns:N}]})[0];let W=0,R=0;const m=this.id.match(/sheet-Ex(\d+)Q(\d+)$/);m&&(W=Number(m[1]),R=Number(m[2]));const a=document.createElement("div");a.id="message-faux",h.appendChild(a);const v=document.createElement("span");v.id=`resultatCheckEx${W}Q${R}`,h.appendChild(v);const I=document.createElement("div");I.id=`feedbackEx${W}Q${R}`,I.className="italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest",h.appendChild(I);const A=document.createElement("button");if(A.id="runCode",A.textContent="Vérifier",A.style.boxSizing="border-box",A.style.position="relative",A.style.zIndex="10",A.style.marginTop="10px",A.style.backgroundColor="#2b6cb0",A.style.color="white",A.style.border="none",A.style.borderRadius="6px",A.style.padding="8px 20px",A.style.fontSize="1rem",A.style.fontWeight="bold",A.style.cursor="pointer",A.style.boxShadow="0 2px 6px rgba(0,0,0,0.08)",A.onmouseover=()=>{A.style.backgroundColor="#174ea6"},A.onmouseout=()=>{A.style.backgroundColor="#2b6cb0"},A.style.display=this.getAttribute("interactif")==="true"?"none":"block",h.appendChild(A),m){const l=Number(m[1]),s=Number(m[2]);this._setupButton(A,l,s)}this.dispatchEvent(new CustomEvent("spreadsheet-ready"))}disconnectedCallback(){this._spreadsheet&&(this._spreadsheet=null);const h=this.querySelector("#runCode");h&&this._buttonListener&&h.removeEventListener("click",this._buttonListener),Object.entries(this._customListeners).forEach(([o,d])=>{this.removeEventListener(o,d)}),this._customListeners={}}_setupButton(h,o,d){const C=`checkEx${o}Q${d}`;this._buttonListener=()=>{this.dispatchEvent(new CustomEvent(C,{detail:{sheet:this}}))},h.addEventListener("click",this._buttonListener)}getCellValue(h,o){return this._spreadsheet.getValueFromCoords(h,o,!0)}getCellFormula(h,o){return this._spreadsheet.getValueFromCoords(h,o,!1)}getData(){return this._spreadsheet.getData()??[]}setCellValue(h,o,d){this._spreadsheet.setValueFromCoords(h,o,d,!0)}setCellFormula(h,o,d){d.startsWith("=")||(d="="+d),this._spreadsheet.setValueFromCoords(h,o,d,!0)}setData(h){this._spreadsheet.setData(h)}isMounted(){return this._spreadsheet!==null}getMinDimensions(){return this._spreadsheet.minDimensions??[5,5]}getStyle(){return this._spreadsheet.style??{}}getColumns(){return this._spreadsheet.columns??[]}}customElements.define("my-spreadsheet",MySpreadsheetElement);function addSheet({numeroExercice:n,question:h,data:o,minDimensions:d,style:C,columns:N,interactif:W}){return`<my-spreadsheet
  id="sheet-Ex${n}Q${h}"
  data='${JSON.stringify(o)}'
  min-dimensions='${JSON.stringify(d)}'
  style='${JSON.stringify(C)}'
  columns='${JSON.stringify(N)}'
  interactif='${W}'
>`+(W?`<div class="ml-2 py-2" id="resultatCheckEx${n}Q${h}"></div>
<div class ="ml-2 py-2 italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest" id="feedbackEx${n}Q${h}"}></div>`:"")+"</my-spreadsheet>"}const titre="Programmer des calculs sur tableur",dateDePublication="12/08/2025",interactifReady=!0,interactifType="custom",uuid="ae07c",refs={"fr-fr":["6I1B-4"],"fr-ch":[]},alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";class ExerciceTableur extends Exercice{destroyers=[];listeSteps=[];constructor(){super(),this.nbQuestions=2,this.besoinFormulaireNumerique=["Nombre d'opérations (entre 2 et 5 ou bien 1 si vous laissez le hasard décider)",5],this.besoinFormulaire2Texte=["Type d'opérations",["Nombres séparés par des tirets  :","1 : Addition","2 : Soustraction","3 : Multiplication","4 : Division","5 : Mélange"].join(`
`)],this.sup=3,this.sup2=5,this.listeSteps=[]}destroy(){this.destroyers.forEach(h=>h()),this.destroyers.length=0}static colors={orange:"#e6b457",vert:"#7adb7a",jaune:"#e6e66a",bleu:"#8181e6",violet:"#f8a3f8",rouge:"#eca2a2"};static styles={style_id_rouge:{fs:12,bg:ExerciceTableur.colors.rouge},style_id_bleu:{fs:12,bg:ExerciceTableur.colors.bleu},style_id_orange:{fs:12,bg:ExerciceTableur.colors.orange},style_id_violet:{fs:12,bg:ExerciceTableur.colors.violet},style_id_vert:{fs:12,bg:ExerciceTableur.colors.vert},style_id_jaune:{fs:12,bg:ExerciceTableur.colors.jaune}};validateFormulas(h,o){const d=o.getData(),C=MySpreadsheetElement.create({data:d,minDimensions:o.getMinDimensions(),style:o.getStyle(),columns:o.getColumns(),interactif:!1,id:"testSheet"});C.style.position="absolute",C.style.left="-9999px",document.body.appendChild(C);const N=[];for(let m=0;m<5;m++){N[m]=[];const a=randint(1,10);C.setCellValue(0,0,a);const v=[1,2,3].map(A=>parseFloat(C.getCellValue(A,0)));for(let A=1;A<4;A++)(typeof v[A-1]!="number"||isNaN(v[A-1]))&&N[m].push(`La cellule ${String.fromCharCode(65+A)}1 ne contient pas un nombre valide.<br>`);for(let A=1;A<4;A++)(typeof C.getCellFormula(A,0)!="string"||!C.getCellFormula(A,0).startsWith("="))&&N[m].push(`La cellule ${String.fromCharCode(65+A)}1 ne contient pas une formule valide.<br>`);let I=a;for(let A=1;A<4;A++){const l=this.listeSteps[h];I=evaluate(I,l[A-1].op,l[A-1].val);const s=parseFloat(C.getCellValue(A,0));Math.abs(s-I)>1e-9&&N[m].push(`Pour un nombre de départ égal à ${a}, la cellule ${String.fromCharCode(65+A)}1 devrait contenir ${texNombre(I,2)} mais elle contient ${texNombre(s,2)}.<br>`)}}const W=N.reduce((m,a)=>a.length>m.length?a:m,[]);document.body.removeChild(C);const R=W.length===0?"✅ Toutes les formules sont correctes !":"❌ Des erreurs ont été détéctées.";return{isOk:W.length===0,messages:W.join("")+R}}checkSolution(h){const o=h?.type,d=o?.match(/Q(\d+)/)?.[1];if(!d){console.error("Question number not found in event name:",o);return}const C=o?.replace("check","sheet-")||"",N=document.getElementById(C);if(N&&N.isMounted()){const{messages:W}=this.validateFormulas(Number(d),N),R=N.querySelector("#message-faux");W&&R&&(R.style.color="green",R.innerHTML=W)}}nouvelleVersion(){this.destroyers.forEach(C=>C()),this.destroyers.length=0;const h=this.sup===1?randint(2,5):Math.min(Math.max(2,this.sup),5),o=gestionnaireFormulaireTexte({saisie:this.sup2,min:1,max:4,melange:5,defaut:5,nbQuestions:h});this.listeSteps=[];const d=Object.entries(ExerciceTableur.colors);for(let C=0,N=0,W,R;C<this.nbQuestions&&N<50;N++){const{steps:m}=programmeCalcul(o);this.listeSteps[C]=m;const a=transformationsOper(m),v={0:{0:{v:m[0].oldn,s:"style_id_orange",t:2}}};for(let s=0;s<m.length;s++)v[0][s+1]={v:"",s:`style_id_${d[(s+1)%d.length][0]}`};const I=[[]];I[0][0]=v[0][0].v;for(let s=0;s<m.length;s++)I[0][s+1]=v[0][s+1].v;const A={0:{v:m[0].oldn.toString(),bg:d[0][1]}};for(let s=0,g=1;s<m.length;s++,g+=2)A[`${g}`]={v:a[s]},A[`${g+1}`]={bg:d[(s+1)%d.length][1]};W="On a créé le programme de calculs suivant :<br>",W+=createDigramm(Object.keys(A).length,A)+"<br>",W+=`On choisit un nombre dans la première case, ici ${m[0].oldn} et on obtient un nombre à la fin de la chaîne.<br><br>      
      On veut programmer cette suite de calculs dans un tableur. <br>
      Par exemple, la cellule B1 doit contenir la formule du premier calcul.<br>
      Faire de même pour les autres cellules. <br>
      Attention, les formules doivent fonctionner même si le nombre de départ change (Cellule A1).<br>
      `,W+=addSheet({numeroExercice:this.numeroExercice??0,question:C,data:I,minDimensions:[4,4],style:{A1:`background-color:   ${ExerciceTableur.colors.orange}; font-weight: bold;`,B1:`background-color: ${ExerciceTableur.colors.vert};`,C1:`background-color: ${ExerciceTableur.colors.jaune};`,D1:`background-color: ${ExerciceTableur.colors.bleu};`},columns:[{width:90},{width:90},{width:90},{width:90}],interactif:this.interactif}),R="Voici les formules à saisir dans le tableur :<br>";for(let s=0;s<m.length;s++){const g=m[s];R+=`$${g.oldn} ${a[s]} = ${g.result}$ devient en cellule ${alphabet[s+1]}1 la formule suivante : "=${alphabet[s]}1${a[s].replace("\\times","*").replace("\\div","/")}"<br>`}const l=()=>{const s=Array.from(document.querySelectorAll("my-spreadsheet"));for(const g of s){const f=g.id.match(/Q(\d+)$/)?.[1],c=f!==void 0&&this.numeroExercice!==void 0?`checkEx${this.numeroExercice}Q${f}`:void 0;if(g&&c){const w=L=>{this.checkSolution(L)};g.addListener(c,w)}else console.error(`SheetElement not found or eventName invalid for question ${f} in exercice ${this.numeroExercice}`)}document.removeEventListener("exercicesAffiches",l)};document.addEventListener("exercicesAffiches",l,{once:!0}),this.questionJamaisPosee(C,W)&&(this.listeQuestions[C]=W,this.listeCorrections[C]=R,C++),listeQuestionsToContenu(this)}}correctionInteractive=h=>{if(h===void 0)return"";this.answers===void 0&&(this.answers={});let o="KO";const d=document.getElementById(`sheet-Ex${this.numeroExercice}Q${h}`);if(!d)return console.error(`sheet-Ex${this.numeroExercice}Q${h} not found`),o;if(d&&d.isMounted()){this.answers[`sheet-Ex${this.numeroExercice}Q${h}`]=JSON.stringify(d.getData());const C=document.querySelector(`#resultatCheckEx${this.numeroExercice}Q${h}`),N=document.querySelector(`#feedbackEx${this.numeroExercice}Q${h}`),{isOk:W,messages:R}=this.validateFormulas(h,d);R.length>0&&C&&N&&(N.innerHTML=R,W?(C&&(C.innerHTML="😊"),o="OK"):C&&(C.innerHTML="☹️"))}return o}}function transformationsOper(n){function h(o){const d={1:"+",2:"−",3:"\\times",4:"\\div"};return o.map(C=>(d[C.op]||"?")+C.val)}return h(n)}function evaluate(n,h,o){return h===1?n+o:h===2?n-o:h===3?n*o:h===4?n/o:NaN}function programmeCalcul(n=[1,2,3,4]){let h=[],o=null,d=n,C=0,N=!1;for(;!N&&C<20;){d=shuffle(d);let W=randint(5,20);h=[],N=!0;for(let R=0,m=0;R<d.length&&m<4;){if(m>0){const l=d.slice(0,R),s=shuffle(d.slice(R));d=[...l,...s]}const a=d[R],v=W;let I=1;const A=R>0?h[R-1].val:1;if(a===1)if(50-W<2||50-W===2&&A===2){m++;continue}else I=randint(2,50-W,[A]),W+=I,R++,m=0;else if(a===2)if(W<2||W===2&&A===2){m++;continue}else I=randint(2,W,[A]),W-=I,R++,m=0;else if(a===3){const l=W<1?5:Math.floor(50/W);if(l<2||l===2&&A===2){m++;continue}else I=randint(2,l,[A]),W*=I,R++,m=0}else if(a===4){const l=listeDesDiviseurs(W).filter(s=>s>1&&s<W);if(l.length===0||l.length===1&&l[0]===A){m++;continue}else I=choice(l,[A]),W/=I,R++,m=0}if(W<0||W>50||!Number.isInteger(W)){m+=10;continue}h.push({oldn:v,op:a,val:I,result:W})}h.length!==d.length&&(N=!1),N&&(o=W),C++}return{ops:d,steps:h,final:o}}function createDigramm(n,h){const N=[];for(let v=0;v<n;v++){const I=point(v*1.8+v*.8,0),A=point(I.x+1.8,0),l=point(A.x,1.5),s=point(I.x,1.5),g=h[v],f=polygone(I,A,l,s);if(g&&g.bg&&(f.couleurDeRemplissage=colorToLatexOrHTML(g.bg),f.opaciteDeRemplissage=1),N.push(f),g&&g.v){const c=latex2d(`${g.v}`,(I.x+A.x)/2,(I.y+s.y)/2,{color:"red",backgroundColor:"none",letterSize:"small",orientation:0,opacity:1});N.push(c)}if(v>0){const c=segment(I.x-.8,.75,I.x,.75,"#f15929");c.styleExtremites="->",N.push(c)}}const W=-.5,R=-.5,m=1.8*n+.8*(n-1)+.5,a=1.5+.5;return mathalea2d({xmin:W,ymin:R,xmax:m,ymax:a,mainlevee:!1,scale:1,style:"margin: auto",optionsTikz:["baseline=(current bounding box.north)"]},N)}export{dateDePublication,ExerciceTableur as default,interactifReady,interactifType,refs,titre,uuid};
