import{e as r,g as o}from"./generalStore-C3E9FHtR.js";import{g as s}from"./canStore-DaSrd7sp.js";import{createTextInput as i,createButon as a,createIButton as m}from"./_components-DYhbsKA3.js";import{g as h}from"./time-DMC-jnVL.js";import{E as n}from"./Exercice-DtXhjCyI.js";import{u as l}from"./sizeTools-DfTC1Dgv.js";import"./exerciseMethods-CtbYPwln.js";import"./index-BUDQz6-w.js";import"katex";import"./embellissements-BYV7mIDn.js";import"mathjs";import"decimal.js";import"earcut";import"roughjs";import"crypto-js";import"seedrandom";const C="video",z="Vidéo";class A extends n{container;iframe;fieldUrl;fieldText;teacherText;iTooltip;button;constructor(){super(),this.typeExercice="html",this.titre="Vidéo",this.container=document.createElement("div"),this.container.setAttribute("overflow","auto"),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("width","500"),this.iframe.setAttribute("height","315"),this.iframe.setAttribute("title","YouTube video player"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"),this.iframe.setAttribute("allowfullscreen",""),this.teacherText=document.createElement("div"),window.addEventListener("resize",this.updateSize),this.container.addEventListener("addedToDom",this.updateSize),this.iframe.setAttribute("id","iframe-video"+h("-")),this.fieldUrl=i({placeholder:"URL",autoCorrect:!1}),this.fieldText=i({placeholder:"Consigne éventuelle"}),this.fieldText.style.display="block",this.button=a();const e=`Formats supportés : 
- lien direct vers la vidéo
- peertube
- podeduc.apps.education.fr
- www.youtube.com
- youtu.be
- www.dailymotion.com
- dai.ly
- vimeo.com`;this.iTooltip=m({tooltip:e,direction:"bottom"}),this.container.append(this.fieldUrl,this.iTooltip,this.fieldText,this.teacherText,this.button,this.iframe),this.button.addEventListener("click",()=>{this.updateVideoFromUrl(),this.sup=encodeURIComponent(this.fieldUrl.value),this.fieldText.value!==""&&(this.sup2=encodeURIComponent(this.fieldText.value)),r.update(t=>(this.numeroExercice!==void 0&&t[this.numeroExercice]!==void 0&&(t[this.numeroExercice].sup=this.sup,this.fieldText.value!==""&&(t[this.numeroExercice].sup2=encodeURIComponent(this.fieldText.value))),t))})}updateSize=()=>{l(this.container,this.iframe)};destroy(){window.removeEventListener("resize",this.updateSize),this.container.removeEventListener("addedToDom",this.updateSize)}get html(){if(s(o).v==="eleve"&&(this.fieldUrl.remove(),this.fieldText.remove(),this.button.remove(),this.iTooltip.remove()),this.sup!==void 0){try{let e;try{e=new URL(decodeURIComponent(this.sup)),e.protocol==="http:"||e.protocol==="https:"||e.protocol==="ftp:"?e=e.href:e="data:text/html,Erreur"}catch{e="data:text/html,Erreur"}this.iframe.src=e,this.fieldUrl.value=e}catch{console.error("Invalid URI: ",this.sup)}this.updateVideoFromUrl()}if(this.sup2!==void 0)try{this.teacherText.textContent=decodeURIComponent(this.sup2)}catch{console.error("Invalid URI: ",this.sup2)}return this.container}updateVideoFromUrl(){const e=new URL(this.fieldUrl.value);e.hostname==="youtu.be"?(e.hostname="www.youtube.com",e.pathname="/embed"+e.pathname,this.iframe.src=e.toString()):e.hostname==="www.youtube.com"?this.iframe.src=e.toString().replace("watch?v=","embed/"):e.hostname==="www.dailymotion.com"?(e.pathname="/embed"+e.pathname,this.iframe.src=e.toString()):e.hostname==="dai.ly"?(e.hostname="www.dailymotion.com",e.pathname="/embed/video"+e.pathname,this.iframe.src=e.toString()):e.hostname==="vimeo.com"?(e.hostname="player.vimeo.com",e.pathname="/video"+e.pathname,this.iframe.src=e.toString()):e.hostname==="podeduc.apps.education.fr"?this.iframe.src=this.fieldUrl.value+"/?is_iframe=true":this.fieldUrl.value.includes("/w/")?this.iframe.src=this.fieldUrl.value.replace("/w/","/videos/embed/"):this.iframe.src=this.fieldUrl.value,this.teacherText.textContent=this.fieldText.value,this.titre=this.fieldText.value}}export{A as default,z as titre,C as uuid};
